/*
 RequireJS text 0.27.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

/*
 *  SliderNav - A Simple Content Slider with a Navigation Bar
 *  Copyright 2010 Monjurul Dolon, http://mdolon.com/
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://devgrow.com/slidernav
 */

define("com/es/widgets/WidgetUtils",[],function(){var e=new Object;return e.log=function(e){},e.isTouchDevice=function(){var e=String(document.documentElement.ontouchmove)!="undefined"?!0:!1;return e},e.isPhone=function(){return window.innerWidth<768?!0:!1},e.isiPhoneOriPod=function(){var e=navigator.userAgent,t=e.match(/iPhone/i),n=e.match(/iPod/i);return t||n?!0:!1},e.fillRange=function(e,t){var n=$(e).parent().css("color"),r=$(e).css("color");t*=100;var i="background: -webkit-linear-gradient(left, "+n+" 0%, "+n+" "+t+"%, "+r+" "+t+"%, "+r+" 100%);";i+="background: -moz-linear-gradient(left, "+n+" 0%, "+n+" "+t+"%, "+r+" "+t+"%, "+r+" 100%);",i+="background: -o-linear-gradient(left, "+n+" 0%, "+n+" "+t+"%, "+r+" "+t+"%, "+r+" 100%);";var s=$(e).attr("style"),o=s?s+" "+i:i;$(e).attr("style",o)},e.isIE=function(){if(navigator.userAgent.indexOf("MSIE")!=-1)var e=/MSIE (\d+\.\d+);/;else var e=/Trident.*rv[ :]*(\d+\.\d+)/;var t=e.test(navigator.userAgent);return t},e.getIEVersion=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=0;return t>0&&(n=parseInt(e.substring(t+5,e.indexOf(".",t)))),n},e.isAndriod=function(){var e=navigator.userAgent.toLowerCase(),t=e.indexOf("android")>-1;return t},e.isIOS=function(){var e=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;return e},e.getAndroidVersion=function(){var e=navigator.userAgent.toLowerCase(),t=e.indexOf("android"),n=0;return t!=-1&&(n=parseFloat(e.match(/android\s+([\d\.]+)/)[1])),n},e.parseHTML=function(e,t,n){if($.parseHTML)return $.parseHTML(e);if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||document;var r=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,i=r.exec(e),s=!n&&[];return i?[t.createElement(i[1])]:(i=$.buildFragment([e],t,s),s&&$(s).remove(),$.merge([],i.fragment.childNodes))},e.setCookie=function(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path=/"},e.getCookie=function(e){var t=e+"=",n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null},e.delCookie=function(t){e.setCookie(t,"",-1)},e.setLangCode=function(t,n){var r="en",i,s,o,u,a,f,l=String(document.documentElement.ontouchmove)!="undefined"?!0:!1;l?i=localStorage.getItem(WIDGET_CONSTANTS.LOCALE_COOKIE_NAME):i=e.getCookie(WIDGET_CONSTANTS.LOCALE_COOKIE_NAME),s=i&&i.toString().length>0?i:r,f=require.s.contexts._.config.resourceBundle?require.s.contexts._.config.resourceBundle:"default",o=s?require.toUrl("./resourceBundle/"+f+"/Strings/Strings_"+s+"/"+n):"",s!=="en"&&(u=require.toUrl("./resourceBundle/"+f+"/Strings/Strings_"+r+"/"+n)),a=function(e){window[t]=e,t==="AppLang"&&(window[t].VERSION+=WIDGET_CONSTANTS.VERSION)},$.ajax({async:!1,url:o,dataType:"json"}).done(function(e,t,n){a(e),WIDGET_CONSTANTS.LOCALE=s}).fail(function(e,t){console.error("Failed to load url: "+o+" with message: "+t),t==="error"&&u&&$.ajax({async:!1,url:u,dataType:"json"}).done(function(e,t,n){a(e),WIDGET_CONSTANTS.LOCALE=r}).fail(function(e,t){console.error("Failed to load url: "+u+" with message: "+t)})})},e.getOffset=function(e){return{left:e.get(0).offsetLeft,top:e.get(0).offsetTop}},e.getCleanURL=function(e){var t;return e.indexOf("file:///")>=0?(t=e.substr(e.indexOf("file:///")+8),t=t.replace(/([^:]\/)\/+/g,"$1"),t="file:///"+t):t=e.replace(/([^:]\/)\/+/g,"$1"),t},e.showLoader=function(){$("#loading-indicator").modal({show:!0,keyboard:!1,backdrop:"static"}),$(".modal-backdrop").last().css("z-index","9000")},e.hideLoader=function(){$("#loading-indicator").modal("hide")},e.sortObjByKey=function(e){var t=e,n=[],r,i,s,o={};for(r in t)t.hasOwnProperty(r)&&n.push(r);n.sort(),s=n.length;for(i=0;i<s;i++)r=n[i],o[r]=t[r];return o},e.injectCSSFile=function(t){var n=document.getElementsByTagName("head")[0],r=require.s.contexts._.config.readerCss;for(i=0;i<r.length;i++){var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.href="widgets/"+r[i],n.appendChild(s)}iframeHeadTag=t.document.getElementsByTagName("head")[0];var o=window.location.origin,u=window.location.pathname.split("/");u.pop();var a=u.join("/")+"/widgets/",f=require.s.contexts._.config.iframeCss;for(i=0;i<f.length;i++){var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.href=o+a+"/"+f[i],iframeHeadTag.appendChild(s)}if(parseFloat(e.getAndroidVersion())<4.4&&e.isAndriod()){var l=require.s.contexts._.config.iframeCss_android4;for(i=0;i<l.length;i++){var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.href=o+a+"/"+l[i],iframeHeadTag.appendChild(s)}}},e.getSvcParams=function(e){var t={};return e.data&&(t.data=e.data),e.type&&(t.type=e.type),e.url&&(t.url=e.url),e.contentType&&(t.contentType=e.contentType),e.success&&(t.success=e.success),e.error&&(t.error=e.error),e.context&&(t.context=e.context),e.crossDomain&&(t.crossDomain=e.crossDomain),e.headers&&(t.headers=e.headers),e.mimeType&&(t.mimeType=e.mimeType),e.statusCode&&(t.statusCode=e.statusCode),t},e.getWidgetProperties=function(e){var t=window.location.pathname.split("/")[1],n=window.location.origin+"/"+t+"/pubservice/";$.get(n+"/widget/props.excel?type="+e.type,function(e,t){}).done(function(t){console.log("second success",t),e.successCallback(t)}).fail(function(){console.log("error")})},e}),define("com/es/utilities/AppLang",["com/es/widgets/WidgetUtils"],function(e){var t={langGlobalObj:"AppLang",fileName:"editorStrings.json"};return e.setLangCode(t.langGlobalObj,t.fileName),!1}),define("com/es/utilities/AppEvent",[],function(){var e={CLICK:"click",CHANGE:"change",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",TIME_UPDATE:"timeupdate",ASSET_SELECTED:"onAssetSelected",ASSETPOPUP_CANCEL_CLICKED:"onAssetpopUpCancelClick",CONFIG_UPDATED:"onConfigUpdated",CONTEXTMENU_ITEM_SELECTED:"onContextMenuItemClick",SHOW_CONTEXTMENU_CLICKED:"onShowContextMenuClick",SAVE_CONTENT:"onSavePageInitiated",ON_MODE_SELECT:"onModeSelected",TOC_ITEM_SELECT:"onTocItemSelected",TOC_ITEM_CLICK:"onTocItemClick",EDIT_TOC_CLICK:"onEditTocClick",DONE_TOC_CLICK:"onDoneTocClick",TOC_TREE_ITEM_RENAMED:"onTOCTreeItemRenamed",WIDGET_ADDED:"onWidgetAdd",DIRTY_STATE_CHANGED:"onDirtyStateChanged",EDIT_LINK_CLICKED:"onEditLinkClick",SHOW_GLOSSARY:"showGlossary",OPTION_ADDED:"optionAdded",FIB_ANSWER_ADDED:"onFibActivityAppend",ADD_ASSET:"onAssetAdd",DONE_LINK_POPUP_CLICK:"onDoneLinkPopupClick",TOC_EDITABLE_NODE_CLICKED:"onTOCTreeEditableItemClick",TOC_EDITABLE_NODE_BLURRED:"onTOCTreeEditableItemBlur",TOC_RENDER_COMPLETE:"onTOCRenderComplete",REPORTING_READY:"reporting_ready",EDITOR_READY:"qa_editor_ready",RENDERER_READY:"qa_renderer_ready",QUESTION_CREATED:"question_created",GLOSSARY_EDITOR_READY:"glossary_editor_ready",TOCEDITOR_READY:"toc_editor_ready",QUIZ_CREATOR_READY:"quiz_creator_ready",INPUT_PROPERTY_CHANGE:"input propertychange"};window.AppEvent=e}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=typeof location!="undefined"&&location.href,i=r&&location.protocol&&location.protocol.replace(/\:/,""),s=r&&location.hostname,o=r&&(location.port||void 0),u=[];define("com/es/text",[],function(){var a,f,l;return typeof window!="undefined"&&window.navigator&&window.document?f=function(e,t){var n=a.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&process.versions.node?(l=require.nodeRequire("fs"),f=function(e,t){t(l.readFileSync(e,"utf8"))}):typeof Packages!="undefined"&&(f=function(e,t){var n=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),n=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n),"utf-8")),i,s,o="";try{i=new java.lang.StringBuffer,(s=n.readLine())&&s.length()&&s.charAt(0)===65279&&(s=s.substring(1));for(i.append(s);(s=n.readLine())!==null;)i.append(r),i.append(s);o=String(i.toString())}finally{n.close()}t(o)}),a={version:"0.27.0",strip:function(e){if(e){var e=e.replace(t,""),r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw Error("createXhr(): XMLHttpRequest not available");return t},get:f,parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),e=e.substring(n+1,e.length),n=e.indexOf("!");return n!==-1&&(t=e.substring(n+1,e.length),t=t==="strip",e=e.substring(0,n)),{moduleName:r,ext:e,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=a.xdRegExp.exec(e),s;return i?(e=i[2],i=i[3],i=i.split(":"),s=i[1],i=i[0],(!e||e===t)&&(!i||i===n)&&(!s&&!i||s===r)):!0},finishLoad:function(e,t,n,r,i){n=t?a.strip(n):n,i.isBuild&&i.inlineText&&(u[e]=n),r(n)},load:function(e,t,n,u){var f=a.parseName(e),l=f.moduleName+"."+f.ext,c=t.toUrl(l),h=u&&u.text&&u.text.useXhr||a.useXhr;!r||h(c,i,s,o)?a.get(c,function(t){a.finishLoad(e,f.strip,t,n,u)}):t([l],function(e){a.finishLoad(f.moduleName+"."+f.ext,f.strip,e,n,u)})},write:function(e,t,n){if(t in u){var r=a.jsEscape(u[t]);n.asModule(e+"!"+t,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,t,n,r,i){var t=a.parseName(t),s=t.moduleName+"."+t.ext,o=n.toUrl(t.moduleName+"."+t.ext)+".js";a.load(s,n,function(){var t=function(e){return r(o,e)};t.asModule=function(e,t){return r.asModule(e,o,t)},a.write(e,s,t,i)},i)}}})}(),define("com/es/text!templateBasePath/Reader/glossary/glossaryModuleTemplate.html",[],function(){return'<div id="glossaryList" class="slider-content">\r\n	<ul>\r\n		<% _.each(listAttr, function(listItem, i){ availableKeys.push(i.toLowerCase());%>\r\n		  \r\n      <li id=<%=i %>><a class="glossaryListTitle" name=<%=i %> > <%=i %></a>\r\n      	<% _.each(listItem, function(item, i){ %>\r\n        <ul data-id="<%=item.attributes.id%>" class="clearfix">\r\n          <li class="heading term" data-key= "term" data-term=<%=item.attributes.term%>><%=item.attributes.term %>\r\n          </li>\r\n          \r\n\r\n           <li class="delete-heading" data-key= "term">\r\n            <% if(item.attributes.audiofiles){%> <span class="audioPlayPauseBtn"  data-src=<%=GLOSSARY_CONSTANTS.MEDIA_BASE_URL+"/"+item.attributes.audiofiles %> ></span><% } %>\r\n            <span class="edit-term"></span>\r\n            <span class="delete-term"></span>\r\n          </li>\r\n          <li class="clear"></li>\r\n\r\n          <% if(item.attributes.imagefiles){ %><li class="image"> <img src=<%=GLOSSARY_CONSTANTS.CONTENT_BASE_URL+"/"+item.attributes.imagefiles%> class = "imageAssocistedWithGlossaryTerm"></li><% } %>\r\n\r\n                     \r\n          <li class="description" data-key= "description"> <%=item.attributes.description %></li>\r\n          <span class="more-less-definition" style="display: none"><%=GlossaryReaderLang.MORE_LABEL%></span>\r\n        </ul>\r\n          <% }); %>\r\n      </li>\r\n      <% }); %>\r\n	</ul>\r\n	<div class = "selectedAlphabet" style="display: none"><%=GlossaryReaderLang.SELECTED_ALPHABHET%></div>\r\n</div>'}),define("com/es/glossary/GlossaryConstants",[],function(){return window.GLOSSARY_CONSTANTS||(window.GLOSSARY_CONSTANTS={BOOK_ID:"",ROOT_URL:"",ROOT_PATH:"",SERVICE_BASE_URL:"",CONTENT_BASE_URL:"",MEDIA_BASE_URL:"",IMAGE_FILE_LIMIT:0,AUDIO_FILE_LIMIT:0,A_LIST:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#"],V_LIST:["a","ă","â","b","c","d","đ","e","ê","g","h","i","k","l","m","n","o","ô","ơ","p","q","r","s","t","u","ư","v","x","y","#"]}),window.GLOSSARY_CONSTANTS}),define("com/es/models/GlossaryTerm",[],function(){var e=Backbone.Model.extend({defaults:{id:null,term:"",description:"",dirty:!1},url:function(){return AppConst.SERVICE_BASE_URL+"book/"+AppConst.BOOK_ID+"/glossary"}});return e.sync=function(e,t,n){console.log("override model")},e}),define("com/es/collections/GlossaryCollection",["com/es/models/GlossaryTerm"],function(e){var t=Backbone.Collection.extend({model:e,clone:function(e,t){return t?new e.constructor(_.map(e.where({dirty:!0}),function(e){return e.clone()})):Backbone.Collection.prototype.clone.apply(this)},sync:function(e,t,n){var r,i;switch(e){case"create":r="POST",i=n.data;break;case"read":Backbone.sync.call(t,e,t,n);return;case"delete":r="delete",i=n.deletedItems;break;case"update":Backbone.sync.call(t,e,t,n);return}$.ajax({url:t.url,type:r,contentType:!1,processData:!1,data:i,success:n.success,error:n.error})}});return t});var GLOSSARY_EVENTS={INITIALIZED:"initialized",RENDER_COMPLETE:"renderComplete",CONTAINER_RENDER_COMPLETE:"containerRenderComplete",SHOWN:"shown",CLOSED:"closed",CLICK:String(document.documentElement.ontouchmove)!="undefined"?"touchend":"click",CHANGE:"change",ON_MODE_CHANGE:"onModeChange",NO_GLOSSARY_ITEM:"noGlossaryItem"},GLOSSARY_TERM_EVENTS={SHOWN:"shown",CLOSED:"closed"};define("com/es/glossary/GlossaryEvents",function(){}),define("com/es/utilities/services",["com/es/utilities/utils"],function(e){var t=new Object;return t.getBookMetadata=function(e){var t=e.model,n=e.successCallback,r=e.errorCallback;bookId=e.id,t.url=AppConst.SERVICE_BASE_URL+"book/"+bookId+"/details",t.fetch({success:function(e){n(e)},error:function(e){r(e)}})},t.tocData=function(e){e.tocCollection.url=e.id+"/TOCData.json",e.tocCollection.fetch({success:function(t){e.successCallback(t)},error:function(t){e.errorCallback(t)}})},t.getAssetList=function(t){var n;t.assetListCollection.url=t.url,n={type:t.type,term:t.term,sortedby:t.sortedby,pageSize:t.pageSize,pageIndex:t.pageIndex},e.log("popupparams",t),t.assetListCollection.fetch({type:"POST",data:n,success:function(e){t.successCallback(e)},error:function(e){t.errorCallback(e)}})},t.getSelectedAssetData=function(e){var t="epub_content/assets/"+e.path;$.getJSON(t,{}).done(function(t){e.successCallback(t)}).fail(function(t,n,r){e.errorCallback(r)})},t.saveAndPublish=function(e){var t=unescape(AppConst.PAGE_NAME).split("#")[0],n={data:encodeURIComponent(e.data),page:t,enrichment:encodeURIComponent(e.enrichment),quiz:encodeURIComponent(e.quiz)};$.ajax({type:"POST",url:AppConst.SERVICE_BASE_URL+"book/"+AppConst.BOOK_ID+"/save",data:n,success:function(t){e.successCallback(e.callback,e.status)},error:function(t,n,r){e.errorCallback(n)}})},t.getUserInfo=function(e){var t=e.model,n=e.successCallback,r=e.errorCallback;t.url=AppConst.SERVICE_BASE_URL+AppConst.USER_SERVICE_SUB_URL+e.id,t.fetch({success:function(e){n(e)},error:function(e){r(e)}})},t.getLinkList=function(e){var t=e.linkCollection,n=e.successCallback,r=e.errorCallback;t.url="epub_content/assetLists/linkList.json",t.fetch({success:function(e){n(e)},error:function(e){r(e)}})},t.getGlossaryData=function(e){var t=e.glossaryCollection,n=e.successCallback,r=e.errorCallback;t.url="epub_content/glossary.json",t.fetch({success:function(e){n(e)},error:function(e){r(e)}})},t.getOPFData=function(e){$.ajax({type:"GET",url:e.baseUrl,dataType:"xml",success:function(t){var n=new X2JS,r=n.xml2json(t),i=r.package;e.successCallback(i)},error:function(t){e.errorCallback(t)}})},t.getSpineData=function(e){$.ajax({type:"GET",url:e.baseUrl,dataType:"xml",success:function(t){var n=new X2JS,r=n.xml2json(t),i=r.package.manifest.item;e.successCallback(i)},error:function(t){e.errorCallback(t)}})},t.unlockBook=function(e){$.ajax({type:"GET",url:AppConst.SERVICE_BASE_URL+"book/unlock/"+AppConst.BOOK_ID+"?userId="+e.userID,success:function(t){e.successCallback(t)},error:function(t,n,r){e.failureCallback(n)}})},t.saveTOCData=function(e){var t=JSON.stringify(e.data),n={data:t,isSampleBookDefined:e.isSampleBookDefined};$.ajax({type:"POST",url:AppConst.SERVICE_BASE_URL+"book/"+AppConst.BOOK_ID+"/toc",data:n,success:function(t){e.success()},error:function(t,n,r){console.log("error in saving updated toc data"),e.error()}})},t.redirectLibrary=function(n){if(n){var r={userID:AppConst.USER_ID,successCallback:function(t){var n=jQuery.parseJSON(t);if(n.status=="true"){var r=window.location.href,i;i=r.substring(0,r.indexOf("/QA/")+1),i+="bookdefault.excel",window.location.href=i}else e.showToasterMessage(AppLang.UNABLE_TO_UNLOCK_FILE_FOR_USER_MESSAGE+AppConst.USER_ID,2e3,function(){var e=window.location.href,t;t=e.substring(0,e.indexOf("/QA/")+1),t+="bookdefault.excel",window.location.href=t})},failureCallback:function(e){console.log("Error occured: ",e)}};t.unlockBook(r)}else{var i=window.location.href,s;s=i.substring(0,i.indexOf("/QA/")+1),s+="bookdefault.excel",window.location.href=s}},t.redirectLogout=function(){var e=window.location.href,t;t=e.substring(0,e.indexOf("/QA/")+1),window.location.href=t+AppConst.LOGOUT_SERVICE_SUB_URL},t.fetchGlossaryData=function(e){e.glossaryCollection.url="/pubportal/QA/com/es/data/glossary.json",e.glossaryCollection.fetch({success:function(t){e.successCallback(t)},error:function(t){e.errorCallback(t)}})},t.fetchQuestionData=function(e){$.ajax({type:"GET",url:e.url,success:function(t){t=typeof t=="string"?JSON.parse(t):t,e.successCallback(t)},error:function(t,n,r){e.errorCallback(n)}})},t.fetchLrnActivity=function(e){var t={type:"GET",url:e.url,success:function(t){t=typeof t=="string"?JSON.parse(t):t,e.successCallback(t)},error:function(t,n,r){e.errorCallback(n)}};WIDGET_CONSTANTS.APPLICATION_TYPE==="Reader"&&(t.headers={userId:WIDGET_CONSTANTS.USER_ID}),$.ajax(t)},t.fetchLrnSignature=function(e){var t={security:e.data.securityObj,request:e.data.requestObj},n=null,r;t=JSON.stringify(t),WIDGET_CONSTANTS.APPLICATION_TYPE==="Editor"?n="application/json":n="text/plain",r={type:"POST",data:t,url:e.url,contentType:n,success:function(t){t=typeof t=="string"?JSON.parse(t):t,e.successCallback(t)},error:function(t,n,r){e.errorCallback(n)}},WIDGET_CONSTANTS.APPLICATION_TYPE==="Reader"&&(r.headers={userId:WIDGET_CONSTANTS.USER_ID}),$.ajax(r)},t.fetchEowData=function(e){var t={type:"POST",data:JSON.stringify(e.data),url:e.url,contentType:"application/json",success:function(t){t=typeof t=="string"?JSON.parse(t):t,e.successCallback(t)},error:function(t,n,r){e.errorCallback(n)}};$.ajax(t)},t}),define("com/es/text!templateBasePath/Editor/popups/confirmationPopupTemplate.html",[],function(){return'\r\n	<div class="confirmPopup modal-dialog">\r\n		<div class="modal-content">\r\n			<div class="header modal-header">\r\n				<div class="title modal-title"><%=AppLang.CONFIRMATION_POPUP_TITLE%></div>\r\n			</div>		\r\n			\r\n			<div class="modal-body message">\r\n				<%=AppLang.CONFIMATION_MESSAGE%>\r\n			</div>\r\n			\r\n			<div class="bottomBar modal-footer">\r\n				<div>\r\n					<button type="button" id="yes" class=" btn btn-default" ><%=AppLang.CONFIRMATION_POPUP_YES%></button>\r\n					<button type="button" id="no" class=" btn btn-primary" ><%=AppLang.CONFIRMATION_POPUP_NO%></button>\r\n	       			<button type="button" id="cancel" class=" btn btn-primary" ><%=AppLang.CONFIRMATION_POPUP_CANCEL%></button>\r\n				</div>\r\n			</div>\r\n		</div>\r\n	</div>\r\n\r\n'}),define("com/es/utilities/utils",["com/es/utilities/services","com/es/text!templateBasePath/Editor/popups/confirmationPopupTemplate.html","com/es/widgets/WidgetUtils"],function(e,t,n){var r=new Object;return r.DEFAULT_TOASTER_DURATION=1e3,r.log=function(e){},r.rewriteProperty=function(e,t,n){if(typeof e!="object")return e;for(var r in e)e.hasOwnProperty(r)&&(e[r.replace(t,n)]=this.rewriteProperty(e[r],t,n),r.indexOf(t)>-1&&delete e[r]);return e},r.showLoader=function(){$("#loading-indicator").modal({show:!0,keyboard:!1,backdrop:"static"}),$(".modal-backdrop").last().css("z-index","9000")},r.hideLoader=function(){$("#loading-indicator").modal("hide")},r.showAlert=function(e){if(!e)return!1;var t=e.toLowerCase().toString(),n=$("#js-alert"),r=$(".alert-text",n);r.html(t),n.modal({show:!0,keyboard:!1,backdrop:"static"}),n.on("hidden.bs.modal",function(e){r&&r.html(""),$(this).off("hidden.bs.modal")})},r.hideAlert=function(){},r.showToasterMessage=function(e,t,n,i){if(t==undefined||t==null||t=="")t=r.DEFAULT_TOASTER_DURATION;$("#toastMsg").text(e);var s=$(window).height()/2-$("#toastContainer").outerHeight()/2;$("#toastContainer").css({top:s,margin:"auto"}),$(".popUpContainer").addClass("onshow"),$("#toastContainer").modal("show"),r.myTimer=setTimeout(r.hideToasterMessage.bind(r,n,i),t)},r.hideToasterMessage=function(e,t){clearTimeout(r.myTimer),$("#toastContainer").modal("hide"),$(".popUpContainer").removeClass("onshow"),e!=undefined&&e!=null&&e(t)},r.showConfirmPopUp=function(e,n,r,i){var s=$("#confirmPopupCover"),o=_.template(t,{});$("#confirmPopupCover").attr("tabindex","-1"),s.html("").append(o),r!=undefined&&r!=undefined&&r!=undefined&&_.each(r,function(e){s.find("#"+e).remove()}),$(".title",s).html(n),$(".message",s).html(e),$(".bottomBar",s).find(".btn").unbind().bind(AppEvent.CLICK,function(e){s.modal("hide"),i(e.target.id)}),s.off("hidden.bs.modal").on("hidden.bs.modal",function(){$(".bottomBar",s).find(".btn").unbind(),s.html(""),$("body").css("overflow","auto")}),$("body").css("overflow","hidden"),s.modal("show")},r.loadJsCssFile=function(e,t,n,r){var i,s;s=e.get(0).contentWindow,r=="js"?(i=s.document.createElement("script"),i.setAttribute("type","text/javascript"),i.setAttribute("src",t+"/"+n+".js")):r=="css"&&(i=s.document.createElement("link"),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",t+"/"+n+".css")),typeof i!="undefined"&&s.document.getElementsByTagName("head")[0].appendChild(i)},r.checkAddJsCssFile=function(e,t,n,i){var s,o,u,a,f,l=!1;o=e.get(0).contentWindow,i=="js"?s=t+"/"+n+".js":i=="css"&&(s=t+"/"+n+".css"),u=i=="js"?"script":i=="css"?"link":"none",a=i=="js"?"src":i=="css"?"href":"none",f=o.document.getElementsByTagName(u),l||r.loadJsCssFile(e,t,n,i)},r.getIframePageHtml=function(){var e=["jquery-ui.css","widgets.css","widgets_iFrameWidgetEditor.css","widgets_iFrameWidget.css","widget_color.css","widget_global.css","iframeTheme"],t=document.getElementById("authoringIframe"),n=t.contentWindow.document.documentElement,i=$("body",$(t).contents()).width(),s=jQuery(n).clone(),o=r.removeExtraContent(e,s,i),u='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html>'+o.prop("outerHTML");return u},r.removeCssFile=function(e,t){return _.each(e,function(e){$('link[href*="'+e+'"]',t).remove()}),t},r.removeExtraContent=function(e,t,n){var i=$("#authoringIframe").contents(),s=["block"];$("#tinyhippos-injected",t).remove(),$("body",t).removeAttr("contenteditable"),$("body",t).removeAttr("dropzone"),$(".widget-ui",t).remove();var o=$(".widget-placeholder",t);o.find(".dummyWidget").remove(),o.find(".ui-resizable-handle").remove(),o.find(".move-icon").remove(),o.removeAttr("draggable"),o.removeAttr("contenteditable"),o.removeClass("ui-resizable"),o.removeClass("widgetFrame");var u=o.length;if(AppConst.BOOK_TYPE=="reflowable"){o.css("height","");for(var a=0;a<u;a++){var f=$(o[a]),l=$("div[id='"+f.get(0).id+"']",i),c=l.parent(),h=0;while(c.css("display").toLowerCase()=="inline")h++,c=c.parent();var p=c.width(),d=l.width();f.data("align")=="fitToWidth"&&(f.data("type")=="image"||f.data("type")=="imageGal"||f.data("type")=="video"||f.data("type")=="assessment"&&f.data("mode")=="poster")?(d=$("#ui-"+f.get(0).id+" img",i).width()/$("#"+f.get(0).id,i).width()*100+"%",f.attr("data-width",d),f.css("height",f.data("height"))):d=d/p*100+"%",f.css("width",d)}}else for(var a=0;a<u;a++){var f=$(o[a]);if(f.data("mode")=="compact"&&f.data("border")){var d=$("#div-border-ui-"+f.attr("id"),$("#authoringIframe").contents()).width(),v=$("#div-border-ui-"+f.attr("id"),$("#authoringIframe").contents()).height();$("#div-border-ui-"+f.attr("id"),t).remove(),f.css("width",d),f.css("height",v)}}var m=r.removeCssFile(e,t);return m},r.getDateFormat=function(e){var t=new Date(e),n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=["January","February","March","April","May","June","July","August","September","October","November","December"],i=n[t.getDay()],s=r[t.getMonth()],o=i+", "+s+" "+t.getDate()+", "+t.getFullYear();return o},r.clone=function(e){if(Object.prototype.toString.call(e)==="[object Array]"){var t=[],n=0,r=e.length;for(;n<r;n++)t[n]=arguments.callee(e[n]);return t}if(typeof e=="object"){var t={},n;for(n in e)t[n]=arguments.callee(e[n]);return t}return e},r.isTouchDevice=function(){var e=String(document.documentElement.ontouchmove)!="undefined"?!0:!1;return e},r.string2Bin=function(e){var t=[];for(var n=0;n<e.length;n++)t.push(e.charCodeAt(n)&255);return t},r.arrayBufferToBinaryString=function(e){var t="",n=new Uint8Array(e),r=n.byteLength;for(var i=0;i<r;i++)t+=String.fromCharCode(n[i]);return t},r.string2ArrayBuffer=function(e){var t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(var r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return t},r.bin2String=function(e){return String.fromCharCode.apply(String,e)},r.encode_utf8=function(e){return unescape(encodeURIComponent(e))},r.makeOptionsSortable=function(e,t,n){$(e).addClass("sortableOptions"),$(e).sortable({handle:"span.dragIcon",containment:t,update:function(e,t){n&&n()},start:function(){}})},r.getURlQueryStringParams=function(){var e=[],t,n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var r=0;r<n.length;r++)t=n[r].split("="),e.push(t[0]),e[t[0]]=t[1];return e},r.removeNbsp=function(e){var t;return e?t=e.replace(/&nbsp;/g,"").trim():t="",t},r.userInputValidator=function(e,t){var n=!1,r="";return t?e.find("img").length>0?(n=!0,n):(r=e.text().replace(/&nbsp;/g,"").trim(),r=r.replace("​",""),r?(n=!0,n):(n=!1,n)):(r=e.text().replace(/&nbsp;/g,"").trim(),r=r.replace("​",""),r?(n=!0,n):(n=!1,n))},r.sortObjByKey=function(e){var t=e,n=[],r,i,s,o={};for(r in t)t.hasOwnProperty(r)&&n.push(r);n.sort(),s=n.length;for(i=0;i<s;i++)r=n[i],o[r]=t[r];return o},r.isIE=function(){var e=navigator.userAgent.toLowerCase(),t=e.indexOf("msie")>-1;return t},r.isPhone=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:!1},r.getQuestionTypeById=function(e){var t=[{quesTypeID:101,quesType:"MCQ Single Response"},{quesTypeID:102,quesType:"MCQ Multiple Response"},{quesTypeID:103,quesType:"FIB Text"},{quesTypeID:104,quesType:"FIB Tap and Place"},{quesTypeID:105,quesType:"FIB Drop Down"},{quesTypeID:106,quesType:"Matching"},{quesTypeID:107,quesType:"Grouping"},{quesTypeID:108,quesType:"True or False"},{quesTypeID:109,quesType:"Collection"}],n="";return n=_.findWhere(t,{quesTypeID:parseInt(e)})?_.findWhere(t,{quesTypeID:parseInt(e)}).quesType:"",n},r.mouseWheel=function(e){$(e).on("mousewheel DOMMouseScroll",function(e){var t=e.originalEvent,n=t.wheelDelta||-t.detail;this.scrollTop+=(n<0?1:-1)*30,e.preventDefault()})},r.checkProtocol=function(e){var e=e,t=e.split("http:"),n="https:";if(window.location.protocol===n){var r=n+t[1];return r}return e},r}),define("com/es/text!templateBasePath/Reader/glossary/glossaryPopupTemplate.html",[],function(){return'<div id="glossaryPopupCover" class="glossaryPopupCover modal fade">\r\n	<div class="glossaryPopup modal-dialog">\r\n		<div class="modal-content">\r\n			<!--div class="header modal-header">\r\n			</div-->		\r\n			\r\n			<div id="glossaryPopup" class="modal-body" style="height: 60%;">\r\n				<div id=\'slider\' class=\'glossaryListDiv\'>\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<!--div class="bottomBar modal-footer">\r\n				<div>\r\n					<button type="button" class="cancelBtn btn btn-default" data-dismiss="modal">Cancel</button>\r\n	       			<button type="button" class="doneBtn btn btn-primary"  >Done</button>\r\n				</div>\r\n			</div-->\r\n		</div>\r\n	</div>\r\n</div>\r\n'});var indexOfIndexBar=null,prevSelectedEle=null;$.fn.sliderNav=function(e){function f(e,n){if(!e)return;var r=e.substr(1)+"anchor",i=$("[id = "+r+"]").hasClass("disable");if(i)return;if($("[id = "+e.substr(1)+"]",$(".slider-content")).length<1){var u=_.indexOf(t,e.substring(1,2));u==t.length&&(u-=1),e="#"+t[u]}if(indexOfIndexBar==e)return;indexOfIndexBar=e,prevSelectedEle&&prevSelectedEle.removeClass("selectIndexBar"),$("[id = "+e.substr(1)+"anchor]").addClass("selectIndexBar"),$(".selectedAlphabet").hide(),n=="move"&&($(".selectedAlphabet").html(e.substring(1,2).toUpperCase()),$(".selectedAlphabet").show()),_.delay(function(){$(".selectedAlphabet").hide()},2e3),prevSelectedEle=$("[id = "+e.substr(1)+"anchor]");var a=$(".slider-content",o).offset().top,f=$("[id = "+e.substr(1).toUpperCase()+"]",o).offset().top,l=$(".slider-nav",o).height();s.height&&(l=s.height);var c=f-a-l/8;$(".slider-content",o).stop().animate({scrollTop:"+="+c+"px"})}function l(e){_.each(e,function(e){$("[id = "+e+"anchor]").addClass("disable")})}var t=e,n={items:GlossaryReaderLang.LIST_ALPHABET,debug:!1,height:null,arrows:!0},r=_.difference(n.items,e),i=$.extend(n,e),s=$.meta?$.extend({},i,$$.data()):i,o=$(this);$(o).addClass("slider"),$(o).append('<div class="mainSlider"><div class="sliderContent"><div class="slider-nav"><ul></ul></div></div></div>');for(var u in s.items)$(".slider-nav ul",o).append("<li><a id = '"+s.items[u]+"anchor' class = 'navIndexBar' alt='#"+s.items[u]+"'>"+s.items[u]+"</a></li>");var a=$(".slider-nav",o).height();s.height&&(a=s.height),l(r),$(".slider-nav a").bind("click",function(e){var t=$(this).attr("alt");f(t,"click")}),$(".slider-nav").bind("mousedown",function(e){e.button==0&&$(".slider-nav").bind("mousemove",function(e){e.preventDefault();var t=document.elementFromPoint(e.pageX,e.pageY),n=$(t).attr("alt");return f(n,"move"),!1})}),$("body").bind("mouseup",function(e){$(".slider-nav").unbind("mousemove")}),$(".slider-nav").bind("touchmove",function(e){e.preventDefault();var t=document.elementFromPoint(e.touches[0].pageX,e.touches[0].pageY),n=$(t).attr("alt");f(n,"move")})},define("com/es/glossary/slidernav",function(){}),define("com/es/glossary/GlossaryView",["com/es/glossary/GlossaryEvents","com/es/glossary/GlossaryConstants","com/es/utilities/utils","com/es/text!templateBasePath/Reader/glossary/glossaryPopupTemplate.html","com/es/glossary/slidernav"],function(e,t,n,r,i){var s=function(e,t,r,i){var s,o,u,a=0,f,l=new Audio,c=null,h=require.s.contexts._.config.glossaryConfig,p=h.lineCount,d=function(){var t=y(e.models);t=_sortObject(t),v(t)},v=function(e){var n={listAttr:e,availableKeys:[]},r=_.template(t,n);f=n.availableKeys,b(r),l.onended=m},m=function(){$(".audioPlayPauseBtn.audioPlayBtn").removeClass("audioPlayBtn"),g()},g=function(){l&&(l.pause(),$(".audioPlayPauseBtn.audioPlayBtn").removeClass("audioPlayBtn"),l.duration&&(l.currentTime=0))},y=function(e){var t={};e=_.sortBy(e,function(e){return e.attributes.term});for(var n=0;n<e.length;n++){var r=e[n].attributes.term.substr(0,1).toUpperCase();$.inArray(r.toLowerCase(),GlossaryReaderLang.LIST_ALPHABET)<0&&(r="#"),t[r]==undefined&&(t[r]=[]),t[r].push(e[n])}return t};_sortObject=function(e){var t={},n,r=[];for(n in e)e.hasOwnProperty(n)&&r.push(n);r.sort(),$.inArray("#",r)>-1&&(r=$.grep(r,function(e){return e!="#"}),r.push("#"));for(n=0;n<r.length;n++)t[r[n]]=e[r[n]];return t};var b=function(e){r.html(e),r.show(),r.sliderNav(f),$(".more-less-definition",$("#glossaryList")).on("click",S),_.delay(function(){s.trigger(GLOSSARY_EVENTS.RENDER_COMPLETE,s)},100),_.delay(function(){E()},500),$("span.audioPlayPauseBtn").off(),$("span.audioPlayPauseBtn",$("#glossaryList")).on("click",w)},w=function(e){var t=e.target;c!==t&&(l.src=$(t).attr("data-src"),$(c).removeClass("audioPlayBtn"),c=t),l.paused?(l.play(),$(t).addClass("audioPlayBtn")):($(t).removeClass("audioPlayBtn"),g())},E=function(){var e=$(".description",$("#glossaryList"));_.each(e,function(e){var t=e.scrollHeight,n=parseInt($(e).css("line-height"),10),r=n*p;parseInt(t)>r&&($(e).parent().find(".more-less-definition").show(),$(e).css("height",r+"px"),$(e).css("overflow","hidden"))})},S=function(e){var t=$(e.target),n=t.parent().find(".description"),r=parseInt($(n).css("line-height"),10),i=r*p,s=$(n)[0].scrollHeight,o=t.html();o==GlossaryReaderLang.MORE_LABEL?$(n).animate({height:s+"px"},600,function(){t.html(GlossaryReaderLang.LESS_LABEL).addClass("makeLess")}):$(n).animate({height:i},600,function(){t.html(GlossaryReaderLang.MORE_LABEL).removeClass("makeLess")})},x=function(e){var t=this;this.iScroll!=null&&this.iScroll.destroy(),this.iScroll=new IScroll(e.get(0),{desktopCompatibility:!0,interactiveScrollbars:!0,scrollY:!0}),_.delay(function(){t.iScroll.refresh()},999)},T=Backbone.View.extend({initialize:function(e,t,r,i){s===undefined?(_.extend(this,Backbone.Events),s=this,n.log("initialize -- ",s)):n.log("instance already created");for(var o=0;o<e.length;o++)e.models[o].attributes.imagefiles=escape(e.models[o].attributes.imagefiles),e.models[o].attributes.audiofiles=escape(e.models[o].attributes.audiofiles);d()},stopAudio:g});return new T(e,t,r,i)};return s}),define("com/es/text!templateBasePath/Editor/glossary/glossaryEditorPopupTemplate.html",[],function(){return'<div id="glossaryEditorPopupCover" class="glossaryEditorPopupCover modal fade in">\r\n	<div class="glossaryEditorPopup modal-dialog">\r\n		<div class="modal-content">\r\n			<div class="header modal-header clearfix">\r\n                            <div class="GlossaryEditorPopUpTitle modal-title"><%=AppLang.GLOSSARY_LABEL%></div>\r\n                            <div class="right-action-bar pull-right">\r\n\r\n				<div class="pull-left radiobuttons">\r\n                                    <label class="button-label"><%=AppLang.EDIT_LABEL%></label>\r\n\r\n                                    <div id="editPreviewToggle" class="btn-group  edit-preview-buttons" data-toggle="buttons">\r\n                                        <label class="btn btn-primary">\r\n                                            <input type="radio" name="glossaryEditPreviewToggle" value="true">\r\n                                        </label>\r\n                                        <label class="btn btn-primary active">\r\n                                            <input type="radio" name="glossaryEditPreviewToggle" value="false">\r\n                                        </label>\r\n                                    </div>\r\n                                    <label class="button-label"><%=AppLang.PREVIEW_LABEL%></label>\r\n                                </div>\r\n                                <button type="button" id ="closeIcon" class="close-pop" data-dismiss="modal"></button>\r\n                            </div> \r\n			</div>		\r\n			\r\n			<div id="glossaryEditorPopup" class="modal-body">\r\n                            <div id=\'glossaryEditorList\' class=\'glossaryListDiv\'>\r\n					\r\n			    </div> \r\n			</div>\r\n			\r\n			<div class="bottomBar modal-footer">\r\n				<div>\r\n				    <button type="button" id ="glossaryAddWordBtn" class="btn-addword" style="display: none"><%=AppLang.ADD_WORD_LABEL%></button>\r\n                                    <button type="button" id ="glossarySaveBtn" class="btn btn-default" style="display: none"><%=AppLang.SAVE_LABEL%></button>\r\n				</div>\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>\r\n'}),define("com/es/text!templateBasePath/Editor/glossary/glossaryAddNewTermTemplate.html",[],function(){return'<div id="glossaryAddNewTermPopupCover" class="glossaryAddNewTermPopupCover modal fade in">\r\n    <div class="glossaryEditorPopup glossaryAddNewTermPopup modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="header modal-header clearfix">\r\n\r\n                            <div class="GlossaryEditorPopUpTitle modal-title"><span class="back-arrow"></span><%=AppLang.ADD_WORD_LABEL%></div>\r\n                            <button type="button" id ="closeIcon" class="close-pop f-right" ></button>\r\n\r\n                            \r\n            </div>      \r\n            \r\n            <div id="addWordContainer" class="modal-body" style="height: 500px">\r\n				<form method="post" name="glossary" id="add-glossary" action="" enctype="multipart/form-data">\r\n                            <div class="form-group clearfix">\r\n                                <label for="name"><%=AppLang.WORD_LABEL%><span><%=AppLang.ASTERISK_LABEL%></span></label>\r\n                                    <input type="text" class="form-control" name="term" id="inputWord">\r\n\r\n                                </div>\r\n                                <div class="form-group clearfix">\r\n                                   <label for="inputfile"><%=AppLang.DEFINITION_LABEL%><span><%=AppLang.ASTERISK_LABEL%></span></label>\r\n\r\n                                    <textarea class="form-control" name="description" rows="5" id="inputDescription"></textarea>\r\n                            </div>\r\n\r\n                            <div id="imageFileContainer" class="form-group clearfix">\r\n                                <label for="name"><%=AppLang.BROWSE_IMAGE_LABEL%></label>\r\n                                <div class="browseBox">\r\n                                    <div class="clearfix">\r\n                                        <span id="selectedImageName"></span>\r\n                                        <button type="button" id="browseImage"><%=GlossaryEditorLang.BROWSE_LABEL%></button><br> \r\n                                        <input  type="file" name="imagefiles" id="imageFile" style="display:none" class="filestyle" accept=".jpg, .jpeg, .png">  \r\n                                    </div>       \r\n                                    <div id="imageSelectionInfo">\r\n                                        <%=AppLang.IMAGE_SELECTION_INFO%>\r\n                                        <span id="gsAddImageFileSizeInfo" class="fs-info"></span>\r\n                                    </div>\r\n                                    <div class="imagePreviewBOx">\r\n                                        <img id="imagePreview" class="imagePreview"/>   \r\n                                        <span id="resetImageSelection" class="resetSelection"></span> \r\n                                    </div>\r\n                                </div>                             \r\n                            </div>\r\n\r\n                            <div id="audioFileContainer"  class="form-group clearfix">\r\n                                <label for="name"><%=AppLang.BROWSE_AUDIO_LABEL%></label>                              \r\n                                <div class="browseBox">\r\n                                    <span id="selectedAudioName"></span>\r\n                                <button type="button" id="browseAudio"><%=GlossaryEditorLang.BROWSE_LABEL%></button><br>\r\n                                    <input type="file" id="audioFile" name="audiofiles" style="display:none" accept=".mp3">\r\n                                    <span id="audioSelectionInfo">\r\n                                        <%=AppLang.AUDIO_SELECTION_INFO%>\r\n                                        <span id="gsAddAudioFileSizeInfo" class="fs-info"></span>\r\n                                    </span> \r\n                                    <div class="audioPlayPauseBtn audioPlayPauseBtnAddNewGlossaryTerm" id="audioPlayPauseImage"></div>\r\n                                    <span id="resetAudioSelection" class="resetSelection"></span>\r\n                                </div>\r\n                            </div>\r\n            </div>\r\n            \r\n            <div class="bottomBar modal-footer">\r\n                <div>\r\n                    <button type="button" id ="glossaryAddWordSaveBtn" class="btn"><%=AppLang.SAVE_LABEL%></button>\r\n                                    <button type="button" id ="glossaryAddWordContinueBtn" class="btn" ><%=AppLang.SAVE_LABEL%><%=AppLang.AND_WITH_SPACE_LABEL%><%=AppLang.CONTINUE_LABEL%></button>\r\n                                    <button type="button" id ="glossaryCancelBtn" class="btn" ><%=AppLang.CANCEL_LABEL%></button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}),define("com/es/text!templateBasePath/Editor/glossary/glossaryEditTermTemplate.html",[],function(){return'<div id="glossaryEditNewTermPopupCover" class="glossaryEditNewTermPopupCover modal fade in">\n	<div class="glossaryEditorPopup glossaryEditTermPopup modal-dialog">\n		<div class="modal-content">\n			<div class="header modal-header clearfix">\n\n                            <div class="GlossaryEditorPopUpTitle modal-title"><span class="back-arrow"></span><%=AppLang.EDIT_WORD_LABEL%></div>\n                            <button type="button" id ="closeIcon" class="close-pop f-right"></button>\n\n                            \n			</div>\n			\n			<div id="editTermContainer" class="modal-body" style="height: 500px">\n				<form method="post" name="glossary" id="add-glossary" action="" enctype="multipart/form-data">\n                            <div class="form-group clearfix">\n                                <label for="name"><%=AppLang.WORD_LABEL%><span><%=AppLang.ASTERISK_LABEL%></span></label>\n                                    <input type="text" class="form-control" name="term" id="inputWord">\n\n                                </div>\n                                <div class="form-group clearfix">\n                                   <label for="inputfile"><%=AppLang.DEFINITION_LABEL%><span><%=AppLang.ASTERISK_LABEL%></span></label>\n\n                                    <textarea class="form-control" name="description" rows="5" id="inputDescription"></textarea>\n                            </div>\n\n                            <div id="imageFileContainer" class="form-group clearfix">\n                                <label for="name"><%=AppLang.BROWSE_IMAGE_LABEL%></label>\n                                <div class="browseBox">\n                                    <div class="clearfix">\n                                        <span id="selectedImageName"></span>\n                                        <button type="button" id="browseImage"><%=GlossaryEditorLang.BROWSE_LABEL%></button><br> \n                                        <input  type="file" name="imagefiles" id="imageFile" style="display:none" class="filestyle" accept=".jpg, .jpeg, .png">  \n                                    </div>           \n                                    <div id="imageSelectionInfo">\n                                        <%=AppLang.IMAGE_SELECTION_INFO%>\n                                        <span id="gsEditImageFileSizeInfo" class="fs-info"></span>\n                                    </div>\n                                    <div class="imagePreviewBOx">\n                                        <img id="imagePreview" class="imagePreview"/>   \n                                        <span id="resetImageSelection" class="resetSelection"></span> \n                                    </div>\n                                </div>                            \n\n                            </div>\n\n                            <div id="audioFileContainer"  class="form-group clearfix">\n\n                                <label for="name"><%=AppLang.BROWSE_AUDIO_LABEL%></label>   \n                                <div class="browseBox">  \n                                <span id="selectedAudioName"></span>\n                                <button type="button" id="browseAudio"><%=GlossaryEditorLang.BROWSE_LABEL%></button><br>                        \n                                    <input type="file" id="audioFile" name="audiofiles" style="display:none" accept=".mp3">\n                                    <span id="audioSelectionInfo">\n                                        <%=AppLang.AUDIO_SELECTION_INFO%>\n                                        <span id="gsEditAudioFileSizeInfo" class="fs-info"></span>\n                                    </span> \n                                    <div class="audioPlayPauseBtn audioPlayPauseBtnAddNewGlossaryTerm" id="audioPlayPauseImage"></div>\n                                    <span id="resetAudioSelection" class="resetSelection"></span>\n                                </div>\n\n                            </div>\n                            <input type="text" style="display: none;" name="imageChanged" id="imageChanged" value="false">\n                            <input type="text" style="display: none;" name="audioChanged" id="audioChanged" value="false">\n                            </form>\n            </div>\n			\n			<div class="bottomBar modal-footer">\n				<div>\n				    <button type="button" id ="glossaryEditTermSaveBtn" class="btn"><%=AppLang.SAVE_LABEL%></button>\n                                    \n                                    <button type="button" id ="glossaryCancelBtn" class="btn" ><%=AppLang.CANCEL_LABEL%></button>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n'}),define("com/es/glossary/GlossaryEditorLang",["com/es/widgets/WidgetUtils"],function(e){var t={langGlobalObj:"GlossaryEditorLang",fileName:"glossaryEditorStrings.json"};return e.setLangCode(t.langGlobalObj,t.fileName),!1}),define("com/es/text!templateBasePath/Editor/glossary/glossaryEditorInlineTemplate.html",[],function(){return'<div id="glossaryEditorPopupCover" class="glossaryEditorPopupCover  glossaryInlineContainer">\n	<div class="glossaryEditorPopup ">\n		<div >\n			<div class="header clearfix">\n                <div class="GlossaryEditorPopUpTitle "><%=AppLang.GLOSSARY_LABEL%></div>\n                <div class="right-action-bar pull-right">\n\n					<span class="radiobuttons">\n                        <label class="button-label"><%=AppLang.EDIT_LABEL%></label>\n\n                        <div id="editPreviewToggle" class="btn-group  edit-preview-buttons" data-toggle="buttons">\n                            <label class="btn btn-primary">\n                                <input type="radio" name="glossaryEditPreviewToggle" value="true">\n                            </label>\n                            <label class="btn btn-primary active">\n                                <input type="radio" name="glossaryEditPreviewToggle" value="false">\n                            </label>\n                        </div>\n                        <label class="button-label"><%=AppLang.PREVIEW_LABEL%></label>\n                    </span>\n                <span>\n			    	<button type="button" id ="glossaryAddWordBtn" class="btn-addword" style="display: none"><%=AppLang.ADD_WORD_LABEL%></button>\n                	<button type="button" id ="glossarySaveBtn" class="btn btn-default" style="display: none"><%=AppLang.SAVE_LABEL%></button>\n				</span>\n            </div> \n                    \n			</div>		\n			\n			<div id="glossaryEditorPopup">\n                            <div id=\'glossaryEditorList\' class=\'glossaryListDiv\'>\n					\n			    </div> \n			</div>\n			\n			<div class="bottomBar">\n				<!--div>\n				    <button type="button" id ="glossaryAddWordBtn" class="btn-addword" style="display: none"><%=AppLang.ADD_WORD_LABEL%></button>\n                    <button type="button" id ="glossarySaveBtn" class="btn btn-default" style="display: none"><%=AppLang.SAVE_LABEL%></button>\n				</div-->\n			</div>\n		</div>\n	</div>\n</div>\n'}),define("com/es/glossary/GlossaryEditor",["com/es/text!templateBasePath/Reader/glossary/glossaryModuleTemplate.html","com/es/glossary/GlossaryConstants","com/es/models/GlossaryTerm","com/es/collections/GlossaryCollection","com/es/glossary/GlossaryView","com/es/utilities/utils","com/es/utilities/services","com/es/text!templateBasePath/Editor/glossary/glossaryEditorPopupTemplate.html","com/es/text!templateBasePath/Editor/glossary/glossaryAddNewTermTemplate.html","com/es/text!templateBasePath/Editor/glossary/glossaryEditTermTemplate.html","com/es/glossary/GlossaryEditorLang","com/es/text!templateBasePath/Editor/glossary/glossaryEditorInlineTemplate.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=function(t){var n,o,l,h=0,p=null,d=null,v=!1,m=[],g=null,y="33px",b=null,w="inline",E=[],S=new Audio,x=require.s.contexts._.config.glossaryConfig,T=x.lineCount,N=function(e){var t=this;GLOSSARY_CONSTANTS.CONTENT_BASE_URL=e,GLOSSARY_CONSTANTS.MEDIA_BASE_URL=e,p=new r,O(),M(),wt(),C()},C=function(){var e={success:k,error:L};p.url=GLOSSARY_CONSTANTS.SERVICE_BASE_URL+"book/"+GLOSSARY_CONSTANTS.BOOK_ID+"/glossary",p.fetch(e)},k=function(e){s.log("success glossaryCollection data"),GC=p,s.log(p),$(window.GlossaryEditor).trigger(GLOSSARY_EVENTS.CONTAINER_RENDER_COMPLETE)},L=function(e){s.log(e)},A=function(){s.showLoader(),v=!0;var t=$("#glossaryEditorPopup").find("#glossaryEditorList");w=="inline"&&(t.empty(),t.html("")),d=new i(p,e,t),d.on(GLOSSARY_EVENTS.RENDER_COMPLETE,X)},O=function(){w=="inline"?($(b).html(_.template(c)),$(".GlossaryEditorPopUpTitle",$(b)).html(GLOSSARY_CONSTANTS.BOOK_NAME)):$(b).append(_.template(u)),$("input[name=glossaryEditPreviewToggle]:radio").on("change",function(e){K(e.target.value)})},M=function(){$(b).append(_.template(a)),$(b).append(_.template(f)),D(),$("#glossaryAddWordSaveBtn",$("#glossaryAddNewTermPopupCover")).on("click",{isContinue:!1},nt),$("#glossaryAddWordContinueBtn",$("#glossaryAddNewTermPopupCover")).on("click",{isContinue:!0},nt),$("#glossaryAddNewTermPopupCover").on("click",function(e){e.target.id=="glossaryAddNewTermPopupCover"&&st()}),$("#glossaryCancelBtn",$("#glossaryAddNewTermPopupCover")).on("click",st),$("#closeIcon",$("#glossaryAddNewTermPopupCover")).on("click",st),$(".back-arrow",$("#glossaryAddNewTermPopupCover")).on("click",st),$("#browseImage",$("#glossaryAddNewTermPopupCover")).on("click",function(){$("#imageFile",$("#glossaryAddNewTermPopupCover")).click()}),$("#browseAudio",$("#glossaryAddNewTermPopupCover")).on("click",function(){$("#audioFile",$("#glossaryAddNewTermPopupCover")).click()}),$("#imageFile",$("#glossaryAddNewTermPopupCover")).on("change",function(e){var t=e.currentTarget.files[0].name,n=t.substr(t.lastIndexOf("."),t.length),r=parseInt(e.currentTarget.files[0].size,10);if(n!==".jpeg"&&n!==".jpg"&&n!==".png"){var i={};i.data=$("#glossaryAddNewTermPopupCover"),B(i),s.showToasterMessage(GlossaryEditorLang.FILE_FORMAT_ERROR,3e3);return}if(parseInt(GLOSSARY_CONSTANTS.IMAGE_FILE_LIMIT,10)>0&&r>parseInt(GLOSSARY_CONSTANTS.IMAGE_FILE_LIMIT,10)){s.showToasterMessage(GlossaryEditorLang.FILE_SIZE_ERROR,2e3);var i={};return i.data=$("#glossaryAddNewTermPopupCover"),B(i),!1}$("#selectedImageName",$("#glossaryAddNewTermPopupCover")).html(this.files[0].name),P(this,$("#glossaryAddNewTermPopupCover"))}),$("#audioFile",$("#glossaryAddNewTermPopupCover")).on("change",function(e){var t=e.currentTarget.files[0].name,n=t.substr(t.lastIndexOf("."),t.length),r=parseInt(e.currentTarget.files[0].size,10);if(n!==".mp3"){var i={};i.data=$("#glossaryAddNewTermPopupCover"),I(i),s.showToasterMessage(GlossaryEditorLang.FILE_FORMAT_ERROR,2e3);return}if(parseInt(GLOSSARY_CONSTANTS.AUDIO_FILE_LIMIT,10)>0&&r>parseInt(GLOSSARY_CONSTANTS.AUDIO_FILE_LIMIT,10)){s.showToasterMessage(GlossaryEditorLang.FILE_SIZE_ERROR,2e3);var i={};return i.data=$("#glossaryAddNewTermPopupCover"),I(i),!1}$("#selectedAudioName",$("#glossaryAddNewTermPopupCover")).html(this.files[0].name),j(this,$("#glossaryAddNewTermPopupCover"))}),S.onended=J},D=function(){$("#glossaryEditTermSaveBtn",$("#glossaryEditNewTermPopupCover")).on("click",{isContinue:!1},rt),$("#glossaryCancelBtn",$("#glossaryEditNewTermPopupCover")).on("click",at),$("#closeIcon",$("#glossaryEditNewTermPopupCover")).on("click",at),$(".back-arrow",$("#glossaryEditNewTermPopupCover")).on("click",at),$("#browseImage",$("#glossaryEditNewTermPopupCover")).on("click",function(){$("#imageFile",$("#glossaryEditNewTermPopupCover")).click()}),$("#browseAudio",$("#glossaryEditNewTermPopupCover")).on("click",function(){$("#audioFile",$("#glossaryEditNewTermPopupCover")).click()}),$("#imageFile",$("#glossaryEditNewTermPopupCover")).on("change",function(e){var t=e.currentTarget.files[0].name,n=t.substr(t.lastIndexOf("."),t.length),r=parseInt(e.currentTarget.files[0].size,10);if(n!==".jpeg"&&n!==".jpg"&&n!==".png"){var i={};i.data=$("#glossaryEditNewTermPopupCover"),B(i),s.showToasterMessage(GlossaryEditorLang.FILE_FORMAT_ERROR);return}if(parseInt(GLOSSARY_CONSTANTS.IMAGE_FILE_LIMIT,10)>0&&r>parseInt(GLOSSARY_CONSTANTS.IMAGE_FILE_LIMIT,10)){s.showToasterMessage(GlossaryEditorLang.FILE_SIZE_ERROR,2e3);var i={};return i.data=$("#glossaryAddNewTermPopupCover"),B(i),!1}$("#imageChanged",$("#glossaryEditNewTermPopupCover")).val("true"),$("#selectedImageName",$("#glossaryEditNewTermPopupCover")).html(this.files[0].name),P(this,$("#glossaryEditNewTermPopupCover"))}),$("#audioFile",$("#glossaryEditNewTermPopupCover")).on("change",function(e){var t=e.currentTarget.files[0].name,n=t.substr(t.lastIndexOf("."),t.length),r=parseInt(e.currentTarget.files[0].size,10);if(n!==".mp3"){var i={};i.data=$("#glossaryEditNewTermPopupCover"),I(i),s.showToasterMessage(GlossaryEditorLang.FILE_FORMAT_ERROR);return}if(parseInt(GLOSSARY_CONSTANTS.AUDIO_FILE_LIMIT,10)>0&&r>parseInt(GLOSSARY_CONSTANTS.AUDIO_FILE_LIMIT,10)){s.showToasterMessage(GlossaryEditorLang.FILE_SIZE_ERROR,2e3);var i={};return i.data=$("#glossaryAddNewTermPopupCover"),I(i),!1}$("#audioChanged",$("#glossaryEditNewTermPopupCover")).val("true"),$("#selectedAudioName",$("#glossaryEditNewTermPopupCover")).html(this.files[0].name),j(this,$("#glossaryEditNewTermPopupCover"))})},P=function(e,t){if(e.files&&e.files[0]){var n=new FileReader;n.onload=function(e){H(e.target.result,t)},n.readAsDataURL(e.files[0])}},H=function(e,t){$("#imageSelectionInfo",t).hide(),$("#imagePreview",t).show(),$("#imagePreview",t).attr("src",e),$("#resetImageSelection",t).addClass("inline-block"),$("#resetImageSelection",t).off(),$("#resetImageSelection",t).on("click",t,B)},B=function(e){var t=e.data;t.hasClass("glossaryEditNewTermPopupCover")&&$("#imageChanged",$("#glossaryEditNewTermPopupCover")).val("true");var n=$("#imageFile",t);n.replaceWith(n.val("").clone(!0)),$("#selectedImageName",t).html(""),$("#imagePreview",t).hide(),$("#resetImageSelection",t).removeClass("inline-block"),$("#resetImageSelection",t).off(),$("#resetImageSelection",t).unbind(),$("#imageSelectionInfo",t).show()},j=function(e,t){S.src="",$("#audioPlayPauseImage",t).off();if(e.files&&e.files[0]){var n=new FileReader;n.onload=function(e){F(e.target.result,t)},n.readAsDataURL(e.files[0])}},F=function(e,t){$("#audioSelectionInfo",t).hide(),$("#audioPlayPauseImage",t).addClass("inline-block"),$("#resetAudioSelection",t).addClass("inline-block"),S.src=e,$("#audioPlayPauseImage",t).off(),$("#audioPlayPauseImage",t).removeClass("audioPlayBtn"),$("#audioPlayPauseImage",t).on("click",q),$("#resetAudioSelection",t).bind("click",t,I)},I=function(e){var t=e.data;t.hasClass("glossaryEditNewTermPopupCover")&&$("#audioChanged",$("#glossaryEditNewTermPopupCover")).val("true");var n=$("#audioFile",t);V(),n.replaceWith(n.val("").clone(!0)),$("#selectedAudioName",t).html(""),$("#resetAudioSelection",t).removeClass("inline-block"),$("#audioPlayPauseImage",t).removeClass("inline-block"),$("#audioPlayPauseImage",t).off(),$("#resetAudioSelection",t).unbind(),$("#audioSelectionInfo",t).show()},q=function(e){var t=e.target;S.paused?(S.play(),$(t).addClass("audioPlayBtn")):(V(),$(t).removeClass("audioPlayBtn"))},R=function(e){v?U():A()},U=function(){w=="inline"?$("#glossaryEditorPopupCover").show():$("#glossaryEditorPopupCover").modal("show")},z=function(){v&&(v=!1,$("#glossaryPopupCover").modal("hide"))},W=function(){w!="inline"&&$("#glossaryEditorPopupCover").modal("hide")},X=function(e){var t=null;s.hideLoader(),U(),G(),vt(),dt(),_makeDisable(),$("#glossarySaveBtn",$("#glossaryEditorPopupCover")).on("click",tt),$("#glossaryAddWordBtn",$("#glossaryEditorPopupCover")).on("click",et),$(".delete-term",$("#glossaryEditorPopupCover")).on("click",ft),$(".edit-term",$("#glossaryEditorPopupCover")).on("click",lt),$("#glossaryEditorPopupCover").off("hidden.bs.modal").on("hidden.bs.modal",function(){$("span.audioPlayPauseBtn").removeClass("audioPlayBtn"),V(),v=!1,$("input[name=glossaryEditPreviewToggle]:radio").trigger("click")}),$(".glossaryEditNewTermPopupCover").on("hidden.bs.modal",function(){w=="inline"&&$("input[name=glossaryEditPreviewToggle]:radio").trigger("click");var e={};e.data=$("#glossaryEditNewTermPopupCover"),V(),B(e),I(e)}),$(".glossaryAddNewTermPopupCover").on("hidden.bs.modal",function(){var e={};e.data=$("#glossaryAddNewTermPopupCover"),V(),B(e),I(e)}),$("#glossaryEditorPopupCover").on("shown.bs.modal",function(){Y(),g&&it()}),$("span.audioPlayPauseBtn").off(),$("span.audioPlayPauseBtn").on("click",function(e){var n=e.target,r=$(n).parent().parent().attr("data-id");t!==n&&(S.src=$(n).attr("data-src"),$(S).attr("data-id",r),$(t).removeClass("audioPlayBtn"),t=n),S.paused?(S.play(),$(n).addClass("audioPlayBtn")):($(n).removeClass("audioPlayBtn"),V())}),$("#glossaryEditorPopupCover, .glossaryAddNewTermPopup, .glossaryEditTermPopup").off("paste").on("paste",mt)};_makeDisable=function(){$(".term").length>0?($("#editPreviewToggle").prop("disabled",!1),$("#editPreviewToggle").removeClass("disable")):($("#editPreviewToggle").prop("disabled",!0),$("#editPreviewToggle").addClass("disable"),$("#glossaryList").find("ul").html('<div class="noData"><span class="infoIcon"></span><p>'+GlossaryEditorLang.NO_GLOSSARY_TERM+"</p></div>"))};var V=function(){S&&(S.pause(),S.duration&&(S.currentTime=0))},J=function(){$(".audioPlayPauseBtnAddNewGlossaryTerm.audioPlayBtn").removeClass("audioPlayBtn"),$(".audioPlayPauseBtn.audioPlayBtn").removeClass("audioPlayBtn"),V()},K=function(e){e=="true"?Q():G()},Q=function(){$("#glossaryList").find(".term, .description").attr("contentEditable",!0),$("#glossaryList > ul").addClass("editableBackground"),$("#glossarySaveBtn",$("#glossaryEditorPopupCover")).show(),$("#glossaryAddWordBtn",$("#glossaryEditorPopupCover")).hide(),$(".delete-term,.delete-heading",$("#glossaryEditorPopupCover")).show(),$(".delete-term,.edit-term",$("#glossaryEditorPopupCover")).show(),$(".glossaryEditorPopup .button-label:contains('Edit')").addClass("activeMode"),$(".glossaryEditorPopup .button-label:contains('Preview')").removeClass("activeMode"),J(),Z()},G=function(){$("#glossaryList").find(".term, .description").attr("contentEditable",!1),$("#glossaryList>ul").removeClass("editableBackground"),$("#glossarySaveBtn",$("#glossaryEditorPopupCover")).hide(),$("#glossaryAddWordBtn",$("#glossaryEditorPopupCover")).show(),$(".delete-term,.edit-term",$("#glossaryEditorPopupCover")).hide(),$(".glossaryEditorPopup .button-label:contains('Preview')").addClass("activeMode"),$(".glossaryEditorPopup .button-label:contains('Edit')").removeClass("activeMode"),J(),Y(),tt()},Y=function(){var e=$(".description",$("#glossaryList"));_.each(e,function(e){var t=e.scrollHeight,n=parseInt($(e).css("line-height"),10),r=n*T;parseInt(t)>r&&($(e).parent().find(".more-less-definition").show(),$(e).css("height",r+"px"),$(e).css("overflow","hidden"))})},Z=function(){var e=$(".description",$("#glossaryList"));_.each(e,function(e){$(e).parent().find(".more-less-definition").hide(),$(e).parent().find(".more-less-definition").html(GlossaryReaderLang.MORE_LABEL),$(e).css("height","auto"),$(e).css("overflow","auto")})},et=function(){$(".glossaryAddNewTermPopupCover").modal("show"),W(),$("#inputWord",$("#glossaryAddNewTermPopupCover")).val(""),$("#inputDescription",$("#glossaryAddNewTermPopupCover")).val("")},tt=function(e){var t=p.clone(p,!0),n={success:function(n){s.log("updated glossary"),s.hideLoader(),s.showToasterMessage(GlossaryEditorLang.CHANGED_SUCCESSFULLY),_.each(t.models,function(e){p.get(e.id).set({dirty:!1})}),typeof e=="function"&&e()},error:function(e){s.log(e)}};t.url=GLOSSARY_CONSTANTS.SERVICE_BASE_URL+"book/"+GLOSSARY_CONSTANTS.BOOK_ID+"/glossary",t.models.length>0&&(s.showLoader(),t.sync("update",t,n));var r={success:function(e){s.hideLoader(),s.showToasterMessage(GlossaryEditorLang.DELETED_SUCCESSFULLY),m=[],$(".term").length>0||($("input[name=glossaryEditPreviewToggle]:radio").trigger("click"),_makeDisable())},error:function(e){s.log(e)},deletedItems:JSON.stringify(m)};m.length>0&&(s.showLoader(),p.url=GLOSSARY_CONSTANTS.SERVICE_BASE_URL+"book/"+GLOSSARY_CONSTANTS.BOOK_ID+"/glossary",p.sync("delete",p,r))},nt=function(e){var t,n;J(),e&&(t=e.data.isContinue);var r=pt($("#glossaryAddNewTermPopupCover"));if(!r)return;var i=$("#inputWord",$("#glossaryAddNewTermPopupCover")).val().trim(),n=GC.find(function(e){return e.get("term").toLowerCase()==i.toLowerCase()});if(n){s.showAlert(GlossaryEditorLang.TERM_ALREADY_EXIST);return}var o=$("#inputDescription",$("#glossaryAddNewTermPopupCover")).val().trim();o=o.replace(/\r?\n/g,"<br />");var u={term:i,description:o},a=$("#add-glossary",$("#glossaryAddNewTermPopupCover"))[0],f=new FormData(a),l={success:function(e){typeof e=="string"&&(e=JSON.parse(e)),e.id&&p.add([{term:e.term,description:u.description,id:e.id,audiofiles:e.audiofiles,imagefiles:e.imagefiles}]);if(t){$("#inputWord",$("#glossaryAddNewTermPopupCover")).val(""),$("#inputDescription",$("#glossaryAddNewTermPopupCover")).val("");var n={};n.data=$("#glossaryAddNewTermPopupCover"),B(n),I(n)}else ct(),g=e.term;s.hideLoader()},error:function(e){s.hideLoader()}};s.showLoader(),l.data=f,p.url=GLOSSARY_CONSTANTS.SERVICE_BASE_URL+"/book/"+GLOSSARY_CONSTANTS.BOOK_ID+"/addMediaGlossary.excel",p.sync("create",p,l)},rt=function(e){var t,n;J(),e&&(t=e.data.isContinue);var r=pt($("#glossaryEditNewTermPopupCover"));if(!r)return;var i=$("#inputWord",$("#glossaryEditNewTermPopupCover")).val().trim(),n=GC.find(function(e){return e.get("term").toLowerCase()==i.toLowerCase()}),o=$("#inputDescription",$("#glossaryEditNewTermPopupCover")).val().trim();o=o.replace(/\r?\n/g,"<br />");var u=$("#glossaryEditNewTermPopupCover").attr("current-model-id"),a={term:i,description:o,id:u},f=$("#add-glossary",$("#glossaryEditNewTermPopupCover"))[0],l=new FormData(f);l.append("id",a.id);var c={success:function(e){typeof e=="string"&&(e=JSON.parse(e));var n=p.get(e.id);e.id&&n.set({term:e.term,description:a.description,id:e.id,audiofiles:e.audiofiles,imagefiles:e.imagefiles}),t?($("#inputWord",$("#glossaryEditNewTermPopupCover")).val(""),$("#inputDescription",$("#glossaryEditNewTermPopupCover")).val("")):(console.log(e),$("#glossaryEditNewTermPopupCover").modal("hide"),d.remove(),A(),U(),g=e.term),s.hideLoader()},error:function(e){console.log(e),s.hideLoader()}};s.showLoader(),c.data=l,p.url=GLOSSARY_CONSTANTS.SERVICE_BASE_URL+"/book/"+GLOSSARY_CONSTANTS.BOOK_ID+"/updateMediaGlossary.excel",p.sync("create",p,c)},it=function(){var e=$("#glossaryList"),t=$("#glossaryList .heading[data-term = "+g+"]");e.animate({scrollTop:t.offset().top-e.offset().top+e.scrollTop()}),g=null},st=function(){V();var e=$("#inputWord",$("#glossaryAddNewTermPopupCover")).val(),t=$("#inputDescription",$("#glossaryAddNewTermPopupCover")).val();if(e==""&&t==""){ct();return}s.showConfirmPopUp(GlossaryEditorLang.SAVE_TERM_CONFIMATION_MESSAGE,GlossaryEditorLang.SAVE_CONFIMATION_TITLE,"",function(e){if(e.toLowerCase()==="yes")nt();else{if(e.toLowerCase()!=="no")return;s.hideLoader(),ct()}})},ot=function(){var e=p.clone(p,!0);return e},ut=function(e){var t=ot();_.delay(function(){t.length>0?s.showConfirmPopUp(GlossaryEditorLang.SAVE_TERM_CONFIMATION_MESSAGE,GlossaryEditorLang.SAVE_CONFIMATION_TITLE,"",function(t){if(t.toLowerCase()==="yes")tt(e);else{if(t.toLowerCase()!=="no")return;s.hideLoader(),e()}}):e()},100)},at=function(){V();var e=$("#inputWord",$("#glossaryEditNewTermPopupCover")).val(),t=$("#inputDescription",$("#glossaryEditNewTermPopupCover")).val();if(e==""&&t==""){ht();return}$("#confirmPopupCover").appendTo($(b)),s.showConfirmPopUp(GlossaryEditorLang.SAVE_TERM_CONFIMATION_MESSAGE,GlossaryEditorLang.SAVE_CONFIMATION_TITLE,"",function(e){if(e.toLowerCase()==="yes")rt();else{if(e.toLowerCase()!=="no")return;s.hideLoader(),ht()}})},ft=function(e){var t=$(e.target).parent().parent(),n=t.parent(),r=t.data("id");r==$(S).attr("data-id")&&J(),m.push({id:""+r}),t.remove();var i=n.find("ul");if(i.length==0){var s=n.attr("id").toLowerCase();$("[id = "+s+"anchor").addClass("disable"),n.remove()}p.remove(p.get(r))},lt=function(e){var t=$(e.target).parent().parent();$("#audioPlayPauseImage").off(),$("#resetImageSelection").off(),V(),$(".glossaryEditNewTermPopupCover").modal("show"),W();var n=t.data("id");$("#glossaryEditNewTermPopupCover").attr("current-model-id",n);var r=p.get(n).attributes,i=r.imagefiles,s=r.audiofiles;$("#inputWord",$("#glossaryEditNewTermPopupCover")).val(r.term),$("#inputDescription",$("#glossaryEditNewTermPopupCover")).val(r.description),$("#selectedImageName",$("#glossaryEditNewTermPopupCover")).html(i.substring(i.lastIndexOf("/")+1,i.length)),$("#selectedAudioName",$("#glossaryEditNewTermPopupCover")).html(s.substring(s.lastIndexOf("/")+1,s.length)),$("#imageChanged",$("#glossaryEditNewTermPopupCover")).val("false"),$("#audioChanged",$("#glossaryEditNewTermPopupCover")).val("false"),r.imagefiles&&H(GLOSSARY_CONSTANTS.CONTENT_BASE_URL+"/"+r.imagefiles,$("#glossaryEditNewTermPopupCover")),r.audiofiles&&F(GLOSSARY_CONSTANTS.CONTENT_BASE_URL+"/"+r.audiofiles,$("#glossaryEditNewTermPopupCover"))},ct=function(e){var t={};t.data=$("#glossaryAddNewTermPopupCover"),$("#inputWord",$("#glossaryAddNewTermPopupCover")).val(""),$("#inputDescription",$("#glossaryAddNewTermPopupCover")).val(""),B(t),I(t),$("#glossaryAddNewTermPopupCover").modal("hide"),d.remove(),A(),U()},ht=function(){var e={};e.data=$("#glossaryEditNewTermPopupCover"),$("#inputWord",$("#glossaryEditNewTermPopupCover")).val(""),$("#inputDescription",$("#glossaryEditNewTermPopupCover")).val(""),B(e),I(e),$("#glossaryEditNewTermPopupCover").modal("hide"),d.remove(),A(),U()},pt=function(e){var t=$("#inputWord",e).val(),n=$("#inputDescription",e).val();return t.trim()==""?(s.showAlert(GlossaryEditorLang.TERM_VALIDATION_MESSAGE),!1):n.trim()==""?(s.showAlert(GlossaryEditorLang.DEFINITION_VALIDATION_MESSAGE),!1):!0},dt=function(){$("#glossaryList").on("keyup","[contenteditable]",function(){var e=$(this),t=e.parent().data("id"),n=p.get(t),r=e.data("key"),i=new Object,o=e.html().replace(/&nbsp;/g," ");i[r]=o.trim();if(i[r]==""){e.blur(),s.showToasterMessage(GlossaryEditorLang.YOU_CANNOT_SAVE_BLANK_MESSAGE+r),e.focus();return}i.dirty=!0,n.set(i),E=[],_.each(p.models,function(e){E.push(p.get(e.id).get("term"))}),_.indexOf(E,i.term)!==_.lastIndexOf(E,i.term)?$("#glossarySaveBtn").unbind().hide():($("#glossarySaveBtn").unbind().show(),$("#glossarySaveBtn",$("#glossaryEditorPopupCover")).on("click",tt))})},vt=function(){$("#glossaryList").find(".term, .description").on("keyup mouseup",function(){!this.lastChild||this.lastChild.nodeName.toLowerCase()!="br"}).on("keydown",function(e){if(e.which==13&&window.getSelection){var t=window.getSelection(),n=t.getRangeAt(0),r=document.createElement("br");return n.deleteContents(),n.insertNode(r),n.setStartAfter(r),n.setEndAfter(r),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!1}})},mt=function(e){e.preventDefault();var t=undefined;window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData&&(t=e.originalEvent.clipboardData.getData("text/plain"));if(t){t="<span>"+t+"</span>";var n=s.removeNbsp($(t.toString()).text()),r=$(e.target).text();gt(n,$(e.target))}},gt=function(e,t){var n,r,i;if(window.getSelection){n=window.getSelection();if(n.getRangeAt&&n.rangeCount){r=n.getRangeAt(0),t.get(0).nodeName==="INPUT"||t.get(0).nodeName==="TEXTAREA"?i=$(t):i="",r.deleteContents();var s=document.createElement("span");s.innerHTML=e;var o=document.createDocumentFragment(),u,a;while(u=s.firstChild)a=o.appendChild(u);if(i.length>0){var f=i.get(0).selectionStart,l=i.get(0).selectionEnd,c=i.val(),h=$(a).text(),p="";p=yt(c,h,f),i.val(p),bt(f+h.length,i.get(0))}else r.insertNode(o);a&&i.length===0&&(r=r.cloneRange(),r.setStartAfter(a),r.collapse(!0),n.removeAllRanges(),n.addRange(r))}}else document.selection&&document.selection.type!="Control"&&document.selection.createRange().pasteHTML(e)},yt=function(e,t,n){return e.slice(0,n)+t+e.slice(n)},bt=function(e,t){typeof t.selectionStart=="number"&&typeof t.selectionEnd=="number"&&(t.selectionStart=e,t.selectionEnd=e)},wt=function(){var e=GLOSSARY_CONSTANTS.AUDIO_FILE_LIMIT,t=GLOSSARY_CONSTANTS.IMAGE_FILE_LIMIT,n,r,i,s;e>0&&(i=Et(e),n=AppLang.FILE_SIZE_INFO+" "+i+AppLang.MEGABYTE_ABBR,$("#gsAddAudioFileSizeInfo, #gsEditAudioFileSizeInfo",b).text(n)),t>0&&(s=Et(t),r=AppLang.FILE_SIZE_INFO+" "+s+AppLang.MEGABYTE_ABBR,$("#gsAddImageFileSizeInfo, #gsEditImageFileSizeInfo",b).text(r))},Et=function(e){return e/1048576},St=Backbone.View.extend({initialize:function(){GLOSSARY_CONSTANTS.ROOT_URL=location.href.split("#")[0],GLOSSARY_CONSTANTS.ROOT_PATH=window.location.pathname.split("/")[1],GLOSSARY_CONSTANTS.SERVICE_BASE_URL=window.location.origin+"/"+GLOSSARY_CONSTANTS.ROOT_PATH+"/pubservice/"},init:function(e){n===undefined?(_.extend(this,Backbone.Events),n=this,b=e.container,GLOSSARY_CONSTANTS.BOOK_ID=e.bookId,GLOSSARY_CONSTANTS.BOOK_NAME=e.bookName,w=e.mode,e.audioFileLimit&&(GLOSSARY_CONSTANTS.AUDIO_FILE_LIMIT=parseInt(e.audioFileLimit,10)),e.imageFileLimit&&(GLOSSARY_CONSTANTS.IMAGE_FILE_LIMIT=parseInt(e.imageFileLimit,10)),s.log("initialize -- ",n),N(e.contentBaseUrl)):s.log("instance already created")},show:R,hide:z,checkUnsavedData:ut});return new St};return window.GlossaryEditor=new h,window.GlossaryEditor}),define("com/es/text!templateBasePath/Editor/popups/popUpTemplate.html",[],function(){return'<div class="popUpContainer">\r\n	<div id="loading-indicator" class="modal-dialog loading-indicator" >\r\n	    	<img class="preloader"/>\r\n	</div>\r\n	<!--div id="js-alert" class="modal-dialog alert alert-warning js-alert fade">\r\n	    <p class="js-alert-text"></p>\r\n	</div-->\r\n\r\n	<div id="js-alert" class="modal popup-alert-cover fade in" tabindex="-1" role="dialog">\r\n	    <div class="modal-dialog popup-alert modal-sm">\r\n	      <div class="modal-content">\r\n	        <!--div class="modal-header">\r\n	          <h4 class="modal-title alert-text" id="js-alert-text"></h4>\r\n	        </div-->\r\n	        <div class="modal-body">\r\n	          <p id="js-alert-text" class="alert-text"></p>\r\n	          <button type="button" class="btn btn-default cancelbtn" data-dismiss="modal" aria-label="Close">Close</button>\r\n	        </div>\r\n	      </div>\r\n	    </div>\r\n	</div>\r\n\r\n\r\n	\r\n	<div id="toastContainer" class="modal-dialog toastContainer" >\r\n	    <div id="toastMsg" class="modal-content">\r\n		</div>\r\n	</div>\r\n	<div id="confirmPopupCover" class="modal fade in">		\r\n	</div>\r\n</div>'}),require(["com/es/utilities/AppLang","com/es/utilities/AppEvent","com/es/glossary/GlossaryEditor","com/es/text!templateBasePath/Editor/popups/popUpTemplate.html"],function(e,t,n,r){$(window).trigger(AppEvent.GLOSSARY_EDITOR_READY),$("body").append(_.template(r))}),define("com/es/mainGlossaryEditor",function(){});