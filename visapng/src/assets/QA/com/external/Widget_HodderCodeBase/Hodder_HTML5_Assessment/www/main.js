//     Underscore.js 1.5.1
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/*! jQuery v2.0.3 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-2.0.3.min.map
*/

//     (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/*
 Copyright 2011 Abdulla Abdurakhmanov
 Original sources are available at https://code.google.com/p/x2js/

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 */

/*! iScroll v5.0.4 ~ (c) 2008-2013 Matteo Spinelli ~ http://cubiq.org/license */

/*
 *	jQuery carouFredSel 6.2.1
 *	Demo's and documentation:
 *	caroufredsel.dev7studios.com
 *
 *	Copyright (c) 2013 Fred Heusschen
 *	www.frebsite.nl
 *
 *	Dual licensed under the MIT and GPL licenses.
 *	http://en.wikipedia.org/wiki/MIT_License
 *	http://en.wikipedia.org/wiki/GNU_General_Public_License
 */

/*! TinySort 1.5.6
* Copyright (c) 2008-2013 Ron Valstar http://tinysort.sjeiti.com/
* License:
*     MIT: http://www.opensource.org/licenses/mit-license.php
*     GPL: http://www.gnu.org/licenses/gpl.html
*/

/*
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/

/* Javascript plotting library for jQuery, version 0.8.3.

Copyright (c) 2007-2014 IOLA and Ole Laursen.
Licensed under the MIT license.

*/

/* Plugin for jQuery for working with colors.
 *
 * Version 1.1.
 *
 * Inspiration from jQuery color animation plugin by John Resig.
 *
 * Released under the MIT license by Ole Laursen, October 2009.
 *
 * Examples:
 *
 *   $.color.parse("#fff").scale('rgb', 0.25).add('a', -0.5).toString()
 *   var c = $.color.extract($("#mydiv"), 'background-color');
 *   console.log(c.r, c.g, c.b, c.a);
 *   $.color.make(100, 50, 25, 0.4).toString() // returns "rgba(100,50,25,0.4)"
 *
 * Note that .scale() and .add() return the same modified object
 * instead of making a new one.
 *
 * V. 1.1: Fix error handling so e.g. parsing an empty string does
 * produce a color rather than just crashing.
 */

/* Flot plugin for rendering pie charts.

Copyright (c) 2007-2014 IOLA and Ole Laursen.
Licensed under the MIT license.

The plugin assumes that each series has a single data value, and that each
value is a positive integer or zero.  Negative numbers don't make sense for a
pie chart, and have unpredictable results.  The values do NOT need to be
passed in as percentages; the plugin will calculate the total and per-slice
percentages internally.

* Created by Brian Medendorp

* Updated with contributions from btburnett3, Anthony Aragues and Xavi Ivars

The plugin supports these options:

	series: {
		pie: {
			show: true/false
			radius: 0-1 for percentage of fullsize, or a specified pixel length, or 'auto'
			innerRadius: 0-1 for percentage of fullsize or a specified pixel length, for creating a donut effect
			startAngle: 0-2 factor of PI used for starting angle (in radians) i.e 3/2 starts at the top, 0 and 2 have the same result
			tilt: 0-1 for percentage to tilt the pie, where 1 is no tilt, and 0 is completely flat (nothing will show)
			offset: {
				top: integer value to move the pie up or down
				left: integer value to move the pie left or right, or 'auto'
			},
			stroke: {
				color: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#FFF')
				width: integer pixel width of the stroke
			},
			label: {
				show: true/false, or 'auto'
				formatter:  a user-defined function that modifies the text/style of the label text
				radius: 0-1 for percentage of fullsize, or a specified pixel length
				background: {
					color: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#000')
					opacity: 0-1
				},
				threshold: 0-1 for the percentage value at which to hide labels (if they're too small)
			},
			combine: {
				threshold: 0-1 for the percentage value at which to combine slices (if they're too small)
				color: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#CCC'), if null, the plugin will automatically use the color of the first slice to be combined
				label: any text value of what the combined slice should be labeled
			}
			highlight: {
				opacity: 0-1
			}
		}
	}

More detail and specific examples can be found in the included HTML file.

*/

function X2JS(){function r(e){var t=e.localName;t==null&&(t=e.baseName);if(t==null||t=="")t=e.nodeName;return t}function i(e){return e.prefix}function s(e){return typeof e=="string"?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):e}function o(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function u(e){if(e.nodeType==n.DOCUMENT_NODE){var s=new Object,a=e.firstChild,f=r(a);return s[f]=u(a),s}if(e.nodeType==n.ELEMENT_NODE){var s=new Object;s.__cnt=0;var l=e.childNodes;for(var c=0;c<l.length;c++){var a=l.item(c),f=r(a);s.__cnt++;if(s[f]==null)s[f]=u(a),s[f+"_asArray"]=new Array(1),s[f+"_asArray"][0]=s[f];else{if(s[f]!=null&&!(s[f]instanceof Array)){var h=s[f];s[f]=new Array,s[f][0]=h,s[f+"_asArray"]=s[f]}var p=0;while(s[f][p]!=null)p++;s[f][p]=u(a)}}for(var d=0;d<e.attributes.length;d++){var v=e.attributes.item(d);s.__cnt++,s["_"+v.name]=v.value}var m=i(e);m!=null&&m!=""&&(s.__cnt++,s.__prefix=m),s.__cnt==1&&s["#text"]!=null&&(s=s["#text"]),s["#text"]!=null&&(s.__text=s["#text"],t&&(s.__text=o(s.__text)),delete s["#text"],delete s["#text_asArray"]),s["#cdata-section"]!=null&&(s.__cdata=s["#cdata-section"],delete s["#cdata-section"],delete s["#cdata-section_asArray"]);if(s.__text!=null||s.__cdata!=null)s.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")};return s}if(e.nodeType==n.TEXT_NODE||e.nodeType==n.CDATA_SECTION_NODE)return e.nodeValue}function a(e,t,n,r){var i="<"+(e!=null&&e.__prefix!=null?e.__prefix+":":"")+t;if(n!=null)for(var s=0;s<n.length;s++){var o=n[s],u=e[o];i+=" "+o.substr(1)+"='"+u+"'"}return r?i+="/>":i+=">",i}function f(e,t){return"</"+(e.__prefix!=null?e.__prefix+":":"")+t+">"}function l(e,t){return e.indexOf(t,e.length-t.length)!==-1}function c(e,t){return l(t.toString(),"_asArray")||t.toString().indexOf("_")==0||e[t]instanceof Function?!0:!1}function h(e){var t=0;if(e instanceof Object)for(var n in e){if(c(e,n))continue;t++}return t}function p(e){var t=[];if(e instanceof Object)for(var n in e)n.toString().indexOf("__")==-1&&n.toString().indexOf("_")==0&&t.push(n);return t}function d(e){var n="";return e.__cdata!=null&&(n+="<![CDATA["+e.__cdata+"]]>"),e.__text!=null&&(t?n+=s(e.__text):n+=e.__text),n}function v(e){var n="";return e instanceof Object?n+=d(e):e!=null&&(t?n+=s(e):n+=e),n}function m(e,t,n){var r="";if(e.length==0)r+=a(e,t,n,!0);else for(var i=0;i<e.length;i++)r+=a(e[i],t,p(e[i]),!1),r+=g(e[i]),r+=f(e[i],t);return r}function g(e){var t="",n=h(e);if(n>0)for(var r in e){if(c(e,r))continue;var i=e[r],s=p(i);if(i==null||i==undefined)t+=a(i,r,s,!0);else if(i instanceof Object)if(i instanceof Array)t+=m(i,r,s);else{var o=h(i);o>0||i.__text!=null||i.__cdata!=null?(t+=a(i,r,s,!1),t+=g(i),t+=f(i,r)):t+=a(i,r,s,!0)}else t+=a(i,r,s,!1),t+=v(i),t+=f(i,r)}return t+=v(e),t}var e="1.0.11",t=!1,n={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t;if(window.DOMParser){var n=new window.DOMParser;t=n.parseFromString(e,"text/xml")}else e.indexOf("<?")==0&&(e=e.substr(e.indexOf("?>")+2)),t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);return t},this.xml2json=function(e){return u(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return this.xml2json(t)},this.json2xml_str=function(e){return g(e)},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return e},this.escapeMode=function(e){t=e}}function Stopwatch(e){this.callback=e.updateHandler||function(e){console.log(e)},this.reset(e)}(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.5.1";var T=x.each=x.forEach=function(e,t,r){if(e==null)return;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?void 0:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t==null?x.identity:t);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=n==null?x.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,0,t):e[0]},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i=null;return function(){var s=this,o=arguments,u=function(){i=null,n||(r=e.apply(s,o))},a=n&&!i;return clearTimeout(i),i=setTimeout(u,t),a&&(r=e.apply(s,o)),r}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u))return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),define("underscore",function(e){return function(){var t,n;return t||e._}}(this)),function(e,undefined){function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,s,o,u,a,f;if(1===t.nodeType){if(q.hasData(e)&&(s=q.access(e),o=q.set(t,s),f=s.events)){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;r>n;n++)x.event.add(t,i,f[i][n])}L.hasData(e)&&(u=L.access(e),a=x.extend({},u),L.set(t,a))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=q.get(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(s[o]=q.access(r,"olddisplay",Rt(r.nodeName)))):s[o]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=x.css(e,n+jt[s],!0,i)),r?("content"===n&&(o-=x.css(e,"padding"+jt[s],!0,i)),"margin"!==n&&(o-=x.css(e,"border"+jt[s]+"Width",!0,i))):(o+=x.css(e,"padding"+jt[s],!0,i),"padding"!==n&&(o+=x.css(e,"border"+jt[s]+"Width",!0,i)));return o}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=qt(e),o=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=vt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=o&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(o?"border":"content"),r,s)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){function o(u){var a;return i[u]=!0,x.each(e[u]||[],function(e,u){var f=u(t,n,r);return"string"!=typeof f||s||i[f]?s?!(a=f):undefined:(t.dataTypes.unshift(f),o(f),!1)}),a}var i={},s=e===on;return o(t.dataTypes[0])||!i["*"]&&o("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}function pn(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while("*"===a[0])a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}return s?(s!==a[0]&&a.unshift(s),n[s]):undefined}function fn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),s=0,o=i.length;for(;o>s;s++)if(r=i[s].call(n,t,e))return r}function jn(e,t,n){var r,i,s=0,o=kn.length,u=x.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(Dn(l,f.opts.specialEasing);o>s;s++)if(r=kn[s].call(f,e,l,f.opts))return r;return x.map(l,Sn,f),x.isFunction(f.opts.start)&&f.opts.start.call(e,f),x.fx.timer(x.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Dn(e,t){var n,r,i,s,o;for(n in e)if(r=x.camelCase(n),i=t[r],s=e[n],x.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=x.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function An(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&Lt(e),p=q.get(e,"fxshow");n.queue||(u=x._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,x.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(c.display="inline-block")),n.overflow&&(c.overflow="hidden",f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!p||p[r]===undefined)continue;h=!0}l[r]=p&&p[r]||x.style(e,r)}if(!x.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=q.access(e,"fxshow",{}),s&&(p.hidden=!h),h?x(e).show():f.done(function(){x(e).hide()}),f.done(function(){var t;q.remove(e,"fxshow");for(t in l)x.style(e,t,l[t])});for(r in l)o=Sn(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;for("boolean"==typeof o&&(f=o,o=arguments[1]||{},u=2),"object"==typeof o||x.isFunction(o)||(o={}),a===u&&(o=this,--u);a>u;u++)if(null!=(e=arguments[u]))for(t in e)n=o[t],r=e[t],o!==r&&(f&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,s=n&&x.isArray(n)?n:[]):s=n&&x.isPlainObject(n)?n:{},o[t]=x.extend(f,s,r)):r!==undefined&&(o[t]=r));return o},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=j(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=j(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return f.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=null==n;if("object"===x.type(n)){i=!0;for(u in n)x.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(x(e),n)})),t))for(;a>u;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)));return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),t=x(o),function(e,t){function ot(e,t,n,i){var s,o,u,a,f,l,p,m,g,E;if((t?t.ownerDocument||t:w)!==h&&c(t),t=t||h,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(d&&!i){if(s=Z.exec(e))if(u=s[1]){if(9===a){if(o=t.getElementById(u),!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return H.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return H.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){if(m=p=b,g=t,E=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){l=mt(e),(p=t.getAttribute("id"))?m=p.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+gt(l[f]);g=$.test(e)&&t.parentNode||t,E=l.join(",")}if(E)try{return H.apply(n,g.querySelectorAll(E)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Nt(e.replace(W,"$1"),t,n,i)}function ut(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function at(e){return e[b]=!0,e}function ft(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)s.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(){}function mt(e,t){var n,r,i,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){(!n||(r=X.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=V.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),u=u.slice(n.length));for(o in s.filter)!(r=G[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)}function gt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,s=n&&"parentNode"===r,o=S++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=E+" "+o;if(u){while(t=t[r])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||s)if(l=t[b]||(t[b]={}),(f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else if(f=l[r]=[c],f[1]=e(t,n,u)||i,f[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Et(e,t,n,r,i,s){return r&&!r[b]&&(r=Et(r)),i&&!i[b]&&(i=Et(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||Tt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:wt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?j.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):H.apply(o,g)})}function St(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return j.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;i>a;a++)if(n=s.relative[e[a].type])h=[yt(bt(h),n)];else{if(n=s.filter[e[a].type].apply(null,e[a].matches),n[b]){for(r=++a;i>r;r++)if(s.relative[e[r].type])break;return Et(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(W,"$1"),n,r>a&&St(e.slice(a,r)),i>r&&St(e=e.slice(r)),i>r&&gt(e))}h.push(n)}return bt(h)}function xt(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],S=null!=p,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=E+=null==x?1:Math.random()||.1;for(S&&(f=a!==h&&a,i=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}S&&(E=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=D.call(c));g=wt(g)}H.apply(c,g),S&&!u&&g.length>0&&y+t.length>1&&ot.uniqueSort(c)}return S&&(E=N,f=x),w};return r?at(u):u}function Tt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function Nt(e,t,n,i){var o,u,f,l,c,h=mt(e);if(!i&&1===h.length){if(u=h[0]=h[0].slice(0),u.length>2&&"ID"===(f=u[0]).type&&r.getById&&9===t.nodeType&&d&&s.relative[u[1].type]){if(t=(s.find.ID(f.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(u.shift().value.length)}o=G.needsContext.test(e)?0:u.length;while(o--){if(f=u[o],s.relative[l=f.type])break;if((c=s.find[l])&&(i=c(f.matches[0].replace(rt,it),$.test(u[0].type)&&t.parentNode||t))){if(u.splice(o,1),e=i.length&&gt(u),!e)return H.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,$.test(e)),n}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),w=e.document,E=0,S=0,T=ut(),N=ut(),C=ut(),k=!1,L=function(e,t){return e===t?(k=!0,0):0},A=typeof t,O=1<<31,M={}.hasOwnProperty,_=[],D=_.pop,P=_.push,H=_.push,B=_.slice,j=_.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=q.replace("w","w#"),U="\\["+I+"*("+q+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+I+"*\\]",z=":("+q+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+U.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=RegExp("^"+I+"*,"+I+"*"),V=RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),$=RegExp(I+"*[+~]"),J=RegExp("="+I+"*([^\\]'\"]*)"+I+"*\\]","g"),K=RegExp(z),Q=RegExp("^"+R+"$"),G={ID:RegExp("^#("+q+")"),CLASS:RegExp("^\\.("+q+")"),TAG:RegExp("^("+q.replace("w","w*")+")"),ATTR:RegExp("^"+U),PSEUDO:RegExp("^"+z),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:RegExp("^(?:"+F+")$","i"),needsContext:RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{H.apply(_=B.call(w.childNodes),w.childNodes),_[w.childNodes.length].nodeType}catch(st){H={apply:_.length?function(e,t){P.apply(e,B.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=ot.support={},c=ot.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.defaultView;return n!==h&&9===n.nodeType&&n.documentElement?(h=n,p=n.documentElement,d=!u(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){c()}),r.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ft(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ft(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ft(function(e){return p.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==A&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==A&&d?n.getElementsByClassName(e):t},m=[],v=[],(r.qsa=Y.test(n.querySelectorAll))&&(ft(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+F+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),ft(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(r.matchesSelector=Y.test(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ft(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",z)}),v=v.length&&RegExp(v.join("|")),m=m.length&&RegExp(m.join("|")),y=Y.test(p.contains)||p.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=p.compareDocumentPosition?function(e,t){if(e===t)return k=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||y(w,e)?-1:t===n||y(w,t)?1:l?j.call(l,e)-j.call(l,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return k=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:l?j.call(l,e)-j.call(l,t):0;if(s===o)return ct(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ct(u[i],a[i]):u[i]===w?-1:a[i]===w?1:0},n):h},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&c(e),t=t.replace(J,"='$1']"),!(!r.matchesSelector||!d||m&&m.test(t)||v&&v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return ot(t,h,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},ot.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&M.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,n=[],i=0,s=0;if(k=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(L),k){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},s=ot.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return G.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&K.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===E&&f[1],h=f[0]===E&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[E,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===E)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[b]||(c[b]={}))[e]=[E,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=j.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(W,"$1"));return r[b]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return Q.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[0>n?n+t:n]}),even:dt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=pt(n);vt.prototype=s.filters=s.pseudos,s.setFilters=new vt,a=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=mt(e)),n=t.length;while(n--)s=St(t[n]),s[b]?r.push(s):i.push(s);s=C(e,xt(i,r))}return s},r.sortStable=b.split("").sort(L).join("")===b,r.detectDuplicates=k,c(),r.sortDetached=ft(function(e){return 1&e.compareDocumentPosition(h.createElement("div"))}),ft(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ft(function(e){return null==e.getAttribute("disabled")})||lt(F,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(h){for(t=e.memory&&h,n=!0,o=i||0,i=0,s=u.length,r=!0;u&&s>o;o++)if(u[o].apply(h[0],h[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&l.has(n)||u.push(n):n&&n.length&&"string"!==r&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,u,n))>-1)u.splice(n,1),r&&(s>=n&&s--,o>=n&&o--)}),this},has:function(e){return e?x.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return!u||n&&!a||(t=t||[],t=[e,t.slice?t.slice():t],r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,s){var o=s[0],u=x.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,s=1===i?e:x.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),u=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=u.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(u,null!=u.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),u.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if("string"==typeof t)s[t]=n;else if(x.isEmptyObject(s))x.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===undefined)this.cache[s]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(w)||[])),n=r.length;while(n--)delete o[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===undefined){if(this.length&&(o=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>s;s++)r=n[s].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,o[r]));q.set(i,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}}),x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),s=x._queueHooks(e,t),o=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(o--)n=q.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,s=x(this),o=e.match(w)||[];while(t=o[i++])s.hasClass(t)?s.removeClass(t):s.addClass(t)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=x.makeArray(t),o=i.length;while(o--)r=i[o],(r.selected=x.inArray(x(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===r?x.prop(e,t,n):(1===o&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(s=i.get(e,t))?s:(s=x.find.attr(e,t),null==s?undefined:s):null!==n?i&&"set"in i&&(s=i.set(e,n,t))!==undefined?s:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(w);if(s&&1===e.nodeType)while(n=s[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!x.isXMLDoc(e),s&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],s=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,s}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;x.event={global:{},add:function(e,t,n,i,s){var o,u,a,f,l,c,h,p,d,v,m,g=q.get(e);if(g){n.handler&&(o=n,n=o.handler,s=o.selector),n.guid||(n.guid=x.guid++),(f=g.events)||(f=g.events={}),(u=g.handle)||(u=g.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(w)||[""],l=t.length;while(l--)a=X.exec(t[l])||[],d=m=a[1],v=(a[2]||"").split(".").sort(),d&&(h=x.event.special[d]||{},d=(s?h.delegateType:h.bindType)||d,h=x.event.special[d]||{},c=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&x.expr.match.needsContext.test(s),namespace:v.join(".")},o),(p=f[d])||(p=f[d]=[],p.delegateCount=0,h.setup&&h.setup.call(e,i,v,u)!==!1||e.addEventListener&&e.addEventListener(d,u,!1)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),s?p.splice(p.delegateCount++,0,c):p.push(c),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=q.hasData(e)&&q.get(e);if(m&&(a=m.events)){t=(t||"").match(w)||[""],f=t.length;while(f--)if(u=X.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=x.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],!i&&v!==l.origType||n&&n.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,p,m.handle),delete a[p])}else for(p in a)x.event.remove(e,p+t[f],n,r,!0);x.isEmptyObject(a)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,u,a,f,l,c,h,p=[r||o],d=y.call(t,"type")?t.type:t,v=y.call(t,"namespace")?t.namespace.split("."):[];if(u=a=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(v=d.split("."),d=v.shift(),v.sort()),l=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=v.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),h=x.event.special[d]||{},i||!h.trigger||h.trigger.apply(r,n)!==!1)){if(!i&&!h.noBubble&&!x.isWindow(r)){for(f=h.delegateType||d,_.test(f+d)||(u=u.parentNode);u;u=u.parentNode)p.push(u),a=u;a===(r.ownerDocument||o)&&p.push(a.defaultView||a.parentWindow||e)}s=0;while((u=p[s++])&&!t.isPropagationStopped())t.type=s>1?f:h.bindType||d,c=(q.get(u,"events")||{})[t.type]&&q.get(u,"handle"),c&&c.apply(u,n),c=l&&u[l],c&&x.acceptData(u)&&c.apply&&c.apply(u,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),n)!==!1||!x.acceptData(r)||l&&x.isFunction(r[d])&&!x.isWindow(r)&&(a=r[l],a&&(r[l]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,a&&(r[l]=a)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,s,o=[],u=d.call(arguments),a=(q.get(this,"events")||{})[e.type]||[],f=x.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,e)!==!1){o=x.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,r=((x.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return f.postDispatch&&f.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||"click"!==e.type))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||"click"!==e.type){for(r=[],n=0;u>n;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?x(i,this).index(a)>=0:x.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return t.length>u&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),u.filter?u.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(s=r,r=function(e){return x().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?x.unique(s):s)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,s,o,u,a,l=0,c=this.length,h=this,p=c-1,d=e[0],v=x.isFunction(d);if(v||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=h.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(s=x.map(mt(r,"script"),ft),o=s.length;c>l;l++)u=r,l!==p&&(u=x.clone(u,!0,!0),o&&x.merge(s,mt(u,"script"))),t.call(this[l],u,l);if(o)for(a=s[s.length-1].ownerDocument,x.map(s,ht),l=0;o>l;l++)u=s[l],at.test(u.type||"")&&!q.access(u,"globalEval")&&x.contains(a,u)&&(u.src?x._evalUrl(u.src):x.globalEval(u.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),s=i.length-1,o=0;for(;s>=o;o++)n=o===s?this:this.clone(!0),x(i[o])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(o=mt(u),s=mt(e),r=0,i=s.length;i>r;r++)yt(s[r],o[r]);if(t)if(n)for(s=s||mt(e),o=o||mt(u),r=0,i=s.length;i>r;r++)gt(s[r],o[r]);else gt(e,u);return o=mt(u,"script"),o.length>0&&dt(o,!a&&mt(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=0,c=e.length,h=t.createDocumentFragment(),p=[];for(;c>l;l++)if(i=e[l],i||0===i)if("object"===x.type(i))x.merge(p,i.nodeType?[i]:i);else if(rt.test(i)){s=s||h.appendChild(t.createElement("div")),o=(nt.exec(i)||["",""])[1].toLowerCase(),u=ct[o]||ct._default,s.innerHTML=u[1]+i.replace(tt,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.lastChild;x.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}else p.push(t.createTextNode(i));h.textContent="",l=0;while(i=p[l++])if((!r||-1===x.inArray(i,r))&&(a=x.contains(i.ownerDocument,i),s=mt(h.appendChild(i),"script"),a&&dt(s),n)){f=0;while(i=s[f++])at.test(i.type||"")&&n.push(i)}return h},cleanData:function(e){var t,n,r,i,s,o,u=x.event.special,a=0;for(;(n=e[a])!==undefined;a++){if(F.accepts(n)&&(s=n[q.expando],s&&(t=q.cache[s]))){if(r=Object.keys(t.events||{}),r.length)for(o=0;(i=r[o])!==undefined;o++)u[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);q.cache[s]&&delete q.cache[s]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,s={},o=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>o;o++)s[t[o]]=x.css(e,t[o],!1,r);return s}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,u=x.camelCase(t),a=e.style;return t=x.cssProps[u]||(x.cssProps[u]=At(a,u)),o=x.cssHooks[t]||x.cssHooks[u],n===undefined?o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t]:(s=typeof n,"string"===s&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),s="number"),null==n||"number"===s&&isNaN(n)||("number"!==s||x.cssNumber[u]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(a[t]="inherit"),o&&"set"in o&&(n=o.set(e,n,r))===undefined||(a[t]=n)),undefined)}},css:function(e,t,n,r){var i,s,o,u=x.camelCase(t);return t=x.cssProps[u]||(x.cssProps[u]=At(e.style,u)),o=x.cssHooks[t]||x.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(s=parseFloat(i),n===!0||x.isNumeric(s)?s||0:i):i}}),vt=function(e,t,n){var r,i,s,o=n||qt(e),u=o?o.getPropertyValue(t)||o[t]:undefined,a=e.style;return o&&(""!==u||x.contains(e.ownerDocument,e)||(u=x.style(e,t)),Ct.test(u)&&wt.test(t)&&(r=a.width,i=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=u,u=o.width,a.width=r,a.minWidth=i,a.maxWidth=s)),u},x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=s[r]||s[r-2]||s[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")},x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[],x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),o.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){function T(e,t,s,u){var f,m,g,b,w,S=t;2!==y&&(y=2,o&&clearTimeout(o),n=undefined,i=u||"",E.readyState=e>0?4:0,f=e>=200&&300>e||304===e,s&&(b=pn(l,E,s)),b=fn(l,b,E,f),f?(l.ifModified&&(w=E.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=E.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===l.type?S="nocontent":304===e?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g)):(g=S,(e||!S)&&(S="error",0>e&&(e=0))),E.status=e,E.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,E]):p.rejectWith(c,[E,S,g]),E.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?m:g]),d.fireWith(c,[E,S]),a&&(h.trigger("ajaxComplete",[E,l]),--x.active||x.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=x.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?x(c):x.event,p=x.Deferred(),d=x.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!s){s={};while(t=Qt.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)v[t]=[v[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),T(0,t),this}};if(p.promise(E).complete=d.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=x.trim(l.dataType||"*").toLowerCase().match(w)||[""],null==l.crossDomain&&(u=tn.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===Xt[1]&&u[2]===Xt[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=x.param(l.data,l.traditional)),ln(rn,l,t,E),2===y)return E;a=l.global,a&&0===x.active++&&x.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Zt.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(Vt.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),l.ifModified&&(x.lastModified[r]&&E.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&E.setRequestHeader("If-None-Match",x.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+sn+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)E.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&2!==y){b="abort";for(f in{success:1,error:1,complete:1})E[f](l[f]);if(n=ln(on,l,t,E)){E.readyState=1,a&&h.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{y=1,n.send(m,T)}catch(S){if(!(2>y))throw S;T(-1,S)}}else T(-1,"No Transport");return E}return E.abort()},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return u||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||x.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),o&&x.isFunction(s)&&s(o[0]),o=s=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,s,o=e.xhr();if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?r(o.status||404,o.statusText):r(mn[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:undefined,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=vn[s=yn++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),s=i&&i[3]||(x.cssNumber[e]?"":"px"),o=(x.cssNumber[e]||"px"!==s&&+r)&&Tn.exec(x.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,x.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}}),x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),s=x.speed(t,n,r),o=function(){var t=jn(this,x.extend({},e),s);(i||q.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=x.timers,o=q.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&Cn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=x.timers,o=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],s={top:0,left:0},o=i&&i.ownerDocument;if(o)return t=o.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(s=i.getBoundingClientRect()),n=Hn(o),{top:s.top+n.pageYOffset-t.clientTop,left:s.left+n.pageXOffset-t.clientLeft}):s},x.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=x.css(e,"position"),c=x(e),h={};"static"===l&&(e.style.position="relative"),u=c.offset(),s=x.css(e,"top"),a=x.css(e,"left"),f=("absolute"===l||"fixed"===l)&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),x.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(h.top=t.top-u.top+o),null!=t.left&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,s){var o=Hn(t);return s===undefined?o?o[n]:t[i]:(o?o.scrollTo(r?e.pageXOffset:s,r?s:e.pageYOffset):t[i]=s,undefined)},t,i,arguments.length,null)}}),x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var s=arguments.length&&(n||"boolean"!=typeof r),o=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,o):x.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)}(window),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="1.0.0";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender||e.$,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=o.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,f=o.length;a<f;a++){e=o[a];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(c=0,h=s.length;c<h;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;typeof t=="object"&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=u.uniqueId("l"));return i[s]=t,typeof n=="object"&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(o,a);var p=o.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(t,d)),t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},j(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t;if(r&&(!n||!n.wait)&&!this.set(r,n))return!1;n=u.extend({validate:!0},n);if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);n.wait&&(t=u.extend(r||{},t));if(u.isObject(t)&&!a.set(t,n))return!1;f&&f(a,e,n),a.trigger("sync",a,e,n)},j(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;j(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||B();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t||{},{validationError:n})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];u.each(v,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var m=o.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};u.extend(m.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.defaults(t||{},y))},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},set:function(e,t){t=u.defaults(t||{},g),t.parse&&(e=this.parse(e,t)),u.isArray(e)||(e=e?[e]:[]);var n,i,o,a,f,l,c=t.at,h=this.comparator&&c==null&&t.sort!==!1,p=u.isString(this.comparator)?this.comparator:null,d=[],v=[],m={};for(n=0,i=e.length;n<i;n++){if(!(o=this._prepareModel(e[n],t)))continue;(f=this.get(o))?(t.remove&&(m[f.cid]=!0),t.merge&&(f.set(o.attributes,t),h&&!l&&f.hasChanged(p)&&(l=!0))):t.add&&(d.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o))}if(t.remove){for(n=0,i=this.length;n<i;++n)m[(o=this.models[n]).cid]||v.push(o);v.length&&this.remove(v,t)}d.length&&(h&&(l=!0),this.length+=d.length,c!=null?s.apply(this.models,[c,0].concat(d)):r.apply(this.models,d)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,i=d.length;n<i;n++)(o=d[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(b,function(e){m.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var w=["groupBy","countBy","sortBy"];u.each(w,function(e){m.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var E=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];u.extend(E.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(S),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,x)),this.options=e},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}}),o.sync=function(e,t,n){var r=T[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||B()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled)&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,a,n),a};var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var N=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(e,t,n){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return o.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),o.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=u.result(this,"routes");var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=D.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(_,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!O.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new O;var H=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=m.extend=N.extend=E.extend=O.extend=H;var B=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),define("backbone",["underscore"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),define("external/xml2json",function(){}),define("AppConst",[],function(){var e={VERSION:"1.0.8.41",ANIMATE_FORWARD:"forward",ANIMATE_BACKWARD:"reverse",QUESTION_SCREEN:"QuestionScreen",QUESTION_PLAYER:"questionPlayer",QUESTION_TYPE_FIB:"FIB",QUESTION_TYPE_REORDERING:"REORDERING",QUESTION_TYPE_LABELLING:"LABELLING",QUESTION_TYPE_MCQ:"MCQ",QUESTION_TYPE_MATCHSORT:"MATCHSORT",QUESTION_TYPE_GROUPING:"GROUPING",QUESTION_TYPE_IMAGE:"IMAGE",QUESTION_TYPE_SPEAKING:"SPEAKING",QUESTION_TYPE_CROSSWORD:"CROSSWORD",QUESTION_TYPE_FIBTABLE:"FIBTABLE",QUESTION_TYPE_OPENTEXT:"OPENTEXT",QUESTION_TYPE_OPENTEXT_TEACHER_MARKED:"OPENTEXT_TEACHER_MARKED",RESPONSE_TYPE_PICKER:"PICKER",RESPONSE_INSTRUCTION_TEXT:"TEXT",RESPONSE_TYPE_BUTTON:"BUTTON",RESPONSE_TYPE_DRAG:"DRAGDROP",RESPONSE_TYPE_TEXT:"TEXT",RESPONSE_TYPE_BINARY:"BINARY",RESPONSE_TYPE_SET:"SET",RESPONSE_TYPE_TAPPLACE:"TAPPLACE",RESULT_SCREEN:"resultsScreen",RESOURCE_SCREEN:"resourceScreen",WELCOME_SCREEN:"splashScreen",LAYOUT_HORIZONTAL:"HORIZONTAL",ASSETS_PATH:"",DEF_PREFIX:"PRE_",POPQ:!0,ASSESSMENT_BTNS_DIV:"assessmentBtnsContainer",REVIEW_BTNS_DIV:"reviewBtnsContainer",QBTN_RESET:"resetQBtn",QBTN_ANSWERS:"answersBtn",QBTN_CLUES:"activityCluesBtn",QBTN_EVALUATE:"evaluateBtn",QBTN_CORRECT_ANS:"correctAnsBtn",QBTN_USER_ANS:"userAnsBtn",TOOLBAR_DEFAULT:"default",TOOLBAR_ACTIVE:"active",TOOLBAR_LOCKED:"locked",TOOLBAR_DISABLED:"disabled",TOOLBAR_RESET:"reset",TOOLBAR_REVIEW_CORRECT:"review_correct",TOOLBAR_REVIEW_USER:"review_user",QUESTION_VIEW_FIB:"FIB_",QUESTION_VIEW_FIB_TEXT:"FIB__text",QUESTION_VIEW_FIB_IMAGE:"FIB__image",QUESTION_VIEW_FIB_2COL:"FIB_2COL_image",QUESTION_VIEW_FIB_VERTICAL:"FIB__VERTICAL",QUESTION_VIEW_FIB_IMAGE_VERTICAL:"FIB__image_VERTICAL",QUESTION_VIEW_FIB_GAP:"FIB_GAP",QUESTION_VIEW_FIB_GAP_2COL:"FIB_2COL_text",QUESTION_VIEW_FIB_GAP_2COL_IMAGE:"FIB_2COL_image",QUESTION_VIEW_FIB_GAP_2COL_IMAGE_TEXT:"FIB_2COL_image_text",QUESTION_VIEW_FIB_GAP_2COL_AUDIO:"FIB_2COL_audio",QUESTION_VIEW_FIB_GAP_2COL_AUDIO_TEXT:"FIB_2COL_audio_text",QUESTION_VIEW_REORDERING:"REORDERING_HORIZONTAL",QUESTION_VIEW_REORDERING_VERTICAL:"REORDERING_",QUESTION_VIEW_LABELLING:"LABELLING_",QUESTION_VIEW_MCQ:"MCQ_",QUESTION_VIEW_MCQ_2COL:"MCQ_2COL",QUESTION_VIEW_MCQ_TEXT:"MCQ__text",QUESTION_VIEW_MCQ_IMAGE:"MCQ__image",QUESTION_VIEW_MCQ_SOUND:"MCQ__audio",QUESTION_VIEW_MATCHSORT_VERTICAL:"MATCHSORT_",QUESTION_VIEW_GROUPING:"GROUPING_",QUESTION_VIEW_IMAGE:"IMAGE_",QUESTION_VIEW_FIBDROPDOWN:"FIBDROPDOWN_",QUESTION_VIEW_BINARY:"MCQ__BINARY",QUESTION_VIEW_BINARY_TABLE:"FIBTABLE_",QUESTION_VIEW_OPENTEXT:"OPENTEXT_",QUESTION_VIEW_OPENTEXT_TEACHER_MARKED:"OPENTEXT_TEACHER_MARKED_",QUESTION_VIEW_UK2:"UK_2",QUESTION_VIEW_UK3:"UK_3",QUESTION_INSTRUCTION_FIB:"instructions/gapfillbuttondefaultwttext.png",QUESTION_INSTRUCTION_FIB_TEXT:"instructions/gapfilldefaulttext.png",QUESTION_INSTRUCTION_FIB_IMAGE:"instructions/mcqbuttondefaultwtimage.png",QUESTION_INSTRUCTION_FIB_GAP_2COL_IMAGE_TEXT:"instructions/gapfilldefaulttext.png",QUESTION_INSTRUCTION_FIB_2COL:"instructions/gapfill2colwtimage.png",QUESTION_INSTRUCTION_FIB_VERTICAL:"instructions/gapfillpicker.png",QUESTION_INSTRUCTION_FIB_IMAGE_VERTICAL:"instructions/gapfillpickerimage.png",QUESTION_INSTRUCTION_FIB_GAP:"instructions/gapfilldefaulttext.png",QUESTION_INSTRUCTION_FIB_GAP_2COL:"instructions/gapfilldefaulttext.png",QUESTION_INSTRUCTION_FIB_GAP_2COL_IMAGE:"instructions/gapfilldefaulttext.png",QUESTION_INSTRUCTION_FIB_GAP_2COL_AUDIO:"instructions/gapfillbutton2columnwtaudio.png",QUESTION_INSTRUCTION_FIB_GAP_2COL_AUDIO_TEXT:"instructions/gapfill2colwt-audio.png",QUESTION_TYPE_FIB_DROPDOWN:"FIBDROPDOWN",QUESTION_INSTRUCTION_REORDERING:"instructions/reordering(horizontal).png",QUESTION_INSTRUCTION_REORDERING_VERTICAL:"instructions/re-ordering(vertical).png",QUESTION_INSTRUCTION_LABELLING:"instructions/textlabelling.png",QUESTION_INSTRUCTION_MCQ:"instructions/mcqbuttondefaultwtimage.png",QUESTION_INSTRUCTION_MCQ_2COL:"instructions/mcqbutton2colwtimage.png",QUESTION_INSTRUCTION_MCQ_TEXT:"instructions/mcqbuttondefaultwtimage.png",QUESTION_INSTRUCTION_MCQ_TEXT_PICKER:"instructions/mcqpicker.png",QUESTION_INSTRUCTION_MCQ_IMAGE:"instructions/mcqbuttondefaultwtimage.png",QUESTION_INSTRUCTION_MCQ_SOUND:"instructions/mcqbuttondefaultaudio.png",QUESTION_INSTRUCTION_MATCHSORT_VERTICAL:"instructions/matchingvertical.png",QUESTION_INSTRUCTION_GROUPING:"instructions/groupingquestion.png",QUESTION_INSTRUCTION_FIBDROPDOWN:"instructions/fibdropdown.png",QUESTION_INSTRUCTION_BINARY:"instructions/binary.png",QUESTION_INSTRUCTION_BINARY_TABLE:"instructions/fibtablebinary.png",QUESTION_INSTRUCTION_OPENTEXT:"instructions/opentext.png",TOOLBAR_SPEAKING:"speaking_locked",TOOLBAR_SPEAKING_ACTIVE:"speaking",CORRECT:"correct",INCORRECT:"incorrect",PARTIAL:"partial",LANDSCAPE:"90",PORTRAIT:"0",ORIENTATION_ALERT_TEXT:"This device does not support landscape orientation. Please use only portrait orientation.",LOCALSTORAGE_FULL_ERROR_TEXT:"Offline Storage Full!Please sync all test data before continuing!",LOCALSTORAGE_SAVE_ERROR_TEXT:"Error in saving to localstorage!",MATCHING_RIGHTSIDE:"rightside",MATCHING_BOTH:"both",CROSSWORD_AUTO_POPULATE:!0,REORDERING_TAP_PLACE:"tapplace",REORDERING_DRAG_DROP:"dragdrop",DROPDOWN_SPINNINGWHEEL:"spinningwheel",DROPDOWN_NATIVE:"native",FIB_REMOVE_OPTIONS:"removeoptions",FIB_MAINTAIN_OPTIONS:"maintainoptions",DEFAULT_TOASTER_DURATION:1500,INCOMPLETE_TEST_REPORT_CLICK_MSG:"You have missed a question. You must complete all of the questions before proceeding.",URL_CHANGE_MSG:"Are you sure you want to leave this page?",testid:"",mode:"normal",userid:"1",samsid:"9781444116526",usertoken:"{31180698-287f-4043-a076-ccc7efc30bed}",reportToken:"",username:"",isbn:"",aeWebServicePath:"",dlWebservicePath:"",dlAuthorizationServiceURL:"",siteURL:"",COMPLETE:"complete",NO_ATTEMPT:"noattempted",OFFLINE_PATH:"",OFFLINE:!1,P_TOKEN:"A574CBDB-B36B-4883-8F16-B18AC1FA08DC",TEST_NAME:"",IS_PHONE:!1,launchID:"",timetakeninseconds:"",appEnvironment:"",bookName:"",reportCardImage:"",wsSet:[{getTest:"/GetTestDetailsByID",saveTest:"/SaveTestDetailsWithTime",getTests:"/GetTestDetailsByIDs",getReports:"/GetStudentProjectReport1"},{getTest:"/opGetTestDetailsByID",saveTest:"/opSaveTestDetailsWithTime",getTests:"/opGetTestDetailsByIDs",getReports:"/GetStudentProjectReport1"}],ws:null,module:"",base_url:"",data_url:""};return e}),define("AppEvent",[],function(){var e={SCREEN_READY:"screenReady",TEMPLATE_READY:"templateReady",ASSESSMENT_INITIATED:"assessmentInitiated",QUESTION_RENDERED:"onQuestionRenderd",QUESTION_EVALUATED:"onQuestionEvaluated",GET_QUESTIONDATA:"getQuestionData",REVIEW_QUESTION:"reviewAssessment",QUESTION_RESET:"onQuestionReset",HINT_SHOWED:"onHintShowed",ANSWER_SHOWED:"onAnswerShowed",ASSESSMENT_COMPLETED:"assessmentCompleted",RESPONSE_SAVED:"onResponseSaved",RESULT_SHOWED:"onResultShowed",CONFIG_SET:"onConfigSet",CONTROLS_DISABLED:"onControlsDisabled",CONTROLS_ENABLED:"onControlsEnabled",MARK_CORRECT:"markCorrect",MARK_INCORRECT:"markIncorrect",MARK_ANSWER:"markAnswer",SAVE_RESPONSE:"saveResponse",ANSWER_MARKED:"answerMarked",CONTINUE_ASSESSMENT:"continueAssessment",CLICK:String(document.documentElement.ontouchmove)!="undefined"?"touchend":"click",UPDATE_RESPONSE:"updateResponse",CHANGETOOLBARMODE:"onChangeToolbarMode",MARK_EMPTY:"markEmpty",QUIT_RESULT:"quitResult",CHANGE:"change",KEYPRESS:"keypress",KEYDOWN:"keydown",REFRESH_SCROLL:"refreshScroll",Q_STATUS:"quesStatusChanged",START_TEST:"startTest"};return e});var IScroll=function(e,t,n){function s(e,n){this.wrapper=typeof e=="string"?t.querySelector(e):e,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeIndicator:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,HWCompositing:!0,useTransition:!0,useTransform:!0,scrollbars:!0,mouseWheel:!0,interactiveScrollbars:!0};for(var r in n)this.options[r]=n[r];this.translateZ=this.options.HWCompositing&&i.hasPerspective?" translateZ(0)":"",this.options.useTransition=i.hasTransition&&this.options.useTransition,this.options.useTransform=i.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY=this.options.eventPassthrough=="vertical"?!1:this.options.scrollY,this.options.scrollX=this.options.eventPassthrough=="horizontal"?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing=typeof this.options.bounceEasing=="string"?i.ease[this.options.bounceEasing]||i.ease.circular:this.options.bounceEasing,this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function o(e,n,r){var s=t.createElement("div"),o=t.createElement("div");return r===!0&&(s.style.cssText="position:absolute;z-index:9999",o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),o.className="iScrollIndicator",e=="h"?(r===!0&&(s.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",o.style.height="100%"),s.className="iScrollHorizontalScrollbar"):(r===!0&&(s.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",o.style.width="100%"),s.className="iScrollVerticalScrollbar"),n||(s.style.pointerEvents="none"),i.hasTouch&&(s.style.opacity=0),s.appendChild(o),s}function u(n,r){this.wrapper=typeof r.el=="string"?t.querySelector(r.el):r.el,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=n,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,speedRatioX:0,speedRatioY:0};for(var s in r)this.options[s]=r[s];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(i.addEvent(this.indicator,"touchstart",this),i.addEvent(this.indicator,"MSPointerDown",this),i.addEvent(this.indicator,"mousedown",this),i.addEvent(e,"touchend",this),i.addEvent(e,"MSPointerUp",this),i.addEvent(e,"mouseup",this))}var r=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},i=function(){function o(e){return s===!1?!1:s===""?e:s+e.charAt(0).toUpperCase()+e.substr(1)}var r={},i=t.createElement("div").style,s=function(){var e=["t","webkitT","MozT","msT","OT"],t,n=0,r=e.length;for(;n<r;n++){t=e[n]+"ransform";if(t in i)return e[n].substr(0,e[n].length-1)}return!1}();r.getTime=Date.now||function(){return(new Date).getTime()},r.extend=function(e,t){for(var n in t)e[n]=t[n]},r.addEvent=function(e,t,n,r){e.addEventListener(t,n,!!r)},r.removeEvent=function(e,t,n,r){e.removeEventListener(t,n,!!r)},r.momentum=function(e,t,r,i,s){var o=e-t,u=n.abs(o)/r,a,f,l=6e-4;return a=e+u*u/(2*l)*(o<0?-1:1),f=u/l,a<i?(a=s?i-s/2.5*(u/8):i,o=n.abs(a-e),f=o/u):a>0&&(a=s?s/2.5*(u/8):0,o=n.abs(e)+a,f=o/u),{destination:n.round(a),duration:f}};var u=o("transform");return r.extend(r,{hasTransform:u!==!1,hasPerspective:o("perspective")in i,hasTouch:"ontouchstart"in e,hasPointer:navigator.msPointerEnabled,hasTransition:o("transition")in i}),r.isAndroidBrowser=/Android/.test(e.navigator.appVersion)&&/Version\/\d/.test(e.navigator.appVersion),r.extend(r.style={},{transform:u,transitionTimingFunction:o("transitionTimingFunction"),transitionDuration:o("transitionDuration"),transformOrigin:o("transformOrigin")}),r.hasClass=function(e,t){var n=new RegExp("(^|\\s)"+t+"(\\s|$)");return n.test(e.className)},r.addClass=function(e,t){if(r.hasClass(e,t))return;var n=e.className.split(" ");n.push(t),e.className=n.join(" ")},r.removeClass=function(e,t){if(!r.hasClass(e,t))return;var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(n,"")},r.offset=function(e){var t=-e.offsetLeft,n=-e.offsetTop;while(e=e.offsetParent)t-=e.offsetLeft,n-=e.offsetTop;return{left:t,top:n}},r.extend(r.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),r.extend(r.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return n.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e-=1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){return(e/=1)<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}},elastic:{style:"",fn:function(e){var t=.22,r=.4;return e===0?0:e==1?1:r*n.pow(2,-10*e)*n.sin((e-t/4)*2*n.PI/t)+1}}}),r.tap=function(e,n){var r=t.createEvent("Event");r.initEvent(n,!0,!0),r.pageX=e.pageX,r.pageY=e.pageY,e.target.dispatchEvent(r)},r.click=function(e){var n=e.target,r;n.tagName.toLowerCase()!="select"&&n.tagName.toLowerCase()!="input"&&n.tagName.toLowerCase()!="textarea"&&(r=t.createEvent("MouseEvents"),r.initMouseEvent("click",!0,!0,e.view,1,n.screenX,n.screenY,n.clientX,n.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),r._constructed=!0,n.dispatchEvent(r))},r}();return s.prototype={version:"5.0.4",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){if(e.target!=this.scroller)return;this._transitionTime(0),this.resetPosition(this.options.bounceTime)||this._execEvent("scrollEnd")},_start:function(e){if(i.eventType[e.type]!=1&&e.button!==0)return;if(!this.enabled||this.initiated&&i.eventType[e.type]!==this.initiated)return;this.options.preventDefault&&!i.isAndroidBrowser&&e.target.nodeName.toLowerCase()!="select"&&e.target.nodeName.toLowerCase()!="input"&&e.target.nodeName.toLowerCase()!="textarea"&&!e.target.getAttribute("contenteditable")&&$(e.target).parents(".contentArea").length==0&&e.preventDefault();var t=e.touches?e.touches[0]:e,r;this.initiated=i.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.isAnimating=!1,this.startTime=i.getTime(),this.options.useTransition&&this.isInTransition&&(r=this.getComputedPosition(),this._translate(n.round(r.x),n.round(r.y)),this.isInTransition=!1),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=t.pageX,this.pointY=t.pageY,this._execEvent("scrollStart")},_move:function(e){if(!this.enabled||i.eventType[e.type]!==this.initiated)return;this.options.preventDefault&&e.preventDefault();var t=e.touches?e.touches[0]:e,r=this.hasHorizontalScroll?t.pageX-this.pointX:0,s=this.hasVerticalScroll?t.pageY-this.pointY:0,o=i.getTime(),u,a,f,l;this.pointX=t.pageX,this.pointY=t.pageY,this.distX+=r,this.distY+=s,f=n.abs(this.distX),l=n.abs(this.distY);if(o-this.endTime>300&&f<10&&l<10)return;!this.directionLocked&&!this.options.freeScroll&&(f>l+this.options.directionLockThreshold?this.directionLocked="h":l>=f+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n");if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical")e.preventDefault();else if(this.options.eventPassthrough=="horizontal"){this.initiated=!1;return}s=0}else if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal")e.preventDefault();else if(this.options.eventPassthrough=="vertical"){this.initiated=!1;return}r=0}u=this.x+r,a=this.y+s;if(u>0||u<this.maxScrollX)u=this.options.bounce?this.x+r/3:u>0?0:this.maxScrollX;if(a>0||a<this.maxScrollY)a=this.options.bounce?this.y+s/3:a>0?0:this.maxScrollY;this.directionX=r>0?-1:r<0?1:0,this.directionY=s>0?-1:s<0?1:0,this.moved=!0,this._translate(u,a),o-this.startTime>300&&(this.startTime=o,this.startX=this.x,this.startY=this.y)},_end:function(e){if(!this.enabled||i.eventType[e.type]!==this.initiated)return;this.options.preventDefault&&e.preventDefault();var t=e.changedTouches?e.changedTouches[0]:e,r,s,o=i.getTime()-this.startTime,u=n.round(this.x),a=n.round(this.y),f=n.abs(u-this.startX),l=n.abs(a-this.startY),c=0,h="";this.scrollTo(u,a),this.isInTransition=0,this.initiated=0,this.endTime=i.getTime();if(this.resetPosition(this.options.bounceTime))return;if(!this.moved){this.options.tap&&i.tap(e,this.options.tap),this.options.click&&i.click(e);return}if(this._events.flick&&o<200&&f<100&&l<100){this._execEvent("flick");return}this.options.momentum&&o<300&&(r=this.hasHorizontalScroll?i.momentum(this.x,this.startX,o,this.maxScrollX,this.options.bounce?this.wrapperWidth:0):{destination:u,duration:0},s=this.hasVerticalScroll?i.momentum(this.y,this.startY,o,this.maxScrollY,this.options.bounce?this.wrapperHeight:0):{destination:a,duration:0},u=r.destination,a=s.destination,c=n.max(r.duration,s.duration),this.isInTransition=1);if(this.options.snap){var p=this._nearestSnap(u,a);this.currentPage=p,u=p.x,a=p.y,c=this.options.snapSpeed||n.max(n.max(n.min(f,1e3),n.min(f,1e3)),300),this.directionX=0,this.directionY=0,h=this.options.bounceEasing}if(u!=this.x||a!=this.y){if(u>0||u<this.maxScrollX||a>0||a<this.maxScrollY)h=i.ease.quadratic;this.scrollTo(u,a,c,h);return}this._execEvent("scrollEnd")},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.refresh()},this.options.resizePolling)},resetPosition:function(e){var t=this.x,n=this.y;return e=e||0,!this.hasHorizontalScroll||this.x>0?t=0:this.x<this.maxScrollX&&(t=this.maxScrollX),!this.hasVerticalScroll||this.y>0?n=0:this.y<this.maxScrollY&&(n=this.maxScrollY),t==this.x&&n==this.y?!1:(this.scrollTo(t,n,e,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){var e=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=i.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition();if(this.options.snap){var t=this._nearestSnap(this.x,this.y);if(this.x==t.x&&this.y==t.y)return;this.currentPage=t,this.scrollTo(t.x,t.y)}},on:function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},_execEvent:function(e){if(!this._events[e])return;var t=0,n=this._events[e].length;if(!n)return;for(;t<n;t++)this._events[e][t].call(this)},scrollBy:function(e,t,n,r){e=this.x+e,t=this.y+t,n=n||0,this.scrollTo(e,t,n,r)},scrollTo:function(e,t,n,r){r=r||i.ease.circular,!n||this.options.useTransition&&r.style?(this._transitionTimingFunction(r.style),this._transitionTime(n),this._translate(e,t)):this._animate(e,t,n,r.fn)},scrollToElement:function(e,t,r,s,o){e=e.nodeType?e:this.scroller.querySelector(e);if(!e)return;var u=i.offset(e);u.left-=this.wrapperOffset.left,u.top-=this.wrapperOffset.top,r===!0&&(r=n.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)),s===!0&&(s=n.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)),u.left-=r||0,u.top-=s||0,u.left=u.left>0?0:u.left<this.maxScrollX?this.maxScrollX:u.left,u.top=u.top>0?0:u.top<this.maxScrollY?this.maxScrollY:u.top,t=t===undefined||t===null||t==="auto"?n.max(n.abs(u.left)*2,n.abs(u.top)*2):t,this.scrollTo(u.left,u.top,t,o)},_transitionTime:function(e){e=e||0,this.scrollerStyle[i.style.transitionDuration]=e+"ms",this.indicator1&&this.indicator1.transitionTime(e),this.indicator2&&this.indicator2.transitionTime(e)},_transitionTimingFunction:function(e){this.scrollerStyle[i.style.transitionTimingFunction]=e,this.indicator1&&this.indicator1.transitionTimingFunction(e),this.indicator2&&this.indicator2.transitionTimingFunction(e)},_translate:function(e,t){this.options.useTransform?this.scrollerStyle[i.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ:(e=n.round(e),t=n.round(t),this.scrollerStyle.left=e+"px",this.scrollerStyle.top=t+"px"),this.x=e,this.y=t,this.indicator1&&this.indicator1.updatePosition(),this.indicator2&&this.indicator2.updatePosition()},_initEvents:function(t){var n=t?i.removeEvent:i.addEvent,r=this.options.bindToWrapper?this.wrapper:e;n(e,"orientationchange",this),n(e,"resize",this),n(this.wrapper,"mousedown",this),n(r,"mousemove",this),n(r,"mousecancel",this),n(r,"mouseup",this),i.hasPointer&&(n(this.wrapper,"MSPointerDown",this),n(r,"MSPointerMove",this),n(r,"MSPointerCancel",this),n(r,"MSPointerUp",this)),i.hasTouch&&(n(this.wrapper,"touchstart",this),n(r,"touchmove",this),n(r,"touchcancel",this),n(r,"touchend",this)),n(this.scroller,"transitionend",this),n(this.scroller,"webkitTransitionEnd",this),n(this.scroller,"oTransitionEnd",this),n(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t=e.getComputedStyle(this.scroller,null),n,r;return this.options.useTransform?(t=t[i.style.transform].split(")")[0].split(", "),n=+(t[12]||t[4]),r=+(t[13]||t[5])):(n=+t.left.replace(/[^-\d]/g,""),r=+t.top.replace(/[^-\d]/g,"")),{x:n,y:r}},_initIndicators:function(){var e=this.options.interactiveScrollbars,t=typeof this.options.scrollbars!="object",n=typeof this.options.scrollbars!="string",r,i;this.options.scrollbars?(this.options.scrollY&&(r={el:o("v",e,this.options.scrollbars),interactive:e,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeIndicator,listenX:!1},this.wrapper.appendChild(r.el)),this.options.scrollX&&(i={el:o("h",e,this.options.scrollbars),interactive:e,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeIndicator,listenY:!1},this.wrapper.appendChild(i.el))):(r=this.options.indicators.length?this.options.indicators[0]:this.options.indicators,i=this.options.indicators[1]&&this.options.indicators[1]),r&&(this.indicator1=new u(this,r)),i&&(this.indicator2=new u(this,i)),this.on("refresh",function(){this.indicator1&&this.indicator1.refresh(),this.indicator2&&this.indicator2.refresh()}),this.on("destroy",function(){this.indicator1&&(this.indicator1.destroy(),this.indicator1=null),this.indicator2&&(this.indicator2.destroy(),this.indicator2=null)})},_initWheel:function(){i.addEvent(this.wrapper,"mousewheel",this),i.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){i.removeEvent(this.wrapper,"mousewheel",this),i.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(!this.enabled)return;var t,n,r,i,s=this;clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){s._execEvent("scrollEnd")},400),e.preventDefault();if("wheelDeltaX"in e)t=e.wheelDeltaX/120,n=e.wheelDeltaY/120;else if("wheelDelta"in e)t=n=e.wheelDelta/120;else{if(!("detail"in e))return;t=n=-e.detail/3}t*=this.options.mouseWheelSpeed,n*=this.options.mouseWheelSpeed,this.hasVerticalScroll||(t=n),r=this.x+(this.hasHorizontalScroll?t*this.options.invertWheelDirection:0),i=this.y+(this.hasVerticalScroll?n*this.options.invertWheelDirection:0),r>0?r=0:r<this.maxScrollX&&(r=this.maxScrollX),i>0?i=0:i<this.maxScrollY&&(i=this.maxScrollY),this.scrollTo(r,i,0)},_initSnap:function(){this.currentPage={},typeof this.options.snap=="string"&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var e=0,t,r=0,i,s,o,u=0,a,f=this.options.snapStepX||this.wrapperWidth,l=this.options.snapStepY||this.wrapperHeight,c;this.pages=[];if(this.options.snap===!0){s=n.round(f/2),o=n.round(l/2);while(u>-this.scrollerWidth){this.pages[e]=[],t=0,a=0;while(a>-this.scrollerHeight)this.pages[e][t]={x:n.max(u,this.maxScrollX),y:n.max(a,this.maxScrollY),width:f,height:l,cx:u-s,cy:a-o},a-=l,t++;u-=f,e++}}else{c=this.options.snap,t=c.length,i=-1;for(;e<t;e++){if(e===0||c[e].offsetLeft<=c[e-1].offsetLeft)r=0,i++;this.pages[r]||(this.pages[r]=[]),u=n.max(-c[e].offsetLeft,this.maxScrollX),a=n.max(-c[e].offsetTop,this.maxScrollY),s=u-n.round(c[e].offsetWidth/2),o=a-n.round(c[e].offsetHeight/2),this.pages[r][i]={x:u,y:a,width:c[e].offsetWidth,height:c[e].offsetHeight,cx:s,cy:o},u>this.maxScrollX&&r++}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=n.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=n.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}),this.on("flick",function(){var e=this.options.snapSpeed||n.max(n.max(n.min(n.abs(this.x-this.startX),1e3),n.min(n.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e)})},_nearestSnap:function(e,t){var r=0,i=this.pages.length,s=0;if(n.abs(e-this.absStartX)<this.snapThresholdX&&n.abs(t-this.absStartY)<this.snapThresholdY)return this.currentPage;e>0?e=0:e<this.maxScrollX&&(e=this.maxScrollX),t>0?t=0:t<this.maxScrollY&&(t=this.maxScrollY);for(;r<i;r++)if(e>=this.pages[r][0].cx){e=this.pages[r][0].x;break}i=this.pages[r].length;for(;s<i;s++)if(t>=this.pages[0][s].cy){t=this.pages[0][s].y;break}return r==this.currentPage.pageX&&(r+=this.directionX,r<0?r=0:r>=this.pages.length&&(r=this.pages.length-1),e=this.pages[r][0].x),s==this.currentPage.pageY&&(s+=this.directionY,s<0?s=0:s>=this.pages[0].length&&(s=this.pages[0].length-1),t=this.pages[0][s].y),{x:e,y:t,pageX:r,pageY:s}},goToPage:function(e,t,r,i){i=i||this.options.bounceEasing,e>=this.pages.length?e=this.pages.length-1:e<0&&(e=0),t>=this.pages[0].length?t=this.pages[0].length-1:t<0&&(t=0);var s=this.pages[e][t].x,o=this.pages[e][t].y;r=r===undefined?this.options.snapSpeed||n.max(n.max(n.min(n.abs(s-this.x),1e3),n.min(n.abs(o-this.y),1e3)),300):r,this.currentPage={x:s,y:o,pageX:e,pageY:t},this.scrollTo(s,o,r,i)},next:function(e,t){var n=this.currentPage.pageX,r=this.currentPage.pageY;n++,n>=this.pages.length&&this.hasVerticalScroll&&(n=0,r++),this.goToPage(n,r,e,t)},prev:function(e,t){var n=this.currentPage.pageX,r=this.currentPage.pageY;n--,n<0&&this.hasVerticalScroll&&(n=0,r--),this.goToPage(n,r,e,t)},_initKeys:function(t){var n={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40},r;if(typeof this.options.keyBindings=="object")for(r in this.options.keyBindings)typeof this.options.keyBindings[r]=="string"&&(this.options.keyBindings[r]=this.options.keyBindings[r].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(r in n)this.options.keyBindings[r]=this.options.keyBindings[r]||n[r];i.addEvent(e,"keydown",this),this.on("destroy",function(){i.removeEvent(e,"keydown",this)})},_key:function(e){if(!this.enabled)return;var t=this.options.snap,r=t?this.currentPage.pageX:this.x,s=t?this.currentPage.pageY:this.y,o=i.getTime(),u=this.keyTime||0,a=.25,f;this.options.useTransition&&this.isInTransition&&(f=this.getComputedPosition(),this._translate(n.round(f.x),n.round(f.y)),this.isInTransition=!1),this.keyAcceleration=o-u<200?n.min(this.keyAcceleration+a,50):0;switch(e.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?r+=t?1:this.wrapperWidth:s+=t?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?r-=t?1:this.wrapperWidth:s-=t?1:this.wrapperHeight;break;case this.options.keyBindings.end:r=t?this.pages.length-1:this.maxScrollX,s=t?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:r=0,s=0;break;case this.options.keyBindings.left:r+=t?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:s+=t?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:r-=t?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:s-=t?1:5+this.keyAcceleration>>0}if(t){this.goToPage(r,s);return}r>0?(r=0,this.keyAcceleration=0):r<this.maxScrollX&&(r=this.maxScrollX,this.keyAcceleration=0),s>0?(s=0,this.keyAcceleration=0):s<this.maxScrollY&&(s=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(r,s,0),this.keyTime=o},_animate:function(e,t,n,s){function c(){var h=i.getTime(),p,d,v;if(h>=l){o.isAnimating=!1,o._translate(e,t),o.resetPosition(o.options.bounceTime)||o._execEvent("scrollEnd");return}h=(h-f)/n,v=s(h),p=(e-u)*v+u,d=(t-a)*v+a,o._translate(p,d),o.isAnimating&&r(c)}var o=this,u=this.x,a=this.y,f=i.getTime(),l=f+n;this.isAnimating=!0,c()},handleEvent:function(e){switch(e.type){case"touchstart":$(this.wrapper).find(".iScrollLoneScrollbar").css("opacity","1");case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":_.delay($(this.wrapper).find(".iScrollLoneScrollbar").css("opacity","0"),2e3);case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e)}}},u.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(i.removeEvent(this.indicator,"touchstart",this),i.removeEvent(this.indicator,"MSPointerDown",this),i.removeEvent(this.indicator,"mousedown",this),i.removeEvent(e,"touchmove",this),i.removeEvent(e,"MSPointerMove",this),i.removeEvent(e,"mousemove",this),i.removeEvent(e,"touchend",this),i.removeEvent(e,"MSPointerUp",this),i.removeEvent(e,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(t){var n=t.touches?t.touches[0]:t;t.preventDefault(),t.stopPropagation(),this.transitionTime(0),this.initiated=!0,this.moved=!1,this.lastPointX=n.pageX,this.lastPointY=n.pageY,this.startTime=i.getTime(),i.addEvent(e,"touchmove",this),i.addEvent(e,"MSPointerMove",this),i.addEvent(e,"mousemove",this),this.scroller._execEvent("scrollStart")},_move:function(e){var t=e.touches?e.touches[0]:e,n,r,s,o,u=i.getTime();this.moved=!0,n=t.pageX-this.lastPointX,this.lastPointX=t.pageX,r=t.pageY-this.lastPointY,this.lastPointY=t.pageY,s=this.x+n,o=this.y+r,this._pos(s,o),e.preventDefault(),e.stopPropagation()},_end:function(t){if(!this.initiated)return;this.initiated=!1,t.preventDefault(),t.stopPropagation(),i.removeEvent(e,"touchmove",this),i.removeEvent(e,"MSPointerMove",this),i.removeEvent(e,"mousemove",this),this.moved&&this.scroller._execEvent("scrollEnd")},transitionTime:function(e){e=e||0,this.indicatorStyle[i.style.transitionDuration]=e+"ms"},transitionTimingFunction:function(e){this.indicatorStyle[i.style.transitionTimingFunction]=e},refresh:function(){this.transitionTime(0),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(i.addClass(this.wrapper,"iScrollBothScrollbars"),i.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(i.removeClass(this.wrapper,"iScrollBothScrollbars"),i.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));var e=this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=n.max(n.round(this.wrapperWidth*this.wrapperWidth/this.scroller.scrollerWidth),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=n.max(n.round(this.wrapperHeight*this.wrapperHeight/this.scroller.scrollerHeight),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var e=n.round(this.sizeRatioX*this.scroller.x)||0,t=n.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(e<0?e=0:e>this.maxPosX&&(e=this.maxPosX),t<0?t=0:t>this.maxPosY&&(t=this.maxPosY)),this.x=e,this.y=t,this.scroller.options.useTransform?this.indicatorStyle[i.style.transform]="translate("+e+"px,"+t+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=e+"px",this.indicatorStyle.top=t+"px")},_pos:function(e,t){e<0?e=0:e>this.maxPosX&&(e=this.maxPosX),t<0?t=0:t>this.maxPosY&&(t=this.maxPosY),e=this.options.listenX?n.round(e/this.sizeRatioX):this.scroller.x,t=this.options.listenY?n.round(t/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(e,t)}},s.ease=i.ease,s}(window,document,Math);define("external/iscroll5",function(){}),define("utilities",["AppConst","AppEvent","external/iscroll5"],function(AppConst,AppEvent,iscroll){var imfinity_utils=new Object;imfinity_utils.resourcePath="",imfinity_utils.DEVICE_TYPE="";var end,start=+(new Date);return imfinity_utils.feedbackScroll=null,imfinity_utils.log=function(e){},imfinity_utils.screenTransition=function(e){imfinity_utils.log("screen moving start"),this.showPreloader(),e.persistent==undefined&&(e.persistent=!0),e.direction==undefined||e.direction==""||e.direction=="forward"?reverse=!1:reverse=!0,curElm=typeof e.curScreen=="string"?$("#"+e.curScreen):e.curScreen,showElm=typeof e.newScreen=="string"?$("#"+e.newScreen):e.newScreen;if(e.handler==undefined||e.handler==null)e.handler=function(){};reverse?(showElm.css("right","100%"),showElm.css("left","auto"),curElm.css("right","0%"),curElm.css("left","auto"),curElm.animate({right:"-100%"},500),showElm.animate({right:"0%"},500)):(showElm.css("left","100%"),curElm.css("left","0%"),curElm.animate({left:"-100%"},500),showElm.animate({left:"0%"},500)),setTimeout(function(){imfinity_utils.animationComplete(curElm,showElm,e.persistent,e.handler)},600)},imfinity_utils.questionTransition=function(e){},imfinity_utils.animationComplete=function(e,t,n,r){e.removeClass("current"),this.removeAnimClasses([e,t]),t.addClass("current"),imfinity_utils.log(r),r(e),e.hasClass("quesWrapper")||this.hidePreloader()},imfinity_utils.removeAnimClasses=function(e){var t=["infwd","outfwd","inback","outback","current"];for(var n in t)for(var r in e)e[r].removeClass(t[n])},imfinity_utils.showPreloader=function(){$(".overlay").show(),$("#floatingCirclesG").show()},imfinity_utils.hidePreloader=function(){$(".overlay").hide(),$("#floatingCirclesG").hide()},imfinity_utils.showQuesPopup=function(e){if(!AppConst.POPQ)return;var t=$(".questionPopup"),n='<img src="interface/correctAnswer.png">',r='<img src="interface/wrongAnswer.png">';t.bind("click",this.hideQuesPopup);switch(e){case"correct":var i=n+"<br />"+"Correct.";t.find(".questionPopupBox").html(i),t.show();break;case"incorrect":var i=r+"<br />"+"Incorrect.";t.find(".questionPopupBox").html(i),t.show();break;default:}},imfinity_utils.hideQuesPopup=function(e){$(".questionPopup").hide(),$(".questionPopup").unbind()},imfinity_utils.showToasterMessage=function(e,t,n){if(t==undefined||t==null||t=="")t=AppConst.DEFAULT_TOASTER_DURATION;$(".toast_message").text(e);var r=$("body").height()-100;r/=2,$(".toast_message").css("top",r),$(".Overlay_toast").css("opacity","1"),$(".toast_message").css("opacity","1"),$("#toast").show(),_.delay(function(){imfinity_utils.hideToasterMessage(imfinity_utils,n)},t)},imfinity_utils.hideToasterMessage=function(e){clearTimeout(imfinity_utils.myTimer),$(".Overlay_toast").unbind(),$(".toast_message").text(""),$("#toast").hide(),e!=undefined&&e!=null&&e()},imfinity_utils.findResumePosition=function(e,t){imfinity_utils.log("findResumePosition quesIds",e),imfinity_utils.log("findResumePosition responseData",t);if(t)for(var n=0;n<e.length;n++){imfinity_utils.log("id>>>>",e[n]);var r=_.findWhere(t,{id:e[n]});if(r.userResponse==undefined)return imfinity_utils.log("k",n),n}return 0},imfinity_utils.renderNode=function renderNode(e){var t="",n="PRE_";if(_.isArray(e))for(var r=0;r<e.length;r++)t+=renderNode(e[r]);else if(typeof e=="object")switch(e.type){case"text":t+=e.data;break;case"optionText":var i="text-icon.png",s="132";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' width='"+s+"'  />";break;case"image":n.indexOf(AppConst.DEF_PREFIX)<0?(imfinity_utils.log("image tag constuct"),t+="<img src='"+AppConst.IOS_DOC_PATH+e.data+"'  class='image' />"):t+="<img src='"+AppConst.ASSETS_PATH+e.data+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='image' />";break;case"optionImage":var i="image-icon.png",s="132";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' width='"+s+"'  />";break;case"word":var i="word-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;case"powerpoint":var i="powerpoint-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;case"pdf":var i="pdf-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;case"video":var i="video-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;case"html":var i="htmlView-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;case"excel":var i="excel-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;case"weblink":var i="weblink-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;case"activity":var i="activity-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;case"audio":var i="audio-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;case"personalTutor":var i="personalTutor-icon.png";t+="<img src='interface/"+i+"' data-url='"+AppConst.ASSETS_PATH+e.data+"' class='icon' />";break;default:}return t},imfinity_utils.playAudio=function(){imfinity_utils.log("playAudio");var e=$(".audioBtn",this.screen).get(0);e.play(),e=null},imfinity_utils.showResetPopup=function(e){imfinity_utils.log("show reset popup"),$("#confirmload").removeClass("hide").addClass("resetPopup"),$(".resetOverlay").show();var t={};$("#confirmload #buttons input").bind(AppEvent.CLICK,function(n){if(n.target.id=="p_reset")var r=1;else if(n.target.id=="c_reset")var r=2;if($("#RemReset").is(":checked"))var i=!0;else var i=!1;$("#confirmload #buttons input").unbind(),$("#confirmload").addClass("hide"),$("#confirmload").removeClass("show"),$(".resetOverlay").hide(),imfinity_utils.log("obj",t),e(r,i)})},imfinity_utils.hideResetPopup=function(e){$(".resetPopup").hide(),$(".resetOverlay").hide(),$(".resetPopup").unbind()},imfinity_utils.showInfo=function(e,t,n,r){$(".overlay").show();var t=t,n=n;$("#infoTitle").html(t),$("#infoContent").html(n),$("#infoImage img").attr("src",r),$("#infoImage img").show(),Imfinity.Constants.ORIENTATION_TYPE==AppConst.LANDSCAPE?$("#info").addClass("alert"):$("#info").removeClass("alert"),(r==""||r==undefined)&&$("#infoImage img").hide(),$("#info").show();var i=$("#info",this.screen)[0].clientHeight,s=$("#InfoHeader",this.screen)[0].clientHeight,o=i-s-5;$("#infoContentCover",this.screen).css("height",o+"px");return},imfinity_utils.hideInfo=function(){title=null,message=null,$("#info").hide(),$(".overlay").hide()},imfinity_utils.randomizeArray=function(e,t){var n=t.slice(),r=new Array;if(e.length!=t.length)return null;for(var i=0;i<t.length;i++){var s=t[i],o=!1;n.indexOf(s)>-1&&(o=!0,n=imfinity_utils.removeIndexFromArray(n,n.indexOf(s)));var u=imfinity_utils.generateRandomNo(0,n.length-1);r[i]=n[u],n=imfinity_utils.removeIndexFromArray(n,u),o&&n.push(s)}return r},imfinity_utils.generateRandomNo=function(e,t){return Math.floor(Math.random()*t)+e},imfinity_utils.removeIndexFromArray=function(e,t){if(t>=0&&t<=e.length){var n=[],r=e.slice(0,t),i=e.slice(t+1,e.length);return n.push.apply(n,r),n.push.apply(n,i),n}return e},imfinity_utils.showFeedback=function(e,t){if($("#feedbackBtn").hasClass("disabled"))return;this.feedbackScroll=null,t==undefined&&(t=0);for(var n=0;n<e.length;n++)if(t>=e[n].minMarks&&t<=e[n].maxMarks){var r=e[n];break}var i="";r.feedbackText!=""&&(i+="<div id='feedbackText'>"+r.feedbackText+"</div>");if(r.resources.length>0){i+="<div id='feedbackResource'>";if(r.resources.length>0){i+="<span class='resourceHeading'>Useful Resources</span>",i+="<div class='resourceContent'><ul>";for(var n=0;n<r.resources.length;n++){var s="";switch(r.resources[n].remCode){case"DLR":r.resources[n].longText==""&&(s="disabled"),i+="<li id='"+n+"' title='"+r.resources[n].longText+"' data-type='"+r.resources[n].remCode+"' class='resource'><span id='resourceType' class='"+r.resources[n].icon+"'></span><span class='resource-txt'>"+r.resources[n].descriptionText+"</span><span class='infoBtn "+s+"'></span></li>";break;default:i+="<li id='"+n+"' title='"+r.resources[n].text+"' data-type='"+r.resources[n].remCode+"' class='resource'><span id='resourceType' class='"+r.resources[n].icon+"'></span><span class='resource-txt'>"+r.resources[n].text+"</span><span class='infoBtn'></span></li>"}}i+="</ul></div>"}i+="</div>"}$("#feedbackContent",this.obj).html(i),$("#feedbackOverlay",this.obj).show(),$("#contentWrapper").css("overflow","hidden"),$("#contentWrapper").css("position","relative"),$(".resource",this.obj).bind("click",function(e){if(imfinity_utils.feedbackScroll.moved)return;var t=e.target,n=t.className;if(n.indexOf("infoBtn")>-1)return;t.nodeName.toLowerCase()!="li"&&(t=t.parentNode),imfinity_utils.showResource(r.resources[t.id])}),$("#closeFeedback",this.obj).bind(AppEvent.CLICK,imfinity_utils.hideFeedback),$(".infoBtn",this.screen).bind(AppEvent.CLICK,imfinity_utils.showfeedbackInfo);var o=$("#feedbackWrapper").height()-$(".feedbackTitle").height();$("#contentWrapper").height(o-20),this.feedbackScroll!=null&&this.feedbackScroll.destroy(),this.feedbackScroll=new IScroll($("#contentWrapper").get(0),{desktopCompatibility:!0,hScroll:!0}),ths=this,_.delay(function(){ths.feedbackScroll.refresh()},999)},imfinity_utils.showfeedbackInfo=function(e){var t=e.target.getAttribute("class");if(t.indexOf("disabled")>-1)return;var n=e.target.parentNode.title;$(".infoOverlay",this.screen).show(),$(".infoContent").html(n),$(".closeBtn2").bind(AppEvent.CLICK,function(){$(".infoOverlay").hide(),imfinity_utils.infoScroll!=null&&imfinity_utils.infoScroll.destroy(),$(".closeBtn2").unbind()});var r=$(".infoWrapper").height();$(".contentWrapper").height(r-30),$(".contentWrapper").css("position","relative"),imfinity_utils.infoScroll!=null&&imfinity_utils.infoScroll.destroy(),imfinity_utils.infoScroll=new IScroll($(".contentWrapper").get(0),{desktopCompatibility:!0,hScroll:!0}),ths=this,_.delay(function(){imfinity_utils.infoScroll.refresh()},999)},imfinity_utils.hideFeedback=function(e){$("#feedbackContent",this.obj).html(""),$("#feedbackOverlay",this.obj).hide(),$("#closeFeedback",this.obj).unbind(),$(".resource",this.obj).unbind(),imfinity_utils.feedbackScroll!=null&&imfinity_utils.feedbackScroll.destroy()},imfinity_utils.showDPSResource=function(e){var t=this;$.ajax({url:AppConst.dlWebservicePath+"/getTitleGuidByTitleID",data:{ptoken:"A574CBDB-B36B-4883-8F16-B18AC1FA08DC",pTitleId:parseInt(e.Titleid)},success:function(t){openResourceWindow("ViewPage.aspx?tid="+t+"&fn="+e.contentFilename)},error:function(e){},dataType:"string"})},imfinity_utils.showResource=function(resource){var data={};switch(resource.remCode){case"DLR":var filename=resource.contentFilename.split("/");filename=filename[filename.length-1],data={pToken:AppConst.P_TOKEN,pTitleID:parseInt(resource.titleId)||0,pContentFileName:filename,pResourceFileName:resource.resourceFileName,pIsAERemediationResource:!1,pAssetFileURL:"",pAssetFileTitle:"",pAssetFileDescription:""};break;case"DPS":var url=resource.url,urlArray=resource.url.split("/"),filename=resource.contentFilename.split("/");filename=filename[filename.length-1],data={pToken:AppConst.P_TOKEN,pTitleID:parseInt(resource.titleId)||0,pContentFileName:filename,pResourceFileName:resource.resourceFileName||filename,pIsAERemediationResource:!0,pAssetFileURL:"",pAssetFileTitle:"",pAssetFileDescription:""};break;case"NDLA":data={pToken:AppConst.P_TOKEN,pTitleID:parseInt(resource.titleId)||0,pContentFileName:"",pResourceFileName:"",pIsAERemediationResource:!0,pAssetFileURL:resource.url,pAssetFileTitle:resource.descriptionText,pAssetFileDescription:AppConst.TEST_NAME};break;case"URL":var dem={width:screen.width,height:screen.height};imfinity_utils.openNewWindow(resource.text,dem);break;case"TEST":var mode=AppConst.mode;mode.toLowerCase()=="review"&&(mode="normal");var url="./LaunchTest.aspx?testID="+resource.testId+"&mode="+mode+"&userID="+AppConst.userid+"&samsID="+AppConst.samsid+"&userToken="+AppConst.usertoken+"&username="+AppConst.username+"&dlWebservicePath="+AppConst.dlWebservicePath+"&aeWebServicePath="+AppConst.aeWebServicePath+"&contentBaseUrl="+AppConst.ASSETS_PATH,dem={width:1020,height:620};imfinity_utils.openNewWindow(url,dem);break;case"TIER":var titleid=resource.titleId||0,url="/ResourceBank.aspx?tnum="+titleid+"&fn="+resource.resourceFileName+"&testLink=true&testID="+AppConst.testid,dem={width:screen.width,height:screen.height};imfinity_utils.openNewWindow(url,dem)}(resource.remCode=="DLR"||resource.remCode=="DPS"||resource.remCode=="NDLA")&&$.ajax({url:AppConst.dlWebservicePath+"/getViewResourceJavascript",data:data,success:function(xmlObj){var x2js=new X2JS,xmlString=x2js.xml2json(xmlObj).string.__text,jsonObj=x2js.xml_str2json(xmlString);eval(jsonObj.viewResourceJS.__cdata)},error:function(e){},dataType:"xml"})},imfinity_utils.create_unique_random_array=function(e,t,n){var r,i=new Array;for(var s=0;s<e;s++){while((r=imfinity_utils.number_found(imfinity_utils.random_number(t,n),i))==-1);i[s]=r}return i},imfinity_utils.random_number=function(e,t){return Math.round((t-e)*Math.random()+e)},imfinity_utils.number_found=function(e,t){for(var n=0;n<t.length;n++)if(e==t[n])return-1;return e},imfinity_utils.generateAlphaArr=function(e){var t=[];for(var n=0;n<e;n++)t.push(String.fromCharCode(65+n));return t},imfinity_utils.checkDevice=function(){screen.width<480?imfinity_utils.DEVICE_TYPE="phone":imfinity_utils.DEVICE_TYPE="desktop"},imfinity_utils.isPhone=function(){return window.innerWidth<768?!0:!1},imfinity_utils.isDesktopBrowser=function(){return navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i)?!1:!0},imfinity_utils.iOSversion=function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]}return undefined},imfinity_utils.getspecificHashValue=function(e){var t="";if(window.location.hash){var n=window.location.hash.split("?")[1];params=n.split("&");for(var r=0;r<params.length;r++)if(params[r].split("=")[0]==e){t=params[r].split("=")[1];break}}return imfinity_utils.log("value",t),t},imfinity_utils.getAllHashValues=function(){var e={};if(window.location.hash){var t=window.location.hash.split("?")[1];params=t.split("&");for(var n=0;n<params.length;n++)paramName=params[n].split("=")[0],e[paramName]=params[n].split("=")[1]}return imfinity_utils.log("hashObj",e),e},imfinity_utils.getSpecificQueryStringValues=function(e){var t="",n=window.location.href.split("?")[1];if(n!=undefined){params=n.split("&");for(var r=0;r<params.length;r++)if(params[r].split("=")[0]==e){t=params[r].split("=")[1];break}}return imfinity_utils.log("value",t),t},imfinity_utils.getAllQueryStringValues=function(){var e={},t=window.location.href.split("?")[1];if(t!=undefined){params=t.split("&");for(var n=0;n<params.length;n++)paramName=params[n].split("=")[0],e[paramName]=params[n].split("=")[1]}return imfinity_utils.log("hashObj",e),e},imfinity_utils.getWebServiceParams=function(){var e={testid:AppConst.testid,mode:AppConst.mode,userid:AppConst.userid,samsid:AppConst.samsid,usertoken:AppConst.usertoken,username:AppConst.username,dlWebservicePath:AppConst.dlWebservicePath,aeWebServicePath:AppConst.aeWebServicePath,launchID:AppConst.launchID};return e},imfinity_utils.hideAddressBar=function(){var e=document.getElementById("page"),t=navigator.userAgent,n=t.indexOf("iPhone")||t.indexOf("iPod"),r=t.indexOf("iPad"),i=n||r,s=window.navigator.standalone,o=t.indexOf("Android"),u=0,a,f=imfinity_utils.iOSversion();o>=0?(e.style.height=window.innerHeight+"px",window.onscroll=function(){},window.onbeforeunload=function(){}):window.onresize=function(){var t=e.offsetWidth;if(u==t)return;u=t,a()},(a=window.onload=function(){if(i>=0){var t=document.documentElement.clientHeight;n&&!s&&f[0]<7&&(t+=60),f[0]>=7&&(t-=20),e.style.height=t+"px"}else o>=0&&AppConst.appEnvironment!=="ReaderMobile"&&(e.style.height=window.innerHeight+56+"px");setTimeout(scrollTo,0,0,1)})()},imfinity_utils.sortByKey=function(e,t){return e.sort(function(e,n){var r=e[t],i=n[t];return r<i?-1:r>i?1:0})},imfinity_utils.romanize=function(e){if(!+e)return!1;var t=String(+e).split(""),n=["","c","cc","ccc","cd","d","dc","dcc","dccc","cm","","x","xx","xxx","xl","l","lx","lxx","lxxx","xc","","i","ii","iii","iv","v","vi","vii","viii","ix"],r="",i=3;while(i--)r=(n[+t.pop()+i*10]||"")+r;return Array(+t.join("")+1).join("M")+r},imfinity_utils.setWebServiceParams=function(e){AppConst.testid=parseInt(e.testID),AppConst.mode=e.mode,AppConst.userid=parseInt(e.userID),AppConst.samsid=e.samsID,AppConst.usertoken=unescape(e.userToken),AppConst.username=decodeURIComponent(e.username),AppConst.dlWebservicePath=e.dlWebservicePath,AppConst.aeWebServicePath=e.aeWebServicePath,AppConst.dlAuthorizationServiceURL=e.dlAuthorizationServiceURL,AppConst.ASSETS_PATH=e.contentBaseUrl,AppConst.launchID=e.launchID,AppConst.timetakeninseconds=e.timeTakenInSeconds},imfinity_utils.openNewWindow=function(e,t){var n=600,r=600;t!=undefined&&(n=t.width,r=t.height);var i=window.open(e,"","height="+r+",width="+n+",resizable=yes");return window.focus&&i.focus(),!1},imfinity_utils.decodeBase64=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",r,i,s,o,u,a,f,l=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(l<e.length)o=t.indexOf(e.charAt(l++)),u=t.indexOf(e.charAt(l++)),a=t.indexOf(e.charAt(l++)),f=t.indexOf(e.charAt(l++)),r=o<<2|u>>4,i=(u&15)<<4|a>>2,s=(a&3)<<6|f,n+=String.fromCharCode(r),a!=64&&(n+=String.fromCharCode(i)),f!=64&&(n+=String.fromCharCode(s));return n=_utf8_decode(n),n},_utf8_decode=function(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t},imfinity_utils.getLatestTestData=function(e){var t=_.filter(e,function(t){if(t.get("att_id")==String(e.length))return t});return this.log("Latest model filtered: "+JSON.stringify(t)),t[0]},imfinity_utils.checkLocalStorage=function(){try{return localStorage.setItem("TestEntry",""+Date()+'{"user_id":"{"ct":"j+QoBrdFfAs8Rnvbep5nBI8Uw75S13zoFk9kiHt1J0SNcvzoF3mB87cvV6/a158T","iv":"22b0ebcbb6f61bd211969d59136c8920","s":"a8ac74bf2ca5ad6e"}","test_id":"{"ct":"dLStPYJZ6C2HPOcyncr5SQ==","iv":"b532c87a41f6e2e4da1257590f2b74fe","s":"91f9ded5555b22fe"}","test_name":"{"ct":"QjlbEy62RkIVqQxt6ljDcsy0n2dNA8A7gHE6pDEKvD36AYsL0vPJsuJl5AP/p06T","iv":"7a89052b5d69a301080c391172047f00","s":"eedf095ec41eac40"}","test_metadata":"{"ct":"ECZFsGquBnLfYhhiatKuX7MEwc6Y+97RBKgLBT7e904yO0luCXYYvpfEB22z2afladqpRU+Bwcw/vDP6vlZHfXCHdblYhun2Lq1qmJ8hHvxY5eG4ezLWLZolI3xnahzKy9zEW3x/QsyUB6ZMf9QC2GD8vn/6+GN1uN/a2bHjvA4MWiDcJJEKKY71lrQZniDMhjuhStwvMLZcZIZLa8QUvIRquQpabKAUdZ6JTAV22rcR09LFxG6MYX1Rr3x7XWYl9Pi97ffBdjJHGl32jEcttzsJ2zqhZoY0FDWoN3JAzXh2gdWaKtlmgEICykmMszH6TWuFexOF/gxxD7u/KpP00TwYgk2vkvQXPqVo8kPHHAxgBwMDULThUVoVJTkO0kKXcEtunWCPUo0La8GDP9b3X66SlMnh3wz1dH5yrScAr6V0n+e1V9X1O9mI7y/dASF8VVDJB0u4ECnnxb+L8GxH5ARXOU7liHQUNFlUiL6wwVjZjQ8cfYPv8zlSdLEbXtNCKrVqsTI+Mi34E5g6lq9vvXBbTKqCzbeCSYxwxPktz3lrpl1UdrWMVTMcy7FbaRXU0zX1d4JqQTfJL0UeAkMMf+gTXYgsFJZhUoZqGdvqebTzAaacQnX4aOwIZN4sm2XWkjDb2KtciHAfbs9+PIvcivzfX5VgeSfac5GQQdSD/gc6/0PQxO8HGbAiPZbLIR8vMOLYTdGeYh5N9dcaNbUtjlFOGMugA2TAD1xlJroV+kM0t6/ndkLbSv/AhI/EVh3k6V5WQg0NY17C46udTE+OUNwfCQ87EvPJMlpsFryEvXw0OGFjaC9I9sA2jisVexBtt+E6ogcZlpAqvJz8i0V+k9ETSe3NSW5e4AkDFxhPza2/3kf4aVHgsNMNctu5Gik3qQioFbDHf6Tw6eSGtOmJAr+HXaAGY9KAHnhD+9R8OzJJ//X8i+cb/GKgjUS/KYTh5v1tFov7Bho0LXmEsiopnfWE9pflxQRAGDilUmogVsBqQFpxxvKzdUCK8QNlSF+4k1uGGgJJMI4w5NkSSSLo+z/yCo6BsrTSCx6wvGL52GfoXb2pZax0QaTuRw6Bu76zza5jraygvr/VXBkNhSdR9snv7yndv2USyUC6tzbEn7wuOMqi93EKiP6WcQYkno742FIzwWnDkqqRumgTxmuxtAHw95/N0pUuyQgo9ZwZjnrmdlRkIkyeTU7uEpXwURHxiOTlyLoVd5Hs0/9VyvaEj4xzSHDSAHa25wycc4Nnd7lE3QwNkZwJbwS8BqSO7tntTMvbOaFYDh1D+p/Im8Av9SaerCOZ9tgI+EFVGD6g3t7kn1v3OyPQZP4EtV1UkFRfp4XKQVt9FNzpxxlxxqpcEclDyUxeHtUowuFtz4ldp2ExFWBOADQoR6NZlR5+ewUVahMi5bzlicWXEegMLbtrmcDVENPsxO1TRK67W+h9tHQQWdYsfbWQ7Z9mQLhfzrOsGIu+fhp7qhHl6C67xwo6MCNZFLRFUP9mHuHyePJOH+55avRO+hGM7VzDUVRH69Ofyazcqai6JlnVNwOcq5riumk30TLU5HMXrJfrsSZp07qxzc+4WFA3Z1cuV+WeS+9LMtKi3ZlELjiQaG7T7gZhS7hfgwyWSbxdAY4wjYejX7SYnXsAcGzdZbvHcEHIP0uA0UVbwuXKnYK2e14sfa7FfJLHEgYn/iB8+/H/y3g9z4d3Rg0MM45dEyt2trlf+y7NWy7Wa+ujoLgM1GieSsKsyTYg27PZTQEM8Tx57UjG/ap+3BiewpW/zoP+cxiNw/Z0qbGIHhz5y0xRdo7x+rsAV0sl9GyvygYxhTRyeSVef3ugO4MgEwtcbIlwXNh9iQv4G75f4yj1HBenEFRgJSL2luVFJWHsOa4KLcPfSvLwjWLg8zY3/hby183/ztDnhWjmG9TTGNef5M6N8qf0oFHiMW5MtrWA9qQ0M4RuIk7OhLQfu35I26dzmUH8FVlmZNAp46CsTj0XA+NF5eskKRujFKjdJ+33AXe/EZte1J22IdFUkt1M8a+50VHxzCfNGxjnMZxski6yMf0/OsyfVafHeZIj5puceXLGn11AifgCAE6SPlGJVltu84fQnESnPo5cUscymxUzURO3BUtV14bPD+VgAVfq///IpeX49uobODme4PhM2gmoQ3M4/SBlsO4LQr2TQzChWAvGZu/vOQ2lFninBA/bkiL1dNJHBGGoHI86RemkJizRUem/mk72tFdXp0S46c+9g60FtkccuHDzC5CbCJ49P/lB8X8yLqKE+ZcNIRtXcF4zzOAwUIYX55YNruI3H6iWWh0BbcZXFO085Hzp1NS2BG+HPlmXUKmjKcY/lR6Qd5O7oeTZ9+t5oA6yCfrBvuguCTCH4vn2pVoim+pUNaes7cdOGTCxpfKvn9JFLDD8i7IrRei+zyk0Z9rp4R9MbyJshP2dPujbeq11tNIAKBRcN6CYbinbuixHIg8PV0gPEMEx9BKyUvgnb+/vhkRVOS+s7fnrzXeABI9HfaGN6mFQFCFF7CZZvUkwXyXrKhmMrm9hBJF3oZqlZ2tY","iv":"335e842c8358c29e02508271840ad490","s":"2b1f2dbfd7bcc27f"}","attempts_taken":"{"ct":"dDapeZyApaj/MAEZhrNlfA==","iv":"bf957726172ee8d8740ae91a2beede4a","s":"443a319bf78fcfb4"}","date":"{"ct":"1li8KeKMa+wZyLQAhqxsBg==","iv":"cc3e1c795120644a7bf10cc4983ee1ef","s":"8d3952bd9d7b3b24"}","sync_status":"{"ct":"oS+WKFhbt1TLCIhHoKCClg==","iv":"1a452bcac5a050560cb29d394a73ba83","s":"235d868a922092f6"}","max_score":"{"ct":"L3KrdleGeS+NJWpGpQKO3Q==","iv":"3cba573722d98ef9d69960be059e64b0","s":"30ad94af6313c7eb"}","grade":"-","isbn":"9781471805783","data_url":"","base_url":"http://127.0.0.1:2394/OEBPS/resources/assessment/HodderReport-hdl-reports-19638/undefined","att_id":"1","id":"f963ed19-32be-73f9-56de-872862d3bc10"}'),localStorage.removeItem("TestEntry"),!0}catch(e){return e.code==22|e.code==1014?(this.showToasterMessage(AppConst.LOCALSTORAGE_FULL_ERROR_TEXT),this.log("LocalStorage limit reached")):this.showToasterMessage(AppConst.LOCALSTORAGE_SAVE_ERROR_TEXT),!1}},imfinity_utils.getParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\#&]"+e+"=([^&#]*)"),n=t.exec(window.location.href);return n===null?"":decodeURIComponent(n[1].replace(/\+/g," "))},imfinity_utils}),define("core/model/questionPlayerVO",[],function(){var e=Backbone.Model.extend({defaults:{myId:"questionPlayer",headerVisible:"none",leftBtnClass:"",leftVisible:"none",leftLabel:"",title:"Title",titleVisible:"none",rightLabel:"",rightBtnClass:"",rightVisible:"none",timestamp:"00:00:00",colorCode:"",coverImage:""}});return e}),define("language",[],function(){var e={ACTIVITY_TITLE:"Activities",NO_ACTIVITY:"No activities",DEBUG_TITLE:"Debug",DEBUG_CONTENT:"<p><b>About Safari</b></p>",BACK_BUTTON_LABEL:"Back",EDIT_BUTTON_LABEL:"Edit",QUIT_BUTTON_LABEL:"Quit",DONE_BUTTON_LABEL:"Done",QUESTION_TITLE:"Question",QUESTION_INSTRUCTION:"Instructions",QUESTION_INSTRUCTION_IMAGE:"interface/load.png",QUESTION_TEXT:"Question text",QUESTION_OPTIONS:"Question options",QUESTION_RESET_CONFIRMATION:"This would reset your current response. Continue?",QUESTION_RESET_CONFIRMATION_TITLE:"Reset",RESULT_TITLE:"Results",RESULT_TEXT:"<p>Based on your performance in the activity, your score has been calculated to be: </p>",RESULT_START_AGAIN_PROMPT_TITLE:"Start again?",RESULT_START_AGAIN_PROMPT:"Starting again will erase your previous answers.",RESULT_SCORE_LABEL:"Score: ",RESULT_SKIPPED_LABEL:"Not answered: ",RESULT_TIME_LABEL:"Time taken: ",SETTING_ACTIVITIES:"Activities",SETTING_QUESTION_COUNT:"Question count",SETTING_RANDOMIZE_ACTIVITIES:"Randomize activities",SETTING_APPEARANCE:"Appearance",SETTING_TYPEFACE:"Typeface",SETTING_FONTSIZE:"Font Size",SETTINGS_ACCOUNT:"Account",SETTINGS_PASS_CHANGE:"Change password",SETTINGS_EMAIL_CHANGE:"Change email",SETTINGS_CREATE:"Create account",TOPICS_TITLE:"Topics",TESTS_TITLE:"Tests",IMAGE_MISSING_ALERT:"Image Missing",SELECTION_LIMIT_ALERT:"words are already selected. Please deselect one of the selected words to pick a new word.",OK_BUTTON_LABEL:"Ok",MISSING_ACTIVITY_ALERT:"No activities in the selected topic.",MISSING_QUESTION_ALERT:" question details cannot be loaded for ques:",UNSUPPORTED_QUESTION_ALERT:"Unsupported question type: ",CORRECT:"correct",INCORRECT:"incorrect",CONTENTMANAGER_TITLE:"Manage",START_AGAIN_BUTTON_LABEL:"Start Again",CONTINUE_BUTTON_LABEL:"Continue",CANCEL_BUTTON_LABEL:"Cancel",START_TEST_LABEL:"Start test",TEST_REVIEW_BUTTON_LABEL:"Review Answers",REVIEW_NOT_AVAIL:"Only available in Test Mode.",TEST_CONTINUE_PROMPT:"Would you like to continue where you last left off? Starting again will erase your previous answers.",TOPIC_CONTINUE_PROMPT:"Would you like to continue where you last left off? Starting again will erase your previous answers.",TOPIC_RESET_PROMPT:"This will erase your previous answers for this topic.		Continue?",TEST_RESET_PROMPT:"This will erase your previous answers for this test.		Continue?",TOPIC_RESET_PROMPT_TITLE:"Reset topic?",QP_DELETE_PROMPT_TITLE:"Delete Question Pack?",QP_DELETE_PROMPT:"This will delete this question pack from your device. You can download it again from the Purchase screen later.			Continue?",QP_RESTRICTED_DELETE_PROMPT:"You cannot delete the default question pack.",QP_SELECTED_DELETE_PROMPT:"Currently selected question packs cannot be removed. Please select any other question pack before removing it.",QP_DELETE_SUCCESS:"Question pack deleted successfully.",QP_RESET_PROMPT_TITLE:"Reset Question Pack?",QP_RESET_PROMPT:"This will erase your previous answers for this question pack.		Continue?",ACTIVITY_DONE_PROMPT_TITLE:"Proceed to results",ACTIVITY_DONE_INCOMPLETE_PROMPT:"Would you like to leave all incomplete questions and proceed to results?",ACTIVITY_DONE_COMPLETE_PROMPT:"Would you like to proceed to results?",ACTIVITY_REVIEW_DONE_PROMPT:"Would you like to proceed to results?",CREATE_ACCOUNT_TITLE:"Create Account",LOGIN_SAVE:"Sign in",NEW_ACCOUNT_NAME:"Username (abcd@xyz.com)",NEW_ACCOUNT_PASS:"Password (at least 6 characters long)",NEW_ACCOUNT_CONFIRM_PASS:"Confirm password",LOGIN_NAME:"Username",LOGIN_PASS:"Password",FORGOT_PASS:"Forgot password?",LOGIN_TITLE:"User sign in",FORGOT_PASSWORD_TITLE:"Forgot Password",CHANGE_PASSWORD_TITLE:"Change Password",NEW_ACCOUNT_TEMP_PASS:"Temporary password",ACCOUNT_NEW_PASS:"New password",ACCOUNT_NEW_EMAIL:"New Email",ACCOUNT_OLD_PASS:"Present password",NEW_ACCOUNT_SAVE:"Submit",GET_QUESTIONPACKS_TITLE:"Purchase",TAB_AVAILABLE:"Available",TAB_PURCHASED:"Purchased",NO_USERNAME_ALERT:"Username required",INVALID_USERNAME_ALERT:"Invalid username",NO_PASSWORD_ALERT:"Password required",NO_EMAIL_ALERT:"Email Required",INVALID_PASSWORD_ALERT:"Invalid password. Password should be atleast six character long.",ERR_PASS_MATCH:"Passwords don't match.",INVALID_LOGIN:"Invalid username/password",ACCOUNT_CREATION_FAILED:"User already exists.",NO_OLD_PASS_ALERT:"Please enter your present password",PASS_CHANGED:"Password changed",PASS_CHANGE_ERROR:"There was an error in changing your password.",CHANGE_PASS_FAILED:"Sorry you entered an invalid password.",SEND_NEW_PASS:"Send",PASSWORD_SENT:"New password sent to your email account.",PASSWORD_SENDING_FAILED:"Invalid user name.",QUESTION_POSITION_LABEL:"Question: ",SEARCH_KEYWORD:"search by keyword",LEVEL_SETTINGS_0:"All",LEVEL_SETTINGS_1:"Beginner",LEVEL_SETTINGS_2:"Elementary",LEVEL_SETTINGS_3:"Intermediate",LEVEL_SETTINGS_4:"Advanced",FIND_LABEL:"Find",DOWNLOADPACK_CREATE_USER:"Please create an account from the Settings screen to download new question packs.",QUESTIONPACK_PURCHASED:"You have successfully purchased <qpName>.Click the green download button to install.",PURCHASE_FAILED:"Purchase Failed",NO_NEW_PACK_AVAILABLE:"No new question packs are available for purchase.",ACCOUNT_CREATED:"Your account has been created. Please activate your account by clicking on the activation link sent to your email.",SOUND_EFFECT:"Sound Effect",NO_QP_INSTALLED:"No question packs are installed.",QP_ALREADY_INSTALLED:"question pack is already installed.",NO_PACKS_PURCHASED:"No question pack is purchased yet.",PASSWORD_CHANGED:"Your password has been changed. You need to re-login.",ACCOUNT_PENDING:"Please activate your account through your email.",SETTINGS_DESCRIPTION:"An account is needed to download further question packs.",QP_INSTALLED:"Question pack Installed successfully.",QP_INSTALLED_TITLE:"QP Installed",ANSWER_BTN_LABEL:"Answer",HINT_BTN_LABEL:"Hint",EVALUATE_BTN_LABEL:"Check",RESET_BTN_LABEL:"Reset",CORRECT_ANSWER_BTN_LABEL:"Answer",USER_ANSWER_BTN_LABEL:"Your Answer",SHOW_ANSWE_WARNING:"Are you sure you want to see the answer? This will erase all your unchecked answers.",WARNINGS:"Warnings",DISPLAY_WARNING:"Display Warning",QUIT_CONFIRMATION:"Are you sure you want to quit?",QUIT_CONFIRMATION_TEST:"Are you sure you want to quit? This will reset the test.",NEXT_CONFIRMATION:"Do you want to check your answer or go to the next question?",BACK_CONFIRMATION:"Do you want to check your answer or go to the previous question?",CHANGE_EMAIL_NAME:"New email can not be same as old email.",CHANGE_EMAIL_ERR:"There was an error updating your email.",CHANGE_EMAIL_SUCC:"Your email address has been updated successfully. Please re-activate your account using the activation link sent to your new email.",NO_CON_PASSWORD_ALERT:"Please confirm your password.",PASS_NOT_MATCH:"Passwords do not match.",FIRST_SETUP_MSG:"Installing content, please wait.",VERIFY_RECEIPT_MSG:"Verifying purchase receipt",LOW_MEMORY_WIPE_TEXT:"Data from your installed questionpacks was deleted by the device during a cleanup. You can re-install these questionpacks from 'Purchase' screen without having to purchase them again.",LOW_MEMORY_WIPE_TITLE:"Warning",RESOURCE_TITLE:"Resources"};return e}),define("core/model/resultScreenVO",["AppConst","language"],function(e,t){var n=Backbone.Model.extend({initialize:function(){this.set({myId:e.RESULT_SCREEN,leftLabel:"",title:t.RESULT_TITLE,rightLabel:"",leftBtnClass:"",rightBtnClass:"",content:"",headerVisible:"block",leftVisible:"block",titleVisible:"block",rightVisible:"block",questionIds:[],resultData:[],testFeedbackData:[],colorCode:"",testMarkScheme:[],coverImage:""})},toString:function(){return e.RESULT_SCREEN}});return n}),function($){function sc_setScroll(e,t,n){return n.transition=="transition"&&t=="swing"&&(t="ease"),{anims:[],duration:e,orgDuration:e,easing:t,startTime:getTime()}}function sc_startScroll(e,t){for(var n=0,r=e.anims.length;n<r;n++){var i=e.anims[n];if(!i)continue;i[0][t.transition](i[1],e.duration,e.easing,i[2])}}function sc_stopScroll(e,t){is_boolean(t)||(t=!0),is_object(e.pre)&&sc_stopScroll(e.pre,t);for(var n=0,r=e.anims.length;n<r;n++){var i=e.anims[n];i[0].stop(!0),t&&(i[0].css(i[1]),is_function(i[2])&&i[2]())}is_object(e.post)&&sc_stopScroll(e.post,t)}function sc_afterScroll(e,t,n){t&&t.remove();switch(n.fx){case"fade":case"crossfade":case"cover-fade":case"uncover-fade":e.css("opacity",1),e.css("filter","")}}function sc_fireCallbacks(e,t,n,r,i){t[n]&&t[n].call(e,r);if(i[n].length)for(var s=0,o=i[n].length;s<o;s++)i[n][s].call(e,r);return[]}function sc_fireQueue(e,t,n){return t.length&&(e.trigger(cf_e(t[0][0],n),t[0][1]),t.shift()),t}function sc_hideHiddenItems(e){e.each(function(){var e=$(this);e.data("_cfs_isHidden",e.is(":hidden")).hide()})}function sc_showHiddenItems(e){e&&e.each(function(){var e=$(this);e.data("_cfs_isHidden")||e.show()})}function sc_clearTimers(e){return e.auto&&clearTimeout(e.auto),e.progress&&clearInterval(e.progress),e}function sc_mapCallbackArguments(e,t,n,r,i,s,o){return{width:o.width,height:o.height,items:{old:e,skipped:t,visible:n},scroll:{items:r,direction:i,duration:s}}}function sc_getDuration(e,t,n,r){var i=e.duration;return e.fx=="none"?0:(i=="auto"?i=t.scroll.duration/t.scroll.items*n:i<10&&(i=r/i),i<1?0:(e.fx=="fade"&&(i/=2),Math.round(i)))}function nv_showNavi(e,t,n){var r=is_number(e.items.minimum)?e.items.minimum:e.items.visible+1;if(t=="show"||t=="hide")var i=t;else if(r>t){debug(n,"Not enough items ("+t+" total, "+r+" needed): Hiding navigation.");var i="hide"}else var i="show";var s=i=="show"?"removeClass":"addClass",o=cf_c("hidden",n);e.auto.button&&e.auto.button[i]()[s](o),e.prev.button&&e.prev.button[i]()[s](o),e.next.button&&e.next.button[i]()[s](o),e.pagination.container&&e.pagination.container[i]()[s](o)}function nv_enableNavi(e,t,n){if(e.circular||e.infinite)return;var r=t=="removeClass"||t=="addClass"?t:!1,i=cf_c("disabled",n);e.auto.button&&r&&e.auto.button[r](i);if(e.prev.button){var s=r||t==0?"addClass":"removeClass";e.prev.button[s](i)}if(e.next.button){var s=r||t==e.items.visible||t==e.visibleItemCount?"addClass":"removeClass";e.next.button[s](i)}}function go_getObject(e,t){return is_function(t)?t=t.call(e):is_undefined(t)&&(t={}),t}function go_getItemsObject(e,t){return t=go_getObject(e,t),is_number(t)?t={visible:t}:t=="variable"?t={visible:t,width:t,height:t}:is_object(t)||(t={}),t}function go_getScrollObject(e,t){return t=go_getObject(e,t),is_number(t)?t<=50?t={items:t}:t={duration:t}:is_string(t)?t={easing:t}:is_object(t)||(t={}),t}function go_getNaviObject(e,t){t=go_getObject(e,t);if(is_string(t)){var n=cf_getKeyCode(t);n==-1?t=$(t):t=n}return t}function go_getAutoObject(e,t){return t=go_getNaviObject(e,t),is_jquery(t)?t={button:t}:is_boolean(t)?t={play:t}:is_number(t)&&(t={timeoutDuration:t}),t.progress&&(is_string(t.progress)||is_jquery(t.progress))&&(t.progress={bar:t.progress}),t}function go_complementAutoObject(e,t){return is_function(t.button)&&(t.button=t.button.call(e)),is_string(t.button)&&(t.button=$(t.button)),is_boolean(t.play)||(t.play=!0),is_number(t.delay)||(t.delay=0),is_undefined(t.pauseOnEvent)&&(t.pauseOnEvent=!0),is_boolean(t.pauseOnResize)||(t.pauseOnResize=!0),is_number(t.timeoutDuration)||(t.timeoutDuration=t.duration<10?2500:t.duration*5),t.progress&&(is_function(t.progress.bar)&&(t.progress.bar=t.progress.bar.call(e)),is_string(t.progress.bar)&&(t.progress.bar=$(t.progress.bar)),t.progress.bar?(is_function(t.progress.updater)||(t.progress.updater=$.fn.carouFredSel.progressbarUpdater),is_number(t.progress.interval)||(t.progress.interval=50)):t.progress=!1),t}function go_getPrevNextObject(e,t){return t=go_getNaviObject(e,t),is_jquery(t)?t={button:t}:is_number(t)&&(t={key:t}),t}function go_complementPrevNextObject(e,t){return is_function(t.button)&&(t.button=t.button.call(e)),is_string(t.button)&&(t.button=$(t.button)),is_string(t.key)&&(t.key=cf_getKeyCode(t.key)),t}function go_getPaginationObject(e,t){return t=go_getNaviObject(e,t),is_jquery(t)?t={container:t}:is_boolean(t)&&(t={keys:t}),t}function go_complementPaginationObject(e,t){return is_function(t.container)&&(t.container=t.container.call(e)),is_string(t.container)&&(t.container=$(t.container)),is_number(t.items)||(t.items=!1),is_boolean(t.keys)||(t.keys=!1),!is_function(t.anchorBuilder)&&!is_false(t.anchorBuilder)&&(t.anchorBuilder=$.fn.carouFredSel.pageAnchorBuilder),is_number(t.deviation)||(t.deviation=0),t}function go_getSwipeObject(e,t){return is_function(t)&&(t=t.call(e)),is_undefined(t)&&(t={onTouch:!1}),is_true(t)?t={onTouch:t}:is_number(t)&&(t={items:t}),t}function go_complementSwipeObject(e,t){return is_boolean(t.onTouch)||(t.onTouch=!0),is_boolean(t.onMouse)||(t.onMouse=!1),is_object(t.options)||(t.options={}),is_boolean(t.options.triggerOnTouchEnd)||(t.options.triggerOnTouchEnd=!1),t}function go_getMousewheelObject(e,t){return is_function(t)&&(t=t.call(e)),is_true(t)?t={}:is_number(t)?t={items:t}:is_undefined(t)&&(t=!1),t}function go_complementMousewheelObject(e,t){return t}function gn_getItemIndex(e,t,n,r,i){is_string(e)&&(e=$(e,i)),is_object(e)&&(e=$(e,i)),is_jquery(e)?(e=i.children().index(e),is_boolean(n)||(n=!1)):is_boolean(n)||(n=!0),is_number(e)||(e=0),is_number(t)||(t=0),n&&(e+=r.first),e+=t;if(r.total>0){while(e>=r.total)e-=r.total;while(e<0)e+=r.total}return e}function gn_getVisibleItemsPrev(e,t,n){var r=0,i=0;for(var s=n;s>=0;s--){var o=e.eq(s);r+=o.is(":visible")?o[t.d.outerWidth](!0):0;if(r>t.maxDimension)return i;s==0&&(s=e.length),i++}}function gn_getVisibleItemsPrevFilter(e,t,n){return gn_getItemsPrevFilter(e,t.items.filter,t.items.visibleConf.org,n)}function gn_getScrollItemsPrevFilter(e,t,n,r){return gn_getItemsPrevFilter(e,t.items.filter,r,n)}function gn_getItemsPrevFilter(e,t,n,r){var i=0,s=0;for(var o=r,u=e.length;o>=0;o--){s++;if(s==u)return s;var a=e.eq(o);if(a.is(t)){i++;if(i==n)return s}o==0&&(o=u)}}function gn_getVisibleOrg(e,t){return t.items.visibleConf.org||e.children().slice(0,t.items.visible).filter(t.items.filter).length}function gn_getVisibleItemsNext(e,t,n){var r=0,i=0;for(var s=n,o=e.length-1;s<=o;s++){var u=e.eq(s);r+=u.is(":visible")?u[t.d.outerWidth](!0):0;if(r>t.maxDimension)return i;i++;if(i==o+1)return i;s==o&&(s=-1)}}function gn_getVisibleItemsNextTestCircular(e,t,n,r){var i=gn_getVisibleItemsNext(e,t,n);return t.circular||n+i>r&&(i=r-n),i}function gn_getVisibleItemsNextFilter(e,t,n){return gn_getItemsNextFilter(e,t.items.filter,t.items.visibleConf.org,n,t.circular)}function gn_getScrollItemsNextFilter(e,t,n,r){return gn_getItemsNextFilter(e,t.items.filter,r+1,n,t.circular)-1}function gn_getItemsNextFilter(e,t,n,r,i){var s=0,o=0;for(var u=r,a=e.length-1;u<=a;u++){o++;if(o>=a)return o;var f=e.eq(u);if(f.is(t)){s++;if(s==n)return o}u==a&&(u=-1)}}function gi_getCurrentItems(e,t){return e.slice(0,t.items.visible)}function gi_getOldItemsPrev(e,t,n){return e.slice(n,t.items.visibleConf.old+n)}function gi_getNewItemsPrev(e,t){return e.slice(0,t.items.visible)}function gi_getOldItemsNext(e,t){return e.slice(0,t.items.visibleConf.old)}function gi_getNewItemsNext(e,t,n){return e.slice(n,t.items.visible+n)}function sz_storeMargin(e,t,n){t.usePadding&&(is_string(n)||(n="_cfs_origCssMargin"),e.each(function(){var e=$(this),r=parseInt(e.css(t.d.marginRight),10);is_number(r)||(r=0),e.data(n,r)}))}function sz_resetMargin(e,t,n){if(t.usePadding){var r=is_boolean(n)?n:!1;is_number(n)||(n=0),sz_storeMargin(e,t,"_cfs_tempCssMargin"),e.each(function(){var e=$(this);e.css(t.d.marginRight,r?e.data("_cfs_tempCssMargin"):n+e.data("_cfs_origCssMargin"))})}}function sz_storeOrigCss(e){e.each(function(){var e=$(this);e.data("_cfs_origCss",e.attr("style")||"")})}function sz_restoreOrigCss(e){e.each(function(){var e=$(this);e.attr("style",e.data("_cfs_origCss")||"")})}function sz_setResponsiveSizes(e,t){var n=e.items.visible,r=e.items[e.d.width],i=e[e.d.height],s=is_percentage(i);t.each(function(){var t=$(this),n=r-ms_getPaddingBorderMargin(t,e,"Width");t[e.d.width](n),s&&t[e.d.height](ms_getPercentage(n,i))})}function sz_setSizes(e,t){var n=e.parent(),r=e.children(),i=gi_getCurrentItems(r,t),s=cf_mapWrapperSizes(ms_getSizes(i,t,!0),t,!1);n.css(s);if(t.usePadding){var o=t.padding,u=o[t.d[1]];t.align&&u<0&&(u=0);var a=i.last();a.css(t.d.marginRight,a.data("_cfs_origCssMargin")+u),e.css(t.d.top,o[t.d[0]]),e.css(t.d.left,o[t.d[3]])}return e.css(t.d.width,s[t.d.width]+ms_getTotalSize(r,t,"width")*2),e.css(t.d.height,ms_getLargestSize(r,t,"height")),s}function ms_getSizes(e,t,n){return[ms_getTotalSize(e,t,"width",n),ms_getLargestSize(e,t,"height",n)]}function ms_getLargestSize(e,t,n,r){return is_boolean(r)||(r=!1),is_number(t[t.d[n]])&&r?t[t.d[n]]:is_number(t.items[t.d[n]])?t.items[t.d[n]]:(n=n.toLowerCase().indexOf("width")>-1?"outerWidth":"outerHeight",ms_getTrueLargestSize(e,t,n))}function ms_getTrueLargestSize(e,t,n){var r=0;for(var i=0,s=e.length;i<s;i++){var o=e.eq(i),u=o.is(":visible")?o[t.d[n]](!0):0;r<u&&(r=u)}return r}function ms_getTotalSize(e,t,n,r){is_boolean(r)||(r=!1);if(is_number(t[t.d[n]])&&r)return t[t.d[n]];if(is_number(t.items[t.d[n]]))return t.items[t.d[n]]*e.length;var i=n.toLowerCase().indexOf("width")>-1?"outerWidth":"outerHeight",s=0;for(var o=0,u=e.length;o<u;o++){var a=e.eq(o);s+=a.is(":visible")?a[t.d[i]](!0):0}return s}function ms_getParentSize(e,t,n){var r=e.is(":visible");r&&e.hide();var i=e.parent()[t.d[n]]();return r&&e.show(),i}function ms_getMaxDimension(e,t){return is_number(e[e.d.width])?e[e.d.width]:t}function ms_hasVariableSizes(e,t,n){var r=!1,i=!1;for(var s=0,o=e.length;s<o;s++){var u=e.eq(s),a=u.is(":visible")?u[t.d[n]](!0):0;r===!1?r=a:r!=a&&(i=!0),r==0&&(i=!0)}return i}function ms_getPaddingBorderMargin(e,t,n){return e[t.d["outer"+n]](!0)-e[t.d[n.toLowerCase()]]()}function ms_getPercentage(e,t){if(is_percentage(t)){t=parseInt(t.slice(0,-1),10);if(!is_number(t))return e;e*=t/100}return e}function cf_e(e,t,n,r,i){return is_boolean(n)||(n=!0),is_boolean(r)||(r=!0),is_boolean(i)||(i=!1),n&&(e=t.events.prefix+e),r&&(e=e+"."+t.events.namespace),r&&i&&(e+=t.serialNumber),e}function cf_c(e,t){return is_string(t.classnames[e])?t.classnames[e]:e}function cf_mapWrapperSizes(e,t,n){is_boolean(n)||(n=!0);var r=t.usePadding&&n?t.padding:[0,0,0,0],i={};return i[t.d.width]=e[0]+r[1]+r[3],i[t.d.height]=e[1]+r[0]+r[2],i}function cf_sortParams(e,t){var n=[];for(var r=0,i=e.length;r<i;r++)for(var s=0,o=t.length;s<o;s++)if(t[s].indexOf(typeof e[r])>-1&&is_undefined(n[s])){n[s]=e[r];break}return n}function cf_getPadding(e){if(is_undefined(e))return[0,0,0,0];if(is_number(e))return[e,e,e,e];is_string(e)&&(e=e.split("px").join("").split("em").join("").split(" "));if(!is_array(e))return[0,0,0,0];for(var t=0;t<4;t++)e[t]=parseInt(e[t],10);switch(e.length){case 0:return[0,0,0,0];case 1:return[e[0],e[0],e[0],e[0]];case 2:return[e[0],e[1],e[0],e[1]];case 3:return[e[0],e[1],e[2],e[1]];default:return[e[0],e[1],e[2],e[3]]}}function cf_getAlignPadding(e,t){var n=is_number(t[t.d.width])?Math.ceil(t[t.d.width]-ms_getTotalSize(e,t,"width")):0;switch(t.align){case"left":return[0,n];case"right":return[n,0];case"center":default:return[Math.ceil(n/2),Math.floor(n/2)]}}function cf_getDimensions(e){var t=[["width","innerWidth","outerWidth","height","innerHeight","outerHeight","left","top","marginRight",0,1,2,3],["height","innerHeight","outerHeight","width","innerWidth","outerWidth","top","left","marginBottom",3,2,1,0]],n=t[0].length,r=e.direction=="right"||e.direction=="left"?0:1,i={};for(var s=0;s<n;s++)i[t[0][s]]=t[r][s];return i}function cf_getAdjust(e,t,n,r){var i=e;if(is_function(n))i=n.call(r,i);else if(is_string(n)){var s=n.split("+"),o=n.split("-");if(o.length>s.length)var u=!0,a=o[0],f=o[1];else var u=!1,a=s[0],f=s[1];switch(a){case"even":i=e%2==1?e-1:e;break;case"odd":i=e%2==0?e-1:e;break;default:i=e}f=parseInt(f,10),is_number(f)&&(u&&(f=-f),i+=f)}if(!is_number(i)||i<1)i=1;return i}function cf_getItemsAdjust(e,t,n,r){return cf_getItemAdjustMinMax(cf_getAdjust(e,t,n,r),t.items.visibleConf)}function cf_getItemAdjustMinMax(e,t){return is_number(t.min)&&e<t.min&&(e=t.min),is_number(t.max)&&e>t.max&&(e=t.max),e<1&&(e=1),e}function cf_getSynchArr(e){is_array(e)||(e=[[e]]),is_array(e[0])||(e=[e]);for(var t=0,n=e.length;t<n;t++)is_string(e[t][0])&&(e[t][0]=$(e[t][0])),is_boolean(e[t][1])||(e[t][1]=!0),is_boolean(e[t][2])||(e[t][2]=!0),is_number(e[t][3])||(e[t][3]=0);return e}function cf_getKeyCode(e){return e=="right"?39:e=="left"?37:e=="up"?38:e=="down"?40:-1}function cf_setCookie(e,t,n){if(e){var r=t.triggerHandler(cf_e("currentPosition",n));$.fn.carouFredSel.cookie.set(e,r)}}function cf_getCookie(e){var t=$.fn.carouFredSel.cookie.get(e);return t==""?0:t}function in_mapCss(e,t){var n={};for(var r=0,i=t.length;r<i;r++)n[t[r]]=e.css(t[r]);return n}function in_complementItems(e,t,n,r){return is_object(e.visibleConf)||(e.visibleConf={}),is_object(e.sizesConf)||(e.sizesConf={}),e.start==0&&is_number(r)&&(e.start=r),is_object(e.visible)?(e.visibleConf.min=e.visible.min,e.visibleConf.max=e.visible.max,e.visible=!1):is_string(e.visible)?(e.visible=="variable"?e.visibleConf.variable=!0:e.visibleConf.adjust=e.visible,e.visible=!1):is_function(e.visible)&&(e.visibleConf.adjust=e.visible,e.visible=!1),is_string(e.filter)||(e.filter=n.filter(":hidden").length>0?":visible":"*"),e[t.d.width]||(t.responsive?(debug(!0,"Set a "+t.d.width+" for the items!"),e[t.d.width]=ms_getTrueLargestSize(n,t,"outerWidth")):e[t.d.width]=ms_hasVariableSizes(n,t,"outerWidth")?"variable":n[t.d.outerWidth](!0)),e[t.d.height]||(e[t.d.height]=ms_hasVariableSizes(n,t,"outerHeight")?"variable":n[t.d.outerHeight](!0)),e.sizesConf.width=e.width,e.sizesConf.height=e.height,e}function in_complementVisibleItems(e,t){e.items[e.d["width"]]=="variable"&&(e.items.visibleConf.variable=!0);if(!e.items.visibleConf.variable){is_number(e[e.d.width])?e.items.visible=Math.floor(e[e.d.width]/e.items[e.d.width]):(e.items.visible=Math.floor(t/e.items[e.d.width]),e[e.d.width]=e.items.visible*e.items[e.d.width],e.items.visibleConf.adjust||(e.align=!1));if(e.items.visible=="Infinity"||e.items.visible<1)debug(!0,'Not a valid number of visible items: Set to "variable".'),e.items.visibleConf.variable=!0}return e}function in_complementPrimarySize(e,t,n){return e=="auto"&&(e=ms_getTrueLargestSize(n,t,"outerWidth")),e}function in_complementSecondarySize(e,t,n){return e=="auto"&&(e=ms_getTrueLargestSize(n,t,"outerHeight")),e||(e=t.items[t.d.height]),e}function in_getAlignPadding(e,t){var n=cf_getAlignPadding(gi_getCurrentItems(t,e),e);return e.padding[e.d[1]]=n[1],e.padding[e.d[3]]=n[0],e}function in_getResponsiveValues(e,t,n){var r=cf_getItemAdjustMinMax(Math.ceil(e[e.d.width]/e.items[e.d.width]),e.items.visibleConf);r>t.length&&(r=t.length);var i=Math.floor(e[e.d.width]/r);return e.items.visible=r,e.items[e.d.width]=i,e[e.d.width]=r*i,e}function bt_pauseOnHoverConfig(e){if(is_string(e))var t=e.indexOf("immediate")>-1?!0:!1,n=e.indexOf("resume")>-1?!0:!1;else var t=n=!1;return[t,n]}function bt_mousesheelNumber(e){return is_number(e)?e:null}function is_null(e){return e===null}function is_undefined(e){return is_null(e)||typeof e=="undefined"||e===""||e==="undefined"}function is_array(e){return e instanceof Array}function is_jquery(e){return e instanceof jQuery}function is_object(e){return(e instanceof Object||typeof e=="object")&&!is_null(e)&&!is_jquery(e)&&!is_array(e)&&!is_function(e)}function is_number(e){return(e instanceof Number||typeof e=="number")&&!isNaN(e)}function is_string(e){return(e instanceof String||typeof e=="string")&&!is_undefined(e)&&!is_true(e)&&!is_false(e)}function is_function(e){return e instanceof Function||typeof e=="function"}function is_boolean(e){return e instanceof Boolean||typeof e=="boolean"||is_true(e)||is_false(e)}function is_true(e){return e===!0||e==="true"}function is_false(e){return e===!1||e==="false"}function is_percentage(e){return is_string(e)&&e.slice(-1)=="%"}function getTime(){return(new Date).getTime()}function deprecated(e,t){debug(!0,e+" is DEPRECATED, support for it will be removed. Use "+t+" instead.")}function debug(e,t){if(!is_undefined(window.console)&&!is_undefined(window.console.log)){if(is_object(e)){var n=" ("+e.selector+")";e=e.debug}else var n="";if(!e)return!1;is_string(t)?t="carouFredSel"+n+": "+t:t=["carouFredSel"+n+":",t]}return!1}if($.fn.carouFredSel)return;$.fn.caroufredsel=$.fn.carouFredSel=function(options,configs){if(this.length==0)return debug(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){$(this).carouFredSel(options,configs)});var $cfs=this,$tt0=this[0],starting_position=!1;$cfs.data("_cfs_isCarousel")&&(starting_position=$cfs.triggerHandler("_cfs_triggerEvent","currentPosition"),$cfs.trigger("_cfs_triggerEvent",["destroy",!0]));var FN={};FN._init=function(e,t,n){e=go_getObject($tt0,e),e.items=go_getItemsObject($tt0,e.items),e.scroll=go_getScrollObject($tt0,e.scroll),e.auto=go_getAutoObject($tt0,e.auto),e.prev=go_getPrevNextObject($tt0,e.prev),e.next=go_getPrevNextObject($tt0,e.next),e.pagination=go_getPaginationObject($tt0,e.pagination),e.swipe=go_getSwipeObject($tt0,e.swipe),e.mousewheel=go_getMousewheelObject($tt0,e.mousewheel),t&&(opts_orig=$.extend(!0,{},$.fn.carouFredSel.defaults,e)),opts=$.extend(!0,{},$.fn.carouFredSel.defaults,e),opts.d=cf_getDimensions(opts),crsl.direction=opts.direction=="up"||opts.direction=="left"?"next":"prev";var r=$cfs.children(),i=ms_getParentSize($wrp,opts,"width");is_true(opts.cookie)&&(opts.cookie="caroufredsel_cookie_"+conf.serialNumber),opts.maxDimension=ms_getMaxDimension(opts,i),opts.items=in_complementItems(opts.items,opts,r,n),opts[opts.d.width]=in_complementPrimarySize(opts[opts.d.width],opts,r),opts[opts.d.height]=in_complementSecondarySize(opts[opts.d.height],opts,r),opts.responsive&&(is_percentage(opts[opts.d.width])||(opts[opts.d.width]="100%")),is_percentage(opts[opts.d.width])&&(crsl.upDateOnWindowResize=!0,crsl.primarySizePercentage=opts[opts.d.width],opts[opts.d.width]=ms_getPercentage(i,crsl.primarySizePercentage),opts.items.visible||(opts.items.visibleConf.variable=!0)),opts.responsive?(opts.usePadding=!1,opts.padding=[0,0,0,0],opts.align=!1,opts.items.visibleConf.variable=!1):(opts.items.visible||(opts=in_complementVisibleItems(opts,i)),opts[opts.d.width]||(!opts.items.visibleConf.variable&&is_number(opts.items[opts.d.width])&&opts.items.filter=="*"?(opts[opts.d.width]=opts.items.visible*opts.items[opts.d.width],opts.align=!1):opts[opts.d.width]="variable"),is_undefined(opts.align)&&(opts.align=is_number(opts[opts.d.width])?"center":!1),opts.items.visibleConf.variable&&(opts.items.visible=gn_getVisibleItemsNext(r,opts,0))),opts.items.filter!="*"&&!opts.items.visibleConf.variable&&(opts.items.visibleConf.org=opts.items.visible,opts.items.visible=gn_getVisibleItemsNextFilter(r,opts,0)),opts.items.visible=cf_getItemsAdjust(opts.items.visible,opts,opts.items.visibleConf.adjust,$tt0),opts.items.visibleConf.old=opts.items.visible;if(opts.responsive)opts.items.visibleConf.min||(opts.items.visibleConf.min=opts.items.visible),opts.items.visibleConf.max||(opts.items.visibleConf.max=opts.items.visible),opts=in_getResponsiveValues(opts,r,i);else{opts.padding=cf_getPadding(opts.padding),opts.align=="top"?opts.align="left":opts.align=="bottom"&&(opts.align="right");switch(opts.align){case"center":case"left":case"right":opts[opts.d["width"]]!="variable"&&(opts=in_getAlignPadding(opts,r),opts.usePadding=!0);break;default:opts.align=!1,opts.usePadding=opts.padding[0]==0&&opts.padding[1]==0&&opts.padding[2]==0&&opts.padding[3]==0?!1:!0}}is_number(opts.scroll.duration)||(opts.scroll.duration=500),is_undefined(opts.scroll.items)&&(opts.scroll.items=opts.responsive||opts.items.visibleConf.variable||opts.items.filter!="*"?"visible":opts.items.visible),opts.auto=$.extend(!0,{},opts.scroll,opts.auto),opts.prev=$.extend(!0,{},opts.scroll,opts.prev),opts.next=$.extend(!0,{},opts.scroll,opts.next),opts.pagination=$.extend(!0,{},opts.scroll,opts.pagination),opts.auto=go_complementAutoObject($tt0,opts.auto),opts.prev=go_complementPrevNextObject($tt0,opts.prev),opts.next=go_complementPrevNextObject($tt0,opts.next),opts.pagination=go_complementPaginationObject($tt0,opts.pagination),opts.swipe=go_complementSwipeObject($tt0,opts.swipe),opts.mousewheel=go_complementMousewheelObject($tt0,opts.mousewheel),opts.synchronise&&(opts.synchronise=cf_getSynchArr(opts.synchronise)),opts.auto.onPauseStart&&(opts.auto.onTimeoutStart=opts.auto.onPauseStart,deprecated("auto.onPauseStart","auto.onTimeoutStart")),opts.auto.onPausePause&&(opts.auto.onTimeoutPause=opts.auto.onPausePause,deprecated("auto.onPausePause","auto.onTimeoutPause")),opts.auto.onPauseEnd&&(opts.auto.onTimeoutEnd=opts.auto.onPauseEnd,deprecated("auto.onPauseEnd","auto.onTimeoutEnd")),opts.auto.pauseDuration&&(opts.auto.timeoutDuration=opts.auto.pauseDuration,deprecated("auto.pauseDuration","auto.timeoutDuration"))},FN._build=function(){$cfs.data("_cfs_isCarousel",!0);var e=$cfs.children(),t=in_mapCss($cfs,["textAlign","float","position","top","right","bottom","left","zIndex","width","height","marginTop","marginRight","marginBottom","marginLeft"]),n="relative";switch(t.position){case"absolute":case"fixed":n=t.position}conf.wrapper=="parent"?sz_storeOrigCss($wrp):$wrp.css(t),$wrp.css({overflow:"hidden",position:n}),sz_storeOrigCss($cfs),$cfs.data("_cfs_origCssZindex",t.zIndex),$cfs.css({textAlign:"left","float":"none",position:"absolute",top:0,right:"auto",bottom:"auto",left:0,marginTop:0,marginRight:0,marginBottom:0,marginLeft:0}),sz_storeMargin(e,opts),sz_storeOrigCss(e),opts.responsive&&sz_setResponsiveSizes(opts,e)},FN._bind_events=function(){FN._unbind_events(),$cfs.bind(cf_e("stop",conf),function(e,t){return e.stopPropagation(),crsl.isStopped||opts.auto.button&&opts.auto.button.addClass(cf_c("stopped",conf)),crsl.isStopped=!0,opts.auto.play&&(opts.auto.play=!1,$cfs.trigger(cf_e("pause",conf),t)),!0}),$cfs.bind(cf_e("finish",conf),function(e){return e.stopPropagation(),crsl.isScrolling&&sc_stopScroll(scrl),!0}),$cfs.bind(cf_e("pause",conf),function(e,t,n){e.stopPropagation(),tmrs=sc_clearTimers(tmrs);if(t&&crsl.isScrolling){scrl.isStopped=!0;var r=getTime()-scrl.startTime;scrl.duration-=r,scrl.pre&&(scrl.pre.duration-=r),scrl.post&&(scrl.post.duration-=r),sc_stopScroll(scrl,!1)}!crsl.isPaused&&!crsl.isScrolling&&n&&(tmrs.timePassed+=getTime()-tmrs.startTime),crsl.isPaused||opts.auto.button&&opts.auto.button.addClass(cf_c("paused",conf)),crsl.isPaused=!0;if(opts.auto.onTimeoutPause){var i=opts.auto.timeoutDuration-tmrs.timePassed,s=100-Math.ceil(i*100/opts.auto.timeoutDuration);opts.auto.onTimeoutPause.call($tt0,s,i)}return!0}),$cfs.bind(cf_e("play",conf),function(e,t,n,r){e.stopPropagation(),tmrs=sc_clearTimers(tmrs);var i=[t,n,r],s=["string","number","boolean"],o=cf_sortParams(i,s);t=o[0],n=o[1],r=o[2],t!="prev"&&t!="next"&&(t=crsl.direction),is_number(n)||(n=0),is_boolean(r)||(r=!1),r&&(crsl.isStopped=!1,opts.auto.play=!0);if(!opts.auto.play)return e.stopImmediatePropagation(),debug(conf,"Carousel stopped: Not scrolling.");crsl.isPaused&&opts.auto.button&&(opts.auto.button.removeClass(cf_c("stopped",conf)),opts.auto.button.removeClass(cf_c("paused",conf))),crsl.isPaused=!1,tmrs.startTime=getTime();var u=opts.auto.timeoutDuration+n;return dur2=u-tmrs.timePassed,perc=100-Math.ceil(dur2*100/u),opts.auto.progress&&(tmrs.progress=setInterval(function(){var e=getTime()-tmrs.startTime+tmrs.timePassed,t=Math.ceil(e*100/u);opts.auto.progress.updater.call(opts.auto.progress.bar[0],t)},opts.auto.progress.interval)),tmrs.auto=setTimeout(function(){opts.auto.progress&&opts.auto.progress.updater.call(opts.auto.progress.bar[0],100),opts.auto.onTimeoutEnd&&opts.auto.onTimeoutEnd.call($tt0,perc,dur2),crsl.isScrolling?$cfs.trigger(cf_e("play",conf),t):$cfs.trigger(cf_e(t,conf),opts.auto)},dur2),opts.auto.onTimeoutStart&&opts.auto.onTimeoutStart.call($tt0,perc,dur2),!0}),$cfs.bind(cf_e("resume",conf),function(e){return e.stopPropagation(),scrl.isStopped?(scrl.isStopped=!1,crsl.isPaused=!1,crsl.isScrolling=!0,scrl.startTime=getTime(),sc_startScroll(scrl,conf)):$cfs.trigger(cf_e("play",conf)),!0}),$cfs.bind(cf_e("prev",conf)+" "+cf_e("next",conf),function(e,obj,num,clb,que){e.stopPropagation();if(crsl.isStopped||$cfs.is(":hidden"))return e.stopImmediatePropagation(),debug(conf,"Carousel stopped or hidden: Not scrolling.");var minimum=is_number(opts.items.minimum)?opts.items.minimum:opts.items.visible+1;if(minimum>itms.total)return e.stopImmediatePropagation(),debug(conf,"Not enough items ("+itms.total+" total, "+minimum+" needed): Not scrolling.");var v=[obj,num,clb,que],t=["object","number/string","function","boolean"],a=cf_sortParams(v,t);obj=a[0],num=a[1],clb=a[2],que=a[3];var eType=e.type.slice(conf.events.prefix.length);if($(eval("opts."+eType+".button.selector")).hasClass("disabled"))return;is_object(obj)||(obj={}),is_function(clb)&&(obj.onAfter=clb),is_boolean(que)&&(obj.queue=que),obj=$.extend(!0,{},opts[eType],obj);if(obj.conditions&&!obj.conditions.call($tt0,eType))return e.stopImmediatePropagation(),debug(conf,'Callback "conditions" returned false.');if(!is_number(num)){if(opts.items.filter!="*")num="visible";else{var arr=[num,obj.items,opts[eType].items];for(var a=0,l=arr.length;a<l;a++)if(is_number(arr[a])||arr[a]=="page"||arr[a]=="visible"){num=arr[a];break}}switch(num){case"page":return e.stopImmediatePropagation(),$cfs.triggerHandler(cf_e(eType+"Page",conf),[obj,clb]);case"visible":!opts.items.visibleConf.variable&&opts.items.filter=="*"&&(num=opts.items.visible)}}if(scrl.isStopped)return $cfs.trigger(cf_e("resume",conf)),$cfs.trigger(cf_e("queue",conf),[eType,[obj,num,clb]]),e.stopImmediatePropagation(),debug(conf,"Carousel resumed scrolling.");if(obj.duration>0&&crsl.isScrolling)return obj.queue&&(obj.queue=="last"&&(queu=[]),(obj.queue!="first"||queu.length==0)&&$cfs.trigger(cf_e("queue",conf),[eType,[obj,num,clb]])),e.stopImmediatePropagation(),debug(conf,"Carousel currently scrolling.");tmrs.timePassed=0,$cfs.trigger(cf_e("slide_"+eType,conf),[obj,num]);if(opts.synchronise){var s=opts.synchronise,c=[obj,num];for(var j=0,l=s.length;j<l;j++){var d=eType;s[j][2]||(d=d=="prev"?"next":"prev"),s[j][1]||(c[0]=s[j][0].triggerHandler("_cfs_triggerEvent",["configuration",d])),c[1]=num+s[j][3],s[j][0].trigger("_cfs_triggerEvent",["slide_"+d,c])}}return!0}),$cfs.bind(cf_e("slide_prev",conf),function(e,t,n){e.stopPropagation();var r=$cfs.children();if(!opts.circular&&itms.first==0)return opts.infinite&&$cfs.trigger(cf_e("next",conf),itms.total-1),e.stopImmediatePropagation();sz_resetMargin(r,opts);if(!is_number(n)){if(opts.items.visibleConf.variable)n=gn_getVisibleItemsPrev(r,opts,itms.total-1);else if(opts.items.filter!="*"){var i=is_number(t.items)?t.items:gn_getVisibleOrg($cfs,opts);n=gn_getScrollItemsPrevFilter(r,opts,itms.total-1,i)}else n=opts.items.visible;n=cf_getAdjust(n,opts,t.items,$tt0)}opts.circular||itms.total-n<itms.first&&(n=itms.total-itms.first),opts.items.visibleConf.old=opts.items.visible;if(opts.items.visibleConf.variable){var s=cf_getItemsAdjust(gn_getVisibleItemsNext(r,opts,itms.total-n),opts,opts.items.visibleConf.adjust,$tt0);opts.items.visible+n<=s&&n<itms.total&&(n++,s=cf_getItemsAdjust(gn_getVisibleItemsNext(r,opts,itms.total-n),opts,opts.items.visibleConf.adjust,$tt0)),opts.items.visible=s}else if(opts.items.filter!="*"){var s=gn_getVisibleItemsNextFilter(r,opts,itms.total-n);opts.items.visible=cf_getItemsAdjust(s,opts,opts.items.visibleConf.adjust,$tt0)}sz_resetMargin(r,opts,!0);if(n==0)return e.stopImmediatePropagation(),debug(conf,"0 items to scroll: Not scrolling.");debug(conf,"Scrolling "+n+" items backward."),itms.first+=n,itms.last-=n;while(itms.first>=itms.total)itms.first-=itms.total;opts.circular||(itms.first==0&&t.onEnd&&t.onEnd.call($tt0,"prev"),opts.infinite||nv_enableNavi(opts,itms.first,conf)),$cfs.children().slice(itms.total-n,itms.total).prependTo($cfs),itms.total<opts.items.visible+n&&$cfs.children().slice(0,opts.items.visible+n-itms.total).clone(!0).appendTo($cfs);var r=$cfs.children(),o=gi_getOldItemsPrev(r,opts,n),u=gi_getNewItemsPrev(r,opts),a=r.eq(n-1),f=o.last(),l=u.last();sz_resetMargin(r,opts);var c=0,h=0;if(opts.align){var p=cf_getAlignPadding(u,opts);c=p[0],h=p[1]}var d=c<0?opts.padding[opts.d[3]]:0,v=!1,m=$();if(opts.items.visible<n){m=r.slice(opts.items.visibleConf.old,n);if(t.fx=="directscroll"){var g=opts.items[opts.d.width];v=m,a=l,sc_hideHiddenItems(v),opts.items[opts.d.width]="variable"}}var y=!1,b=ms_getTotalSize(r.slice(0,n),opts,"width"),w=cf_mapWrapperSizes(ms_getSizes(u,opts,!0),opts,!opts.usePadding),E=0,S={},x={},T={},N={},C={},k={},L={},A=sc_getDuration(t,opts,n,b);switch(t.fx){case"cover":case"cover-fade":E=ms_getTotalSize(r.slice(0,opts.items.visible),opts,"width")}v&&(opts.items[opts.d.width]=g),sz_resetMargin(r,opts,!0),h>=0&&sz_resetMargin(f,opts,opts.padding[opts.d[1]]),c>=0&&sz_resetMargin(a,opts,opts.padding[opts.d[3]]),opts.align&&(opts.padding[opts.d[1]]=h,opts.padding[opts.d[3]]=c),k[opts.d.left]=-(b-d),L[opts.d.left]=-(E-d),x[opts.d.left]=w[opts.d.width];var O=function(){},M=function(){},_=function(){},D=function(){},P=function(){},H=function(){},B=function(){},j=function(){},F=function(){},I=function(){},q=function(){};switch(t.fx){case"crossfade":case"cover":case"cover-fade":case"uncover":case"uncover-fade":y=$cfs.clone(!0).appendTo($wrp)}switch(t.fx){case"crossfade":case"uncover":case"uncover-fade":y.children().slice(0,n).remove(),y.children().slice(opts.items.visibleConf.old).remove();break;case"cover":case"cover-fade":y.children().slice(opts.items.visible).remove(),y.css(L)}$cfs.css(k),scrl=sc_setScroll(A,t.easing,conf),S[opts.d.left]=opts.usePadding?opts.padding[opts.d[3]]:0;if(opts[opts.d["width"]]=="variable"||opts[opts.d["height"]]=="variable")O=function(){$wrp.css(w)},M=function(){scrl.anims.push([$wrp,w])};if(opts.usePadding){l.not(a).length&&(T[opts.d.marginRight]=a.data("_cfs_origCssMargin"),c<0?a.css(T):(B=function(){a.css(T)},j=function(){scrl.anims.push([a,T])}));switch(t.fx){case"cover":case"cover-fade":y.children().eq(n-1).css(T)}l.not(f).length&&(N[opts.d.marginRight]=f.data("_cfs_origCssMargin"),_=function(){f.css(N)},D=function(){scrl.anims.push([f,N])}),h>=0&&(C[opts.d.marginRight]=l.data("_cfs_origCssMargin")+opts.padding[opts.d[1]],P=function(){l.css(C)},H=function(){scrl.anims.push([l,C])})}q=function(){$cfs.css(S)};var R=opts.items.visible+n-itms.total;I=function(){R>0&&($cfs.children().slice(itms.total).remove(),o=$($cfs.children().slice(itms.total-(opts.items.visible-R)).get().concat($cfs.children().slice(0,R).get()))),sc_showHiddenItems(v);if(opts.usePadding){var e=$cfs.children().eq(opts.items.visible+n-1);e.css(opts.d.marginRight,e.data("_cfs_origCssMargin"))}};var U=sc_mapCallbackArguments(o,m,u,n,"prev",A,w);F=function(){sc_afterScroll($cfs,y,t),crsl.isScrolling=!1,clbk.onAfter=sc_fireCallbacks($tt0,t,"onAfter",U,clbk),queu=sc_fireQueue($cfs,queu,conf),crsl.isPaused||$cfs.trigger(cf_e("play",conf))},crsl.isScrolling=!0,tmrs=sc_clearTimers(tmrs),clbk.onBefore=sc_fireCallbacks($tt0,t,"onBefore",U,clbk);switch(t.fx){case"none":$cfs.css(S),O(),_(),P(),B(),q(),I(),F();break;case"fade":scrl.anims.push([$cfs,{opacity:0},function(){O(),_(),P(),B(),q(),I(),scrl=sc_setScroll(A,t.easing,conf),scrl.anims.push([$cfs,{opacity:1},F]),sc_startScroll(scrl,conf)}]);break;case"crossfade":$cfs.css({opacity:0}),scrl.anims.push([y,{opacity:0}]),scrl.anims.push([$cfs,{opacity:1},F]),M(),_(),P(),B(),q(),I();break;case"cover":scrl.anims.push([y,S,function(){_(),P(),B(),q(),I(),F()}]),M();break;case"cover-fade":scrl.anims.push([$cfs,{opacity:0}]),scrl.anims.push([y,S,function(){_(),P(),B(),q(),I(),F()}]),M();break;case"uncover":scrl.anims.push([y,x,F]),M(),_(),P(),B(),q(),I();break;case"uncover-fade":$cfs.css({opacity:0}),scrl.anims.push([$cfs,{opacity:1}]),scrl.anims.push([y,x,F]),M(),_(),P(),B(),q(),I();break;default:scrl.anims.push([$cfs,S,function(){I(),F()}]),M(),D(),H(),j()}return sc_startScroll(scrl,conf),cf_setCookie(opts.cookie,$cfs,conf),$cfs.trigger(cf_e("updatePageStatus",conf),[!1,w]),!0}),$cfs.bind(cf_e("slide_next",conf),function(e,t,n){e.stopPropagation();var r=$cfs.children();if(!opts.circular&&itms.first==opts.items.visible)return opts.infinite&&$cfs.trigger(cf_e("prev",conf),itms.total-1),e.stopImmediatePropagation();sz_resetMargin(r,opts);if(!is_number(n)){if(opts.items.filter!="*"){var i=is_number(t.items)?t.items:gn_getVisibleOrg($cfs,opts);n=gn_getScrollItemsNextFilter(r,opts,0,i)}else n=opts.items.visible;n=cf_getAdjust(n,opts,t.items,$tt0)}var s=itms.first==0?itms.total:itms.first;if(!opts.circular){if(opts.items.visibleConf.variable)var o=gn_getVisibleItemsNext(r,opts,n),i=gn_getVisibleItemsPrev(r,opts,s-1);else var o=opts.items.visible,i=opts.items.visible;n+o>s&&(n=s-i)}opts.items.visibleConf.old=opts.items.visible;if(opts.items.visibleConf.variable){var o=cf_getItemsAdjust(gn_getVisibleItemsNextTestCircular(r,opts,n,s),opts,opts.items.visibleConf.adjust,$tt0);while(opts.items.visible-n>=o&&n<itms.total)n++,o=cf_getItemsAdjust(gn_getVisibleItemsNextTestCircular(r,opts,n,s),opts,opts.items.visibleConf.adjust,$tt0);opts.items.visible=o}else if(opts.items.filter!="*"){var o=gn_getVisibleItemsNextFilter(r,opts,n);opts.items.visible=cf_getItemsAdjust(o,opts,opts.items.visibleConf.adjust,$tt0)}sz_resetMargin(r,opts,!0);if(n==0)return e.stopImmediatePropagation(),debug(conf,"0 items to scroll: Not scrolling.");debug(conf,"Scrolling "+n+" items forward."),itms.first-=n;while(itms.first<0)itms.first+=itms.total;opts.circular||(itms.first==opts.items.visible&&t.onEnd&&t.onEnd.call($tt0,"next"),opts.infinite||nv_enableNavi(opts,itms.first,conf)),itms.total<opts.items.visible+n&&$cfs.children().slice(0,opts.items.visible+n-itms.total).clone(!0).appendTo($cfs);var r=$cfs.children(),u=gi_getOldItemsNext(r,opts),a=gi_getNewItemsNext(r,opts,n),f=r.eq(n-1),l=u.last(),c=a.last();sz_resetMargin(r,opts);var h=0,p=0;if(opts.align){var d=cf_getAlignPadding(a,opts);h=d[0],p=d[1]}var v=!1,m=$();if(opts.items.visibleConf.old<n){m=r.slice(opts.items.visibleConf.old,n);if(t.fx=="directscroll"){var g=opts.items[opts.d.width];v=m,f=l,sc_hideHiddenItems(v),opts.items[opts.d.width]="variable"}}var y=!1,b=ms_getTotalSize(r.slice(0,n),opts,"width"),w=cf_mapWrapperSizes(ms_getSizes(a,opts,!0),opts,!opts.usePadding),E=0,S={},x={},T={},N={},C={},k=sc_getDuration(t,opts,n,b);switch(t.fx){case"uncover":case"uncover-fade":E=ms_getTotalSize(r.slice(0,opts.items.visibleConf.old),opts,"width")}v&&(opts.items[opts.d.width]=g),opts.align&&opts.padding[opts.d[1]]<0&&(opts.padding[opts.d[1]]=0),sz_resetMargin(r,opts,!0),sz_resetMargin(l,opts,opts.padding[opts.d[1]]),opts.align&&(opts.padding[opts.d[1]]=p,opts.padding[opts.d[3]]=h),C[opts.d.left]=opts.usePadding?opts.padding[opts.d[3]]:0;var L=function(){},A=function(){},O=function(){},M=function(){},_=function(){},D=function(){},P=function(){},H=function(){},B=function(){};switch(t.fx){case"crossfade":case"cover":case"cover-fade":case"uncover":case"uncover-fade":y=$cfs.clone(!0).appendTo($wrp),y.children().slice(opts.items.visibleConf.old).remove()}switch(t.fx){case"crossfade":case"cover":case"cover-fade":$cfs.css("zIndex",1),y.css("zIndex",0)}scrl=sc_setScroll(k,t.easing,conf),S[opts.d.left]=-b,x[opts.d.left]=-E,h<0&&(S[opts.d.left]+=h);if(opts[opts.d["width"]]=="variable"||opts[opts.d["height"]]=="variable")L=function(){$wrp.css(w)},A=function(){scrl.anims.push([$wrp,w])};if(opts.usePadding){var j=c.data("_cfs_origCssMargin");p>=0&&(j+=opts.padding[opts.d[1]]),c.css(opts.d.marginRight,j),f.not(l).length&&(N[opts.d.marginRight]=l.data("_cfs_origCssMargin")),O=function(){l.css(N)},M=function(){scrl.anims.push([l,N])};var F=f.data("_cfs_origCssMargin");h>0&&(F+=opts.padding[opts.d[3]]),T[opts.d.marginRight]=F,_=function(){f.css(T)},D=function(){scrl.anims.push([f,T])}}B=function(){$cfs.css(C)};var I=opts.items.visible+n-itms.total;H=function(){I>0&&$cfs.children().slice(itms.total).remove();var e=$cfs.children().slice(0,n).appendTo($cfs).last();I>0&&(a=gi_getCurrentItems(r,opts)),sc_showHiddenItems(v);if(opts.usePadding){if(itms.total<opts.items.visible+n){var t=$cfs.children().eq(opts.items.visible-1);t.css(opts.d.marginRight,t.data("_cfs_origCssMargin")+opts.padding[opts.d[1]])}e.css(opts.d.marginRight,e.data("_cfs_origCssMargin"))}};var q=sc_mapCallbackArguments(u,m,a,n,"next",k,w);P=function(){$cfs.css("zIndex",$cfs.data("_cfs_origCssZindex")),sc_afterScroll($cfs,y,t),crsl.isScrolling=!1,clbk.onAfter=sc_fireCallbacks($tt0,t,"onAfter",q,clbk),queu=sc_fireQueue($cfs,queu,conf),crsl.isPaused||$cfs.trigger(cf_e("play",conf))},crsl.isScrolling=!0,tmrs=sc_clearTimers(tmrs),clbk.onBefore=sc_fireCallbacks($tt0,t,"onBefore",q,clbk);switch(t.fx){case"none":$cfs.css(S),L(),O(),_(),B(),H(),P();break;case"fade":scrl.anims.push([$cfs,{opacity:0},function(){L(),O(),_(),B(),H(),scrl=sc_setScroll(k,t.easing,conf),scrl.anims.push([$cfs,{opacity:1},P]),sc_startScroll(scrl,conf)}]);break;case"crossfade":$cfs.css({opacity:0}),scrl.anims.push([y,{opacity:0}]),scrl.anims.push([$cfs,{opacity:1},P]),A(),O(),_(),B(),H();break;case"cover":$cfs.css(opts.d.left,$wrp[opts.d.width]()),scrl.anims.push([$cfs,C,P]),A(),O(),_(),H();break;case"cover-fade":$cfs.css(opts.d.left,$wrp[opts.d.width]()),scrl.anims.push([y,{opacity:0}]),scrl.anims.push([$cfs,C,P]),A(),O(),_(),H();break;case"uncover":scrl.anims.push([y,x,P]),A(),O(),_(),B(),H();break;case"uncover-fade":$cfs.css({opacity:0}),scrl.anims.push([$cfs,{opacity:1}]),scrl.anims.push([y,x,P]),A(),O(),_(),B(),H();break;default:scrl.anims.push([$cfs,S,function(){B(),H(),P()}]),A(),M(),D()}return sc_startScroll(scrl,conf),cf_setCookie(opts.cookie,$cfs,conf),$cfs.trigger(cf_e("updatePageStatus",conf),[!1,w]),!0}),$cfs.bind(cf_e("slideTo",conf),function(e,t,n,r,i,s,o){e.stopPropagation();var u=[t,n,r,i,s,o],a=["string/number/object","number","boolean","object","string","function"],f=cf_sortParams(u,a);return i=f[3],s=f[4],o=f[5],t=gn_getItemIndex(f[0],f[1],f[2],itms,$cfs),t==0?!1:(is_object(i)||(i=!1),s!="prev"&&s!="next"&&(opts.circular?s=t<=itms.total/2?"next":"prev":s=itms.first==0||itms.first>t?"next":"prev"),s=="prev"&&(t=itms.total-t),$cfs.trigger(cf_e(s,conf),[i,t,o]),!0)}),$cfs.bind(cf_e("prevPage",conf),function(e,t,n){e.stopPropagation();var r=$cfs.triggerHandler(cf_e("currentPage",conf));return $cfs.triggerHandler(cf_e("slideToPage",conf),[r-1,t,"prev",n])}),$cfs.bind(cf_e("nextPage",conf),function(e,t,n){e.stopPropagation();var r=$cfs.triggerHandler(cf_e("currentPage",conf));return $cfs.triggerHandler(cf_e("slideToPage",conf),[r+1,t,"next",n])}),$cfs.bind(cf_e("slideToPage",conf),function(e,t,n,r,i){e.stopPropagation(),is_number(t)||(t=$cfs.triggerHandler(cf_e("currentPage",conf)));var s=opts.pagination.items||opts.items.visible,o=Math.ceil(itms.total/s)-1;return t<0&&(t=o),t>o&&(t=0),$cfs.triggerHandler(cf_e("slideTo",conf),[t*s,0,!0,n,r,i])}),$cfs.bind(cf_e("jumpToStart",conf),function(e,t){e.stopPropagation(),t?t=gn_getItemIndex(t,0,!0,itms,$cfs):t=0,t+=itms.first;if(t!=0){if(itms.total>0)while(t>itms.total)t-=itms.total;$cfs.prepend($cfs.children().slice(t,itms.total))}return!0}),$cfs.bind(cf_e("synchronise",conf),function(e,t){e.stopPropagation();if(t)t=cf_getSynchArr(t);else{if(!opts.synchronise)return debug(conf,"No carousel to synchronise.");t=opts.synchronise}var n=$cfs.triggerHandler(cf_e("currentPosition",conf)),r=!0;for(var i=0,s=t.length;i<s;i++)t[i][0].triggerHandler(cf_e("slideTo",conf),[n,t[i][3],!0])||(r=!1);return r}),$cfs.bind(cf_e("queue",conf),function(e,t,n){return e.stopPropagation(),is_function(t)?t.call($tt0,queu):is_array(t)?queu=t:is_undefined(t)||queu.push([t,n]),queu}),$cfs.bind(cf_e("insertItem",conf),function(e,t,n,r,i){e.stopPropagation();var s=[t,n,r,i],o=["string/object","string/number/object","boolean","number"],u=cf_sortParams(s,o);t=u[0],n=u[1],r=u[2],i=u[3],is_object(t)&&!is_jquery(t)?t=$(t):is_string(t)&&(t=$(t));if(!is_jquery(t)||t.length==0)return debug(conf,"Not a valid object.");is_undefined(n)&&(n="end"),sz_storeMargin(t,opts),sz_storeOrigCss(t);var a=n,f="before";n=="end"?r?(itms.first==0?(n=itms.total-1,f="after"):(n=itms.first,itms.first+=t.length),n<0&&(n=0)):(n=itms.total-1,f="after"):n=gn_getItemIndex(n,i,r,itms,$cfs);var l=$cfs.children().eq(n);return l.length?l[f](t):(debug(conf,"Correct insert-position not found! Appending item to the end."),$cfs.append(t)),a!="end"&&!r&&n<itms.first&&(itms.first+=t.length),itms.total=$cfs.children().length,itms.first>=itms.total&&(itms.first-=itms.total),$cfs.trigger(cf_e("updateSizes",conf)),$cfs.trigger(cf_e("linkAnchors",conf)),!0}),$cfs.bind(cf_e("removeItem",conf),function(e,t,n,r){e.stopPropagation();var i=[t,n,r],s=["string/number/object","boolean","number"],o=cf_sortParams(i,s);t=o[0],n=o[1],r=o[2];var u=!1;if(t instanceof $&&t.length>1)return a=$(),t.each(function(e,t){var i=$cfs.trigger(cf_e("removeItem",conf),[$(this),n,r]);i&&(a=a.add(i))}),a;if(is_undefined(t)||t=="end")a=$cfs.children().last();else{t=gn_getItemIndex(t,r,n,itms,$cfs);var a=$cfs.children().eq(t);a.length&&t<itms.first&&(itms.first-=a.length)}return a&&a.length&&(a.detach(),itms.total=$cfs.children().length,$cfs.trigger(cf_e("updateSizes",conf))),a}),$cfs.bind(cf_e("onBefore",conf)+" "+cf_e("onAfter",conf),function(e,t){e.stopPropagation();var n=e.type.slice(conf.events.prefix.length);return is_array(t)&&(clbk[n]=t),is_function(t)&&clbk[n].push(t),clbk[n]}),$cfs.bind(cf_e("currentPosition",conf),function(e,t){e.stopPropagation();if(itms.first==0)var n=0;else var n=itms.total-itms.first;return is_function(t)&&t.call($tt0,n),n}),$cfs.bind(cf_e("currentPage",conf),function(e,t){e.stopPropagation();var n=opts.pagination.items||opts.items.visible,r=Math.ceil(itms.total/n-1),i;return itms.first==0?i=0:itms.first<itms.total%n?i=0:itms.first==n&&!opts.circular?i=r:i=Math.round((itms.total-itms.first)/n),i<0&&(i=0),i>r&&(i=r),is_function(t)&&t.call($tt0,i),i}),$cfs.bind(cf_e("currentVisible",conf),function(e,t){e.stopPropagation();var n=gi_getCurrentItems($cfs.children(),opts);return is_function(t)&&t.call($tt0,n),n}),$cfs.bind(cf_e("slice",conf),function(e,t,n,r){e.stopPropagation();if(itms.total==0)return!1;var i=[t,n,r],s=["number","number","function"],o=cf_sortParams(i,s);t=is_number(o[0])?o[0]:0,n=is_number(o[1])?o[1]:itms.total,r=o[2],t+=itms.first,n+=itms.first;if(items.total>0){while(t>itms.total)t-=itms.total;while(n>itms.total)n-=itms.total;while(t<0)t+=itms.total;while(n<0)n+=itms.total}var u=$cfs.children(),a;return n>t?a=u.slice(t,n):a=$(u.slice(t,itms.total).get().concat(u.slice(0,n).get())),is_function(r)&&r.call($tt0,a),a}),$cfs.bind(cf_e("isPaused",conf)+" "+cf_e("isStopped",conf)+" "+cf_e("isScrolling",conf),function(e,t){e.stopPropagation();var n=e.type.slice(conf.events.prefix.length),r=crsl[n];return is_function(t)&&t.call($tt0,r),r}),$cfs.bind(cf_e("configuration",conf),function(e,a,b,c){e.stopPropagation();var reInit=!1;if(is_function(a))a.call($tt0,opts);else if(is_object(a))opts_orig=$.extend(!0,{},opts_orig,a),b!==!1?reInit=!0:opts=$.extend(!0,{},opts,a);else if(!is_undefined(a))if(is_function(b)){var val=eval("opts."+a);is_undefined(val)&&(val=""),b.call($tt0,val)}else{if(!!is_undefined(b))return eval("opts."+a);typeof c!="boolean"&&(c=!0),eval("opts_orig."+a+" = b"),c!==!1?reInit=!0:eval("opts."+a+" = b")}if(reInit){sz_resetMargin($cfs.children(),opts),FN._init(opts_orig),FN._bind_buttons();var sz=sz_setSizes($cfs,opts);$cfs.trigger(cf_e("updatePageStatus",conf),[!0,sz])}return opts}),$cfs.bind(cf_e("linkAnchors",conf),function(e,t,n){return e.stopPropagation(),is_undefined(t)?t=$("body"):is_string(t)&&(t=$(t)),!is_jquery(t)||t.length==0?debug(conf,"Not a valid object."):(is_string(n)||(n="a.caroufredsel"),t.find(n).each(function(){var e=this.hash||"";e.length>0&&$cfs.children().index($(e))!=-1&&$(this).unbind("click").click(function(t){t.preventDefault(),$cfs.trigger(cf_e("slideTo",conf),e)})}),!0)}),$cfs.bind(cf_e("updatePageStatus",conf),function(e,t,n){e.stopPropagation();if(!opts.pagination.container)return;var r=opts.pagination.items||opts.items.visible,i=Math.ceil(itms.total/r);t&&(opts.pagination.anchorBuilder&&(opts.pagination.container.children().remove(),opts.pagination.container.each(function(){for(var e=0;e<i;e++){var t=$cfs.children().eq(gn_getItemIndex(e*r,0,!0,itms,$cfs));$(this).append(opts.pagination.anchorBuilder.call(t[0],e+1))}})),opts.pagination.container.each(function(){$(this).children().unbind(opts.pagination.event).each(function(e){$(this).bind(opts.pagination.event,function(t){t.preventDefault(),$cfs.trigger(cf_e("slideTo",conf),[e*r,-opts.pagination.deviation,!0,opts.pagination])})})}));var s=$cfs.triggerHandler(cf_e("currentPage",conf))+opts.pagination.deviation;return s>=i&&(s=0),s<0&&(s=i-1),opts.pagination.container.each(function(){$(this).children().removeClass(cf_c("selected",conf)).eq(s).addClass(cf_c("selected",conf))}),!0}),$cfs.bind(cf_e("updateSizes",conf),function(e){var t=opts.items.visible,n=$cfs.children(),r=ms_getParentSize($wrp,opts,"width");itms.total=n.length,crsl.primarySizePercentage?(opts.maxDimension=r,opts[opts.d.width]=ms_getPercentage(r,crsl.primarySizePercentage)):opts.maxDimension=ms_getMaxDimension(opts,r),opts.responsive?(opts.items.width=opts.items.sizesConf.width,opts.items.height=opts.items.sizesConf.height,opts=in_getResponsiveValues(opts,n,r),t=opts.items.visible,sz_setResponsiveSizes(opts,n)):opts.items.visibleConf.variable?t=gn_getVisibleItemsNext(n,opts,0):opts.items.filter!="*"&&(t=gn_getVisibleItemsNextFilter(n,opts,0));if(!opts.circular&&itms.first!=0&&t>itms.first){if(opts.items.visibleConf.variable)var i=gn_getVisibleItemsPrev(n,opts,itms.first)-itms.first;else if(opts.items.filter!="*")var i=gn_getVisibleItemsPrevFilter(n,opts,itms.first)-itms.first;else var i=opts.items.visible-itms.first;debug(conf,"Preventing non-circular: sliding "+i+" items backward."),$cfs.trigger(cf_e("prev",conf),i)}opts.items.visible=cf_getItemsAdjust(t,opts,opts.items.visibleConf.adjust,$tt0),opts.items.visibleConf.old=opts.items.visible,opts=in_getAlignPadding(opts,n);var s=sz_setSizes($cfs,opts);return $cfs.trigger(cf_e("updatePageStatus",conf),[!0,s]),nv_showNavi(opts,itms.total,conf),nv_enableNavi(opts,itms.first,conf),s}),$cfs.bind(cf_e("destroy",conf),function(e,t){return e.stopPropagation(),tmrs=sc_clearTimers(tmrs),$cfs.data("_cfs_isCarousel",!1),$cfs.trigger(cf_e("finish",conf)),t&&$cfs.trigger(cf_e("jumpToStart",conf)),sz_restoreOrigCss($cfs.children()),sz_restoreOrigCss($cfs),FN._unbind_events(),FN._unbind_buttons(),conf.wrapper=="parent"?sz_restoreOrigCss($wrp):$wrp.replaceWith($cfs),!0}),$cfs.bind(cf_e("debug",conf),function(e){return debug(conf,"Carousel width: "+opts.width),debug(conf,"Carousel height: "+opts.height),debug(conf,"Item widths: "+opts.items.width),debug(conf,"Item heights: "+opts.items.height),debug(conf,"Number of items visible: "+opts.items.visible),opts.auto.play&&debug(conf,"Number of items scrolled automatically: "+opts.auto.items),opts.prev.button&&debug(conf,"Number of items scrolled backward: "+opts.prev.items),opts.next.button&&debug(conf,"Number of items scrolled forward: "+opts.next.items),conf.debug}),$cfs.bind("_cfs_triggerEvent",function(e,t,n){return e.stopPropagation(),$cfs.triggerHandler(cf_e(t,conf),n)})},FN._unbind_events=function(){$cfs.unbind(cf_e("",conf)),$cfs.unbind(cf_e("",conf,!1)),$cfs.unbind("_cfs_triggerEvent")},FN._bind_buttons=function(){FN._unbind_buttons(),nv_showNavi(opts,itms.total,conf),nv_enableNavi(opts,itms.first,conf);if(opts.auto.pauseOnHover){var e=bt_pauseOnHoverConfig(opts.auto.pauseOnHover);$wrp.bind(cf_e("mouseenter",conf,!1),function(){$cfs.trigger(cf_e("pause",conf),e)}).bind(cf_e("mouseleave",conf,!1),function(){$cfs.trigger(cf_e("resume",conf))})}opts.auto.button&&opts.auto.button.bind(cf_e(opts.auto.event,conf,!1),function(e){e.preventDefault();var t=!1,n=null;crsl.isPaused?t="play":opts.auto.pauseOnEvent&&(t="pause",n=bt_pauseOnHoverConfig(opts.auto.pauseOnEvent)),t&&$cfs.trigger(cf_e(t,conf),n)});if(opts.prev.button){opts.prev.button.bind(cf_e(opts.prev.event,conf,!1),function(e){e.preventDefault(),$cfs.trigger(cf_e("prev",conf))});if(opts.prev.pauseOnHover){var e=bt_pauseOnHoverConfig(opts.prev.pauseOnHover);opts.prev.button.bind(cf_e("mouseenter",conf,!1),function(){$cfs.trigger(cf_e("pause",conf),e)}).bind(cf_e("mouseleave",conf,!1),function(){$cfs.trigger(cf_e("resume",conf))})}}if(opts.next.button){opts.next.button.bind(cf_e(opts.next.event,conf,!1),function(e){e.preventDefault(),$cfs.trigger(cf_e("next",conf))});if(opts.next.pauseOnHover){var e=bt_pauseOnHoverConfig(opts.next.pauseOnHover);opts.next.button.bind(cf_e("mouseenter",conf,!1),function(){$cfs.trigger(cf_e("pause",conf),e)}).bind(cf_e("mouseleave",conf,!1),function(){$cfs.trigger(cf_e("resume",conf))})}}if(opts.pagination.container&&opts.pagination.pauseOnHover){var e=bt_pauseOnHoverConfig(opts.pagination.pauseOnHover);opts.pagination.container.bind(cf_e("mouseenter",conf,!1),function(){$cfs.trigger(cf_e("pause",conf),e)}).bind(cf_e("mouseleave",conf,!1),function(){$cfs.trigger(cf_e("resume",conf))})}(opts.prev.key||opts.next.key)&&$(document).bind(cf_e("keyup",conf,!1,!0,!0),function(e){var t=e.keyCode;t==opts.next.key&&(e.preventDefault(),$cfs.trigger(cf_e("next",conf))),t==opts.prev.key&&(e.preventDefault(),$cfs.trigger(cf_e("prev",conf)))}),opts.pagination.keys&&$(document).bind(cf_e("keyup",conf,!1,!0,!0),function(e){var t=e.keyCode;t>=49&&t<58&&(t=(t-49)*opts.items.visible,t<=itms.total&&(e.preventDefault(),$cfs.trigger(cf_e("slideTo",conf),[t,0,!0,opts.pagination])))});if($.fn.swipe){var t="ontouchstart"in window;if(t&&opts.swipe.onTouch||!t&&opts.swipe.onMouse){var n=$.extend(!0,{},opts.prev,opts.swipe),r=$.extend(!0,{},opts.next,opts.swipe),i=function(){$cfs.trigger(cf_e("prev",conf),[n])},s=function(){$cfs.trigger(cf_e("next",conf),[r])};switch(opts.direction){case"up":case"down":opts.swipe.options.swipeUp=s,opts.swipe.options.swipeDown=i;break;default:opts.swipe.options.swipeLeft=s,opts.swipe.options.swipeRight=i}crsl.swipe&&$cfs.swipe("destroy"),$wrp.swipe(opts.swipe.options),$wrp.css("cursor","move"),crsl.swipe=!0}}if($.fn.mousewheel&&opts.mousewheel){var o=$.extend(!0,{},opts.prev,opts.mousewheel),u=$.extend(!0,{},opts.next,opts.mousewheel);crsl.mousewheel&&$wrp.unbind(cf_e("mousewheel",conf,!1)),$wrp.bind(cf_e("mousewheel",conf,!1),function(e,t){e.preventDefault(),t>0?$cfs.trigger(cf_e("prev",conf),[o]):$cfs.trigger(cf_e("next",conf),[u])}),crsl.mousewheel=!0}opts.auto.play&&$cfs.trigger(cf_e("play",conf),opts.auto.delay);if(crsl.upDateOnWindowResize){var a=function(e){$cfs.trigger(cf_e("finish",conf)),opts.auto.pauseOnResize&&!crsl.isPaused&&$cfs.trigger(cf_e("play",conf)),sz_resetMargin($cfs.children(),opts),$cfs.trigger(cf_e("updateSizes",conf))},f=$(window),l=null;if($.debounce&&conf.onWindowResize=="debounce")l=$.debounce(200,a);else if($.throttle&&conf.onWindowResize=="throttle")l=$.throttle(300,a);else{var c=0,h=0;l=function(){var e=f.width(),t=f.height();if(e!=c||t!=h)a(),c=e,h=t}}f.bind(cf_e("resize",conf,!1,!0,!0),l)}},FN._unbind_buttons=function(){var e=cf_e("",conf),t=cf_e("",conf,!1);ns3=cf_e("",conf,!1,!0,!0),$(document).unbind(ns3),$(window).unbind(ns3),$wrp.unbind(t),opts.auto.button&&opts.auto.button.unbind(t),opts.prev.button&&opts.prev.button.unbind(t),opts.next.button&&opts.next.button.unbind(t),opts.pagination.container&&(opts.pagination.container.unbind(t),opts.pagination.anchorBuilder&&opts.pagination.container.children().remove()),crsl.swipe&&($cfs.swipe("destroy"),$wrp.css("cursor","default"),crsl.swipe=!1),crsl.mousewheel&&(crsl.mousewheel=!1),nv_showNavi(opts,"hide",conf),nv_enableNavi(opts,"removeClass",conf)},is_boolean(configs)&&(configs={debug:configs});var crsl={direction:"next",isPaused:!0,isScrolling:!1,isStopped:!1,mousewheel:!1,swipe:!1},itms={total:$cfs.children().length,first:0,last:$cfs.children().length-1},tmrs={auto:null,progress:null,startTime:getTime(),timePassed:0},scrl={isStopped:!1,duration:0,startTime:0,easing:"",anims:[]},clbk={onBefore:[],onAfter:[]},queu=[],conf=$.extend(!0,{},$.fn.carouFredSel.configs,configs),opts={},opts_orig=$.extend(!0,{},options),$wrp=conf.wrapper=="parent"?$cfs.parent():$cfs.wrap("<"+conf.wrapper.element+' class="'+conf.wrapper.classname+'" />').parent();conf.selector=$cfs.selector,conf.serialNumber=$.fn.carouFredSel.serialNumber++,conf.transition=conf.transition&&$.fn.transition?"transition":"animate",FN._init(opts_orig,!0,starting_position),FN._build(),FN._bind_events(),FN._bind_buttons();if(is_array(opts.items.start))var start_arr=opts.items.start;else{var start_arr=[];opts.items.start!=0&&start_arr.push(opts.items.start)}opts.cookie&&start_arr.unshift(parseInt(cf_getCookie(opts.cookie),10));if(start_arr.length>0)for(var a=0,l=start_arr.length;a<l;a++){var s=start_arr[a];if(s==0)continue;if(s===!0){s=window.location.hash;if(s.length<1)continue}else s==="random"&&(s=Math.floor(Math.random()*itms.total));if($cfs.triggerHandler(cf_e("slideTo",conf),[s,0,!0,{fx:"none"}]))break}var siz=sz_setSizes($cfs,opts),itm=gi_getCurrentItems($cfs.children(),opts);return opts.onCreate&&opts.onCreate.call($tt0,{width:siz.width,height:siz.height,items:itm}),$cfs.trigger(cf_e("updatePageStatus",conf),[!0,siz]),$cfs.trigger(cf_e("linkAnchors",conf)),conf.debug&&$cfs.trigger(cf_e("debug",conf)),$cfs},$.fn.carouFredSel.serialNumber=1,$.fn.carouFredSel.defaults={synchronise:!1,infinite:!0,circular:!0,responsive:!1,direction:"left",visibleItemCount:0,items:{start:0},scroll:{easing:"swing",duration:500,pauseOnHover:!1,event:"click",queue:!1}},$.fn.carouFredSel.configs={debug:!1,transition:!1,onWindowResize:"throttle",events:{prefix:"",namespace:"cfs"},wrapper:{element:"div",classname:"caroufredsel_wrapper"},classnames:{}},$.fn.carouFredSel.pageAnchorBuilder=function(e){return'<a href="#"><span>'+e+"</span></a>"},$.fn.carouFredSel.progressbarUpdater=function(e){$(this).css("width",e+"%")},$.fn.carouFredSel.cookie={get:function(e){e+="=";var t=document.cookie.split(";");for(var n=0,r=t.length;n<r;n++){var i=t[n];while(i.charAt(0)==" ")i=i.slice(1);if(i.indexOf(e)==0)return i.slice(e.length)}return 0},set:function(e,t,n){var r="";if(n){var i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3),r="; expires="+i.toGMTString()}document.cookie=e+"="+t+r+"; path=/"},remove:function(e){$.fn.carouFredSel.cookie.set(e,"",-1)}},$.extend($.easing,{quadratic:function(e){var t=e*e;return e*(-t*e+4*t-6*e+4)},cubic:function(e){return e*(4*e*e-9*e+6)},elastic:function(e){var t=e*e;return e*(33*t*t-106*t*e+126*t-67*e+15)}})}(jQuery),define("external/jquery.carouFredSel-6.2.1",function(){}),Stopwatch.prototype.start=function(e){e||(this.startTime=0,this.curTime=0),this.timer&&this.stop(),this.timer=setInterval(this._updateTime,1e3,this)},Stopwatch.prototype.resume=function(){this.start(!0)},Stopwatch.prototype.stop=function(){clearInterval(this.timer)},Stopwatch.prototype.reset=function(e){this.stop(),this.startTime=0,this.endTime=0,this.timer=0,this.startTime=0,e.startTime?(this.curTime=e.startTime,this.start(!0)):(this.curTime=0,this.start())},Stopwatch.prototype._updateTime=function(e){e.curTime++,e.callback(e.getTime())},Stopwatch.prototype.getHours=function(){var e=this.curTime-this.startTime,t=Math.floor(e/3600);return t},Stopwatch.prototype.getMins=function(){var e=this.curTime-this.startTime,t=Math.floor(e%3600/60);return t},Stopwatch.prototype.getSecs=function(){var e=this.curTime-this.startTime,t=Math.floor(e%60);return t},Stopwatch.prototype.getRawTime=function(){var e=this.curTime-this.startTime;return e},Stopwatch.prototype.getTime=function(){var e=this.getHours(),t=this.getMins(),n=this.getSecs();e=t<=9?"0"+e:e,t=t<=9?"0"+t:t,n=n<=9?"0"+n:n;var r=e+":"+t+":"+n;return r},Stopwatch.prototype.destroy=function(){this.stop(),delete this},define("external/stopwatch",function(){}),define("core/model/fibDropDownVO",[],function(){var e=Backbone.Model.extend({id:"",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",attemptMethod:"",heading:[],partialAttempt:!0,feedback:[],activityMedia:""});return e});var SpinningWheel={cellHeight:44,friction:.003,slotData:[],handleEvent:function(e){e.type=="touchstart"?(this.lockScreen(e),DEVICE_TYPE!=DEVICE_IPAD?e.currentTarget.id=="sw-cancel"||e.currentTarget.id=="sw-done"?this.tapDown(e):e.currentTarget.id=="sw-frame"&&this.scrollStart(e):e.currentTarget.id=="sw-wrapper-overlay"?this.tapUp(e):e.currentTarget.id=="sw-frame"&&this.scrollStart(e)):e.type=="touchmove"?(this.lockScreen(e),e.currentTarget.id=="sw-cancel"||e.currentTarget.id=="sw-done"?this.tapCancel(e):e.currentTarget.id=="sw-frame"&&this.scrollMove(e)):e.type=="touchend"?DEVICE_TYPE==DEVICE_IPAD?e.currentTarget.id=="sw-wrapper-overlay"?this.tapUp(e):e.currentTarget.id=="sw-frame"&&this.scrollEnd(e):e.currentTarget.id=="sw-cancel"||e.currentTarget.id=="sw-done"?this.tapUp(e):e.currentTarget.id=="sw-frame"&&this.scrollEnd(e):e.type=="webkitTransitionEnd"?e.target.id=="sw-wrapper"?this.destroy():this.backWithinBoundaries(e):e.type=="orientationchange"?this.onOrientationChange(e):e.type=="scroll"&&this.onScroll(e)},onOrientationChange:function(e){window.scrollTo(0,0),DEVICE_TYPE==DEVICE_IPAD?this.swWrapper.style.top="50%":this.swWrapper.style.top=window.innerHeight+window.pageYOffset+"px",this.calculateSlotsWidth()},onScroll:function(e){DEVICE_TYPE==DEVICE_IPAD?this.swWrapper.style.top="50%":this.swWrapper.style.top=window.innerHeight+window.pageYOffset+"px"},lockScreen:function(e){e.preventDefault(),e.stopPropagation()},reset:function(){this.slotEl=[],this.activeSlot=null,this.swWrapper=undefined,this.swSlotWrapper=undefined,this.swSlots=undefined,this.swFrame=undefined},calculateSlotsWidth:function(){var e=this.swSlots.getElementsByTagName("div");for(var t=0;t<e.length;t+=1)this.slotEl[t].slotWidth=e[t].offsetWidth},create:function(){var e,t,n,r,i;this.reset(),DEVICE_TYPE==DEVICE_IPAD?(i=document.createElement("div"),i.id="sw-wrapper-overlay",i.innerHTML='<div id="sw-wrapper"><div id="sw-header"><span></span></div><div id="sw-slots-wrapper"><div id="sw-slots"></div></div><div id="sw-frame"></div></div>',document.body.appendChild(i),this.swWrapperOverlay=i,this.swWrapper=document.getElementById("sw-wrapper"),this.swSlotWrapper=document.getElementById("sw-slots-wrapper"),this.swSlots=document.getElementById("sw-slots"),this.swFrame=document.getElementById("sw-frame"),this.swHeader=document.getElementById("sw-header"),this.swWrapper.style.top=window.innerHeight+window.pageYOffset+"px",this.swWrapper.style.webkitTransitionProperty="-webkit-transform"):(i=document.createElement("div"),i.id="sw-wrapper",i.style.top=window.innerHeight+window.pageYOffset+"px",i.style.webkitTransitionProperty="-webkit-transform",i.innerHTML='<div id="sw-header"><div id="sw-cancel">Cancel</div><div id="sw-done">Done</div></div><div id="sw-slots-wrapper"><div id="sw-slots"></div></div><div id="sw-frame"></div>',document.body.appendChild(i),this.swWrapper=i,this.swSlotWrapper=document.getElementById("sw-slots-wrapper"),this.swSlots=document.getElementById("sw-slots"),this.swFrame=document.getElementById("sw-frame"));for(t=0;t<this.slotData.length;t+=1){r=document.createElement("ul"),n="";for(e in this.slotData[t].values)n+="<li>"+this.slotData[t].values[e]+"</li>";r.innerHTML=n,i=document.createElement("div"),i.className=this.slotData[t].style,i.appendChild(r),this.swSlots.appendChild(i),r.slotPosition=t,r.slotYPosition=0,r.slotWidth=0,r.slotMaxScroll=this.swSlotWrapper.clientHeight-r.clientHeight-86,r.style.webkitTransitionTimingFunction="cubic-bezier(0, 0, 0.2, 1)",this.slotEl.push(r),this.slotData[t].defaultValue&&this.scrollToValue(t,this.slotData[t].defaultValue)}this.calculateSlotsWidth(),DEVICE_TYPE==DEVICE_IPAD?(document.getElementById("sw-wrapper-overlay").addEventListener("touchstart",this,!1),this.swFrame.addEventListener("touchstart",this,!1)):(document.addEventListener("touchstart",this,!1),document.addEventListener("touchmove",this,!1),window.addEventListener("orientationchange",this,!0),window.addEventListener("scroll",this,!0),document.getElementById("sw-cancel").addEventListener("touchstart",this,!1),document.getElementById("sw-done").addEventListener("touchstart",this,!1),this.swFrame.addEventListener("touchstart",this,!1))},open:function(e){this.create();if(e!=undefined&&e!=null)if(DEVICE_TYPE==DEVICE_IPAD){var t=0,n=0;e.arrowPosition!=undefined?(n=e.arrowPosition,document.styleSheets[1].removeRule("#sw-header:before { left }",0),document.styleSheets[1].insertRule("#sw-header:before { left: 25px !important; }",0),this.swWrapper.style.left=e.arrowPosition+"px"):(document.styleSheets[1].removeRule("#sw-header:before { left }",0),document.styleSheets[1].insertRule("#sw-header:before { left: 220px !important; }",0),this.swWrapper.style.left="20px"),imfinity_utils.log(e.e.pageY+", "+e.e.layerY),e.position==undefined?t=e.e.pageY?e.e.pageY:e.e.layerY:t=e.position,imfinity_utils.log("position : "+t);var r=e.e.target.clientHeight+e.e.target.offsetTop;e.align=e.align==""||e.align==undefined||e.align==null?"bottom":e.align,e.title=e.title==""||e.title==undefined||e.title==null?"Select":e.title,this.swHeader.querySelector("span").innerHTML=e.title;switch(e.align){case"bottom":this.swWrapper.style.top=t+88+"px";break;case"top":this.swWrapper.style.top=t-r+"px"}}else this.swWrapper.style.top=window.innerHeight+window.pageYOffset+"px",this.swWrapper.style.webkitTransitionTimingFunction="ease-out",this.swWrapper.style.webkitTransitionDuration="400ms",this.swWrapper.style.webkitTransform="translate3d(0, -260px, 0)"},destroy:function(){DEVICE_TYPE==DEVICE_IPAD?(this.swWrapper.removeEventListener("webkitTransitionEnd",this,!1),this.swWrapperOverlay.removeEventListener("touchstart",this,!1),this.swFrame.removeEventListener("touchstart",this,!1)):(this.swWrapper.removeEventListener("webkitTransitionEnd",this,!1),this.swFrame.removeEventListener("touchstart",this,!1),document.getElementById("sw-cancel").removeEventListener("touchstart",this,!1),document.getElementById("sw-done").removeEventListener("touchstart",this,!1),document.removeEventListener("touchstart",this,!1),document.removeEventListener("touchmove",this,!1),window.removeEventListener("orientationchange",this,!0),window.removeEventListener("scroll",this,!0)),this.slotData=[],this.cancelAction=function(){return!1},this.cancelDone=function(){return!0},this.reset(),DEVICE_TYPE==DEVICE_IPAD?document.body.removeChild(document.getElementById("sw-wrapper-overlay")):document.body.removeChild(document.getElementById("sw-wrapper"))},close:function(){var e="ease-in";DEVICE_TYPE==DEVICE_ANDROID_TAB&&(e="ease-out"),this.swWrapper.style.webkitTransitionTimingFunction=e,this.swWrapper.style.webkitTransitionDuration="400ms",this.swWrapper.style.webkitTransform="translate3d(0, 0, 0)",this.swWrapper.addEventListener("webkitTransitionEnd",this,!1)},addSlot:function(e,t,n){t||(t=""),t=t.split(" ");for(var r=0;r<t.length;r+=1)t[r]="sw-"+t[r];t=t.join(" ");var i={values:e,style:t,defaultValue:n};this.slotData.push(i)},getSelectedValues:function(){var e,t,n,r,i=[],s=[];for(n in this.slotEl){this.slotEl[n].removeEventListener("webkitTransitionEnd",this,!1),this.slotEl[n].style.webkitTransitionDuration="0",this.slotEl[n].slotYPosition>0?this.setPosition(n,0):this.slotEl[n].slotYPosition<this.slotEl[n].slotMaxScroll&&this.setPosition(n,this.slotEl[n].slotMaxScroll),e=-Math.round(this.slotEl[n].slotYPosition/this.cellHeight),t=0;for(r in this.slotData[n].values){if(t==e){i.push(r),s.push(this.slotData[n].values[r]);break}t+=1}}return{keys:i,values:s}},setPosition:function(e,t){this.slotEl[e].slotYPosition=t,this.slotEl[e].style.webkitTransform="translate3d(0, "+t+"px, 0)"},scrollStart:function(e){var t=e.targetTouches[0].clientX-this.swSlots.offsetLeft,n=0;for(var r=0;r<this.slotEl.length;r+=1){n+=this.slotEl[r].slotWidth;if(t<n){this.activeSlot=r;break}}if(this.slotData[this.activeSlot].style.match("readonly"))return this.swFrame.removeEventListener("touchmove",this,!1),this.swFrame.removeEventListener("touchend",this,!1),!1;this.slotEl[this.activeSlot].removeEventListener("webkitTransitionEnd",this,!1),this.slotEl[this.activeSlot].style.webkitTransitionDuration="0";var i=window.getComputedStyle(this.slotEl[this.activeSlot]).webkitTransform;return i=(new WebKitCSSMatrix(i)).m42,i!=this.slotEl[this.activeSlot].slotYPosition&&this.setPosition(this.activeSlot,i),this.startY=e.targetTouches[0].clientY,this.scrollStartY=this.slotEl[this.activeSlot].slotYPosition,this.scrollStartTime=e.timeStamp,this.swFrame.addEventListener("touchmove",this,!1),this.swFrame.addEventListener("touchend",this,!1),!0},scrollMove:function(e){var t=e.targetTouches[0].clientY-this.startY;if(this.slotEl[this.activeSlot].slotYPosition>0||this.slotEl[this.activeSlot].slotYPosition<this.slotEl[this.activeSlot].slotMaxScroll)t/=2;this.setPosition(this.activeSlot,this.slotEl[this.activeSlot].slotYPosition+t),this.startY=e.targetTouches[0].clientY,e.timeStamp-this.scrollStartTime>80&&(this.scrollStartY=this.slotEl[this.activeSlot].slotYPosition,this.scrollStartTime=e.timeStamp)},scrollEnd:function(e){this.swFrame.removeEventListener("touchmove",this,!1),this.swFrame.removeEventListener("touchend",this,!1);if(this.slotEl[this.activeSlot].slotYPosition>0||this.slotEl[this.activeSlot].slotYPosition<this.slotEl[this.activeSlot].slotMaxScroll)return this.scrollTo(this.activeSlot,this.slotEl[this.activeSlot].slotYPosition>0?0:this.slotEl[this.activeSlot].slotMaxScroll),!1;var t=this.slotEl[this.activeSlot].slotYPosition-this.scrollStartY;if(t<this.cellHeight/1.5&&t>-this.cellHeight/1.5)return this.slotEl[this.activeSlot].slotYPosition%this.cellHeight&&this.scrollTo(this.activeSlot,Math.round(this.slotEl[this.activeSlot].slotYPosition/this.cellHeight)*this.cellHeight,"100ms"),!1;var n=e.timeStamp-this.scrollStartTime,r=2*t/n/this.friction,i=this.friction/2*r*r;r<0&&(r=-r,i=-i);var s=this.slotEl[this.activeSlot].slotYPosition+i;return s>0?(s/=2,r/=3,s>this.swSlotWrapper.clientHeight/4&&(s=this.swSlotWrapper.clientHeight/4)):s<this.slotEl[this.activeSlot].slotMaxScroll?(s=(s-this.slotEl[this.activeSlot].slotMaxScroll)/2+this.slotEl[this.activeSlot].slotMaxScroll,r/=3,s<this.slotEl[this.activeSlot].slotMaxScroll-this.swSlotWrapper.clientHeight/4&&(s=this.slotEl[this.activeSlot].slotMaxScroll-this.swSlotWrapper.clientHeight/4)):s=Math.round(s/this.cellHeight)*this.cellHeight,this.scrollTo(this.activeSlot,Math.round(s),Math.round(r)+"ms"),!0},scrollTo:function(e,t,n){this.slotEl[e].style.webkitTransitionDuration=n?n:"100ms",this.setPosition(e,t?t:0),(this.slotEl[e].slotYPosition>0||this.slotEl[e].slotYPosition<this.slotEl[e].slotMaxScroll)&&this.slotEl[e].addEventListener("webkitTransitionEnd",this,!1)},scrollToValue:function(e,t){var n,r,i;this.slotEl[e].removeEventListener("webkitTransitionEnd",this,!1),this.slotEl[e].style.webkitTransitionDuration="0",r=0;for(i in this.slotData[e].values){if(i==t){n=r*this.cellHeight,this.setPosition(e,n);break}r-=1}},backWithinBoundaries:function(e){return e.target.removeEventListener("webkitTransitionEnd",this,!1),this.scrollTo(e.target.slotPosition,e.target.slotYPosition>0?0:e.target.slotMaxScroll,"150ms"),!1},tapDown:function(e){e.currentTarget.addEventListener("touchmove",this,!1),e.currentTarget.addEventListener("touchend",this,!1),e.currentTarget.className="sw-pressed"},tapCancel:function(e){e.currentTarget.removeEventListener("touchmove",this,!1),e.currentTarget.removeEventListener("touchend",this,!1),e.currentTarget.className=""},tapUp:function(e){this.tapCancel(e),DEVICE_TYPE==DEVICE_IPAD?e.currentTarget.id=="sw-wrapper-overlay"&&this.doneAction():e.currentTarget.id=="sw-cancel"?this.cancelAction():this.doneAction(),this.close()},setCancelAction:function(e){this.cancelAction=e},setDoneAction:function(e){this.doneAction=e},cancelAction:function(){return!1},cancelDone:function(){return!0}};define("spinningwheel",function(){}),define("core/view/fibDropDown",["language","utilities","AppConst","AppEvent","spinningwheel"],function(language,utils,AppConst,AppEvent,spinningwheel){var fibDropDown=Backbone.View.extend({contentStr1:"<div class='quesWrapper' id='quesWrapper<%=id%>'><div id='ques<%=id%>' class='quesContent'><div id='activityContent'><div id='questionHeading' class='questionHeading'></div>	<div id='questionMediaWrapper'>		<div id='questionMedia' class='left question-media'></div>		<div  class='instruction'>Click/Tap to open resource</div>	</div>	<div id='questionText' class='left mcq-dropdown'></div>	<div id='questionOptions'></div>	<div id='labelanswers'></div>	</div></div></div>",modelParagraph:"",qId:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",itemClicked:!1,correctAnswerVisible:null,inputNo:0,EvaluateFlag:!1,changeToolbar:{},spinnerOpen:!1,maxpoints:0,attemptMethod:AppConst.DROPDOWN_SPINNINGWHEEL,partialAttempt:!0,title:"",activityMedia:"",initialize:function(){_.bindAll(this,"handleScreenExit","handleEvaluate","handleFibBtnClick"),_.bindAll(this,"enableInteraction","destroyScroll","resetClickFlag","showDropDown","spinningWheelCancelClick","spinningWheelDoneClick"),_.extend(this,Backbone.Events)},render:function(){this.element=this.el;var e=_.template(this.contentStr1,this.model.toJSON());$("#content",this.$el).append(e),this.screen=$("#ques"+this.model.get("id")),this.setQuestionData()},setQuestionData:function(){this.modelParagraph=this.model.get("modelParagraph"),this.type=this.model.get("type"),this.layout=this.model.get("questionLayout"),this.responseType=this.model.get("responseType"),this.clues=this.model.get("clues"),this.rubric=this.model.get("rubric"),this.questionText=JSON.stringify(this.model.get("questionBody")),this.questionMedia=this.model.get("questionMedia"),this.optionsMedia=this.model.get("optionsMedia"),this.leftCol=this.model.get("leftCol"),this.rightCol=this.model.get("rightCol"),this.opLayout=this.model.get("optionsLayout"),this.options=this.model.get("options"),this.answers=this.model.get("answers"),this.isTest=this.model.get("isTest"),this.isReview=this.model.get("isReview"),this.reviewData=this.model.get(""),this.qId=this.model.get("id"),this.maxpoints=parseInt(this.model.get("maxpoints")),this.model.get("userResponse").userResponse&&(this.userResponse=this.model.get("userResponse").userResponse),this.heading=this.model.get("heading"),utils.isDesktopBrowser()?this.attemptMethod=AppConst.DROPDOWN_NATIVE:this.attemptMethod=AppConst.DROPDOWN_SPINNINGWHEEL,this.partialAttempt=this.model.get("partialAttempt"),this.title=this.model.get("title"),this.activityMedia=this.model.get("activityMedia"),this.renderQues()},renderQues:function(){this.answers.length>0,this.drags=[],this.drops=[],this.dropObjs=[],this.obj=this.screen;var qBody=eval(this.questionText),qOptions=eval(this.options),qStr="",optionsStr="",gapNo=0,gapLength=0;if(this.type==AppConst.QUESTION_TYPE_FIBTABLE&&!this.resetClicked){var Body=[],options=[];for(var i=0;i<qBody.length;i++){options[i]=[],Body.push(qBody[i]),Body.push("GAP"),Body.push({data:" <br/>",type:"text"});for(var j=0;j<qOptions.length;j++)options[i].push(qOptions[j])}qBody=Body,qOptions=options,this.options=qOptions,this.questionText=qBody}if(this.heading.length==0)$(".questionHeading",this.screen).hide();else{var headingStr="";for(var i=0;i<this.heading.length;i++)this.heading[i].type=="image"?headingStr+="<img src='"+AppConst.ASSETS_PATH+this.heading[i].data+"'></img>":headingStr+="<div>"+this.heading[i].data+"</div>";$(".questionHeading",this.screen).html(headingStr)}if(this.questionMedia.length==0)$("#questionMediaWrapper",this.screen).hide();else{var qMediaStr="";for(var i=0;i<this.questionMedia.length;i++)qMediaStr+=utils.renderNode(this.questionMedia[i]);$("#questionMedia",this.screen).html(qMediaStr)}var that=this;$("#questionMedia img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))});var startNewLineUl=!0,flagGap=!1,assetCount=0;for(var i=0;i<qBody.length;i++){startNewLineUl&&(qStr+='<ul class="fibLine">',startNewLineUl=!1);if(qBody[i]=="GAP"){var index=0;if(this.attemptMethod==AppConst.DROPDOWN_NATIVE){qStr+="<li class='fibLineGap'><div class='inputDrop'><div class='badgeWrapper' id='group_drop"+gapNo+"'><select id='drop"+gapNo+"' class='dropdown' data-ddid='"+(i+1)+"' ><option value='-1'></option>";for(var j=0;j<this.options[gapNo].length;j++)qStr+="<option value='"+index+"'>"+this.options[gapNo][j].data+"</option>",index++;qStr+="</select><!--div class='' id='arrow_drop"+gapNo+"'></div--><div id='badge"+gapNo+"' class='checkBadge5'></div></div></div></li>"}else{gapLength=4;for(var j=0;j<this.options[gapNo].length;j++)gapLength<this.options[gapNo][j].data.length&&(gapLength=this.options[gapNo][j].data.length);qStr+="<li class='fibLineGap'><div class='inputDrop'><div class='badgeWrapper' id='group_drop"+gapNo+"'><div id='drop"+gapNo+"' size='"+parseInt(parseInt(gapLength))+"' class='dropdown'  data-ddid='"+(i+1)+"' ></div><!--div class='dropdown2' id='arrow_drop"+gapNo+"'></div-->",qStr+="<div id='badge"+gapNo+"' class='checkBadge5'></div></div></div></li>"}gapNo++,this.drops.push("drop"+gapNo),flagGap=!0}else{if(typeof qBody[i]=="object"){var liClass="fibLine"+qBody[i].type;if(qBody[i].type=="text")if(qBody[i].data.match(/<[bB][rR]\s*[/]?>/)){var arr=qBody[i].data.split(/<[bB][rR]\s*[/]?>/),txt=arr[0];if(txt.trim()!=""){if(this.activityMedia.length>assetCount){var activityAssetsStr="<div class='assets'>";for(var j=0;j<this.activityMedia[assetCount].length;j++)activityAssetsStr+="<div class='assets'><span class='asset question-media'>"+utils.renderNode(this.activityMedia[assetCount][j])+"</span></div>";assetCount++,activityAssetsStr+="</div>",qStr+=activityAssetsStr}var ref=this;txt=txt.replace(/\<object(.+?)\object>/g,function(e){var t=$(e).attr("id"),n="",r=ref.activityMedia["audio"+t];return n+="<div class='assets'><span class='asset question-media'>"+utils.renderNode(r)+"</span></div>",n}),qStr+=utils.renderNode({type:"text",data:txt})}qStr+='</ul><ul class="fibLine">';for(var j=1;j<arr.length;j++){var txt=arr[j];if(txt.trim()!=""){var ref=this;txt=txt.replace(/\<object(.+?)\object>/g,function(e){var t=$(e).attr("id"),n="",r=ref.activityMedia["audio"+t];return n+="<div class='assets'><span class='asset question-media'>"+utils.renderNode(r)+"</span></div>",n}),qStr+=utils.renderNode({type:"text",data:txt})}else j!=1&&(qStr+="<br/>")}}else if(qBody[i].data.trim().indexOf(" ")==-1&&flagGap)qStr=qStr.replace(new RegExp("</li>$"),utils.renderNode(qBody[i])+"</li>");else{var ref=this;qBody[i].data=qBody[i].data.replace(/\<object(.+?)\object>/g,function(e){var t=$(e).attr("id"),n="",r=ref.activityMedia["audio"+t];return n+="<div class='assets'><span class='asset question-media'>"+utils.renderNode(r)+"</span></div>",n}),qStr+=utils.renderNode(qBody[i])}else qStr+='<li class="'+liClass+'">'+utils.renderNode(qBody[i])+"</li>"}flagGap=!1}}qStr+="</ul>",this.inputNo=gapNo,$("#questionText",this.obj).html(qStr),this.fixWrappedLi(),$(".dropdown",this.obj).css("max-width",$("#questionText",this.obj).width()-45),$("#questionOptions",this.obj).html(optionsStr),$("#questionText",this.obj).removeClass("center"),$("#questionText",this.obj).addClass("left"),$(".assets img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))}),this.trigger(AppEvent.TEMPLATE_READY),this.responseType==AppConst.RESPONSE_TYPE_TEXT&&_.delay(this.destroyScroll,1e3)},fixWrappedLi:function(){var e=$("#questionText",this.obj).find("ul"),t=$(e[0]).height();for(var n=0;n<e.length;n++){var r=$(e[n]).height();r<t&&(t=r)}for(var n=0;n<e.length;n++){var r=$(e[n]).height();if(r>t*2-5){var i=$(e[n]).find("li");for(var s=0;s<i.length;s++){if($(i[s]).find("*").length>0)continue;var o=$(i[s]).text(),u=o.split(" "),a="";for(var f=0;f<u.length;f++)a+='<li class="fibLinetext"> '+u[f]+"</li>";$(i[s]).replaceWith(a)}}}},destroyScroll:function(){this.spinnerOpen=!1,this.iScroll!=null&&this.iScroll.destroy()},enableInteraction:function(){var e=this,t=$(".dropdown",this.obj);t.removeClass("disableOption"),t.removeAttr("disabled"),$(".checkBadge5",this.obj).css("z-index",-1),$("#questionText",this.obj).removeClass("disabled"),this.attemptMethod==AppConst.DROPDOWN_NATIVE?$(".dropdown",this.obj).unbind().bind(AppEvent.CHANGE,function(t){_.delay(e.handleFibBtnClick,500,t)}):$(".badgeWrapper",this.obj).unbind().bind(AppEvent.CLICK,e.showDropDown)},showDropDown:function(e){if(this.spinnerOpen==0){var t={};t.e=e,t.align="bottom",t.position=50,this.disableInteraction(),utils.log(e.target.id),this.currentDropDown=e.target.id;var n=this.currentDropDown.split("drop")[1];this.gapIndex=n;var r=new Object;r[0]="";for(var i=0;i<this.options[n].length;i++)r[i+1]=this.options[n][i].data;return SpinningWheel.addSlot(r,"",this.key||1),SpinningWheel.setCancelAction(this.spinningWheelCancelClick),SpinningWheel.setDoneAction(this.spinningWheelDoneClick),SpinningWheel.open(t),this.spinnerOpen=!0,!1}},spinningWheelCancelClick:function(){this.spinnerOpen=!1,this.enableInteraction()},spinningWheelDoneClick:function(){this.spinnerOpen=!1,this.enableInteraction();var e=this.gapIndex,t=SpinningWheel.getSelectedValues();$("#drop"+e,this.screen).html(t.values),this.key=t.keys,this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.REFRESH_SCROLL);var n=$("#questionText",this.obj).find(".dropdown"),r=0;for(var i=0;i<n.length;i++){var s=n[i];$(s).html()!=""&&(r++,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE)}this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),r==n.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):r>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)},disableInteraction:function(){var e=$(".dropdown",this.obj);e.addClass("disableOption"),e.attr("disabled","disabled"),e.unbind(AppEvent.CLICK),$("#questionText",this.obj).addClass("disabled"),$(".checkBadge5",this.obj).css("z-index",0),$(".badgeWrapper",this.obj).unbind(AppEvent.CLICK)},handleFibBtnClick:function(e){this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT;var t=$("#questionText",this.obj).find(".dropdown"),n=0;for(var r=0;r<t.length;r++){var i=t[r];i.options[i.selectedIndex].value!=-1&&(n++,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE)}var s=this;this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),n==t.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):n>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)},resetClickFlag:function(){this.itemClicked=!1},populateAnswers:function(e,t){if(this.isReset&&this.isTest&&!this.isReview&&e==undefined)return;var n=$("#questionText",this.obj).find(".dropdown"),r=$("#questionText",this.obj).find("div.checkBadge5");t==0?(r.removeClass("markWrong"),r.removeClass("markRight")):e.length>0&&(this.EvaluateFlag=!0);if(e.length>0)if(t!=0)for(var i=0;i<this.options.length;i++)e[i]>0?(e[i]==this.answers[i]?$("#badge"+i,this.obj).addClass("markRight"):$("#badge"+i,this.obj).addClass("markWrong"),this.attemptMethod==AppConst.DROPDOWN_NATIVE?$("#drop"+[i],this.screen).val(parseInt(e[i])-1):$("#drop"+[i],this.screen).html(this.options[i][e[i]-1].data)):($("#badge"+i,this.obj).addClass("markWrong"),this.attemptMethod==AppConst.DROPDOWN_NATIVE?$("#drop"+i,this.screen).val(-1):$("#drop"+i,this.screen).html(""));else for(var i=0;i<this.options.length;i++)this.attemptMethod==AppConst.DROPDOWN_NATIVE?$("#drop"+[i],this.screen).val(e[i]):$("#drop"+[i],this.screen).html(this.options[i][e[i]-1].data),$("#badge"+[i],this.screen).removeClass("markWrong"),$("#badge"+[i],this.screen).removeClass("markRight");e.length>0&&(this.EvaluateFlag=!0),(this.isTest||this.partialAttempt==0)&&!this.isReview&&(r.removeClass("markRight"),r.removeClass("markWrong"))},itemClicked:!1,handleEvaluate:function(e){if(e!=undefined&&$(e.target).hasClass("disabled"))return;if(this.itemClicked==1)return;this.userResponse=[],this.itemClicked=!0,this.EvaluateFlag=!0,this.isReset=!1;var attemtedInputs=0,totalInputs=0,attrToCheck=null,blankObjs=null,totalCorrect=0,qOptions=eval(this.options),markPerQ=parseInt(this.maxpoints)/this.options.length,marksQbtained=0,buttons=$("#questionOptions",this.obj).find("li");blankObjs=$("#questionText",this.obj).find(".dropdown"),blankObjsBadges=$("#questionText",this.obj).find("div.checkBadge5"),attrToCheck="value",totalInputs=blankObjs.size(),$("#questionOptions",this.obj).find(".selected").removeClass("selected");var dropList=$("#questionText",this.obj).find(".dropdown");for(var i=0;i<dropList.length;i++){var el=dropList[i],myanswer=0;if(this.attemptMethod==AppConst.DROPDOWN_NATIVE)myanswer=parseInt(el.options[el.selectedIndex].value)+1;else{var ans=$(el).html();for(var j=0;j<this.options[i].length;j++)if(ans==this.options[i][j].data){myanswer=j+1;break}}myanswer!=0&&attemtedInputs++,this.userResponse.push(myanswer),myanswer==this.answers[i]?($("#badge"+[i],this.obj).addClass("markRight"),totalCorrect++,marksQbtained+=markPerQ):(blankObjsBadges.addClass("markWrong"),$("#badge"+[i],this.obj).addClass("markWrong"))}this.partialAttempt||(blankObjsBadges.removeClass("markRight"),blankObjsBadges.removeClass("markWrong")),this.partialAttempt==1||attemtedInputs==totalInputs?totalCorrect>=totalInputs?this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,status:AppConst.CORRECT,score:marksQbtained,maxScore:parseInt(this.maxpoints),type:this.type,title:this.title,responseType:this.responseType}):totalCorrect>0?this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:marksQbtained,status:AppConst.PARTIAL,maxScore:parseInt(this.maxpoints),type:this.type,title:this.title,responseType:this.responseType}):this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:marksQbtained,status:AppConst.PARTIAL,maxScore:parseInt(this.maxpoints),type:this.type,title:this.title,responseType:this.responseType}):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,maxScore:parseInt(this.maxpoints),type:this.type,responseType:this.responseType}),this.lockQuestion(),_.delay(this.resetClickFlag,500)},resetClickFlag:function(){this.itemClicked=!1},lockQuestion:function(){this.correctAnswerVisible=!1,this.changeToolbar.mode=AppConst.TOOLBAR_LOCKED,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.disableInteraction()},resetQuestion:function(e){this.isReset=!0,this.resetClicked=!0;var t=$("#questionText",this.obj).find("div.checkBadge5");t.removeClass("markRight"),t.removeClass("markWrong"),this.attemptMethod==AppConst.DROPDOWN_NATIVE?$(".dropdown",this.obj).val(-1):$(".dropdown",this.obj).html(""),this.userResponse=[],this.enableInteraction(),this.trigger(AppEvent.MARK_EMPTY,this.qId),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.EvaluateFlag=!1},resetQuestionPartial:function(e){this.targetSelected="";var t=!0,n=$("#questionText",this.obj).find(".dropdown"),r=$("#questionText",this.obj).find("div.checkBadge5");r.removeClass("markWrong"),r.removeClass("markRight");var i=$("#questionText",this.obj).find(".dropdown"),s=0;for(var o=0;o<i.length;o++)if(this.userResponse[o]!=this.answers[o]){if(this.attemptMethod==AppConst.DROPDOWN_NATIVE)var u=$("#drop"+[o],this.screen).val(-1);else var u=$("#drop"+[o],this.screen).html("");this.userResponse[o]=""}else s++;s>0?(t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)):(this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)),n.removeClass("disableOption"),this.EvaluateFlag=!1,this.correctAnswerVisible=!1,this.enableInteraction(),t==0?this.trigger(AppEvent.UPDATE_RESPONSE,this.qId,{userResponse:this.userResponse}):this.trigger(AppEvent.MARK_EMPTY,this.qId),this.disableButton(AppConst.QBTN_RESET)},disableButton:function(e){$("#"+e,this.obj).addClass("disabled")},handleScreenExit:function(){},orientationchange:function(e){},destroy:function(){this.spinnerOpen&&(SpinningWheel.close(),this.spinnerOpen=!1),this.unbind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.unbind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.unbind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.unbind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.unbind(AppEvent.MARK_EMPTY,this.markEmpty),this.unbind(AppEvent.UPDATE_RESPONSE,this.updateResponse),this.unbind(AppEvent.MARK_ANSWER,this.handleMarkAnswer),$("#questionOptions",this.obj).find("li").unbind(),$("#ques"+this.model.get("id")).remove()}});return fibDropDown}),define("core/model/matchSortVO",[],function(){var e=Backbone.Model.extend({id:"",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",heading:[],attemptMethod:"",partialAttempt:!0,feedback:[]});return e}),define("core/view/matchSortView",["language","utilities","AppConst","AppEvent"],function(language,utils,AppConst,AppEvent){var matchSortView=Backbone.View.extend({contentStr1:"<div class='quesWrapper none-bg' id='quesWrapper<%=id%>' ><div id='ques<%=id%>'  class='quesContent'>							<div id='activityContent'>								<div id='questionHeading' class='questionHeading'></div>								<div id='questionMediaWrapper'>									<div id='questionMedia' class='left question-media'></div>									<div  class='instruction'>Click/Tap to open resource</div>								</div>								<div id='questionText' class='center line-connector'></div>								<div id='questionOptions'></div>								<div id='labelanswers'></div>							</div>						  </div></div>",modelParagraph:"",qId:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:[],answers:"",isTest:"",isReview:"",reviewData:"",userResponse:[],itemClicked:!1,correctAnswerVisible:null,inputNo:0,EvaluateFlag:!1,templateOptionItem:"<div class='dropelement' id='drag<%=index+1%>'><span><%=option.data%></span></div>",resetClicked:!1,firstItem:null,secondItem:null,numSelected:0,changeToolbar:{},quesType:"",maxItemHeight:0,maxpoints:0,marksQbtained:0,rightMaxWidth:0,leftMaxWidth:0,heading:"",attemptMethod:AppConst.MATCHING_RIGHTSIDE,partialAttempt:!0,sortItemAttr:"",refItemAttr:"",title:"",defaultOptions:[],scroll:null,initialize:function(){_.bindAll(this,"handleEvaluate","resetClickFlag","handleLook","handleMatchSortItemClick","handleMatchLeftItemClick","handleMatchRightItemClick"),_.extend(this,Backbone.Events)},render:function(){this.element=this.el;var e=_.template(this.contentStr1,this.model.toJSON());$("#content",this.$el).append(e),this.screen=$("#ques"+this.model.get("id")),this.setQuestionData()},setQuestionData:function(){this.modelParagraph=this.model.get("modelParagraph"),this.type=this.model.get("type"),this.layout=this.model.get("questionLayout"),this.responseType=this.model.get("responseType"),this.clues=this.model.get("clues"),this.rubric=this.model.get("rubric"),this.questionText=JSON.stringify(this.model.get("questionBody")),this.questionMedia=this.model.get("questionMedia"),this.answersMedia=this.model.get("optionsMedia"),this.leftCol=this.model.get("leftCol"),this.rightCol=this.model.get("rightCol"),this.opLayout=this.model.get("optionsLayout"),this.answers=this.model.get("answers"),this.options=this.model.get("options"),this.isTest=this.model.get("isTest"),this.isReview=this.model.get("isReview"),this.reviewData=this.model.get(""),this.inputNo=this.answers.length,this.qId=this.model.get("id"),this.heading=this.model.get("heading"),this.maxpoints=parseInt(this.model.get("maxpoints")),this.partialAttempt=this.model.get("partialAttempt"),this.title=this.model.get("title"),this.model.get("userResponse").userResponse&&(this.userResponse=this.model.get("userResponse").userResponse),this.attemptMethod=this.model.get("attemptMethod"),this.renderQues()},renderQues:function(){this.userResponse&&this.userResponse.length>0&&(this.EvaluateFlag=!0),this.obj=this.screen;var leftOptions=eval(this.questionText);this.answers=eval(_.clone(this.answers));var rightOptions=eval(_.clone(this.answers));if(!leftOptions.length||!rightOptions.length)return;var leftSort="<div class='leftsort'>";leftSort+=this.generateList(leftOptions,"sortL","matching addsort textsort","refItem"),leftSort+="</div>";var rightSort="<div class='rightsort'>";rightOptions=utils.randomizeArray(leftOptions,rightOptions),rightSort+=this.generateList(rightOptions,"sort","matching addsort textsort","sortItem","addBadge"),rightSort+="</div>",$("#questionText",this.obj).html(leftSort+rightSort),$("#sortL",this.obj).find("img").length==0?(this.refItemAttr="p",$("#sortL",this.obj).removeClass("addsort")):(this.refItemAttr="img",$("#sortL",this.obj).removeClass("textsort")),$("#sort",this.obj).find("img").length==0?(this.sortItemAttr="p",$("#sort",this.obj).removeClass("addsort")):(this.sortItemAttr="img",$("#sort",this.obj).removeClass("textsort"),this.quesType="image");if(this.heading.length==0)$(".questionHeading",this.screen).hide();else{var headingStr="";for(var i=0;i<this.heading.length;i++)this.heading[i].type=="image"?headingStr+="<img src='"+AppConst.ASSETS_PATH+this.heading[i].data+"'></img>":headingStr+="<div>"+this.heading[i].data+"</div>";$(".questionHeading",this.screen).html(headingStr)}if(this.questionMedia.length==0)$("#questionMediaWrapper",this.screen).hide();else{var qMediaStr="";for(var i=0;i<this.questionMedia.length;i++)qMediaStr+=utils.renderNode(this.questionMedia[i]);$("#questionMedia",this.screen).html(qMediaStr)}var that=this;$("#questionMedia img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))});var fontSize=1;$("#sort > li").css("font-size",fontSize+"em"),_.delay(this.handleLook,200),this.trigger(AppEvent.TEMPLATE_READY)},checkMaxHeight:function(e,t){var n=e.length,r=0;for(var i=0;i<n;i++){var s=$("#"+t+(i+1),this.screen).get(0).scrollHeight,o=parseInt($("#"+t+(i+1)+" p",this.screen).css("padding"));o&&(s+=o*2),s>r&&(r=s)}return r},handleLook:function(){var images=$("ul.matching li figure img");for(var i=0;i<images.length;i++){var wd=$("ul.matching li figure img").get(i).width;$("ul.matching li").get(i).width=wd,$("#sortItem"+(i+1)).css("width",wd)}var leftOptions=eval(this.questionText),rightOptions=eval(_.clone(this.answers)),l=this.checkMaxHeight(leftOptions,"refItem"),r=this.checkMaxHeight(rightOptions,"sortItem");if(utils.isPhone()){var maxWidthNode=$(".matching"),fontSize=this.resizeText(maxWidthNode,.8);$(".matching  > li").css("font-size",fontSize+"em")}this.maxItemHeight=l>r?l:r,this.maxItemHeight<60&&(this.maxItemHeight=60),utils.log("left maxHeight: "+l+" | r mHieght: "+r),$("li",this.screen).css("height",this.maxItemHeight+"px"),$("li",this.screen).css("position","relative");var pHeight=this.maxItemHeight/2;if($("#sort",this.screen).find("p").length==$("#sortL",this.screen).find("p").length){var pList=$("#sort, #sortL",this.screen).find("p");for(var idx=0;idx<pList.length;idx++)$(pList[idx]).height()<this.maxItemHeight-5}$("#sort, #sortL",this.screen).find("p").css("height",this.maxItemHeight+"px"),$("#sort, #sortL",this.screen).find("p").css("position","absolute"),$("#sort, #sortL",this.screen).find("p").css("left","0"),$("#sort",this.screen).find("p").length>0&&$("#sort",this.screen).find("img").length==0&&$("#sortL",this.screen).find("p").length>0&&$("#sortL",this.screen).find("img").length==0&&($("#sort",this.screen).addClass("matchTextSpacer"),$("#sortL",this.screen).addClass("matchTextSpacer")),this.quesType=="image"},checkMaxOffWidth:function(e,t){var n=e.length,r=0,i;for(var s=0;s<n;s++){var o=$("#"+t+(s+1),this.screen).find("p");if(o.length>0)o=o.get(0).offsetWidth;else var o=$("#"+t+(s+1),this.screen).find("img").get(0).offsetWidth;o>r&&(r=o,i=$("#"+t+(s+1),this.screen))}return i},resetFontSize:function(e,t,n){return fSize=n,e.offsetWidth-6<t.offsetWidth&&(fSize=t.innerHTML.length*.625),fSize},resizeText:function(e,t){var n=t;for(var r=0;r<e.length;r++)e[r].offsetWidth<e[r].scrollWidth&&(n-=.1);return n},enableInteraction:function(){$("li",this.obj).removeClass("disableOption"),$("p",this.obj).removeClass("disableOption"),$("img",this.obj).removeClass("disableOption"),$("#questionText",this.obj).removeClass("disabled");var e=$(".rightsort li",this.obj).find("img"),t=$(".leftsort li",this.obj).find("img");this.attemptMethod!=AppConst.MATCHING_RIGHTSIDE?(e.get(0)?$(".rightsort li",this.obj).find("img").unbind().bind(AppEvent.CLICK,this.handleMatchRightItemClick):$(".rightsort",this.obj).find("p").unbind().bind(AppEvent.CLICK,this.handleMatchRightItemClick),t.get(0)?$(".leftsort li",this.obj).find("img").unbind().bind(AppEvent.CLICK,this.handleMatchLeftItemClick):$(".leftsort",this.obj).find("p").unbind().bind(AppEvent.CLICK,this.handleMatchLeftItemClick)):e.get(0)?$(".rightsort li",this.obj).find("img").unbind().bind(AppEvent.CLICK,this.handleMatchSortItemClick):$(".rightsort",this.obj).find("p").unbind().bind(AppEvent.CLICK,this.handleMatchSortItemClick)},disableInteraction:function(){$("li",this.obj).unbind(),$("img",this.obj).unbind(),$("p",this.obj).unbind(),$("#questionText",this.obj).addClass("disabled")},handleTouchStart:function(e){$("#sort>li",this.obj).attr("class","options")},handleMatchSortItemClick:function(e){if(this.itemClicked==1||this.scroll&&this.scroll.moved)return;$(".rightsort li",this.obj).find("img").removeClass("selected"),this.itemClicked=!0;var t=e.target,n=t.id;if(t.nodeName=="IMG")t=t.parentNode.parentNode;else if(t.nodeName=="figure"||t.nodeName=="P")t=t.parentNode;$(".rightsort li",this.obj).find("img").attr("class","options");var r=$(t).find("img");r.get(0)?r.addClass("selected"):$(t).addClass("selected"),this.numSelected==0?(this.firstItem={value:$(t).html(),ele:t.id},this.numSelected++):this.numSelected==1&&(this.secondItem={value:$(t).html(),ele:t.id},this.swap(this.firstItem,this.secondItem),$(".rightsort li",this.obj).removeClass(),this.numSelected=0,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)),_.delay(this.resetClickFlag,100)},handleMatchRightItemClick:function(e){if(this.itemClicked==1||this.scroll&&this.scroll.moved)return;$(".rightsort li",this.obj).removeClass("selected"),$(".rightsort p",this.obj).removeClass("selected"),this.itemClicked=!0;var t=e.target,n=t,r=t.id;t.nodeName=="IMG"?(t=t.parentNode.parentNode,n=t):t.nodeName=="figure"?(t=t.parentNode,n=t):t.nodeName=="P"&&(n=t,t=t.parentNode);if($(t).find(this.sortItemAttr).hasClass("attempted")){$(t).find(this.sortItemAttr).removeClass("attempted"),$(t).find(this.sortItemAttr).removeClass("attempt-line");var i=t.id.split("sortItem")[1];$("#refItem"+i,this.obj).find(this.refItemAttr).removeClass("attempted"),$("#refItem"+i,this.obj).find(this.refItemAttr).removeClass("attempt-line"),$("#sortL").find(".attempted").length==this.answers.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):$("#sortL").find(".attempted").length>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)}var s=$(t).find("img");s.get(0)?s.addClass("selected"):$(n).addClass("selected"),this.firstItem={value:$(t).html(),ele:t.id},this.firstItem!=null&&this.secondItem!=null&&(this.swap(this.firstItem,this.secondItem),$(".rightsort p",this.obj).removeClass("selected"),$(".leftsort p",this.obj).removeClass("selected"),$(".rightsort img",this.obj).removeClass("selected"),$(".leftsort img",this.obj).removeClass("selected"),this.firstItem=null,this.secondItem=null,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)),_.delay(this.resetClickFlag,100)},resetClickFlag:function(){this.itemClicked=!1},handleMatchLeftItemClick:function(e){if(this.itemClicked==1||this.scroll&&this.scroll.moved)return;$(".leftsort li",this.obj).removeClass("selected"),$(".leftsort p",this.obj).removeClass("selected"),$(".leftsort img",this.obj).removeClass("selected"),this.itemClicked=!0;var t=e.target,n=t,r=t.id;t.nodeName=="IMG"||t.nodeName=="figure"?(t=t.parentNode,n=t):t.nodeName=="P"&&(n=t,t=t.parentNode);if($(t).find(this.refItemAttr).hasClass("attempted")){$(t).find(this.refItemAttr).removeClass("attempted"),$(t).find(this.refItemAttr).removeClass("attempt-line");var i=t.id.split("refItem")[1];$("#sortItem"+i,this.obj).find(this.sortItemAttr).removeClass("attempted"),$("#sortItem"+i,this.obj).find(this.sortItemAttr).removeClass("attempt-line"),$("#sortL").find(".attempted").length==this.answers.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):$("#sortL").find(".attempted").length>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)}var s=$(t).find("img");s.get(0)?s.addClass("selected"):$(n).addClass("selected");var i=t.id.match(/\d+$/),o="sortItem"+i,u=$("#sortItem"+i,this.screen).html();this.secondItem={value:u,ele:o},this.firstItem!=null&&this.secondItem!=null&&(this.swap(this.firstItem,this.secondItem),$(".rightsort p",this.obj).removeClass("selected"),$(".leftsort p",this.obj).removeClass("selected"),$(".rightsort img",this.obj).removeClass("selected"),$(".leftsort img",this.obj).removeClass("selected"),this.firstItem=null,this.secondItem=null,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)),_.delay(this.resetClickFlag,100)},generateList:function(e,t,n,r,i){var s=0;if(r==undefined||r=="")r="sortItem";var o="<ul id='"+t+"' class='"+n+"'>";for(var u=0;u<e.length;u++)e[u].type=="image"?e[u].data==undefined?i?o+="<li id="+r+(u+1)+"><figure class='badgeWrapper2'><img src ='"+AppConst.ASSETS_PATH+e[u][0].data+"'></img><div class='checkBadge2'></div></figure></li>":o+="<li id="+r+(u+1)+"><img  id ='imgques"+(u+1)+"' src ='"+AppConst.ASSETS_PATH+e[u][0].data+"'></img></li>":i?o+="<li id="+r+(u+1)+"><figure class='badgeWrapper2'><img src ='"+AppConst.ASSETS_PATH+e[u].data+"'></img><div class='checkBadge2'></div></figure></li>":o+="<li id="+r+(u+1)+"><img  id ='imgques"+(u+1)+"' src ='"+AppConst.ASSETS_PATH+e[u].data+"'></img></li>":e[u].data==undefined?(i?o+="<li id="+r+(u+1)+"><p>"+e[u][0].data+"</p><div class='checkBadge2'></div></li>":o+="<li id="+r+(u+1)+"><p>"+e[u][0].data+"</p></li>",e[u][0].data.length>s&&(s=e[u].data.length)):(i?o+="<li id="+r+(u+1)+"><p>"+e[u].data+"</p><div class='checkBadge2'></div></li>":o+="<li id="+r+(u+1)+"><p>"+e[u].data+"</p></li>",e[u].data.length>s&&(s=e[u].data.length));return o+="</ul>",t=="sortL"?this.leftMaxWidth=s:t=="sort"&&(this.rightMaxWidth=s),o},swap:function(e,t){utils.log("SWAP: ");var n=$("#"+e.ele,this.obj).position(),r=$("#"+t.ele,this.obj).position();if(n&&r){var i=n.top,s=r.top;utils.log(i+" - "+s),utils.log("A id: "+$("#"+e.ele,this.obj).attr("id")),utils.log("B id: "+$("#"+t.ele,this.obj).attr("id"));var o=0,u=0;u=$("#"+t.ele,this.obj).css("top"),utils.log("bNewTop:"+u+(u!="auto")),u!="auto"&&u!=0?(utils.log(u),u=u.replace("px",""),u*=1):u=0,o=$("#"+e.ele,this.obj).css("top"),utils.log("aNewTop: "+o),o!="auto"&&o!=0?(utils.log(o),o=o.replace("px",""),o*=1):o=0,utils.log(o+" - "+u);var a=500,f=e.ele.replace("sortItem","")*1,l=t.ele.replace("sortItem","")*1,c=l-f;isNaN(c)?a=600:c>=2&&(a+=c*50),utils.log("animDuration "+a+" - "+c);if(e.ele==t.ele){var h=e.ele.split("sortItem")[1];$("#refItem"+h,this.obj).find(this.refItemAttr).addClass("attempt-line")}$("#"+t.ele,this.obj).animate({top:i-s+u},a),$("#"+e.ele,this.obj).animate({top:s-i+o},a)}temp=e.value;var p=$("#"+e.ele,this.obj),d=$("#"+t.ele,this.obj);p.attr("id",t.ele),d.attr("id",e.ele);var h=parseInt(t.ele.split("sortItem")[1]);$("#refItem"+h,this.obj).find(this.refItemAttr).addClass("attempted"),$("#"+t.ele,this.obj).find(this.sortItemAttr).addClass("attempted");var v=this;_.delay(function(){$("#refItem"+h,v.obj).find(v.refItemAttr).addClass("attempt-line"),$("#"+t.ele,v.obj).find(v.sortItemAttr).addClass("attempt-line")},500);var m=parseInt(e.ele.split("sortItem")[1]);$("#refItem"+m,this.obj).find(this.refItemAttr).hasClass("attempted")?($("#"+e.ele,this.obj).find(this.sortItemAttr).addClass("attempted"),_.delay(function(){$("#"+e.ele,v.obj).find(v.sortItemAttr).addClass("attempt-line")},500)):($("#"+e.ele,this.obj).find(this.sortItemAttr).removeClass("attempted"),_.delay(function(){$("#"+e.ele,v.obj).find(v.sortItemAttr).removeClass("attempt-line")},500)),$(".rightsort li",this.obj).find("img").removeClass("selected"),$("#sortL").find(".attempted").length==this.answers.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):$("#sortL").find(".attempted").length>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)},isSolved:function(ob){this.userResponse=[];var qOptions=eval(_.clone(ob.answers)),items=$(".rightsort li",ob.obj).sort(function(e,t){var n=e.id.replace("sortItem","")*1,r=t.id.replace("sortItem","")*1;return n>r?1:-1}),selector="div.checkBadge2",blankObjsBadges=$(".rightsort li",this.screen).find("div.checkBadge2");$(".rightsort li",this.screen).find("div.checkBadge2").siblings("p").length>0&&(blankObjsBadges=$(".rightsort li",this.screen).find("div.checkBadge2").siblings("p"),selector="p"),blankObjsBadges.removeClass("markRight2"),blankObjsBadges.removeClass("markWrong2"),utils.log(blankObjsBadges);var max=items.size(),totalCorrect=0,markPerQ=parseInt(this.maxpoints)/max;for(var i=0;i<max;i++){var obj=new Object;$(items.get(i)).find(this.sortItemAttr).hasClass("attempted")?obj.attempted=!0:obj.attempted=!1;var item1=$(items.get(i)).find("img");if(item1.length>0){var itemTexts=$(items.get(i)).find("img").attr("src").split("/"),itemText=itemTexts[itemTexts.length-1];obj.type="image",obj.data=item1.attr("src").split(AppConst.ASSETS_PATH)[1];var correctAnsArray=qOptions[i].data.split("/"),correctAns=correctAnsArray[correctAnsArray.length-1]}else{var itemText=$(items.get(i)).find("p").html();obj.type="text",obj.data=itemText;var correctAns=qOptions[i].data}for(var j=0;j<this.options.length;j++)if(this.options[j].data==itemText){obj.index=j+1;break}this.userResponse.push(obj),utils.log("matching-- ",$(items.get(i)),qOptions[i].data),correctAns==itemText?(totalCorrect++,this.marksQbtained=this.marksQbtained+markPerQ,$(items.get(i)).find(selector).addClass("markRight2")):$(items.get(i)).find(selector).addClass("markWrong2")}return this.partialAttempt||(blankObjsBadges.removeClass("markRight2"),blankObjsBadges.removeClass("markWrong2")),totalCorrect==max?AppConst.CORRECT:totalCorrect>0?AppConst.PARTIAL:AppConst.INCORRECT},handleEvaluate:function(e){if(e!=undefined&&$(e.target).hasClass("disabled"))return;$(".rightsort li",this.obj).removeClass("selected"),$(".rightsort li",this.obj).find("img").removeClass("selected"),$(".leftsort li",this.obj).removeClass("selected"),$(".leftsort li",this.obj).find("img").removeClass("selected"),this.EvaluateFlag=!0;var t=this.isSolved(this),n=$("#sortL").find(".attempted").length;this.partialAttempt==1||n==this.answers.length?t==AppConst.CORRECT?this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,score:this.marksQbtained,status:AppConst.CORRECT,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,responseType:this.responseType}):this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:this.marksQbtained,status:t,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,responseType:this.responseType}):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,responseType:this.responseType}),this.lockQuestion()},lockQuestion:function(){this.correctAnswerVisible=!1,this.changeToolbar.mode=AppConst.TOOLBAR_LOCKED,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.disableInteraction()},populateAnswers:function(answers,correctAnswerVisible){$("#questionText",this.obj).find("li").unbind(AppEvent.CLICK),_.delay(this.handleLook,200),answers.length>0&&(this.EvaluateFlag=!0);var qOptions=[];answers.length==0?qOptions=eval(_.clone(this.answers)):qOptions=eval(_.clone(answers));var leftOptions=eval(this.questionText),leftSort="<div class='leftsort'>";leftSort+=this.generateList(leftOptions,"sortL","matching addsort textsort","refItem"),leftSort+="</div>";var rightSort="<div class='rightsort'>";answers.length==0||correctAnswerVisible==0?(qOptions=eval(_.clone(this.answers)),answers.length==0?rightSort+=this.generateList(qOptions,"sort","matching textsort addsort","sortItem","addBadge"):rightSort+=this.generateList(qOptions,"sort","matching textsort addsort","sortItem","addBadge")):(qOptions=eval(_.clone(answers)),rightSort+=this.generateList(qOptions,"sort","matching textsort addsort","sortItem","addBadge")),rightSort+="</div>",$("#questionText",this.obj).html(leftSort+rightSort);for(var i=0;i<answers.length;i++)answers[i].attempted&&($("#refItem"+(i+1),this.obj).find(this.refItemAttr).addClass("attempted"),$("#sortItem"+(i+1),this.obj).find(this.sortItemAttr).addClass("attempted"),$("#refItem"+(i+1),this.obj).find(this.refItemAttr).addClass("attempt-line"),$("#sortItem"+(i+1),this.obj).find(this.sortItemAttr).addClass("attempt-line"));$("#sortL",this.obj).find("img").length==0&&$("#sortL",this.obj).removeClass("addsort"),$("#sort",this.obj).find("img").length==0?$("#sort",this.obj).removeClass("addsort"):this.quesType="image";var blankObjsBadges=$(".rightsort li",this.screen).find("div.checkBadge2");$(".rightsort li",this.screen).find("div.checkBadge2").siblings("p").length>0&&(blankObjsBadges=$(".rightsort li",this.screen).find("div.checkBadge2").siblings("p"));var blankObjs=$(".rightsort li",this.screen);utils.log(blankObjsBadges),blankObjsBadges.removeClass("markWrong2"),blankObjsBadges.removeClass("markRight2");if(correctAnswerVisible==1)for(var i=0;i<answers.length;i++)answers[i].data==this.answers[i].data?blankObjsBadges[i].className+=" markRight2":blankObjsBadges[i].className+=" markWrong2";var l=this.checkMaxOffWidth(leftOptions,"refItem"),r=this.checkMaxOffWidth(qOptions,"sortItem"),fontSize=1;$("#sort > li").css("font-size",fontSize+"em"),$(".rightsort > ul",this.obj).hide(),answers.length>0||(!this.isTest&&!this.isReview?this.enableInteraction():this.disableInteraction()),(this.isTest||this.partialAttempt==0)&&!this.isReview&&(blankObjsBadges.removeClass("markWrong2"),blankObjsBadges.removeClass("markRight2"),$(".rightsort li",this.screen).removeClass("disableOption")),$(".leftsort > ul",this.obj).show(),$(".rightsort > ul",this.obj).show()},resetQuestion:function(e){$(".rightsort p",this.obj).removeClass("selected"),$(".leftsort p",this.obj).removeClass("selected"),$(".rightsort img",this.obj).removeClass("selected"),$(".leftsort img",this.obj).removeClass("selected"),this.firstItem=null,this.secondItem=null,$("#questionText",this.obj).html(""),this.resetClicked=!0,this.numSelected=0,this.userResponse=[],this.renderQues(),this.enableInteraction(),this.trigger(AppEvent.MARK_EMPTY,this.qId),this.EvaluateFlag=!1,this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)},resetQuestionPartial:function(e){$(".rightsort p",this.obj).removeClass("selected"),$(".leftsort p",this.obj).removeClass("selected"),$(".rightsort img",this.obj).removeClass("selected"),$(".leftsort img",this.obj).removeClass("selected"),this.firstItem=null,this.secondItem=null;var t=$("#questionText",this.obj).find("div.checkBadge2");$(".rightsort li",this.screen).find("div.checkBadge2").siblings("p").length>0&&(t=$(".rightsort li",this.screen).find("div.checkBadge2").siblings("p")),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var n=!0,r=$("#sort>li",this.obj);t.removeClass("markRight2"),t.removeClass("markWrong2"),$(".rightsort li",this.obj).removeClass("disableOption");var i=[],s=[];for(var o=0;o<this.userResponse.length;o++){var u=this.userResponse[o].data;this.answers[o].data!=u?(s.push(o+1),i.push(this.answers[o])):(n=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar))}i=utils.randomizeArray(i,i);for(var o=0;o<s.length;o++)i[o].data.indexOf(".jpg")>0?$("#sortItem"+s[o],this.obj).html("<figure class='badgeWrapper2'><img src ='"+AppConst.ASSETS_PATH+i[o].data+"'></img><div class='checkBadge2'></div></figure>"):$("#sortItem"+s[o],this.obj).html("<p>"+i[o].data+"</p><div class='checkBadge2'></div>");_.delay(this.handleLook,200),this.numSelected=0,this.EvaluateFlag=!1,this.resetFlag=!0,this.enableInteraction(),n==0?this.trigger(AppEvent.UPDATE_RESPONSE,this.qId,{userResponse:this.userResponse}):this.trigger(AppEvent.MARK_EMPTY,this.qId),this.disableButton(AppConst.QBTN_RESET),this.EvaluateFlag=!1,this.userResponse=[]},disableButton:function(e){$("#"+e,this.obj).addClass("disabled")},handleScreenExit:function(){},orientationchange:function(e){this.handleLook()},destroy:function(){this.unbind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.unbind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.unbind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.unbind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.unbind(AppEvent.MARK_EMPTY,this.markEmpty),this.unbind(AppEvent.UPDATE_RESPONSE,this.updateResponse),$("#questionOptions",this.obj).find("li").unbind(),$("#ques"+this.model.get("id")).remove()}});return matchSortView}),define("core/model/fibTapPlaceVO",[],function(){var e=Backbone.Model.extend({id:"",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",heading:[],maintainOptions:"",partialAttempt:!0,feedback:[]});return e}),define("core/view/fibTapPlace",["utilities","AppConst","AppEvent"],function(utils,AppConst,AppEvent){var fibTapPlace=Backbone.View.extend({contentStr1:"<div class='white-bg quesWrapper' id='quesWrapper<%=id%>'><div id='ques<%=id%>' class='quesContent'>							<div id='activityContent'>								<div id='questionHeading' class='questionHeading'></div>								<div id='questionMediaWrapper'>									<div id='questionMedia' class='left question-media'></div>									<div  class='instruction'>Click/Tap to open resource</div>								</div>								<div id='questionOptionsWrapper' class='questionOptionsWrapper'>								<div id='questionOptions' class='trayParent'></div>								</div>								<div id='questionTextCover'>									<div id='questionText' class='left'></div>								</div>								<div id='labelanswers'></div>							</div>						</div>						</div>",modelParagraph:"",qId:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",itemClicked:!1,correctAnswerVisible:null,inputNo:0,EvaluateFlag:!1,changeToolbar:{},drags:[],drops:[],dragObjs:[],targetSelected:"",optionSelected:"",optionNode:"",maxpoints:0,resetClicked:!1,maintainOptions:AppConst.FIB_REMOVE_OPTIONS,partialAttempt:!0,optionHasImg:!1,textScroll:null,optionScroll:null,title:"",blankPositions:"",markPerQ:"",initialize:function(){_.bindAll(this,"handleScreenExit","handleEvaluate","onOptionSelected","onTargetSelected","resetFontSize","disableButton","resetClickFlag","onDeleteBtnClick","initScroll","initScroll2"),_.extend(this,Backbone.Events)},render:function(){this.element=this.el;var e=_.template(this.contentStr1,this.model.toJSON());$("#content",this.$el).append(e),this.screen=$("#ques"+this.model.get("id")),this.setQuestionData()},setQuestionData:function(){utils.log("user Response : ",this.model.get("userResponse")),this.modelParagraph=this.model.get("modelParagraph"),this.type=this.model.get("type"),this.layout=this.model.get("questionLayout"),this.responseType=this.model.get("responseType"),this.clues=this.model.get("clues"),this.rubric=this.model.get("rubric"),this.questionText=JSON.stringify(this.model.get("questionBody")),this.questionMedia=this.model.get("questionMedia"),this.optionsMedia=this.model.get("optionsMedia"),this.leftCol=this.model.get("leftCol"),this.rightCol=this.model.get("rightCol"),this.opLayout=this.model.get("optionsLayout"),this.options=this.model.get("options"),this.answers=this.model.get("answers"),this.isTest=this.model.get("isTest"),this.isReview=this.model.get("isReview"),this.reviewData=this.model.get(""),this.qId=this.model.get("id"),this.maxpoints=parseInt(this.model.get("maxpoints")),this.partialAttempt=this.model.get("partialAttempt"),this.title=this.model.get("title"),this.blankPositions=this.model.get("blankPositions"),this.model.get("userResponse").userResponse&&(this.userResponse=this.model.get("userResponse").userResponse),this.heading=this.model.get("heading"),this.model.get("maintainOptions")?this.maintainOptions=AppConst.FIB_MAINTAIN_OPTIONS:this.maintainOptions=AppConst.FIB_REMOVE_OPTIONS,this.renderQues()},renderQues:function(){this.drags=[],this.drops=[],this.dropObjs=[],this.obj=this.screen;var qBody=eval(this.questionText),qOptions=eval(this.options),qStr="",optionsStr="",gapNo=0,gapLength=0;this.inputNo=this.answers.length;if(this.heading.length==0)$(".questionHeading",this.screen).hide();else{var headingStr="";for(var i=0;i<this.heading.length;i++)this.heading[i].type=="image"?headingStr+="<img src='"+AppConst.ASSETS_PATH+this.heading[i].data+"'></img>":headingStr+="<div>"+this.heading[i].data+"</div>";$(".questionHeading",this.screen).html(headingStr)}if(this.questionMedia.length==0)$("#questionMediaWrapper",this.screen).hide();else{var qMediaStr="";for(var i=0;i<this.questionMedia.length;i++)qMediaStr+=utils.renderNode(this.questionMedia[i]);$("#questionMedia",this.screen).html(qMediaStr)}var that=this;$("#questionMedia img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))});if(this.responseType==AppConst.RESPONSE_TYPE_DRAG){utils.log("render Ques 2");for(var j=0;j<this.options.length;j++)gapLength<this.options[j].data.length&&(gapLength=this.options[j].data.length);gapLength=Math.max(gapLength,6),utils.log("gap length : "+gapLength);var startNewLineUl=!0,flagGap=!1;for(var i=0;i<qBody.length;i++){startNewLineUl&&(qStr+='<ul class="fibLine">',startNewLineUl=!1);if(qBody[i]=="GAP")gapNo++,qStr+="<li class='fibLineGap'><div class='badgeWrapper'><span type='text' id='drop"+gapNo+"' size='"+parseInt(parseInt(gapLength)+3)+"' class='blank' readonly ></span></div><div class='deleteBtn' style='display:none;'></div><div class='checkBadge'></div> </li>",this.drops.push("drop"+gapNo),flagGap=!0;else{if(typeof qBody[i]=="object"){var liClass="fibLine"+qBody[i].type;qBody[i].type=="text"?qStr+=utils.renderNode(qBody[i]):qStr+='<li class="'+liClass+'">'+utils.renderNode(qBody[i])+"</li><br />"}flagGap=!1}}qStr+="</ul>",this.layout=this.layout.toUpperCase(),this.layout.toUpperCase()==AppConst.LAYOUT_HORIZONTAL||this.layout==""?optionsStr="<div class='mcq4'>":this.layout==AppConst.LAYOUT_VERTICAL&&(optionsStr="<div class='mcq2' style='padding-top:30px;'>");var optionsStr2="";for(var i=0;i<qOptions.length;i++)qOptions[i].type=="image"?optionsStr2+="<div class='dropelement trayOptions imageOpt' id='drag"+(i+1)+"'><span>"+utils.renderNode(qOptions[i])+"</span></div>":optionsStr2+="<div class='dropelement trayOptions' id='drag"+(i+1)+"'><span>"+utils.renderNode(qOptions[i])+"</span></div>";var optionsStr3="</div>"}$("#questionText",this.obj).html(qStr),this.fixWrappedLi(),$("#questionOptions",this.obj).html(optionsStr+optionsStr2+optionsStr3);for(var i=0;i<qOptions.length;i++)this.drags.push("drag"+(i+1));var minFontSize=16;for(var i=0;i<qOptions.length;i++){utils.log("calculating font size : "+i),fSize=16,cardTextNode=$("#drag"+(i+1),this.obj).get(0);var node=$("span",cardTextNode).get(0);fCard=node.parentNode;var size=this.resetFontSize(cardTextNode,node,fSize,"px");minFontSize=size<minFontSize?size:minFontSize,cardTextNode.style["font-size"]=minFontSize+"px !important"}$(".dropelement",this.obj).css("font-size",minFontSize+"px !important");for(var i=0;i<qOptions.length;i++)if(qOptions[i].type=="image"){this.optionHasImg=!0;break}utils.isPhone()&&$("#questionOptionsWrapper",this.obj).addClass("isPhone");if(this.optionHasImg){$(".fibLineGap",this.obj).hide();var _ref=this;_.delay(function(){var e=$(".fibLineimage img",_ref.obj).get(1).width,t=$(".fibLineimage img",_ref.obj).get(1).naturalWidth,n=e/920,r=$(".fibLineimage img",_ref.obj).get(1).height,i=$(".fibLineimage img",_ref.obj).get(1).naturalHeight,s=r/175,o=$("#questionTextCover",_ref.obj).get(0).offsetTop,u=$("#questionText",_ref.obj).get(0).offsetTop,a=parseInt($("#questionText",_ref.obj).css("padding-left"))-7,f=$(".fibLineGap",_ref.obj);for(var l=0;l<_ref.blankPositions.length;l++){var c=_ref.blankPositions[l].x-a,h=_ref.blankPositions[l].y,p=_ref.blankPositions[l].w,d=_ref.blankPositions[l].h,v=_ref.rubric.length==0?95:95+parseInt($(".qinstructions").outerHeight());h-=v,h*=s,p*=n,d*=s,h+=$(".fibLineimage",_ref.obj)[$(".fibLineimage",_ref.obj).length-1].offsetTop,f[l].style.left=c+"px",f[l].style.top=h+"px",f[l].style.position="absolute",f[l].style.height=d+"px",f[l].style.width=p+"px"}f.find(".badgeWrapper").addClass("matdd-blanks"),$(".fibLineGap",_ref.obj).show(),_ref.initScroll()},1e3)}else $(".mcq4",this.obj).css("height",$(".mcq4",this.obj).height());this.trigger(AppEvent.TEMPLATE_READY),this.optionHasImg||this.initScroll()},fixWrappedLi:function(){var e=$("#questionText",this.obj).find("ul"),t=$(e[0]).height();for(var n=0;n<e.length;n++){var r=$(e[n]).height();r<t&&(t=r)}for(var n=0;n<e.length;n++){var r=$(e[n]).height();if(r>t*2-5){var i=$(e[n]).find("li");for(var s=0;s<i.length;s++){if($(i[s]).find("*").length>0)continue;var o=$(i[s]).text(),u=o.split(" "),a="";for(var f=0;f<u.length;f++)a+='<li class="fibLinetext"> '+u[f]+"</li>";$(i[s]).replaceWith(a)}}}},resetFontSize:function(e,t,n){return fSize=n,e.offsetWidth-6<t.offsetWidth&&(fSize=n*.625),fSize},enableInteraction:function(){$(".blank",this.obj).unbind().bind(AppEvent.CLICK,this.onTargetSelected),$(".dropelement",this.obj).unbind().bind(AppEvent.CLICK,this.onOptionSelected),$("div.deleteBtn",this.obj).unbind().bind(AppEvent.CLICK,this.onDeleteBtnClick),$(".blank",this.obj).removeClass("disableTarget"),$("#questionText",this.obj).removeClass("disabled"),$(".dropelement",this.obj).removeClass("disableOption"),$(".checkBadge",this.obj).css("z-index",-1)},disableInteraction:function(){$(".blank",this.obj).unbind(),$(".dropelement",this.obj).unbind(),$("div.deleteBtn",this.obj).unbind(),$(".blank",this.obj).addClass("disableTarget"),$(".dropelement",this.obj).addClass("disableOption"),$("#questionText",this.obj).addClass("disabled");var e=$("#questionOptions").find(".dropelement");e.removeClass("selected"),$(".checkBadge",this.obj).css("z-index",0)},onDeleteBtnClick:function(e){this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,$("#questionText",this.obj).find("div.deleteBtn").hide();var t=e.target,n=$(t).siblings(".badgeWrapper").find(".blank");n.html(""),n.removeAttr("style"),n.removeClass("selected"),$("#"+$(t).attr("optionId"),this.obj).show(),this.optionHasImg&&this.initScroll(),$(t).hide(),$(t).attr("optionId",""),this.optionSelected=this.targetSelected=this.optionNode="";var r=$(".blank",this.screen);for(var i=0;i<r.length;i++)if($(r[i]).html()!=""){this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE;break}this.trigger(AppEvent.Q_STATUS,AppConst.No_ATTEMPT),this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),_.delay(this.resetClickFlag,500)},onOptionSelected:function(e){if(this.itemClicked==1)return;if(this.optionScroll&&this.optionScroll.moved||this.scroll&&this.scroll.moved)return;$("#questionOptions").find(".dropelement").removeClass("optionSelected"),$("#questionOptions").find("img").removeClass("optionSelected"),node=e.target;var t=null;node.nodeName.toLowerCase()=="img"?(node=node.parentNode,t=node.parentNode):node.nodeName.toLowerCase()=="span"?t=node.parentNode:node.nodeName.toLowerCase()=="div"&&(t=node,node=$(node).find("span")),this.itemClicked=!0,this.optionNode=$(node),this.optionSelected=$(node).html(),$(t).addClass("optionSelected");var n=this.checkAndFillValue();$("#questionText",this.obj).find("div.deleteBtn").hide(),_.delay(this.resetClickFlag,500)},onTargetSelected:function(e){if(this.itemClicked==1||this.textScroll&&this.textScroll.moved||this.scroll&&this.scroll.moved)return;$("#questionText",this.obj).find(".selected").removeClass("selected"),$("#questionText",this.obj).find(".deleteBtn").hide(),node=e.target,this.itemClicked=!0,node.nodeName.toLowerCase()=="img"&&(node=node.parentNode),utils.log(node.id),this.targetSelected=node.id,$("#"+this.targetSelected,this.obj).addClass("selected");var t=this.checkAndFillValue();!t&&$(node).html()!=""&&($("#questionText",this.obj).find("div.deleteBtn").hide(),$(node).parent().siblings("div.deleteBtn").css("display","inline-block")),_.delay(this.resetClickFlag,500)},initScroll:function(e){if(!this.optionHasImg||!utils.isPhone()){var t=$("#footer").get(0).offsetTop-$("#content").get(0).offsetTop,n=t-parseInt($("#questionOptionsWrapper",this.obj).css("height"))-parseInt($("#questionMedia",this.obj).css("height"))-parseInt($("#questionHeading",this.obj).css("height"))-64;$("#questionTextCover",this.obj).css("position","relative"),$("#questionTextCover",this.obj).css("height",n+"px"),this.textScroll!=null&&this.textScroll.destroy(),$("#questionOptions",this.obj).width($("#questionOptions",this.obj).get(0).scrollWidth),this.textScroll=new IScroll($("#questionTextCover",this.obj).get(0),{desktopCompatibility:!0,hScroll:!1}),ths=this,_.delay(function(){ths.textScroll.refresh()},999),$(".mcq4",this.obj).css("height",$(".mcq4",this.obj).height()),utils.isPhone()&&($("#questionOptionsWrapper",this.obj).addClass("isPhone"),this.optionScroll!=null&&this.optionScroll.destroy(),this.optionScroll=new IScroll($("#questionOptionsWrapper",this.obj).get(0),{desktopCompatibility:!0,scrollY:!1,scrollX:!0}),_.delay(function(){ths.optionScroll.refresh()},999))}else{var r=this;_.delay(r.initScroll2,500)}},initScroll2:function(){var e=$("#questionText",this.obj).get(0).scrollWidth,t=$("#questionOptions",this.obj).get(0).scrollWidth,n=0;$(".qinstructions",this.obj).get(0)&&$(".qinstructions",this.obj).css("display")!="none"&&(n=$(".qinstructions",this.obj).get(0).scrollWidth);var r=0;e>=t?r=e>=n?e:n:r=t>=n?t:n,$($(".pageWrapper div").get(0)).width(r);var i=$("#footer").get(0).offsetTop-$(".pageWrapper").get(0).offsetTop;$(".pageWrapper").height(i),$("#content").height($("#activityContent").get(0).scrollHeight);var s=this;this.scroll!=null&&this.scroll.destroy(),this.scroll=new IScroll($(".pageWrapper").get(0),{desktopCompatibility:!0,scrollX:!0,scrollY:!0}),$(".pageWrapper .iScrollHorizontalScrollbar").css("bottom",$("#footer").height()),_.delay(function(){s.scroll.refresh()},999)},resetClickFlag:function(){this.itemClicked=!1},checkAndFillValue:function(){if(this.optionSelected!=""&&this.targetSelected!=""){$("#"+this.targetSelected).get(0).innerHTML=this.optionSelected;var e=$("#"+this.targetSelected).find("img").height();$("#"+this.targetSelected).height(e),$("#"+this.targetSelected,this.obj).removeClass("selected"),$(".optionSelected").removeClass("optionSelected");if(this.maintainOptions==AppConst.FIB_REMOVE_OPTIONS){this.optionNode.parent().hide();var t=$("#"+this.targetSelected,this.obj).parent().siblings("div.deleteBtn");t.attr("optionId")&&$("#"+t.attr("optionId")).show(),t.attr("optionId",this.optionNode.parent().attr("id"))}var n=$(".blank",this.screen),r=0;for(var i=0;i<n.length;i++)$(n[i]).html()!=""&&r++;return r==n.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):r>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.optionSelected=this.targetSelected=this.optionNode="",this.optionHasImg||this.initScroll(),this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),!0}},populateAnswers:function(e,t){if(this.resetClicked&&this.isTest)return;utils.log(e);var n=$("#questionText",this.obj).find(".blank"),r=$("#questionText",this.obj).find("div.checkBadge"),i=$("#questionOptions",this.obj).find(".dropelement");i.removeClass("selected"),i.removeClass("optionHighlight"),i.removeClass("optionSelected"),$("#questionText",this.obj).find("div.deleteBtn").hide(),$("#questionText",this.obj).find(".selected").removeClass("selected"),t==0&&(utils.log("in correct ans false"),r.removeClass("markWrong"),r.removeClass("markRight"));var s=n.size();utils.log("max "+s),e.length>0?i.addClass("disableOption"):i.css("opacity",1);for(var o=0;o<s;o++){var u=e[o];this.maintainOptions==AppConst.FIB_REMOVE_OPTIONS&&$("#drag"+u,this.obj).hide(),myBlank=n.get(o),myBlank.innerHTML="";if(e.length>0){if(u!=""){if(this.options[u-1].type=="image"){u=this.options[u-1].data;var a=utils.renderNode({type:"image",data:u});myBlank.innerHTML=a;var f=$(myBlank).find("img").height();$(myBlank).height(f)}else u=this.options[u-1].data,myBlank.innerHTML=u;var l=$("#"+myBlank.id,this.obj).parent().siblings("div.deleteBtn");l.attr("optionid","drag"+e[o]),utils.log("answer1 "+u)}else myBlank.innerHTML=u;if(t==1){this.answers.length>0&&(this.EvaluateFlag=!0);var c=this.options[this.answers[o]-1].data.toLowerCase();userAns=u==undefined?u:u.toLowerCase(),userAns==c?r.get(o).className+=" markRight":r.get(o).className+=" markWrong"}if(this.maintainOptions!=AppConst.FIB_REMOVE_OPTIONS){var h=$("#questionOptions",this.obj).find("span");for(var p=0;p<h.length;p++){var d="";if($(h[p]).find("img").length>0){var v=$(h[p]).find("img").attr("src").split(AppConst.ASSETS_PATH);d=v[v.length-1]}else d=h[p].innerHTML;d==u&&i[p].className.search("optionHighlight")<0&&(i[p].className+=" optionHighlight")}}}}e.length>0&&(this.EvaluateFlag=!0),(this.isTest||this.partialAttempt==0)&&!this.isReview&&(r.removeClass("markWrong"),r.removeClass("markRight"),i.removeClass("selected"),i.removeClass("optionHighlight"),i.removeClass("optionSelected"),i.removeClass("disableOption")),!this.isReview&&e.length<=0&&this.enableInteraction()},handleEvaluate:function(e){if(e!=undefined&&$(e.target).hasClass("disabled"))return;this.EvaluateFlag=!0,this.resetClicked=!1;var t=$("#questionText",this.obj).find(".blank"),n=$("#questionText",this.obj).find("div.checkBadge"),r=$("#questionOptions",this.obj).find(".dropelement");n.removeClass("markRight"),n.removeClass("markWrong"),t.removeClass("selected"),r.removeClass("optionSelected"),$("#questionText",this.obj).find("div.deleteBtn").hide(),$("#questionText",this.obj).find(".selected").removeClass("selected");var i=0,s=null,o=null,u=0,a=0;this.userResponse=[];var f=0,l=0;o=$("#questionText",this.obj).find(".blank"),s="value",i=o.length,this.markPerQ=parseInt(this.maxpoints)/i;for(var c=0;c<i;c++){if($(o.get(c)).find("img").length>0)var h=$(o.get(c)).find("img").attr("src"),p=h.indexOf(AppConst.ASSETS_PATH)+parseInt(AppConst.ASSETS_PATH.length),d=h.substring(p);else var d=$(o.get(c)).html();d=d.toLowerCase(),utils.log(d),d==""&&this.userResponse.push(d);var v=[];if(this.answers[c].length&&this.answers[c].length>1)for(var m=0;m<this.answers[c].length;m++)v.push(this.options[this.answers[c][m]-1].data.toLowerCase());else v.push(this.options[this.answers[c]-1].data.toLowerCase());for(var g=0;g<this.options.length;g++)if(d==this.options[g].data.toLowerCase()){a=g+1,f++,this.userResponse.push(a);break}utils.log(d+", correct answer : "+v+" total inputs: "+i),v.indexOf(d)!=-1?(n.get(c).className+=" markRight",l+=this.markPerQ,u++):n.get(c).className+=" markWrong";for(var y=0;y<this.options.length;y++)if(this.options[y].data==d){utils.log("drops[o]",r[y]),$("#drag"+(y+1),this.obj).addClass("optionHighlight");break}}this.partialAttempt||(n.removeClass("markRight"),n.removeClass("markWrong")),this.partialAttempt==1||f==i?u>=i?this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,status:AppConst.CORRECT,score:l,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,optionImg:this.optionHasImg,multiplier:this.markPerQ,responseType:this.responseType}):u>0?this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:l,status:AppConst.PARTIAL,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,optionImg:this.optionHasImg,multiplier:this.markPerQ,responseType:this.responseType}):this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:l,status:AppConst.INCORRECT,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,optionImg:this.optionHasImg,multiplier:this.markPerQ,responseType:this.responseType}):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,optionImg:this.optionHasImg,multiplier:this.markPerQ,responseType:this.responseType}),this.lockQuestion()},lockQuestion:function(){this.correctAnswerVisible=!1,this.changeToolbar.mode=AppConst.TOOLBAR_LOCKED,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.disableInteraction()},resetQuestion:function(e){this.resetClicked=!0,this.optionSelected="",this.targetSelected="",$("#questionText",this.obj).html(""),$("#questionOptions",this.obj).html(""),this.userResponse=[],this.EvaluateFlag=!1,this.renderQues(),this.correctAnswerVisible=!1,this.enableInteraction(),this.trigger(AppEvent.MARK_EMPTY,this.qId),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)},resetQuestionPartial:function(e){this.optionSelected="",this.targetSelected="";var t=!0;this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var n=$("#questionText",this.obj).find("div.checkBadge"),r=$("#questionText",this.obj).find(".blank"),i=$("#questionOptions",this.obj).find(".dropelement");$("#questionText",this.obj).find("div.deleteBtn").hide(),$("#questionText",this.obj).find(".selected").removeClass("selected"),n.removeClass("markWrong"),n.removeClass("markRight"),i.removeClass("optionHighlight");if(this.userResponse.length>0)for(var s=0;s<this.userResponse.length;s++)this.answers[s].indexOf(this.userResponse[s])==-1?($("#drag"+this.userResponse[s],this.obj).removeClass("optionHighlight"),$("#drag"+this.userResponse[s],this.obj).show(),$("div.deleteBtn[optionid=drag"+this.userResponse[s]+"]",this.obj).attr("optionid",""),this.userResponse[s]="",$("#drop"+(s+1)).html("")):(this.maintainOptions==AppConst.FIB_REMOVE_OPTIONS&&$("#drag"+this.userResponse[s],this.obj).hide(),t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar));this.EvaluateFlag=!1,this.correctAnswerVisible=!1,this.enableInteraction(),t==0?this.trigger(AppEvent.UPDATE_RESPONSE,this.qId,{userResponse:this.userResponse}):this.trigger(AppEvent.MARK_EMPTY,this.qId),this.disableButton(AppConst.QBTN_RESET)},disableButton:function(e){$("#"+e,this.obj).addClass("disabled")},handleScreenExit:function(){try{for(var e=0;e<this.dragObjs.length;e++)this.dragObjs[e].lastCurX=null,this.dragObjs[e].lastCurY=null,this.dragObjs[e].destroy();webkit_drop.remove()}catch(t){showAlert(t)}this.textScroll!=null&&this.textScroll.destroy(),this.optionScroll!=null&&this.optionScroll.destroy(),this.scroll!=null&&this.scroll.destroy()},orientationchange:function(e){},destroy:function(){this.scroll!=null&&this.scroll.destroy(),this.unbind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.unbind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.unbind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.unbind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.unbind(AppEvent.MARK_EMPTY,this.markEmpty),this.unbind(AppEvent.UPDATE_RESPONSE,this.updateResponse),$("#questionOptions",this.obj).find("li").unbind(),$("#ques"+this.model.get("id")).remove()}});return fibTapPlace}),define("core/model/mcqBinaryVO",[],function(){var e=Backbone.Model.extend({id:"",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",maxpoints:null,heading:"",partialAttempt:!0,feedback:[],labelTrue:"",labelFalse:"",numberstyle:""});return e}),define("core/view/mcqBinary",["language","utilities","AppConst","AppEvent"],function(language,utils,AppConst,AppEvent){var mcqBinaryView=Backbone.View.extend({contentStr1:"<div class='quesWrapper' id='quesWrapper<%=id%>'><div id='ques<%=id%>' class='quesContent'>		<div id='activityContent'>		<div id='questionHeading' class='questionHeading'></div>			<div id='questionMediaWrapper'>				<div id='questionMedia' class='left question-media'></div>				<div  class='instruction'>Click/Tap to open resource</div>			</div>			<div id='questionText' class='left'></div>			<div id='questionOptions'></div>			<div id='labelanswers'></div>		</div>	</div></div>",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:[],qId:"",itemClicked:!1,correctAnswerVisible:null,inputNo:0,EvaluateFlag:!1,changeToolbar:{},nodes:[],maxpoints:0,partialAttempt:!0,scroll:null,numberstyle:"1",scroll:null,initialize:function(){_.bindAll(this,"handleMcqBtnClick","resetClickFlag","randomize","initScroll","initScroll2"),_.extend(this,Backbone.Events)},render:function(){utils.log(this.model.get("id")),this.element=this.el;var e=_.template(this.contentStr1,this.model.toJSON());$("#content",this.$el).append(e),this.screen=$("#ques"+this.model.get("id")),this.setQuestionData()},setQuestionData:function(){this.modelParagraph=this.model.get("modelParagraph"),this.type=this.model.get("type"),this.layout=this.model.get("questionLayout"),this.responseType=this.model.get("responseType"),this.clues=this.model.get("clues"),this.rubric=this.model.get("rubric"),this.questionText=JSON.stringify(this.model.get("questionBody")),this.questionMedia=this.model.get("questionMedia"),this.optionsMedia=this.model.get("optionsMedia"),this.leftCol=this.model.get("leftCol"),this.rightCol=this.model.get("rightCol"),this.opLayout=this.model.get("optionsLayout"),this.options=this.model.get("options"),this.answers=this.model.get("answers"),this.isTest=this.model.get("isTest"),this.isReview=this.model.get("isReview"),this.reviewData=this.model.get(""),this.qId=this.model.get("id"),this.maxpoints=parseInt(this.model.get("maxpoints")),this.model.get("userResponse").userResponse&&(this.userResponse=this.model.get("userResponse").userResponse,this.isAnswered=!0),this.heading=this.model.get("heading"),this.partialAttempt=this.model.get("partialAttempt"),this.labelFalse=this.model.get("labelFalse"),this.labelTrue=this.model.get("labelTrue"),this.numberstyle=this.model.get("numberstyle"),this.renderQues()},renderQues:function(){this.nodes=[],this.obj=this.screen;var qBody=eval(this.questionText.replace(/'+/g,"&apos;")),qOptions=eval(this.options),initialNumber=49,isRoman=!1;this.numberstyle=="1"?initialNumber=49:this.numberstyle=="a"?initialNumber=97:this.numberstyle=="i"&&(isRoman=!0);if(this.heading.length==0)$(".questionHeading",this.screen).hide();else{var headingStr="";for(var i=0;i<this.heading.length;i++)this.heading[i].type=="image"?headingStr+="<img src='"+AppConst.ASSETS_PATH+this.heading[i].data+"'></img>":headingStr+="<div>"+this.heading[i].data+"</div>";$(".questionHeading",this.screen).html(headingStr)}if(this.questionMedia.length==0)$("#questionMediaWrapper",this.screen).hide();else{var qMediaStr="";for(var i=0;i<this.questionMedia.length;i++)qMediaStr+=utils.renderNode(this.questionMedia[i]);$("#questionMedia",this.screen).html(qMediaStr)}var that=this;$("#questionMedia img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))});var qStr="",optionsStr="";qStr+=utils.renderNode(qBody),this.layout=="2COL"&&this.leftCol!=""&&this.rightCol!=""&&(qStr+="<div class='leftcol'>",qStr+=utils.renderNode(eval(this.leftCol)),qStr+="</div>",qStr+="<div class='rightcol'>",qStr+=utils.renderNode(eval(this.rightCol)),qStr+="</div>"),this.inputNo=this.answers.length;var node="",startLi=!0,idCounter=1;for(var i=0;i<qOptions.length;i++){var curNumbering="";isRoman?curNumbering=utils.romanize(idCounter):curNumbering=String.fromCharCode(initialNumber+idCounter-1),startLi&&(node="<li id='li"+idCounter+"' class=''><span class='numbering'>"+curNumbering+" )</span> <div class='tf-question binaryQues'>",startLi=!1),qOptions[i].data.match(/<[bB][rR]\s*[/]?>/)?(node+="</div><div class='qr-answer binaryAns'><span id='qr-correct-"+idCounter+"' class='qr-correct' data-op = '1' >"+this.labelTrue+"</span><span id='qr-incorrect-"+idCounter+"' class='qr-incorrect' data-op = '0'>"+this.labelFalse+"</span>  <div class='checkBadge4'></div> </div><div style='clear:both;'></div></li>",this.nodes.push(node),idCounter++,startLi=!0,node=""):qOptions[i].type=="image"?node+='<img src="'+AppConst.ASSETS_PATH+qOptions[i].data+'" >':node+=utils.renderNode(qOptions[i])}node.trim()!=""&&(node+="</div><div class='qr-answer binaryAns'><span id='qr-correct-"+idCounter+"' class='qr-correct' data-op = '1' >"+this.labelTrue+"</span><span id='qr-incorrect-"+idCounter+"' class='qr-incorrect' data-op = '0'>"+this.labelFalse+"</span>  <div class='checkBadge4'></div> </div><div style='clear:both;'></div></li>",this.nodes.push(node)),this.randomize(),$("#questionText",this.obj).html(qStr),qBody.length==0&&$("#questionText",this.obj).hide();var root=$(".mcq2",this.obj),options=$("input",root),len=options.length,minFontSize=14;for(var i=0;i<len;i++){var node=options[i],fsize=this.resizeText(node,minFontSize);minFontSize=fsize<minFontSize?fsize:minFontSize}for(var i=0;i<len;i++){var node=options[i];node.style.fontSize=minFontSize+"px"}this.trigger(AppEvent.TEMPLATE_READY)},resizeText:function(e,t){var n=t;while(e.offsetWidth<e.scrollWidth)e.style.fontSize=--n+"px";return n},enableInteraction:function(){$("#questionOptions",this.obj).find("input").unbind(),$("#questionOptions",this.obj).find("li").unbind(),$("#questionOptions",this.obj).find("input").removeClass("disableOption"),$("#questionOptions",this.obj).find("li").removeClass("disableOption"),$(".dropdown",this.obj).unbind(),$("#questionOptions",this.obj).find("span").bind(AppEvent.CLICK,this.handleMcqBtnClick),$("#questionOptions",this.obj).find("input").bind(AppEvent.CLICK,this.handleMcqBtnClick),$("#questionOptions",this.obj).find(".qr-correct").removeAttr("disabled"),$("#questionOptions",this.obj).find(".qr-incorrect").removeAttr("disabled"),$("#questionText",this.obj).removeClass("disabled")},disableInteraction:function(){$("#questionOptions",this.obj).find("input").addClass("disableOption"),$("#questionOptions",this.obj).find("li").addClass("disableOption"),$("#questionOptions",this.obj).find("input").unbind(),$("#questionOptions",this.obj).find("li").unbind(),$("#questionOptions",this.obj).find(".qr-correct").unbind(),$("#questionOptions",this.obj).find(".qr-incorrect").unbind(),$(".dropdown",this.obj).unbind(),$("#questionText",this.obj).addClass("disabled")},randomize:function(){if(this.responseType==""||this.responseType==AppConst.RESPONSE_TYPE_BINARY){var e="";this.opLayout=="2COL"?e="<div class='mcq4'><ul>":e="<div class='mcq2 trueFalse'><ul>";for(var t=0;t<this.nodes.length;t++)e+=this.nodes[t];e+="</ul></div>",$("#questionOptions",this.obj).html(e);var n=$("#questionOptions",this.obj).find("li").width();$("#questionOptions",this.obj).find(".tf-question").css("width",n-180+"px"),$("#questionOptions",this.obj).find(".tf-question img").css("vertical-align","middle"),$("#questionOptions",this.obj).find(".tf-question").css("vertical-align","middle"),$("#questionOptions",this.obj).find(".tf-question img").css("padding","3px"),$("#questionOptions",this.obj).find(".tf-question, .binaryAns").css("display","inline-block"),$("#questionOptions",this.obj).find(".binaryAns").css("position","relative")}},initScroll:function(){var e=this;utils.isPhone()?_.delay(e.initScroll2,1e3):e.initScroll2()},initScroll2:function(){var e=$("#questionText",this.obj).get(0).scrollWidth,e=$("#questionText",this.obj).get(0).scrollWidth,t=$("#questionOptions",this.obj).get(0).scrollWidth,n=0;$(".qinstructions",this.obj).get(0)&&$(".qinstructions",this.obj).css("display")!="none"&&(n=$(".qinstructions",this.obj).get(0).scrollWidth);var r=0;e>=t?r=e>=n?e:n:r=t>=n?t:n,$($(".pageWrapper div").get(0)).width(r);var i=$("#footer").get(0).offsetTop-$(".pageWrapper").get(0).offsetTop;$(".pageWrapper").css("height",i+"px"),$("#content").height($("#activityContent").get(0).scrollHeight+20),$(".qinstructions").height($(".qinstructions").get(0).scrollHeight);var s=this;this.scroll!=null&&this.scroll.destroy(),this.scroll=new IScroll($(".pageWrapper").get(0),{desktopCompatibility:!0,scrollX:!0,scrollY:!0}),$(".pageWrapper .iScrollHorizontalScrollbar").css("bottom",$("#footer").height()),_.delay(function(){s.scroll.refresh()},999)},handleMcqBtnClick:function(e){if(this.itemClicked==1||this.scroll&&this.scroll.moved)return;this.itemClicked=!0,utils.log($(e.target),$(e.target.parentNode));if(this.answers)$(e.target.parentNode).find(".selected").removeClass("selected"),$(e.target).addClass("selected"),this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE;else{$(e.target).hasClass("selected")?$(e.target).removeClass("selected"):$(e.target).addClass("selected");var t=$("#questionOptions",this.obj).find(".selected")}var n=$("#questionOptions").find(".selected").length;this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),n==this.answers.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):n>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),_.delay(this.resetClickFlag,500)},resetClickFlag:function(){this.itemClicked=!1},handleEvaluate:function(e){if(e!=undefined&&$(e.target).hasClass("disabled"))return;var t=this.answers.length,n=parseInt(this.maxpoints)/t,r=0;this.userResponse=[];var i=0;for(var s=0;s<this.answers.length;s++){var o=parseInt($("#li"+(s+1),this.obj).find(".selected").attr("data-op"));if(isNaN(o)){this.userResponse.push(o);continue}o==parseInt(this.answers[s])?($("#li"+(s+1),this.screen).find(".checkBadge4").addClass("markRight"),r+=n,i++,this.userResponse.push(n)):($("#li"+(s+1),this.screen).find(".checkBadge4").addClass("markWrong"),this.userResponse.push(0))}this.partialAttempt||($("#questionOptions",this.obj).find(".checkBadge4").removeClass("markRight"),$("#questionOptions",this.obj).find(".checkBadge4").removeClass("markWrong")),this.partialAttempt==1||this.userResponse.length==t?i==this.answers.length?this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,score:r,status:AppConst.CORRECT,maxScore:parseInt(this.maxpoints),type:this.type,responseType:this.responseType}):i>0?this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:r,status:AppConst.PARTIAL,maxScore:parseInt(this.maxpoints),type:this.type,responseType:this.responseType}):this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:r,status:AppConst.INCORRECT,maxScore:parseInt(this.maxpoints),type:this.type,responseType:this.responseType}):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,maxScore:parseInt(this.maxpoints),type:this.type,responseType:this.responseType}),$("#questionOptions",this.obj).find("li").removeClass("selected"),this.EvaluateFlag=!0,this.lockQuestion()},lockQuestion:function(){this.correctAnswerVisible=!1,this.changeToolbar.mode=AppConst.TOOLBAR_LOCKED,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.disableInteraction()},populateAnswers:function(e,t){e.length>0&&(this.EvaluateFlag=!0);var n=$("#questionOptions",this.obj).find("div.checkBadge4");$("#questionOptions",this.obj).find("input").removeClass("optionHighlight"),$("#questionOptions",this.obj).find("input").removeClass("selected"),$("#questionOptions",this.obj).find("li").removeClass("optionHighlight"),$("#questionOptions",this.obj).find("li").removeClass("selected"),$("#questionOptions",this.obj).find("span").removeClass("optionHighlight"),$("#questionOptions",this.obj).find("span").removeClass("selected"),t==0&&(n.removeClass("markWrong"),n.removeClass("markRight"));for(var r=0;r<e.length;r++){if(isNaN(parseInt(e[r]))){$("#li"+(r+1),this.screen).find(".checkBadge4").addClass("markWrong");continue}parseInt(e[r])>0?($("#li"+(r+1),this.screen).find(".checkBadge4").addClass("markRight"),parseInt(this.answers[r])==1?$("#qr-correct-"+(r+1),this.screen).addClass("selected"):$("#qr-incorrect-"+(r+1),this.screen).addClass("selected")):($("#li"+(r+1),this.screen).find(".checkBadge4").addClass("markWrong"),parseInt(this.answers[r])==1?$("#qr-incorrect-"+(r+1),this.screen).addClass("selected"):$("#qr-correct-"+(r+1),this.screen).addClass("selected"));var i=$("#li"+(r+1),this.screen).find("span.selected").attr("data-op");i=="1"&&$("#li"+(r+1),this.screen).find(".checkBadge4").addClass("leftBadge")}(this.isTest||this.partialAttempt==0)&&!this.isReview&&($("#questionOptions",this.obj).find(".checkBadge4").removeClass("markRight"),$("#questionOptions",this.obj).find(".checkBadge4").removeClass("markWrong"))},resetQuestion:function(e){var t=$("#questionOptions",this.obj).find("div.checkBadge4");$("#questionOptions",this.obj).find(".selected").removeClass("selected"),$("#questionOptions",this.obj).find("input").removeClass("optionHighlight");var n=$("#questionOptions",this.obj).find("li");n.removeAttr("disabled"),n.css("opacity",1),t.removeClass("markRight"),t.removeClass("markWrong"),n.removeClass("optionHighlight"),this.randomize(),this.userResponse=[],this.EvaluateFlag=!1,this.enableInteraction(),this.trigger(AppEvent.MARK_EMPTY,this.qId),this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)},resetQuestionPartial:function(e){$("#questionOptions",this.obj).find(".checkBadge4").removeClass("markWrong"),$("#questionOptions",this.obj).find(".checkBadge4").removeClass("markRight"),$("#questionOptions",this.obj).find("li").removeClass("optionHighlight"),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var t=!0;$("#questionOptions",this.obj).find(".selected").removeClass("selected"),$("#questionOptions",this.obj).find("li").removeAttr("disabled"),$("#questionOptions",this.obj).find("li").css("opacity",1);if(this.userResponse.length>0)for(var n=0;n<this.userResponse.length;n++)this.userResponse[n]==this.answers[n]?(this.userResponse[n]==0?$("#li"+(n+1),this.obj).find(".qr-correct").addClass("selected"):$("#li"+(n+1),this.obj).find(".qr-incorrect").addClass("selected"),t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)):this.userResponse[n]=undefined;this.userResponse=[],this.EvaluateFlag=!1,this.correctAnswerVisible=!1,this.enableInteraction(),t==0?this.trigger(AppEvent.UPDATE_RESPONSE,this.qId,{userResponse:this.userResponse}):this.trigger(AppEvent.MARK_EMPTY,this.qId),this.disableButton(AppConst.QBTN_RESET)},disableButton:function(e){$("#"+e,this.obj).addClass("disabled")},handleScreenExit:function(){},orientationchange:function(e){},destroy:function(){this.unbind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.unbind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.unbind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.unbind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.unbind(AppEvent.MARK_EMPTY,this.markEmpty),this.unbind(AppEvent.UPDATE_RESPONSE,this.updateResponse),$("#questionOptions",this.obj).find("li").unbind(),$("#ques"+this.model.get("id")).remove()}});return mcqBinaryView}),define("core/model/mcqVO",[],function(){var e=Backbone.Model.extend({id:"",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",heading:"",userResponse:"",partialAttempt:!0,feedback:[],numberstyle:"1"});return e}),define("core/view/mcqView",["utilities","AppConst","AppEvent"],function(utils,AppConst,AppEvent){var mcqView=Backbone.View.extend({contentStr1:"<div class='quesWrapper' id='quesWrapper<%=id%>'><div id='ques<%=id%>' class='quesContent'>		<div id='activityContent' style='display:block'>		<div id='questionHeading' class='questionHeading'></div><div id='qCover' class=''>			<div id='questionMediaWrapper'>				<div id='questionMedia' class='left question-media'></div>				<div  class='instruction'>Click/Tap to open resource</div>			</div>			<div id='questionText' class='left questionImage'></div>			<div id='questionOptions'></div></div>		</div>	</div></div>",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:[],qId:"",itemClicked:!1,correctAnswerVisible:null,inputNo:0,EvaluateFlag:!1,changeToolbar:{},nodes:[],maxpoints:0,partialAttempt:!0,scroll:null,numberstyle:"1",scroll:null,initialize:function(){_.bindAll(this,"handleMcqBtnClick","resetClickFlag","handleEvaluate","initScroll"),_.extend(this,Backbone.Events)},render:function(){this.element=this.el;var e=_.template(this.contentStr1,this.model.toJSON());$("#content",this.$el).append(e),this.screen=$("#ques"+this.model.get("id")),this.setQuestionData()},setQuestionData:function(){this.modelParagraph=this.model.get("modelParagraph"),this.type=this.model.get("type"),this.layout=this.model.get("questionLayout"),this.responseType=this.model.get("responseType"),this.clues=this.model.get("clues"),this.rubric=this.model.get("rubric"),this.questionText=JSON.stringify(this.model.get("questionBody")),this.questionMedia=this.model.get("questionMedia"),this.optionsMedia=this.model.get("optionsMedia"),this.leftCol=this.model.get("leftCol"),this.rightCol=this.model.get("rightCol"),this.opLayout=this.model.get("optionsLayout"),this.options=this.model.get("options"),this.answers=this.model.get("answers"),this.isTest=this.model.get("isTest"),this.isReview=this.model.get("isReview"),this.reviewData=this.model.get(""),this.qId=this.model.get("id"),this.maxpoints=parseInt(this.model.get("maxpoints")),this.model.get("userResponse").userResponse&&(this.userResponse=this.model.get("userResponse").userResponse,this.isAnswered=!0),this.heading=this.model.get("heading"),this.partialAttempt=this.model.get("partialAttempt"),this.numberstyle=this.model.get("numberstyle"),this.renderQues()},renderQues:function(){this.obj=this.screen;var qBody=eval(this.questionText.replace(/'+/g,"&apos;")),qOptions=eval(this.options);if(this.heading.length==0)$(".questionHeading",this.screen).hide();else{var headingStr="";for(var i=0;i<this.heading.length;i++)this.heading[i].type=="image"?headingStr+="<img src='"+AppConst.ASSETS_PATH+this.heading[i].data+"'></img>":headingStr+="<div>"+this.heading[i].data+"</div>";$(".questionHeading",this.screen).html(headingStr)}if(this.questionMedia.length==0)$("#questionMediaWrapper",this.screen).hide();else{var qMediaStr="";for(var i=0;i<this.questionMedia.length;i++)qMediaStr+=utils.renderNode(this.questionMedia[i]);$("#questionMedia",this.screen).html(qMediaStr)}var that=this;$("#questionMedia img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))});var qStr="",optionsStr="";optionHasImg=!1;var initialNumber=49,isRoman=!1;this.numberstyle=="1"?initialNumber=49:this.numberstyle=="a"?initialNumber=97:this.numberstyle=="i"&&(isRoman=!0);if(optionHasImg&&this.responseType==AppConst.RESPONSE_TYPE_BUTTON){$("#qCover",this.screen).addClass("img2col");for(var i=0;i<qBody.length;i++)switch(qBody[i].type){case"text":qStr+=qBody[i].data;break;case"image":qStr+='<div class="col inlineImg"><img src=\''+AppConst.ASSETS_PATH+qBody[i].data+"'  /></div>";break;default:}for(var i=0;i<qOptions.length;i++){var curNumbering="";isRoman?curNumbering=utils.romanize(i+1):curNumbering=String.fromCharCode(initialNumber+i);switch(qOptions[i][0].type){case"text":optionsStr+="<div class=\"optionTxt\"><span class='numbering'>"+curNumbering+' )</span>  <div id="text'+(i+1)+'" class="col">'+qOptions[i][0].data+'</div> <div id="opt'+(i+1)+"\" class='indicators modifier' "+"' data-op="+(i+1)+"> </div> </div>";break;case"image":optionsStr+="<li class=\"optionImg\"><span class='numbering'>"+curNumbering+'</span> <img id="img'+(i+1)+"\" src='"+AppConst.ASSETS_PATH+qOptions[i][0].data+"' /> <div id=\"opt"+(i+1)+"\" class='indicators modifier' "+"' data-op="+(i+1)+"> </div> </li>";break;default:}}$("#questionText",this.obj).html(qStr),$("#questionText",this.obj).css("width","50%"),utils.log("QuestionTxt: "+$("#questionText",this.obj).html()),$("#questionOptions",this.obj).html(optionsStr),$("#activityContent",this.obj).addClass("mcqviewParent"),$("#questionText",this.obj).addClass("mcqQuestionText"),$("#questionOptions",this.obj).addClass("mcqOptions")}else{qStr+=utils.renderNode(qBody),this.layout=="2COL"&&this.leftCol!=""&&this.rightCol!=""&&(qStr+="<div class='leftcol'>",qStr+=utils.renderNode(eval(this.leftCol)),qStr+="</div>",qStr+="<div class='rightcol'>",qStr+=utils.renderNode(eval(this.rightCol)),qStr+="</div>");if(this.responseType==""||this.responseType==AppConst.RESPONSE_TYPE_BUTTON){this.inputNo=this.answers.length,this.opLayout=="2COL"?qOptions[0]&&qOptions[0].type=="image"?optionsStr="<div class='mcq4'><ul class='newoptions '>":optionsStr="<div class='mcq4'><ul class='newoptions'>":qOptions[0]&&qOptions[0].type=="image"?optionsStr="<div class='mcq2'><ul class='newoptions '>":optionsStr="<div class='mcq2'><ul class='newoptions'>";for(var i=0;i<qOptions.length;i++){var curNumbering="";isRoman?curNumbering=utils.romanize(i+1):curNumbering=String.fromCharCode(initialNumber+i),optionsStr+="<li><span class='numbering'>"+curNumbering+" ) </span><div class='indicators' id='opt"+(i+1)+"' data-op="+(i+1)+"></div>";for(var j=0;j<qOptions[i].length;j++)qOptions[i][j].type=="image"?optionsStr+="<img src='"+AppConst.ASSETS_PATH+qOptions[i][j].data+"'></img>":optionsStr+="<div>"+qOptions[i][j].data+"</div>",this.optionsMedia.length!=0&&this.optionsMedia[i]!=undefined&&(this.optionsMedia[i].type=="image"?this.optionsMedia[i].type="optionImage":this.optionsMedia[i].type=="text"&&(this.optionsMedia[i].type="optionText"),optionsStr+="<div class='options-media'>"+utils.renderNode(this.optionsMedia[i])+"</div>");optionsStr+="</li>"}optionsStr+="</ul></div>",$("#questionOptions",this.obj).html(optionsStr),$("#questionText",this.obj).html(qStr),this.inputNo>1&&$("#questionOptions",this.obj).addClass("checkbox");if(qOptions[0]&&qOptions[0].type=="image"){var l=$("#questionText",this.obj).find(".leftcol"),r=$("#questionText",this.obj).find(".rightcol");l.before(r),l.removeClass("leftcol"),r.removeClass("rightcol")}}}var root=$(".mcq2",this.obj),options=$("input",root),len=options.length,minFontSize=14;for(var i=0;i<len;i++){var node=options[i],fsize=this.resizeText(node,minFontSize);minFontSize=fsize<minFontSize?fsize:minFontSize}for(var i=0;i<len;i++){var node=options[i];node.style.fontSize=minFontSize+"px"}this.trigger(AppEvent.TEMPLATE_READY);if(utils.isPhone()){var that=this;_.delay(that.initScroll,1e3)}},initScroll:function(){var e=$("#questionText",this.obj).get(0).scrollWidth,t=$("#questionOptions",this.obj).get(0).scrollWidth,n=0;$(".qinstructions",this.obj).get(0)&&$(".qinstructions",this.obj).css("display")!="none"&&(n=$(".qinstructions",this.obj).get(0).scrollWidth);var r=0;e>=t?r=e>=n?e:n:r=t>=n?t:n,$($(".pageWrapper div").get(0)).width(r);var i=$("#footer").get(0).offsetTop-$(".pageWrapper").get(0).offsetTop;$(".pageWrapper").height(i),$("#content").height($("#activityContent").get(0).scrollHeight),$(".qinstructions").height($(".qinstructions").get(0).scrollHeight);var s=this;this.scroll!=null&&this.scroll.destroy(),this.scroll=new IScroll($(".pageWrapper").get(0),{desktopCompatibility:!0,scrollX:!0,scrollY:!0}),$(".pageWrapper .iScrollHorizontalScrollbar").css("bottom",$("#footer").height()),_.delay(function(){s.scroll.refresh()},999)},resizeText:function(e,t){var n=t;while(e.offsetWidth<e.scrollWidth)e.style.fontSize=--n+"px";return n},enableInteraction:function(){$("#questionOptions",this.obj).find("input").unbind(),$("#questionOptions",this.obj).find("li").unbind(),$("#questionOptions",this.obj).find("input").removeClass("disableOption").removeClass("disabled"),$("#questionOptions",this.obj).find("li").removeClass("disableOption").removeClass("disabled"),$("#questionOptions",this.obj).find("li").removeClass("disableOption").removeClass("disabled"),$("#questionOptions",this.obj).find("img").removeClass("disableOption").removeClass("disabled"),$("#questionOptions",this.obj).find("div").removeClass("disableOption").removeClass("disabled"),$("#questionText").removeClass("disabled");var qOptions=eval(this.options);$("#questionOptions",this.obj).find(".indicators").bind(AppEvent.CLICK,this.handleMcqBtnClick),$("#questionOptions",this.obj).find("input").bind(AppEvent.CLICK,this.handleMcqBtnClick),$(".options-media img",this.obj).unbind().bind(AppEvent.CLICK,function(){utils.openNewWindow($(".options-media img").data("url"))})},disableInteraction:function(){$("#questionOptions",this.obj).find("input").addClass("disableOption"),$("#questionOptions",this.obj).find("li").addClass("disableOption"),$("#questionOptions",this.obj).find("img").addClass("disableOption"),$("#questionOptions",this.obj).find("input").unbind(),$("#questionOptions",this.obj).find(".indicators").unbind(),$("#questionOptions",this.obj).find(".qr-correct").unbind(),$("#questionOptions",this.obj).find(".qr-incorrect").unbind(),$("#questionOptions",this.obj).find(".optionImg").unbind(),$("#questionText").addClass("disabled")},handleMcqBtnClick:function(e){var t=e.target.parentNode.className;if(t.indexOf("options-media")>-1)return;if(this.itemClicked==1||this.scroll&&this.scroll.moved)return;this.itemClicked=!0;var n=e.target;this.answers.length==1?($("#questionOptions",this.obj).find(".selected").removeClass("selected"),utils.log(n),n.nodeName.toLowerCase()!="li"?(n.nodeName.toLowerCase()=="img"&&($(n).addClass("selected"),$(n.parentNode).find(".modifier").addClass("selected")),$(n).hasClass("modifier")&&$(n).addClass("selected"),$(n.parentNode).find(".modifier").length>0?$(n).find(".modifier").addClass("selected"):(n=n.parentNode,$(n).find(".indicators").addClass("selected"),$(n).find(".optionsText").addClass("selected"))):($(n).find(".indicators").addClass("selected"),$(n).find(".optionsText").addClass("selected")),this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE):(n.nodeName.toLowerCase()!="li"&&(n=n.parentNode),$(n).find(".indicators").hasClass("selected")?($(n).find(".indicators").removeClass("selected tick"),$(n).find(".optionsText").removeClass("selected")):$("ul.newoptions,div.mcqOptions",this.obj).find(".indicators.selected").length<this.answers.length&&($(n).find(".indicators").addClass("selected tick"),$(n).find(".optionsText").addClass("selected")));var r=$("#questionOptions",this.obj).find(".indicators.selected");this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,r.length==this.answers.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):r.length>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),_.delay(this.resetClickFlag,500)},resetClickFlag:function(){this.itemClicked=!1},handleEvaluate:function(e){if(e!=undefined&&$(e.target).hasClass("disabled"))return;this.userResponse=[],blankObjsBadges=$("#questionOptions",this.obj).find("div.indicators");if(this.answers.length==1){var t=$("#questionOptions",this.obj).find(".indicators.selected").attr("data-op"),n=this.maxpoints,r=0;this.userResponse.push(t);var i=$("#questionOptions",this.obj).find(".indicators.selected").length;this.partialAttempt==1||i>0?t==this.answers[0]?(blankObjsBadges.get(t-1).className+=" markRight2",r+=n,this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,score:r,status:AppConst.CORRECT,maxScore:parseInt(this.maxpoints),optLength:this.options.length,type:this.type,responseType:this.responseType})):(blankObjsBadges.get(t-1).className+=" markWrong2",this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:r,status:AppConst.INCORRECT,maxScore:parseInt(this.maxpoints),optLength:this.options.length,type:this.type,responseType:this.responseType})):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,maxScore:parseInt(this.maxpoints),type:this.type,optLength:this.options.length,responseType:this.responseType})}else if(this.answers.length>1){var s=$("#questionOptions",this.obj).find(".indicators.selected");$("#questionOptions",this.obj).removeClass("selected"),blankObjsBadges=$("#questionOptions",this.obj).find("div.indicators");var o=0,u=0;u=this.answers.length;var n=parseInt(this.maxpoints)/u,r=0;for(var a=0;a<this.answers.length;a++){var t=$(s.get(a)).attr("data-op");this.userResponse.push(""+t)}for(var f=0;f<s.length;f++){var l=parseInt(this.userResponse[f]),t=parseInt($(s.get(f)).attr("data-op"));this.answers.indexOf(l)>=0?(blankObjsBadges.get(t-1).className+=" markRight2",r+=n,o++):blankObjsBadges.get(t-1).className+=" markWrong2"}this.partialAttempt==1||s.length==u?o==this.answers.length?this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,score:r,status:AppConst.CORRECT,maxScore:parseInt(this.maxpoints),type:this.type,optLength:this.options.length,responseType:this.responseType}):o>0?this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:r,status:AppConst.PARTIAL,maxScore:parseInt(this.maxpoints),type:this.type,optLength:this.options.length,responseType:this.responseType}):this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:r,status:AppConst.INCORRECT,maxScore:parseInt(this.maxpoints),type:this.type,optLength:this.options.length,responseType:this.responseType}):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,maxScore:parseInt(this.maxpoints),type:this.type,optLength:this.options.length,responseType:this.responseType})}this.partialAttempt||(blankObjsBadges.removeClass("markRight2"),blankObjsBadges.removeClass("markWrong2")),$("#questionOptions",this.obj).find("li").removeClass("selected"),this.EvaluateFlag=!0,this.lockQuestion()},lockQuestion:function(){this.correctAnswerVisible=!1,this.changeToolbar.mode=AppConst.TOOLBAR_LOCKED,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.disableInteraction()},populateAnswers:function(e,t){e.length>0&&(this.EvaluateFlag=!0);var n=!1;e.length>1&&(n=!0);var r=$("#questionOptions",this.obj).find(".indicators.selected");$("#questionOptions",this.obj).find("input").removeClass("optionHighlight"),$("#questionOptions",this.obj).find("input").removeClass("selected"),$("#questionOptions",this.obj).find("img").removeClass("optionHighlight"),$("#questionOptions",this.obj).find("img").removeClass("selected"),$("#questionOptions",this.obj).find(".indicators").removeClass("markRight2"),$("#questionOptions",this.obj).find(".indicators").removeClass("markWrong2"),$("#questionOptions",this.obj).find(".indicators").removeClass("selected tick"),$("#questionOptions",this.obj).find("div.optionsText").removeClass("Selected"),$("#questionOptions",this.obj).find(".qr-incorrect").removeClass("selected"),$("#questionOptions",this.obj).find(".qr-correct").removeClass("selected"),t==0&&(this.responseType==AppConst.RESPONSE_TYPE_PICKER?($("#MCQpick",this.obj).removeClass("markWrong2"),$("#MCQpick",this.obj).removeClass("markRight2")):(r.removeClass("markWrong2"),r.removeClass("markRight2")));if(this.responseType==AppConst.RESPONSE_TYPE_PICKER)e.length>0?(ans=this.options[e[0]-1].data,$("#questionOptions",this.obj).find("input").val(ans)):$("#questionOptions",this.obj).find("input").val(" ");else if(this.responseType==AppConst.RESPONSE_TYPE_BINARY){if(e.length>0)for(var i=0;i<e.length;i++)e[i]==0?$("#li"+(i+1),this.obj).find(".qr-correct").addClass("selected"):e[i]==1&&$("#li"+(i+1),this.obj).find(".qr-incorrect").addClass("selected")}else{e.length>0?($("#questionOptions",this.obj).find("li").attr("disabled","disabled"),$("#questionOptions",this.obj).find("li").addClass("disabled")):($("#questionOptions",this.obj).find("li").removeAttr("disabled"),$("#questionOptions",this.obj).find("li").removeClass("disabled"),$("#questionOptions",this.obj).find(".selected").removeClass("selected"));for(var s=0;s<e.length;s++)$("#opt"+e[s],this.obj).addClass("selected"),$("#text"+e[s],this.obj).addClass("selected"),n&&$("#opt"+e[s],this.obj).addClass("tick")}if(t==1){for(var s=0;s<this.userResponse.length;s++)for(var o=0;o<this.answers.length;o++){var u=parseInt(this.userResponse[o]);this.answers.indexOf(u)>=0?($("#opt"+u,this.obj).addClass("markRight2"),$("#li"+u,this.obj).find(".indicators").addClass("selected"),n&&$("#li"+u,this.obj).find(".indicators").addClass("tick"),$("#li"+u,this.obj).find(".optionsText").addClass("selected"),$("#opt"+u,this.obj).find("img")?$("#opt"+u,this.obj).find("img").addClass("selected"):($("#opt"+u,this.obj).addClass("markWrong2"),$("#li"+u,this.obj).find(".optionsText").addClass("selected"),$("#opt"+u,this.obj).addClass("selected"))):($("#opt"+u,this.obj).addClass("markWrong2"),$("#opt"+u,this.obj).find("img").length>0?$("#opt"+u,this.obj).find("img").addClass("selected"):($("#opt"+u,this.obj).addClass("selected"),$("#opt"+u,this.obj).find(".indicators").addClass("selected"),n&&$("#opt"+u,this.obj).find(".indicators").addClass("tick"),$("#opt"+u,this.obj).find(".optionsText").addClass("selected")))}(this.isTest||this.partialAttempt==0)&&!this.isReview&&($("#questionOptions",this.obj).find(".checkBadge2").removeClass("markRight2"),$("#questionOptions",this.obj).find(".checkBadge2").removeClass("markWrong2"),$("#questionOptions",this.obj).find(".indicators").removeClass("markRight2"),$("#questionOptions",this.obj).find(".indicators").removeClass("markWrong2"))}},resetQuestion:function(e){var t=$("#questionOptions",this.obj).find("div.indicators");if(this.responseType==""||this.responseType==AppConst.RESPONSE_TYPE_BINARY){$("#questionOptions",this.obj).find(".selected").removeClass("selected"),$("#questionOptions",this.obj).find("input").removeClass("optionHighlight");var n=$("#questionOptions",this.obj).find("li");n.removeAttr("disabled"),n.removeClass("disabled"),t.removeClass("markRight2"),t.removeClass("markWrong2"),n.removeClass("optionHighlight")}else if(this.responseType==""||this.responseType==AppConst.RESPONSE_TYPE_BUTTON){$("#questionOptions",this.obj).find(".selected").removeClass("selected"),$("#questionOptions",this.obj).find(".tick").removeClass("tick"),$("#questionOptions",this.obj).find("input").removeClass("optionHighlight"),$("#questionOptions",this.obj).find("img").removeClass("optionHighlight");var n=$("#questionOptions",this.obj).find("li");n.removeAttr("disabled"),n.removeClass("disabled"),t.removeClass("markRight2"),t.removeClass("markWrong2"),n.removeClass("optionHighlight")}else this.responseType==AppConst.RESPONSE_TYPE_PICKER&&($("#MCQpick",this.obj).val(""),$("#MCQpick",this.obj).removeClass("markRight2"),$("#MCQpick",this.obj).removeClass("markWrong2"),$("#MCQpick",this.obj).removeClass("disabled"),$("#MCQpick",this.obj).removeClass("selected"));this.userResponse=[],this.EvaluateFlag=!1,this.enableInteraction(),this.trigger(AppEvent.MARK_EMPTY,this.qId),this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)},resetQuestionPartial:function(e){var t=!0;$("#questionOptions",this.obj).find(".indicators").removeClass("markWrong2"),$("#questionOptions",this.obj).find(".indicators").removeClass("markRight2"),$("#questionOptions",this.obj).find("li").removeClass("optionHighlight"),$("#questionOptions",this.obj).find("img").removeClass("optionHighlight"),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);if(this.responseType==""||this.responseType==AppConst.RESPONSE_TYPE_BUTTON){$("#questionOptions",this.obj).find(".selected").removeClass("selected"),$("#questionOptions",this.obj).find("li").removeAttr("disabled"),$("#questionOptions",this.obj).find("li").removeClass("disabled");if(this.userResponse.length>0)for(var n=0;n<this.userResponse.length;n++)this.answers.indexOf(this.userResponse[n])>-1?($("#opt"+this.userResponse[n],this.obj).find("img").length!=0?($("#opt"+this.userResponse[n],this.obj).find("img").addClass("selected"),$("#opt"+this.userResponse[n],this.obj).addClass("selected")):$("#opt"+this.userResponse[n],this.obj).addClass("selected"),this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),t=!1):this.userResponse[n]=""}this.EvaluateFlag=!1,this.correctAnswerVisible=!1,this.enableInteraction(),t==0?this.trigger(AppEvent.UPDATE_RESPONSE,this.qId,{userResponse:this.userResponse}):this.trigger(AppEvent.MARK_EMPTY,this.qId),this.disableButton(AppConst.QBTN_RESET)},disableButton:function(e){$("#"+e,this.obj).addClass("disabled")},handleScreenExit:function(){},orientationchange:function(e){},randomize:function(){if(this.responseType==""||this.responseType==AppConst.RESPONSE_TYPE_BINARY){var e="";this.opLayout=="2COL"?e="<div class='mcq4'><ul>":e="<div class='mcq2 trueFalse'><ul>";for(var t=0;t<this.nodes.length;t++)e+=this.nodes[t];e+="</ul></div>",$("#questionOptions").html(e)}},destroy:function(){this.unbind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.unbind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.unbind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.unbind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.unbind(AppEvent.MARK_EMPTY,this.markEmpty),this.unbind(AppEvent.UPDATE_RESPONSE,this.updateResponse),$("#questionOptions",this.obj).find("li").unbind(),$("#ques"+this.model.get("id")).remove()}});return mcqView}),define("core/model/groupingTapPlaceVO",[],function(){var e=Backbone.Model.extend({id:"",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",heading:"",userResponse:"",partialAttempt:!0,feedback:[]});return e}),define("core/view/groupingTapPlace",["language","utilities","AppConst","AppEvent"],function(language,utils,AppConst,AppEvent){var groupingTapPlace=Backbone.View.extend({contentStr1:"<div class='quesWrapper' id='quesWrapper<%=id%>'><div id='ques<%=id%>'  class='quesContent'>		<div id='activityContent'>		<div id='questionHeading' class='questionHeading'></div>			<div id='questionMediaWrapper'>				<div id='questionMedia' class='left question-media'></div>				<div  class='instruction'>Click/Tap to open resource</div>			</div>			<div id='questionText' class='groupingText'></div>			<div id='questionOptionsCover'>			<div id='questionOptions'></div></div>			<div id='labelanswers'></div>		</div>	</div></div>",modelParagraph:"",type:"",qId:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",itemClicked:!1,correctAnswerVisible:null,inputNo:0,EvaluateFlag:!1,changeToolbar:{},drags:[],drops:[],dragObjs:[],targetSelected:"",optionSelected:"",optionNode:"",templateOptionItem:"<div class='dropelement' id='drag<%=index+1%>'><span><%=option.data%></span></div>",resetClicked:!1,alphabets:[],colors:[],optionColor:"",maxpoints:0,partialAttempt:!0,optionScroll:null,quesScroll:null,title:"",blanksCount:"",groupsCount:"",initialize:function(){_.bindAll(this,"handleScreenExit","handleEvaluate","initScroll","onOptionSelected","onTargetSelected","resetClickFlag","addHoverClass"),_.extend(this,Backbone.Events)},render:function(){this.element=this.el;var e=_.template(this.contentStr1,this.model.toJSON());$("#content",this.$el).append(e),this.screen=$("#ques"+this.model.get("id")),this.setQuestionData()},setQuestionData:function(){this.modelParagraph=this.model.get("modelParagraph"),this.type=this.model.get("type"),this.layout=this.model.get("questionLayout"),this.responseType=this.model.get("responseType"),this.clues=this.model.get("clues"),this.rubric=this.model.get("rubric"),this.questionText=JSON.stringify(this.model.get("questionBody")),this.questionMedia=this.model.get("questionMedia"),this.optionsMedia=this.model.get("optionsMedia"),this.leftCol=this.model.get("leftCol"),this.rightCol=this.model.get("rightCol"),this.opLayout=this.model.get("optionsLayout"),this.options=this.model.get("options"),this.answers=this.model.get("answers"),this.isTest=this.model.get("isTest"),this.isReview=this.model.get("isReview"),this.reviewData=this.model.get(""),this.qId=this.model.get("id"),this.maxpoints=parseInt(this.model.get("maxpoints")),this.model.get("userResponse").userResponse&&(this.userResponse=this.model.get("userResponse").userResponse),this.heading=this.model.get("heading"),this.inputNo=this.answers.length,this.partialAttempt=this.model.get("partialAttempt"),this.title=this.model.get("title"),this.alphabets=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.colors=["#80b31c","#ff6600","#c33768","#37aec3","red","#bcff81","black"],this.blanksCount=this.model.get("blanksCount"),this.groupsCount=this.model.get("groupsCount"),this.renderQues()},initScroll:function(e){var t=($("#footer").get(0).offsetTop-$("#content").get(0).offsetTop)/2,n=$("#footer").get(0).offsetTop-$("#content").get(0).offsetTop-parseInt($("#questionText",this.obj).outerHeight())-parseInt($("#questionHeading",this.obj).outerHeight())-parseInt($("#questionMedia",this.obj).outerHeight())-$("#questionMediaWrapper",this.obj).find(".instruction").outerHeight();-44,$("#questionOptionsCover",this.obj).css("position","relative"),$("#questionOptionsCover",this.obj).css("height",n+"px"),this.optionScroll!=null&&this.optionScroll.destroy(),this.optionScroll=new IScroll($("#questionOptionsCover",this.obj).get(0),{desktopCompatibility:!0,hScroll:!1}),ths=this,_.delay(function(){ths.optionScroll.refresh()},999);var r=$(".bottomsort",this.obj).get(0).scrollWidth+10;$("#questionText",this.obj).css("width",$("#questionText",this.obj).width()),$(".bottomsort",this.obj).css("width",r),$("#questionText",this.obj).css("overflow","hidden"),this.quesScroll!=null&&this.quesScroll.destroy(),this.quesScroll=new IScroll($("#questionText",ths.obj).get(0),{desktopCompatibility:!0,scrollX:!0,scrollY:!1}),_.delay(function(){ths.quesScroll.refresh()},999)},renderQues:function(){this.userResponse&&this.userResponse.length>0&&(this.EvaluateFlag=!0),this.drags=[],this.drops=[],this.dropObjs=[],this.dropSequence=[],this.droppedCount=0,this.layout=this.layout.toUpperCase();if(this.heading.length==0)$(".questionHeading",this.screen).hide();else{var headingStr="";for(var i=0;i<this.heading.length;i++)this.heading[i].type=="image"?headingStr+="<img src='"+AppConst.ASSETS_PATH+this.heading[i].data+"'></img>":headingStr+="<div>"+this.heading[i].data+"</div>";$(".questionHeading",this.screen).html(headingStr)}if(this.questionMedia.length==0)$("#questionMediaWrapper",this.screen).hide();else{var qMediaStr="";for(var i=0;i<this.questionMedia.length;i++)qMediaStr+=utils.renderNode(this.questionMedia[i]);$("#questionMedia",this.screen).html(qMediaStr)}var that=this;$("#questionMedia img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))}),this.obj=this.screen;var qBody=eval(this.questionText),qOptions=eval(_.clone(this.options)),layoutClass="col-grouping-three";qOptions.length<=2&&(layoutClass="col-grouping-two");var qStr="<ul class='topsort'>",liCount=0,totalLength=Math.ceil(qBody.length/4)*4;for(var i=0;i<totalLength;i++){liCount++;if(qBody[i]!=undefined){qStr+="<li id='opt"+(i+1)+"' class='matchdrag ' >",qStr+="<div class='checkBadge' id='badge"+(i+1)+"'></div>";for(var j=0;j<qBody[i].length;j++)qBody[i][j].type=="image"?qStr+="<img id='img"+(i+1)+"' class='' src='"+AppConst.ASSETS_PATH+qBody[i][j].data+"'></img>":(qStr+="<span id='text"+(i+1)+"' class='optionsText'>"+qBody[i][j].data,qStr+="</span>");this.drags.push(""+(i+1)),qStr+="<span class='dragBand hide'></span></li>"}}qStr+="</ul>";var optionsStr="<div class='bottomsort'>";for(var i=0;i<qOptions.length;i++)optionsStr+="<div id='drop"+(i+1)+"' class='matchdrop' style='background-color:"+this.colors[i]+"' ><span>"+qOptions[i].data+"</span>",optionsStr+="<span class='dropBand' style='background-color:"+this.colors[i]+"'  ></span>",optionsStr+="</div>",this.drops.push("drop"+(i+1));optionsStr+="</div>",$("#questionText",this.obj).html(optionsStr),$("#questionText",this.obj).removeClass("left"),$("#questionOptions",this.obj).html(qStr);var ulList=$(".topsort",this.obj),liArr=ulList.find("li"),randomArr=liArr;ulList.html(randomArr);var drops=$(".matchdrop",this.obj),len=drops.length,minFontSize=16;for(var i=0;i<len;i++){var node=drops[i];node.style.fontSize=minFontSize+"px"}var drags=$(".matchdrag",this.obj),len=drags.length,minFontSize=16;for(var i=0;i<len;i++){var node=drags[i];node.style.fontSize=minFontSize+"px"}var fontSize=this.resizeText(drops,.8);drops.find("span").css("font-size",fontSize+"em"),this.maxItemHeight=this.checkMaxHeight(qOptions,"drop"),$(".matchdrop",this.screen).css("height",this.maxItemHeight+"px"),this.trigger(AppEvent.TEMPLATE_READY)},checkMaxHeight:function(e,t){var n=e.length,r=0;for(var i=0;i<n;i++){var s=$("#"+t+(i+1),this.screen).css("height");s=s.substr(0,s.length-2),s>r&&(r=s)}return r},resizeText:function(e,t){var n=t;for(var r=0;r<e.length;r++)e[r].offsetWidth<e[r].scrollWidth&&(n-=.1);return n},enableInteraction:function(){$(".matchdrag",this.obj).bind(AppEvent.CLICK,this.onTargetSelected),$(".matchdrop",this.obj).bind(AppEvent.CLICK,this.onOptionSelected),$(".matchdrag",this.obj).removeClass("disableTarget"),$(".matchdrop",this.obj).removeClass("disableOption"),$("#questionText",this.obj).removeClass("disabled")},disableInteraction:function(){$(".matchdrag",this.obj).unbind(),$(".matchdrop",this.obj).unbind(),$(".matchdrag",this.obj).addClass("disableTarget"),$(".matchdrop",this.obj).addClass("disableOption"),$("#questionText",this.obj).addClass("disabled")},onOptionSelected:function(e){if(this.itemClicked==1||this.quesScroll&&this.quesScroll.moved)return;$("#questionText",this.obj).find(".optionSelected").css("color","#fff"),$("#questionText",this.obj).find(".optionSelected").removeClass("optionSelected"),node=e.target,node.nodeName.toLowerCase()=="span"&&(node=node.parentNode),this.itemClicked=!0,this.optionNode=node.id;var t=parseInt(node.id.split("drop")[1]);this.optionSelected=this.alphabets[t-1],this.optionColor=$(node).find(".dropBand").css("background-color");var n=this;$("#"+this.optionNode,this.obj).addClass("optionSelected"),$("#"+this.optionNode,this.obj).css("color",this.optionColor),$("#"+this.optionNode,this.obj).css("border","solid 2px "+this.optionColor),_.delay(function(){n.addHoverClass(n.optionNode)},300),_.delay(this.resetClickFlag,500)},onTargetSelected:function(e){if(this.itemClicked==1||this.optionScroll&&this.optionScroll.moved)return;$("#questionOptions",this.obj).find(".optionSelected").find(".optionsText").css("color","#3462bf"),$("#questionOptions",this.obj).find(".optionSelected").removeClass("optionSelected"),node=e.target;if(node.nodeName.toLowerCase()=="div"||node.nodeName.toLowerCase()=="span"||node.nodeName.toLowerCase()=="img")node=node.parentNode;this.itemClicked=!0,this.targetSelected=node.id;var t=this;$("#"+this.targetSelected,this.obj).addClass("optionSelected"),$("#"+this.targetSelected,this.obj).find(".optionsText").addClass("optionSelected"),$("#"+this.targetSelected,this.obj).find(".optionsText").css("color","#3462bf"),_.delay(function(){t.addHoverClass(t.targetSelected)},300),_.delay(this.resetClickFlag,500)},addHoverClass:function(e){this.checkAndFillValue()},resetClickFlag:function(){this.itemClicked=!1},checkAndFillValue:function(){if(this.optionSelected!=""&&this.targetSelected!=""){$("#"+this.targetSelected,this.obj).get(0).setAttribute("data-group",this.optionSelected),$("#"+this.targetSelected,this.obj).css("background-color",this.optionColor),badge=$("#"+this.targetSelected).find(".dragBand"),badge.html(this.optionSelected),$(".matchdrop",this.obj).removeClass("optionSelected"),$(".matchdrop",this.obj).css("color","#fff"),$("#"+this.targetSelected,this.obj).removeClass("optionSelected"),$("#"+this.targetSelected,this.obj).css("color","#fff"),$("#"+this.targetSelected,this.obj).find(".optionsText").removeClass("optionSelected"),$("#"+this.targetSelected,this.obj).find(".optionsText").css("color","#fff"),this.optionSelected=this.targetSelected=this.optionNode="",this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var e=0;for(var t=0;t<this.drags.length;t++)dragLabel=$("#opt"+this.drags[t],this.obj).find(".dragBand").html(),dragLabel!=""&&e++;e==this.drags.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):e>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)}},handleEvaluate:function(e){if(e!=undefined&&$(e.target).hasClass("disabled"))return;this.EvaluateFlag=!0;var correctAnswerLabels=[],binLabels=[];this.userResponse=[];var myanswerIndex=0,totalCorrect=0,ulList=$(".topsort",this.obj).find("li");this.answers=_.flatten(this.answers),$(".matchdrag",this.obj).removeClass("optionSelected"),$(".optionText",this.obj).removeClass("optionSelected"),$(".matchdrag",this.obj).css("color","#fff"),$(".optionText",this.obj).css("color","#fff"),$(".matchdrag",this.obj).find("div.checkBadge").removeClass("markRight"),$(".matchdrag",this.obj).find("div.checkBadge").removeClass("markWrong");var qOptions=eval(_.clone(this.options)),markPerQ=parseInt(this.maxpoints)/this.drags.length,marksQbtained=0;for(var i=0;i<qOptions.length;i++)binLabels.push(this.alphabets[i]);for(var i=0;i<this.drags.length;i++)dragLabel=$("#opt"+this.drags[i],this.obj).find(".dragBand").html(),dragLabelIndex=binLabels.indexOf(dragLabel)+1,this.userResponse.push(dragLabelIndex),dragLabel!=""&&(dragLabelIndex==this.answers[i]?($("#badge"+(i+1)).addClass("markRight"),marksQbtained+=markPerQ,totalCorrect++):$("#badge"+(i+1)).addClass("markWrong"));this.partialAttempt||($(".checkBadge",this.obj).removeClass("markRight"),$(".checkBadge",this.obj).removeClass("markWrong"));var attemtedInputs=_.without(this.userResponse,0).length;this.partialAttempt==1||attemtedInputs==this.drags.length?totalCorrect==this.drags.length?this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,score:marksQbtained,status:AppConst.CORRECT,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,blanksCount:this.blanksCount,groupsCount:this.groupsCount,responseType:this.responseType}):totalCorrect>0?this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:marksQbtained,status:AppConst.PARTIAL,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,blanksCount:this.blanksCount,groupsCount:this.groupsCount,responseType:this.responseType}):this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:marksQbtained,status:AppConst.INCORRECT,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,blanksCount:this.blanksCount,groupsCount:this.groupsCount,responseType:this.responseType}):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,blanksCount:this.blanksCount,groupsCount:this.groupsCount,responseType:this.responseType}),this.isReset=!1,this.lockQuestion()},lockQuestion:function(){this.correctAnswerVisible=!1,this.changeToolbar.mode=AppConst.TOOLBAR_LOCKED,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.disableInteraction()},checkMaxHeight:function(e,t){var n=e.length,r=0;for(var i=0;i<n;i++){var s=$("#"+t+(i+1),this.screen).css("height");s=parseInt(s.substr(0,s.length-2)),s>r&&(r=s)}return r},populateAnswers:function(answers,correctAnswerVisible){if(this.isReset&&this.isTest&&!this.isReview)return;try{answers.length>0&&(this.EvaluateFlag=!0),$(".matchdrag",this.obj).unbind();var qBody=eval(this.questionText);$("#questionOptions",this.obj).find(".dragBand").html(""),this.answers=_.flatten(this.answers);if(answers.length>0)for(var i=0;i<answers.length;i++){if(answers[i]!=0){var dragDataGroup=$("#drop"+answers[i],this.obj).find("span").html();utils.log("dragDataGroup : "+dragDataGroup),$("#opt"+this.drags[i],this.obj).get(0).setAttribute("data-group",dragDataGroup),$("#opt"+this.drags[i],this.obj).find(".dragBand").html(this.alphabets[answers[i]-1]),$("#opt"+this.drags[i],this.obj).css("background-color",this.colors[answers[i]-1])}else $("#opt"+this.drags[i],this.obj).find(".dragBand").html("");this.resetFlag!=1&&correctAnswerVisible!=0?answers[i]==this.answers[i]?$("#badge"+(i+1),this.obj).addClass("markRight"):$("#badge"+(i+1),this.obj).addClass("markWrong"):(utils.log("else case"),$("#badge"+(i+1),this.obj).removeClass("markRight"),$("#badge"+(i+1),this.obj).removeClass("markWrong"))}else $(".dragBand",this.obj).find(".dragBand").html("");(this.isTest||this.partialAttempt==0)&&!this.isReview&&($(".checkBadge",this.obj).removeClass("markRight"),$(".checkBadge",this.obj).removeClass("markWrong")),this.resetFlag=!1,!this.isReview&&answers.length<=0&&this.enableInteraction()}catch(error){showAlert(error)}},resetQuestion:function(e){this.isReset=!0,this.resetClicked=!0,$("#questionText",this.obj).html(""),$("#questionOptions",this.obj).html(""),this.userResponse=[],this.renderQues(),this.enableInteraction(),this.trigger(AppEvent.MARK_EMPTY,this.qId),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.EvaluateFlag=!1,this.optionSelected="",this.targetSelected="",$(".matchdrag",this.obj).removeClass("optionSelected"),$(".matchdrag",this.obj).css("color","#fff"),this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)},resetQuestionPartial:function(e){this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var t=!0;if(this.userResponse.length>0)for(var n=0;n<this.userResponse.length;n++)this.userResponse[n]==this.answers[n]?(t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)):(this.userResponse[n]=0,$("#opt"+this.drags[n],this.obj).removeAttr("background-color"),$("#opt"+this.drags[n],this.obj).find(".optionsText").removeAttr("color"),$("#opt"+this.drags[n],this.obj).get(0).setAttribute("data-group",""),$("#opt"+this.drags[n],this.obj).find(".dragBand").html(""));this.EvaluateFlag=!1,this.resetFlag=!0,this.optionSelected="",this.targetSelected="",this.populateAnswers(this.userResponse,!0),this.enableInteraction(),t==0?this.trigger(AppEvent.UPDATE_RESPONSE,this.qId,{userResponse:this.userResponse}):this.trigger(AppEvent.MARK_EMPTY,this.qId),this.disableButton(AppConst.QBTN_RESET)},disableButton:function(e){$("#"+e,this.obj).addClass("disabled")},handleScreenExit:function(){this.iScroll!=null&&this.iScroll.destroy(),this.optionScroll!=null&&this.optionScroll.destroy(),this.quesScroll!=null&&this.quesScroll.destroy()},orientationchange:function(e){},destroy:function(){this.unbind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.unbind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.unbind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.unbind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.unbind(AppEvent.MARK_EMPTY,this.markEmpty),this.unbind(AppEvent.UPDATE_RESPONSE,this.updateResponse),$("#questionOptions",this.obj).find("li").unbind(),$("#ques"+this.model.get("id")).remove()}});return groupingTapPlace}),define("core/model/openTextVO",[],function(){var e=Backbone.Model.extend({id:"",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",heading:[],maintainOptions:"",partialAttempt:!0,feedback:[],activityMedia:""});return e}),define("core/view/openText",["language","utilities","AppConst","AppEvent"],function(language,utils,AppConst,AppEvent){var openText=Backbone.View.extend({contentStr1:"<div class='quesWrapper' id='quesWrapper<%=id%>'><div id='ques<%=id%>' class='quesContent'>		<div id='activityContent'>		<div id='questionHeading' class='questionHeading'></div>			<div id='questionMediaWrapper'>				<div id='questionMedia' class='left question-media'></div>				<div  class='instruction'>Click/Tap to open resource</div>			</div>			<div id='questionText' class='left'></div>			<div id='questionOptions'></div>			<div id='labelanswers'></div>		</div>	</div></div>",modelParagraph:"",qId:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",itemClicked:!1,correctAnswerVisible:null,inputNo:0,EvaluateFlag:!1,changeToolbar:{},maxpoints:0,partialAttempt:!0,hiddenDiv:"",activityMedia:"",initialize:function(){_.bindAll(this,"handleScreenExit","handleEvaluate","handleBlankChange","handleBlankClick","lockQuestion"),_.bindAll(this,"enableInteraction","destroyScroll","resetClickFlag"),_.extend(this,Backbone.Events)},render:function(){this.element=this.el;var e=_.template(this.contentStr1,this.model.toJSON());$("#content",this.$el).append(e),this.screen=$("#ques"+this.model.get("id")),this.setQuestionData()},setQuestionData:function(){this.modelParagraph=this.model.get("modelParagraph"),this.type=this.model.get("type"),this.layout=this.model.get("questionLayout"),this.responseType=this.model.get("responseType"),this.clues=this.model.get("clues"),this.rubric=this.model.get("rubric"),this.questionText=JSON.stringify(this.model.get("questionBody")),this.questionMedia=this.model.get("questionMedia"),this.optionsMedia=this.model.get("optionsMedia"),this.leftCol=this.model.get("leftCol"),this.rightCol=this.model.get("rightCol"),this.opLayout=this.model.get("optionsLayout"),this.options=this.model.get("options"),this.answers=this.model.get("answers"),this.isTest=this.model.get("isTest"),this.isReview=this.model.get("isReview"),this.reviewData=this.model.get(""),this.qId=this.model.get("id"),this.maxpoints=parseInt(this.model.get("maxpoints")),this.model.get("userResponse").userResponse&&(this.userResponse=this.model.get("userResponse").userResponse),this.heading=this.model.get("heading"),this.partialAttempt=this.model.get("partialAttempt"),this.activityMedia=this.model.get("activityMedia"),this.renderQues()},renderQues:function(){this.answers.length>0,this.obj=this.screen;var qBody=eval(this.questionText),qOptions=eval(this.options),questionStr="",optionsStr="",gapNo=0,gapLength=0,headingStr="";if(this.heading.length==0)$(".questionHeading",this.screen).hide();else{for(var i=0;i<this.heading.length;i++)this.heading[i].type=="image"?headingStr+="<img src='"+AppConst.ASSETS_PATH+this.heading[i].data+"'></img>":headingStr+="<div>"+this.heading[i].data+"</div>";$(".questionHeading",this.screen).html(headingStr)}if(this.questionMedia.length==0)$("#questionMediaWrapper",this.screen).hide();else{var qMediaStr="";for(var i=0;i<this.questionMedia.length;i++)qMediaStr+=utils.renderNode(this.questionMedia[i]);$("#questionMedia",this.screen).html(qMediaStr)}var that=this;$("#questionMedia img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))}),this.inputNo=qBody.length,questionStr+="<ul>";for(var i=0;i<qBody.length;i++){var activityAssetsStr="";if(this.activityMedia[i])for(var j=0;j<this.activityMedia[i].length;j++)activityAssetsStr+=utils.renderNode(this.activityMedia[i][j]);questionStr+="<li id = '"+i+"'><span class='ot-header'>",questionStr+=qBody[i].data,questionStr+="</span>",activityAssetsStr!=""&&(questionStr+="<div class='asset question-media'>",questionStr+=activityAssetsStr,questionStr+="</div>"),questionStr+="<div class='opentext badgeWrapper block-element'>",questionStr+="<textarea spellcheck='false' id='ans"+i+"' class='FIBblank'>",questionStr+=qOptions[i].data,questionStr+="</textarea>",questionStr+="<div id='badge"+i+"' class='checkBadge'></div></div>",questionStr+="</li>"}questionStr+="</ul>",$("#questionText",this.obj).html(questionStr),$(".asset img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))}),this.hiddenDiv=$(document.createElement("div")),this.hiddenDiv.addClass("opentext hiddendiv FIBblank"),$("#questionText",this.obj).append(this.hiddenDiv);var width=$("#questionText",this.obj).find("textarea").width();$(".hiddendiv",this.obj).css("width",width),this.trigger(AppEvent.TEMPLATE_READY)},destroyScroll:function(){this.spinnerOpen=!1,this.iScroll!=null&&this.iScroll.destroy()},enableInteraction:function(){var e=$("#questionText",this.obj).find("textarea"),t=this;$(e).height(18);for(var n=0;n<e.length;n++){var r=$(e[n]).val();if(r){r=r.replace(/\n/g,"<br>"),t.hiddenDiv.html(r),$(e[n]).css("height",t.hiddenDiv.height()+"px");var i=parseInt($(e[n]).get(0).scrollHeight);i-=parseInt($(e[n]).css("padding-top"))+parseInt($(e[n]).css("padding-bottom")),$(e[n]).css("height",i+"px")}}e.unbind(),e.bind(AppEvent.CLICK,this.handleBlankClick),this.scroll&&this.scroll.refresh(),e.css("resize","none"),e.css("overflow","hidden"),e.bind("keyup",function(r){var i=$(r.target).val();i=i.replace(/\n/g,"<br>"),t.hiddenDiv.html(i+'<br class="lbr">');if(parseInt($(r.target).css("height"))!=t.hiddenDiv.height()){$(r.target).css("height",t.hiddenDiv.height());var s=parseInt(r.target.scrollHeight);s-=parseInt($(e[n]).css("padding-top"))+parseInt($(e[n]).css("padding-bottom")),$(r.target).css("height",s),$(".quesContent",t.obj).scrollTop(0),t.scroll&&t.scroll.refresh()}t.handleBlankChange()}),e.bind("focus",function(e){$(".quesContent",t.obj).scrollTop(0),t.scroll.scrollToElement($(e.target))});var s=String(document.documentElement.ontouchmove)!="undefined"?"touchstart":"mouseup";$("body").unbind(s).bind(s,function(n){if(n.target.className.indexOf("FIBblank")>=0)return;e.blur(),t.scroll.refresh()}),e.removeClass("disableOption"),e.removeAttr("readonly"),$("#questionText",this.obj).removeClass("disabled")},disableInteraction:function(){var e=$("#questionText",this.obj).find("textarea");e.addClass("disableOption"),e.unbind(),e.attr("readonly","true"),$("#questionText",this.obj).addClass("disabled")},handleBlankClick:function(e){if(this.scroll&&this.scroll.moved)return;var t=e.target;if(typeof t.selectionStart=="number")t.selectionStart=t.selectionEnd=t.value.length;else if(typeof t.createTextRange!="undefined"){$("#"+t.id).focus();var n=t.createTextRange();n.collapse(!1),n.select()}},handleBlankChange:function(e){if(this.scroll&&this.scroll.moved)return;this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT;var t=$("#questionText",this.obj).find("textarea"),n=0;for(var r=0;r<t.length;r++){var i=escape(t[r].value).replace(/\%0D/g,"").replace(/\%0A/g,""),s=escape(this.options[r].data).replace(/\%0D/g,"").replace(/\%0A/g,"");i!=s&&(n++,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE)}this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),n==t.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):n>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)},resetClickFlag:function(){this.itemClicked=!1},populateAnswers:function(answers,correctAnswerVisible){if(this.isReset&&this.isTest&&!this.isReview&&answers==undefined)return;var blanks=$("#questionText",this.obj).find("textarea"),blankObjsBadges=$("#questionText",this.obj).find("div.checkBadge");utils.log(answers),answers.length>0&&(this.EvaluateFlag=!0);var qOptions=eval(this.options);for(var i=0;i<blanks.length;i++){var ans=answers[i].inputText;ans!=undefined?ans=ans.trim():(ans=this.options[i].data,ans=ans.trim());var myBlank=$(blanks.get(i));myBlank.val(""+ans);var compAns=""+ans;compAns=compAns.trim();var compAnsSplit=compAns.trim().replace(/[\n\r]/g,"").split(" ").filter(function(e){return e!=""&&typeof e!=undefined}),TrimedCorrAnswerArray=[];for(var j=0;j<this.answers[i].length;j++)TrimedCorrAnswerArray.push(this.answers[i][j].data.replace(/<div>/gi,"<br>").replace(/<\/div>/gi,"").trim()),TrimedCorrAnswerArray[j]=TrimedCorrAnswerArray[j].replace(/[\u21B5]/g," ").replace(/[\n\r]/g,"").trim();correctAnswerVisible==1&&(TrimedCorrAnswerArray.indexOf(compAnsSplit.join(" "))>-1?$(blankObjsBadges.get(i)).addClass("markRight"):$(blankObjsBadges.get(i)).addClass("markWrong")),(this.isTest||this.partialAttempt==0)&&!this.isReview&&(blankObjsBadges.removeClass("markRight"),blankObjsBadges.removeClass("markWrong"))}if(correctAnswerVisible==0||answers.length==0)blankObjsBadges.removeClass("markWrong"),blankObjsBadges.removeClass("markRight");!this.isReview&&answers.length<=0,this.enableInteraction()},handleEvaluate:function(e){if(e!=undefined&&$(e.target).hasClass("disabled"))return;if(this.itemClicked==1)return;this.userResponse=[],this.itemClicked=!0,this.EvaluateFlag=!0,this.isReset=!1;var totalInputs=0,attrToCheck=null,blankObjs=null,totalCorrect=0,qOptions=eval(this.options),attemtedInputs=0,blankObjsBadges=$("#questionText",this.obj).find("div.checkBadge");blankObjs=$("#questionText",this.obj).find("textarea"),attrToCheck="value",totalInputs=blankObjs.size();var markPerQ=parseInt(this.maxpoints)/totalInputs,marksQbtained=0;$("#questionOptions",this.obj).find(".selected").removeClass("selected");for(var i=0;i<totalInputs;i++){if(blankObjs.get(i)[attrToCheck]==undefined)break;blankObjs.get(i)[attrToCheck]!=""&&attemtedInputs++;var myanswer=""+blankObjs.get(i)[attrToCheck];myanswerRaw=myanswer,utils.log(myanswer);var myanswerSplit=myanswer.trim().replace(/[\n\r]/g,"").split(" ").filter(function(e){return e!=""&&typeof e!=undefined});utils.log("answer after split"),utils.log(myanswerSplit),utils.log("after answer");var TrimedCorrAnswerArray=[];for(var j=0;j<this.answers[i].length;j++)TrimedCorrAnswerArray.push(this.answers[i][j].data.trim());for(var j=0;j<TrimedCorrAnswerArray.length;j++)TrimedCorrAnswerArray[j]=TrimedCorrAnswerArray[j].replace(/[\u21B5]/g," ").replace(/[\n\r]/g,"").trim();$("#badge"+(i+1),this.obj).removeClass("markRight"),$("#badge"+(i+1),this.obj).removeClass("markWrong"),utils.log("myanswerSplit:: "+myanswerSplit.join(" ")),TrimedCorrAnswerArray.indexOf(myanswerSplit.join(" "))>-1?($("#badge"+(i+1),this.obj).addClass("markRight"),marksQbtained+=markPerQ,totalCorrect++,this.userResponse.push({inputText:myanswerRaw,isCorrect:!0}),utils.log("Answer is correct!"+myanswerRaw)):($("#badge"+(i+1),this.obj).addClass("markWrong"),this.userResponse.push({inputText:myanswerRaw,isCorrect:!1}),utils.log("Answer is wrong!"+myanswerRaw))}this.partialAttempt||(blankObjsBadges.removeClass("markRight"),blankObjsBadges.removeClass("markWrong")),this.partialAttempt==1||attemtedInputs==totalInputs?totalCorrect>=totalInputs?this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,score:marksQbtained,status:AppConst.CORRECT,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,responseType:this.responseType}):totalCorrect>0?this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:marksQbtained,status:AppConst.PARTIAL,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,responseType:this.responseType}):this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:marksQbtained,status:AppConst.INCORRECT,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,responseType:this.responseType}):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,maxScore:parseInt(this.maxpoints),title:this.title,type:this.type,responseType:this.responseType}),this.lockQuestion(),_.delay(this.resetClickFlag,500)},lockQuestion:function(){this.correctAnswerVisible=!1,this.changeToolbar.mode=AppConst.TOOLBAR_LOCKED,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.disableInteraction()},resetQuestion:function(e){this.isReset=!0;var t=$("#questionText",this.obj).find("textarea"),n=$("#questionText",this.obj).find("div.checkBadge"),r=$("#questionOptions",this.obj).find(".selected");n.removeClass("markRight"),n.removeClass("markWrong"),r.removeClass("markRight"),r.removeClass("markWrong"),r.removeClass("selected");var i=$(".mcq2",this.obj).find(".checkBadge2");i.size()>0&&(i.removeClass("markRight"),i.removeClass("markWrong")),$("#questionText textarea",this.obj).val("");for(var s=0;s<this.options.length;s++)$("#ans"+s,this.obj).val(this.options[s].data);this.responseType==AppConst.RESPONSE_TYPE_TEXT&&$("#questionText textarea",this.obj).removeAttr("readonly"),$("#questionOptions",this.obj).find(".selected").removeClass("selected"),$("#questionOptions",this.obj).find("li").removeClass("optionHighlight"),$("#questionOptions",this.obj).find("li").removeAttr("disabled"),this.userResponse=[],this.enableInteraction(),this.trigger(AppEvent.MARK_EMPTY,this.qId),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.EvaluateFlag=!1},resetQuestionPartial:function(e){this.optionSelected="",this.targetSelected="";var t=!0;$("#questionOptions",this.obj).find(".selected").removeClass("selected"),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var n=$("#questionText",this.obj).find("textarea"),r=$("#questionText",this.obj).find("div.checkBadge"),i=$("#questionOptions",this.obj).find("li");r.removeClass("markWrong"),r.removeClass("markRight");if(this.userResponse.length>0)if(this.responseType==AppConst.RESPONSE_TYPE_TEXT)for(var s=0;s<n.length;s++)if(this.answers[s].length>1)if(_.indexOf(this.answers[s],this.userResponse[s].trim())<0){var o=$(n.get(s));o.val(""),this.userResponse[s]=""}else t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);else if(this.userResponse[s].trim()!=this.answers[s][0].replace(/[.,?,']/g,"").toLowerCase()){var o=$(n.get(s));o.val(""),this.userResponse[s]=""}else t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);else{for(var s=0;s<n.length;s++)if(this.userResponse[s]!=this.options[this.answers[s][0]-1].data.toLowerCase()){var o=$(n.get(s));o.val(""),this.userResponse[s]=""}else t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var u=this.userResponse[0];for(var s=0;s<this.options.length;s++)if(this.options[s].data.toLowerCase()==u){var a=i.get(s);$(a).find(".indicators").addClass("selected"),$(a).find(".optionsText").addClass("selected")}}n.removeClass("disableOption"),i.removeClass("disableOption"),i.removeClass("optionHighlight"),this.EvaluateFlag=!1,this.correctAnswerVisible=!1,this.enableInteraction(),t==0?this.trigger(AppEvent.UPDATE_RESPONSE,this.qId,{userResponse:this.userResponse}):this.trigger(AppEvent.MARK_EMPTY,this.qId),this.disableButton(AppConst.QBTN_RESET)},disableButton:function(e){$("#"+e,this.obj).addClass("disabled")},handleScreenExit:function(){},orientationchange:function(e){},destroy:function(){this.unbind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.unbind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.unbind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.unbind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.unbind(AppEvent.MARK_EMPTY,this.markEmpty),this.unbind(AppEvent.UPDATE_RESPONSE,this.updateResponse),this.unbind(AppEvent.MARK_ANSWER,this.handleMarkAnswer),$("#questionOptions",this.obj).find("li").unbind(),$("#ques"+this.model.get("id")).remove()}});return openText}),define("core/model/fibBinaryTableVO",[],function(){var e=Backbone.Model.extend({id:"",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",maxpoints:null,heading:"",maintainOptions:"",partialAttempt:!0,feedback:[]});return e}),define("core/view/fibBinaryTable",["language","utilities","AppConst","AppEvent"],function(language,utils,AppConst,AppEvent){var fibBinaryTable=Backbone.View.extend({contentStr1:"<div class='quesWrapper' id='quesWrapper<%=id%>'><div id='ques<%=id%>' class='quesContent'>		<div id='activityContent'>		<div id='questionMediaWrapper'>				<div id='questionMedia' class='left question-media'></div>				<div  class='instruction'>Click/Tap to open resource</div>			</div>			<div id='questionOptions'></div>		<div id='questionText' class='left fibTable'></div>		<div id='labelanswers'></div>		</div>	</div></div>",modelParagraph:"",qId:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",itemClicked:!1,correctAnswerVisible:null,inputNo:0,EvaluateFlag:!1,changeToolbar:{},maxpoints:0,rowHeader:"",colHeader:"",rowRandom:"",colRandom:"",rowNumber:[],rowArray:[],colArray:[],optionSelected:"",targetSelected:"",maintainOptions:AppConst.FIB_REMOVE_OPTIONS,partialAttempt:!0,scroll:null,initialize:function(){_.bindAll(this,"handleScreenExit","handleEvaluate"),_.bindAll(this,"enableInteraction","resetClickFlag","handleBtnClick","handleBtnTouchstart","handleItemClick"),_.extend(this,Backbone.Events)},render:function(){this.element=this.el;var e=_.template(this.contentStr1,this.model.toJSON());$("#content",this.$el).append(e),this.screen=$("#ques"+this.model.get("id")),this.obj=this.screen,this.setQuestionData()},setQuestionData:function(){this.modelParagraph=this.model.get("modelParagraph"),this.type=this.model.get("type"),this.layout=this.model.get("questionLayout"),this.responseType=this.model.get("responseType"),this.clues=this.model.get("clues"),this.rubric=this.model.get("rubric"),this.questionText=this.model.get("questionBody"),this.questionMedia=this.model.get("questionMedia"),this.optionsMedia=this.model.get("optionsMedia"),this.leftCol=this.model.get("leftCol"),this.rightCol=this.model.get("rightCol"),this.opLayout=this.model.get("optionsLayout"),this.options=this.model.get("options"),this.answers=this.model.get("answers"),this.isTest=this.model.get("isTest"),this.isReview=this.model.get("isReview"),this.reviewData=this.model.get(""),this.qId=this.model.get("id"),this.maxpoints=parseInt(this.model.get("maxpoints")),this.model.get("userResponse").userResponse&&(this.userResponse=this.model.get("userResponse").userResponse),this.heading=this.model.get("heading"),this.partialAttempt=this.model.get("partialAttempt"),this.maintainOptions=this.model.get("maintainOptions"),this.renderQues()},renderQues:function(){var qBody=eval(this.questionText),qOptions=eval(this.options),startIndex=0,endIndex=0,qStr="",gap=0,rowNo=0,colNo=0,optionsStr="",gapLength=0,diff=0;this.inputNo=this.answers.length;var headingStr="";if(this.heading.length==0)$(".questionHeading",this.screen).hide();else{for(var i=0;i<this.heading.length;i++)this.heading[i].type=="image"?headingStr+="<img src='"+AppConst.ASSETS_PATH+this.heading[i].data+"'></img>":headingStr+="<div>"+this.heading[i].data+"</div>";$(".questionHeading",this.screen).html(headingStr)}if(this.questionMedia.length==0)$("#questionMediaWrapper",this.screen).hide();else{var qMediaStr="";for(var i=0;i<this.questionMedia.length;i++)qMediaStr+=utils.renderNode(this.questionMedia[i]);$("#questionMedia",this.screen).html(qMediaStr)}var that=this;$("#questionMedia img",this.screen).bind(AppEvent.CLICK,function(){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($("#questionMedia img").data("url"))}),colNo=qOptions.length,rowNo=qBody.length,qStr+="<span id='tableHeadings'>",qStr+="<span class='blankDiv'></span>";for(var i=0;i<colNo;i++){var colStr="";colStr+="<span id='col"+i+"'>"+utils.renderNode(qOptions[i])+"</span>",qStr+=colStr}qStr+="</span>",qStr+="<div id='tableContentWrapper'><ul id='tableContent' border='0' class='fibtable' cellpadding='0' cellspacing='0'>";for(var j=0;j<qBody.length;j++){qStr+="<li id='row"+j+"' class='row'>",qStr+="<span class='rowHeader'><div class='table-cell'><span>"+utils.renderNode(qBody[j])+"</span><span id='badge"+j+"' class='checkBadge2' ></span></div></span>";for(var i=0;i<colNo;i++)qStr+="<span class ='inputTD'>",qStr+="<span class='indicators' id='input"+i+"' data-op='"+j+"'></span>",qStr+="</span>";qStr+="</li>"}qStr+="</ul></div>",$("#questionText",this.screen).html(qStr),this.trigger(AppEvent.TEMPLATE_READY)},enableInteraction:function(){$(".indicators",this.obj).unbind().bind(AppEvent.CLICK,this.handleItemClick),$("#questionText").removeClass("disabled"),$(".indicators",this.screen).removeAttr("disabled")},disableInteraction:function(){$(".indicators",this.obj).unbind(),$(".indicators",this.obj).attr("disabled","disabled"),$("#questionText").addClass("disabled")},initScroll:function(){var e=$("#footer").get(0).offsetTop-$("#content").get(0).offsetTop-parseInt($("#tableHeadings",this.obj).outerHeight())-parseInt($("#questionMedia",this.obj).outerHeight())-$("#questionMediaWrapper",this.obj).find(".instruction").outerHeight()-40;$("#tableContentWrapper",this.obj).css("height",e+"px"),this.scroll!=null&&this.scroll.destroy(),this.scroll=new IScroll($("#tableContentWrapper",this.obj).get(0),{desktopCompatibility:!0,interactiveScrollbars:!0,scrollY:!0}),ths=this,_.delay(function(){ths.iScroll.refresh()},999)},handleBtnTouchstart:function(e){$("#"+e.target.name+" #"+e.target.id).prop("checked",!0),this.handleBtnClick()},handleItemClick:function(e){if(this.scroll&&this.scroll.moved)return;var t=e.target;$(t.parentNode.parentNode).find(".indicators").removeClass("selected"),$(t).addClass("selected");var n=$(".indicators.selected").length;n==this.questionText.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):n>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)},handleBtnClick:function(e){var t=0;for(var n=0;n<this.questionText.length;n++)$("input[name=row"+n+"]:checked",this.screen).length!=0&&t++;this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),t==this.questionText.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):t>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)},resetClickFlag:function(){this.itemClicked=!1},populateAnswers:function(e,t){if(this.resetClicked&&this.isTest)return;$(".inputTD").removeClass("selected");var n=$("#questionText",this.screen).find(".checkBadge2");for(var r=0;r<e.length;r++)if(e[r]!=-1){var i=$("#row"+r,this.screen).find("#input"+(e[r]-1));$(i).addClass("selected"),this.answers[r].indexOf(e[r])!=-1?n.get(r).className+=" markRight":n.get(r).className+=" markWrong"}else n.get(r).className+=" markWrong";t==0&&(n.removeClass("markWrong"),n.removeClass("markRight")),e.length>0&&(this.EvaluateFlag=!0),(this.isTest||this.partialAttempt==0)&&!this.isReview&&(n.removeClass("markWrong"),n.removeClass("markRight")),!this.isReview&&e.length<=0},handleEvaluate:function(e){if(e!=undefined&&$(e.target).hasClass("disabled"))return;this.EvaluateFlag=!0,this.resetClicked=!1;var t=$("#questionText",this.screen).find(".checkBadge2"),n=this.questionText.length,r=0,i=0;this.userResponse=[];var s=parseInt(this.maxpoints)/n,o=0,u=0;for(var a=0;a<this.questionText.length;a++){var f=$("#row"+a,this.screen).find(".indicators.selected");if(f.length>0){u++;var l=f.get(0).id,c=parseInt(l.split("input")[1])+1;this.userResponse.push(c),this.answers[a].indexOf(c)!=-1?(o+=s,r++,t.get(a).className+=" markRight"):t.get(a).className+=" markWrong"}else this.userResponse.push(-1),t.get(a).className+=" markWrong"}this.partialAttempt||(t.removeClass("markRight"),t.removeClass("markWrong")),this.partialAttempt==1||u==n?r==n?this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,status:AppConst.CORRECT,score:o,maxScore:parseInt(this.maxpoints),type:this.type,title:this.title,responseType:this.responseType}):r>0?this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:o,status:AppConst.PARTIAL,maxScore:parseInt(this.maxpoints),type:this.type,title:this.title,responseType:this.responseType}):this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,score:o,status:AppConst.INCORRECT,maxScore:parseInt(this.maxpoints),type:this.type,title:this.title,responseType:this.responseType}):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,maxScore:parseInt(this.maxpoints),type:this.type,responseType:this.responseType}),this.lockQuestion()},lockQuestion:function(){this.correctAnswerVisible=!1,this.changeToolbar.mode=AppConst.TOOLBAR_LOCKED,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.disableInteraction()},resetQuestion:function(e){this.resetClicked=!0,$("#questionText",this.screen).html(""),$("#questionOptions",this.screen).html(""),this.userResponse=[],this.EvaluateFlag=!1,this.renderQues(),this.correctAnswerVisible=!1,this.enableInteraction(),this.trigger(AppEvent.MARK_EMPTY,this.qId),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT),this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar)},resetQuestionPartial:function(e){this.optionSelected="",this.targetSelected="";var t=!0;this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var n=$("#questionText",this.screen).find(".checkBadge2"),r=$("#questionText",this.screen).find(".blank"),i=$("#questionOptions",this.screen).find(".trayOptions");n.removeClass("markWrong"),n.removeClass("markRight"),$("#questionText",this.screen).find("div.deleteBtn").hide(),$("#questionText",this.screen).find(".selected").removeClass("selected"),i.removeClass("optionHighlight");if(this.userResponse.length>0){utils.log(this.answers),utils.log(this.userResponse);for(var s=0;s<this.userResponse.length;s++)_.indexOf(this.answers[s],this.userResponse[s])<0?($("#opt"+this.userResponse[s],this.screen).removeClass("optionHighlight"),$("#opt"+(this.userResponse[s]-1),this.screen).css("visibility","visible"),$("div.deleteBtn[optionid=opt"+(this.userResponse[s]-1)+"]",this.screen).attr("optionid",""),this.userResponse[s]="",$("#gap"+s,this.screen).html("")):(this.maintainOptions==AppConst.FIB_REMOVE_OPTIONS&&$("#opt"+(this.userResponse[s]-1),this.screen).css("visibility","hidden"),t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar))}this.EvaluateFlag=!1,this.correctAnswerVisible=!1,this.enableInteraction(),t==0?this.trigger(AppEvent.UPDATE_RESPONSE,this.qId,{userResponse:this.userResponse}):this.trigger(AppEvent.MARK_EMPTY,this.qId)},handleScreenExit:function(){try{for(var e=0;e<this.dragObjs.length;e++)this.dragObjs[e].lastCurX=null,this.dragObjs[e].lastCurY=null,this.dragObjs[e].destroy();webkit_drop.remove()}catch(t){showAlert(t)}},orientationchange:function(e){},destroy:function(){this.unbind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.unbind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.unbind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.unbind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.unbind(AppEvent.MARK_EMPTY,this.markEmpty),this.unbind(AppEvent.UPDATE_RESPONSE,this.updateResponse),$("#questionOptions",this.screen).find("li").unbind()}});return fibBinaryTable}),define("core/model/openTextTeacherMarkedVO",[],function(){var e=Backbone.Model.extend({id:"",modelParagraph:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",heading:[],maintainOptions:"",partialAttempt:!0,feedback:[],activityMedia:""});return e}),define("core/view/openTextTeacherMarked",["language","utilities","AppConst","AppEvent"],function(language,utils,AppConst,AppEvent){var openTextTeacherMarked=Backbone.View.extend({contentStr1:"<div class='quesWrapper' id='quesWrapper<%=id%>'><div id='ques<%=id%>' class='quesContent'>		<div id='activityContent'>		<div id='questionHeading' class='questionHeading'></div>			<div id='questionMediaWrapper'>				<div id='questionMedia' class='left question-media'></div>				<div  class='instruction'>Click/Tap to open resource</div>			</div>			<div id='questionText' class='left'></div>			<div id='questionOptions'></div>			<div id='labelanswers'></div>		</div>	</div></div>",modelParagraph:"",qId:"",type:"",layout:"",responseType:"",clues:"",rubric:"",questionText:"",questionMedia:"",optionsMedia:"",leftCol:"",rightCol:"",opLayout:"",options:"",answers:"",isTest:"",isReview:"",reviewData:"",userResponse:"",itemClicked:!1,correctAnswerVisible:null,inputNo:0,EvaluateFlag:!1,changeToolbar:{},maxpoints:0,partialAttempt:!0,hiddenDiv:"",title:"",popUpScroll:null,activityMedia:"",initialize:function(){_.bindAll(this,"handleScreenExit","handleEvaluate","handleBlankChange","handleBlankClick","lockQuestion"),_.bindAll(this,"enableInteraction","destroyScroll","resetClickFlag","setInputFieldHeight","onExpanderClicked"),_.extend(this,Backbone.Events)},render:function(){this.element=this.el;var e=_.template(this.contentStr1,this.model.toJSON());$("#content",this.$el).append(e),this.screen=$("#ques"+this.model.get("id")),this.setQuestionData()},setQuestionData:function(){this.modelParagraph=this.model.get("modelParagraph"),this.type=this.model.get("type"),this.layout=this.model.get("questionLayout"),this.responseType=this.model.get("responseType"),this.clues=this.model.get("clues"),this.rubric=this.model.get("rubric"),this.questionText=JSON.stringify(this.model.get("questionBody")),this.questionMedia=this.model.get("questionMedia"),this.optionsMedia=this.model.get("optionsMedia"),this.leftCol=this.model.get("leftCol"),this.rightCol=this.model.get("rightCol"),this.opLayout=this.model.get("optionsLayout"),this.options=this.model.get("options"),this.answers=this.model.get("answers"),this.isTest=this.model.get("isTest"),this.isReview=this.model.get("isReview"),this.reviewData=this.model.get(""),this.qId=this.model.get("id"),this.maxpoints=parseInt(this.model.get("maxpoints")),this.model.get("userResponse").userResponse&&(this.userResponse=this.model.get("userResponse").userResponse),this.heading=this.model.get("heading"),this.partialAttempt=this.model.get("partialAttempt"),this.title=this.model.get("title"),this.activityMedia=this.model.get("activityMedia"),this.renderQues()},renderQues:function(){this.answers.length>0,this.obj=this.screen;var qBody=eval(this.questionText),qOptions=eval(this.options),questionStr="",optionsStr="",gapNo=0,gapLength=0,headingStr="";if(this.heading.length==0)$(".questionHeading",this.screen).hide();else{for(var i=0;i<this.heading.length;i++)this.heading[i].type=="image"?headingStr+="<img src='"+AppConst.ASSETS_PATH+this.heading[i].data+"'></img>":headingStr+="<div>"+this.heading[i].data+"</div>";$(".questionHeading",this.screen).html(headingStr)}if(this.questionMedia.length==0)$("#questionMediaWrapper",this.screen).hide();else{var qMediaStr="";for(var i=0;i<this.questionMedia.length;i++)qMediaStr+=utils.renderNode(this.questionMedia[i]);$("#questionMedia",this.screen).html(qMediaStr)}var that=this;$("#questionMedia img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))}),this.inputNo=qBody.length,questionStr+="<ul>";for(var i=0;i<qBody.length;i++){var activityAssetsStr="";if(this.activityMedia[i])for(var j=0;j<this.activityMedia[i].length;j++)activityAssetsStr+=utils.renderNode(this.activityMedia[i][j]);questionStr+="<li id = '"+i+"'><span class='question' id = 'question"+i+"'>",questionStr+=qBody[i].data,questionStr+="</span>",activityAssetsStr!=""&&(questionStr+="<div class='asset question-media'>",questionStr+=activityAssetsStr,questionStr+="</div>"),questionStr+="<div class='badgeWrapper block-element'><span id='expander"+i+"' class='expander'></span>",questionStr+="<textarea spellcheck='false' id='ans"+i+"' class='FIBblank'>",questionStr+=qOptions[i].data,questionStr+="</textarea>",questionStr+="<div id='badge"+i+"' class='checkBadge'></div></div>",questionStr+="</li>"}questionStr+="</ul>",$("#questionText",this.obj).html(questionStr),$(".asset img",this.screen).bind(AppEvent.CLICK,function(e){if(that.scroll&&that.scroll.moved)return;utils.openNewWindow($(e.target).attr("data-url"))}),this.hiddenDiv=$(document.createElement("div")),this.hiddenDiv.addClass("hiddendiv FIBblank"),$("#questionText",this.obj).append(this.hiddenDiv);var width=$("#questionText",this.obj).find("textarea").width();$(".hiddendiv",this.obj).css("width",width);var ref=this;_.delay(function(){ref.setInputFieldHeight()},999),this.trigger(AppEvent.TEMPLATE_READY)},setInputFieldHeight:function(){var e=parseInt($(this.obj).outerHeight());e-=parseInt($($("#questionText li",this.obj).find(".question").get(0)).outerHeight()),e-=parseInt($(".questionHeading",this.obj).outerHeight()),e-=parseInt($("#questionMedia",this.obj).outerHeight())+$("#questionMediaWrapper").find(".instruction").outerHeight(),e-=parseInt($("#questionText",this.obj).css("padding-top"))+parseInt($("#questionText",this.obj).css("padding-bottom"))+parseInt($("#questionText",this.obj).css("margin-top"))+parseInt($("#questionText",this.obj).css("margin-bottom")),e-=parseInt($(".FIBblank",this.obj).css("margin-top"))+parseInt($(".FIBblank",this.obj).css("margin-bottom"))+parseInt($(".FIBblank",this.obj).css("padding-top"))+parseInt($(".FIBblank",this.obj).css("padding-bottom")),$($("#questionText li",this.obj).find(".asset").get(0)!=undefined)&&(e-=parseInt($($("#questionText li",this.obj).find(".asset").get(0)).outerHeight())),$(".FIBblank",this.obj).css("min-height",e),$(".FIBblank",this.obj).attr("data-origHeight",e),this.scroll&&this.scroll.refresh()},destroyScroll:function(){this.spinnerOpen=!1,this.iScroll!=null&&this.iScroll.destroy()},enableInteraction:function(){var e=$("#questionText",this.obj).find("textarea"),t=this;for(var n=0;n<e.length;n++){var r=$(e[n]).val();r=r.replace(/\n/g,"<br>"),t.hiddenDiv.html(r+'<br class="lbr">'),$(e[n]).css("height",t.hiddenDiv.height()+"px"),t.hiddenDiv.css("height",t.hiddenDiv.outerHeight()+20+"px");var i=0;navigator.userAgent.toLowerCase().indexOf("msie")>-1?i=parseInt($(e[n]).outerHeight()):i=parseInt($(e[n]).get(0).scrollHeight),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(i+=parseInt($(e[n]).css("padding-top"))+parseInt($(e[n]).css("padding-bottom")+2)),$(e[n]).css("height",i+"px")}e.unbind().bind(AppEvent.CLICK,this.handleBlankClick),$(".expander",this.obj).unbind().bind(AppEvent.CLICK,this.onExpanderClicked),this.scroll&&this.scroll.refresh(),e.css("resize","none"),e.css("overflow","hidden"),e.bind("keyup",function(e){var n=$(e.target).val();n=n.replace(/\n/g,"<br>"),t.hiddenDiv.html(n+'<br class="lbr">'),t.hiddenDiv.css("height","auto"),$(e.target).css("height",t.hiddenDiv.height());var r=0;navigator.userAgent.toLowerCase().indexOf("msie")>-1?r=parseInt($(e.target).outerHeight()):r=parseInt(e.target.scrollHeight),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(r+=parseInt($(e.target).css("padding-top"))+parseInt($(e.target).css("padding-bottom")+2)),$(e.target).css("height",r),$(".quesContent",t.obj).scrollTop(0),t.scroll&&t.scroll.refresh(),t.handleBlankChange()}),e.bind("focus",function(e){$(".quesContent",t.obj).scrollTop(0),t.scroll.scrollToElement($(e.target))});var s=String(document.documentElement.ontouchmove)!="undefined"?"touchstart":"mouseup";$("body").unbind(s).bind(s,function(n){if(n.target.className.indexOf("FIBblank")>=0)return;e.blur(),t.scroll.refresh()}),e.removeClass("disableOption"),e.removeAttr("readonly"),$("#questionText",this.obj).removeClass("disabled")},disableInteraction:function(){var e=$("#questionText",this.obj).find("textarea");e.addClass("disableOption"),e.unbind(),$(".expander",this.obj).unbind(),e.attr("readonly","true"),$("#questionText",this.obj).addClass("disabled"),e.css("resize","none"),e.css("overflow","hidden")},onExpanderClicked:function(e){var t=e.target.id.split("expander")[1];if($(e.target).hasClass("expanded")){var n=$(".hiddendiv",this.obj).height();$("#ans"+t,this.obj).css("height",n),$("#ans"+t,this.obj).css("min-height",0),$(e.target).removeClass("expanded"),$(".qinstructions").show(),this.heading.length!=0&&$(".questionHeading",this.obj).show(),this.questionMedia.length!=0&&$("#questionMediaWrapper",this.obj).show(),$("#questionText",this.obj).find("li").show(),$(".asset",this.obj).show(),$("#question"+t,this.obj).show();var r=$("#footer").get(0).offsetTop-$("#content").get(0).offsetTop-parseInt($($("#questionText li").find(".question").get(0)).height())-parseInt($(".questionHeading").outerHeight())-parseInt($("#questionMediaWrapper").outerHeight())-20;this.trigger(AppEvent.REFRESH_SCROLL)}else{var i=$("#ans"+t,this.obj).height();$("#ans"+t,this.obj).attr("data-origHeight",i),$(e.target).addClass("expanded"),$(".qinstructions").hide(),$("#questionText",this.obj).find("li").hide(),$(".questionHeading",this.obj).hide(),$("#questionMediaWrapper",this.obj).hide(),$("#"+t,this.obj).show(),$("#question"+t,this.obj).hide(),$(".asset",this.obj).hide();var r=parseInt($("#questionPlayer").outerHeight());r-=parseInt($("#header").outerHeight()),r-=parseInt($("#footer").outerHeight()),r-=parseInt($(".FIBblank",this.obj).css("margin-top"))+parseInt($(".FIBblank",this.obj).css("margin-bottom"))+parseInt($(".FIBblank",this.obj).css("padding-top"))+parseInt($(".FIBblank",this.obj).css("padding-bottom"))+10;var s=$("#footer").get(0).offsetTop-$("#content").get(0).offsetTop,o=isNaN(parseInt($(".qinstructions").css("margin")))?0:parseInt($(".qinstructions").css("margin"));this.obj.css("height",s-o+"px"),$("#ans"+t,this.obj).css("min-height",r-parseInt($("#header").height())),$("#ans"+t,this.obj).trigger("keyup"),this.trigger(AppEvent.REFRESH_SCROLL)}},handleBlankClick:function(e){if(this.scroll&&this.scroll.moved)return;$("#"+e.target.id).focus()},handleBlankChange:function(e){if(this.scroll&&this.scroll.moved)return;this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT;var t=$("#questionText",this.obj).find("textarea"),n=0;for(var r=0;r<t.length;r++){var i=escape(t[r].value).replace(/\%0D/g,"").replace(/\%0A/g,""),s=escape(this.options[r].data).replace(/\%0D/g,"").replace(/\%0A/g,"");i!=s&&(n++,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE)}this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),n==t.length?this.trigger(AppEvent.Q_STATUS,AppConst.COMPLETE):n>0?this.trigger(AppEvent.Q_STATUS,AppConst.PARTIAL):this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)},resetClickFlag:function(){this.itemClicked=!1},populateAnswers:function(answers,correctAnswerVisible){if(this.isReset&&this.isTest&&!this.isReview&&answers==undefined)return;var blanks=$("#questionText",this.obj).find("textarea"),blankObjsBadges=$("#questionText",this.obj).find("div.checkBadge");utils.log(answers),answers.length>0&&(this.EvaluateFlag=!0);var qOptions=eval(this.options);for(var i=0;i<blanks.length;i++){var ans="";answers[i]!=undefined&&answers[i].inputText!=undefined&&(ans=answers[i].inputText),ans!=undefined?ans=ans.trim():(ans=this.options[i].data,ans=ans.trim());var myBlank=$(blanks.get(i));ans=unescape(ans),myBlank.val(""+ans)}if(correctAnswerVisible==0||answers.length==0)blankObjsBadges.removeClass("markWrong"),blankObjsBadges.removeClass("markRight");!this.isReview&&answers.length<=0,this.enableInteraction()},handleEvaluate:function(e){if(e!=undefined&&$(e.target).hasClass("disabled"))return;if(this.itemClicked==1)return;this.userResponse=[],this.itemClicked=!0,this.EvaluateFlag=!0,this.isReset=!1;var totalInputs=0,attrToCheck=null,blankObjs=null,totalCorrect=0,qOptions=eval(this.options),attemtedInputs=0,blankObjsBadges=$("#questionText",this.obj).find("div.checkBadge");blankObjs=$("#questionText",this.obj).find("textarea"),attrToCheck="value",totalInputs=blankObjs.size();var markPerQ=parseInt(this.maxpoints)/totalInputs,marksQbtained=0,qData=JSON.parse(this.questionText);$("#questionOptions",this.obj).find(".selected").removeClass("selected");for(var i=0;i<totalInputs;i++){if(blankObjs.get(i)[attrToCheck]==undefined)break;blankObjs.get(i)[attrToCheck]!=""&&attemtedInputs++;var myanswer=""+blankObjs.get(i)[attrToCheck];myanswer=escape(myanswer.trim()),utils.log("my answer : "+myanswer),this.userResponse.push({inputText:myanswer,ActivityDescription:qData[i].data})}this.partialAttempt||(blankObjsBadges.removeClass("markRight"),blankObjsBadges.removeClass("markWrong")),this.partialAttempt==1||attemtedInputs==totalInputs?totalCorrect>=totalInputs?this.trigger(AppEvent.MARK_CORRECT,this.qId,{userResponse:this.userResponse,title:this.title,type:this.type,responseType:this.responseType}):totalCorrect>0?this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,title:this.title,type:this.type,responseType:this.responseType}):this.trigger(AppEvent.MARK_INCORRECT,this.qId,{userResponse:this.userResponse,title:this.title,type:this.type,responseType:this.responseType}):this.trigger(AppEvent.MARK_ANSWER,this.qId,{userResponse:this.userResponse,title:this.title,type:this.type,responseType:this.responseType}),this.lockQuestion(),_.delay(this.resetClickFlag,500)},lockQuestion:function(){this.correctAnswerVisible=!1,this.changeToolbar.mode=AppConst.TOOLBAR_LOCKED,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.disableInteraction()},resetQuestion:function(e){this.isReset=!0;var t=$("#questionText",this.obj).find("textarea"),n=$("#questionText",this.obj).find("div.checkBadge"),r=$("#questionOptions",this.obj).find(".selected");n.removeClass("markRight"),n.removeClass("markWrong"),r.removeClass("markRight"),r.removeClass("markWrong"),r.removeClass("selected");var i=$(".mcq2",this.obj).find(".checkBadge2");i.size()>0&&(i.removeClass("markRight"),i.removeClass("markWrong")),$("#questionText textarea",this.obj).val("");for(var s=0;s<this.options.length;s++)$("#ans"+s,this.obj).val(this.options[s].data);this.responseType==AppConst.RESPONSE_TYPE_TEXT&&$("#questionText textarea",this.obj).removeAttr("readonly"),$("#questionOptions",this.obj).find(".selected").removeClass("selected"),$("#questionOptions",this.obj).find("li").removeClass("optionHighlight"),$("#questionOptions",this.obj).find("li").removeAttr("disabled"),this.userResponse=[],this.enableInteraction(),this.trigger(AppEvent.MARK_EMPTY,this.qId),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar),this.trigger(AppEvent.Q_STATUS,AppConst.NO_ATTEMPT)},resetQuestionPartial:function(e){this.optionSelected="",this.targetSelected="";var t=!0;$("#questionOptions",this.obj).find(".selected").removeClass("selected"),this.changeToolbar.mode=AppConst.TOOLBAR_DEFAULT,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var n=$("#questionText",this.obj).find("textarea"),r=$("#questionText",this.obj).find("div.checkBadge"),i=$("#questionOptions",this.obj).find("li");r.removeClass("markWrong"),r.removeClass("markRight");if(this.userResponse.length>0)if(this.responseType==AppConst.RESPONSE_TYPE_TEXT)for(var s=0;s<n.length;s++)if(this.answers[s].length>1)if(_.indexOf(this.answers[s],this.userResponse[s].trim())<0){var o=$(n.get(s));o.val(""),this.userResponse[s]=""}else t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);else if(this.userResponse[s].trim()!=this.answers[s][0].replace(/[.,?,']/g,"").toLowerCase()){var o=$(n.get(s));o.val(""),this.userResponse[s]=""}else t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);else{for(var s=0;s<n.length;s++)if(this.userResponse[s]!=this.options[this.answers[s][0]-1].data.toLowerCase()){var o=$(n.get(s));o.val(""),this.userResponse[s]=""}else t=!1,this.changeToolbar.mode=AppConst.TOOLBAR_ACTIVE,this.trigger(AppEvent.ANSWER_MARKED,this.changeToolbar);var u=this.userResponse[0];for(var s=0;s<this.options.length;s++)if(this.options[s].data.toLowerCase()==u){var a=i.get(s);$(a).find(".indicators").addClass("selected"),$(a).find(".optionsText").addClass("selected")}}n.removeClass("disableOption"),i.removeClass("disableOption"),i.removeClass("optionHighlight"),this.EvaluateFlag=!1,this.correctAnswerVisible=!1,this.enableInteraction(),t==0?this.trigger(AppEvent.UPDATE_RESPONSE,this.qId,{userResponse:this.userResponse}):this.trigger(AppEvent.MARK_EMPTY,this.qId),this.disableButton(AppConst.QBTN_RESET)},disableButton:function(e){$("#"+e,this.obj).addClass("disabled")},handleScreenExit:function(){},orientationchange:function(e){},destroy:function(){this.unbind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.unbind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.unbind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.unbind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.unbind(AppEvent.MARK_EMPTY,this.markEmpty),this.unbind(AppEvent.UPDATE_RESPONSE,this.updateResponse),this.unbind(AppEvent.MARK_ANSWER,this.handleMarkAnswer),$("#questionOptions",this.obj).find("li").unbind(),$("#ques"+this.model.get("id")).remove()}});return openTextTeacherMarked}),define("core/view/questionPlayer",["external/jquery.carouFredSel-6.2.1","language","utilities","AppConst","AppEvent","external/stopwatch","external/iscroll5","core/model/fibDropDownVO","core/view/fibDropDown","core/model/matchSortVO","core/view/matchSortView","core/model/fibTapPlaceVO","core/view/fibTapPlace","core/model/mcqBinaryVO","core/view/mcqBinary","core/model/mcqVO","core/view/mcqView","core/model/groupingTapPlaceVO","core/view/groupingTapPlace","core/model/openTextVO","core/view/openText","core/model/fibBinaryTableVO","core/view/fibBinaryTable","core/model/openTextTeacherMarkedVO","core/view/openTextTeacherMarked"],function(carousel,language,utils,AppConst,AppEvent,stopwatch,iscroll,fibDropDownVO,fibDropDown,matchSortVO,matchSortView,fibTapPlaceVO,fibTapPlace,mcqBinaryVO,mcqBinaryView,mcqVO,mcqView,groupingTapPlaceVO,groupingTapPlace,openTextVO,openText,fibBinaryTableVO,fibBinaryTable,openTextTeacherMarkedVO,openTextTeacherMarked){var questionPlayer=Backbone.View.extend({templateHeader:"<div id='info' class='info'>				<div id='InfoHeader'>					<h1 id='infoTitle' class = 'infoTitle'></h1>					<span id='infoClose' class = 'close'></span>                  	</div>                  	<div id ='infoContentCover' class= 'infoContent'>                  	<div id='infoContent' class= 'infoContent'></div><div id='infoImage'><img/></div>                  	</div></div>                  	<div><div id='<%=myId%>' class='screen'>		<!--header-->		<div id='header' class='head' style='display: <%=headerVisible%>;'>		<div class='center-content' >			<!--LEFT BTN-->	 		<div id='header-left' class='header-left-btn header-thumb <%=leftBtnClass%>'>	 		<img id='coverImageDiv'/>				</div>			<!--TITLE-->			<h1 style='display: <%=titleVisible%>'><%=title%></h1>			<!--RIGHT BTN-->			<div class='header-right-btn'>				<div class='<%=rightBtnClass%>'>					<div>					  <span>Version: "+AppConst.VERSION+"</span>					</div>					<!--p><%=rightLabel%></p-->				</div>			</div>			</div>		</div>				<div class='qinfo phone' id='info'>				  <span class='qposition'></span>				  <div class='infoButton'></div>				  <span class='qtime'></span>				  <span class='qMapWrapper'><div class='qMap'></div></span>				</div>				<div class='colorCode' style='background-color: <%=colorCode%>'></div>				<div class='pageWrapper center-content'><div><div class='qinstructions' id='inst'><!--span class='instructionTitle closed'>"+language.QUESTION_INSTRUCTION+"</span--><span class='instructionContent '></span></div>",templateContent:"<div id='content' class='content'></div></div></div>",templateFooter:"<div id='footer'>							<div class='center-content' >							<div id='assessmentBtnsContainer'>							<span id='qMapDesktop' class='footer_ico'></span>							<span class='right-icons'>							<span id='prevQBtn' class='footer_ico'><label>Previous</label>							</span><span id='resetQBtn' class='footer_ico'><label>"+language.RESET_BTN_LABEL+"</label>							</span><span id='answersBtn' class='footer_ico myAnswers'><label>"+language.ANSWER_BTN_LABEL+"</label>							</span><span id='evaluateBtn' class='footer_ico'><label>"+language.EVALUATE_BTN_LABEL+"</label>							</span><span id='nextQBtn' class='footer_ico'><label>Next</label>							</span><span id='ReportBtn' class=' report-btn'><label></label>							</span>							</span>							</span>							</div>							<div id='reviewBtnsContainer'>							<span id='qMapDesktop' class='footer_ico'></span>							<span class='right-icons'>							<span id='prevQBtn' class='footer_ico'><label>Previous</label></span>							<span id='correctAnsBtn' class='review_ico'><label>"+language.CORRECT_ANSWER_BTN_LABEL+"</label></span>							<span id='userAnsBtn' class='review_ico'><label>"+language.USER_ANSWER_BTN_LABEL+"</label></span>							<span id='feedbackBtn' class='footer_ico'><label>Feedback</label></span>							<span id='nextQBtn' class='footer_ico'><label>Next</label></span>							<span id='ReportBtn' class='  report-btn'><label></label></span>							</span>							</span>							</div>							<div class='qinfo desktop' id='info'>								<div class='infoButton'></div>							 	<span class='qposition'></span>							</div>						</div>						</div>						<!--div class='questionPopup'>							<div class='questionPopupBox arrowEvaluate'>							<img src='interface/wrongAnswer.png'><img src='interface/correctAnswer.png'>							<br>Oh, answer?							</div>							<div class='questionPopupArrow'></div>						</div>						<div class='instructionPopup'>							<div class='instructionPopupBox'>							<img src='"+language.QUESTION_INSTRUCTION_IMAGE+"'>							</div>						</div-->					<div id='instructionsWrapper'><img/></div>				<div class='resetOverlay'>      	    <div id='confirmload' class='hide resetPopup'>              <div id='confirm'>                  <div id='title'></div>                  <div id='message'></div>                  <div id= 'buttons' class = 'button'>                      <input id='p_reset' type='button'  value= 'Reset only incorrect answers'><br>                          <input id='c_reset' type='button'  value= 'Reset the whole question'><br>                              </div>                  <input type='checkbox' id='RemReset' value='0'> Remember my preference<br><br>                       </div>        </div>        </div>        <div id='navigatorOverlay'><div id='navigatorWrapper'><div class='navigator hidden'><span id='closeQMap' class='closeBtn'></span></div></div></div>",animconfig:{},screenId:"",curScreen:"",screen:null,prevBtnEnabled:!0,nextBtnEnabled:!0,quesView:null,mode:"",isTest:!1,isReview:!1,correctAnswerVisible:null,userResponse:{},isAnswered:!1,externalCall:!1,prevQobj:null,stopwatch:0,questionids:[],responseData:[],currentView:"",curIndex:-1,readOnly:!1,CurrentResponse:null,isBypass:!1,isRemember:!1,resetType:2,launchId:"",disableIScroll:!1,OrientationSupport:!1,direction:"",templateConfig:{},partialAttempt:!0,feedbackScroll:null,mapScroll:null,QAttemptStatus:[],partial_test_submission:!0,reportButton:null,uicfg:{},iScroll:null,navigatorsDisabled:!1,visibleElement:0,rubricScroll:null,initialize:function(){utils.log("questionplayer rendering",this.model),_.bindAll(this,"onTemplateReady","handleMarkCorrect","handleMarkIncorrect","handleMarkAnswer","onAnswerMarked","resetBtnClick","handleTemplateEvents","onQuestionReset","handleEvaluateClick","toggleVisibleResponse","nextBtnClick","prevBtnClick","handleAnimationComplete","handleQuestionAnimationComplete","destroyPrev","updateTime","handleDoneClick","resetAnswer","handleShowAnswer","handleBackClick","showQueInfo","hideQueInfo","destroy","orientationchange","initScroll","intRubricScroll","handleEvaluateBtnClick","refreshScroll","showFeedback","handleDoneStatus","handleMapItemClick","hideQMap","toggleInstructions","showQuesMap","handleQmap")},render:function(e,t,n,r,i){var s=this;this.screen=this.$el,this.responseData=r,this.launchId=i,s.setConfig(e,t,n,s),this.onScreenReady()},setConfig:function(e,t,n,r){this.templateConfig=n,this.mode=e.Mode,this.uicfg=t,this.partialAttempt=e.Partial_attempt,this.partial_test_submission=e.partial_test_submission,this.OrientationSupport=e.OrientationSupport,this.questionids=e.QuestionIds,this.mode=="Test"?(this.isTest=!0,this.isReview=!1):this.mode=="Review"&&(this.isTest=!0,this.isReview=!0);var i={};t.Header.visible&&(i.headerVisible="block",t.Header.left.visible&&(i.leftLabel=t.Header.left.text,i.leftVisible="none"),t.Header.right.visible&&(i.rightLabel=t.Header.right.text,i.rightVisible="block"),t.Header.title.visible&&(i.title=t.Header.title.text,i.titleVisible="block")),r.model.set(i);var s=_.template(r.templateHeader+r.templateContent+r.templateFooter,r.model.toJSON());this.changeToolbarMode({mode:AppConst.TOOLBAR_ACTIVE}),this.$el.append(s)},onScreenReady:function(e){this.screen=$("#"+this.model.get("myId"));if(!this.launchId||this.launchId=="undefined"||this.launchId=="null")this.mode=="Review"?this.curIndex=-1:this.curIndex=utils.findResumePosition(this.questionids,this.responseData)-1;else{this.curIndex=_.indexOf(this.questionids,this.launchId)-1;if(this.curIndex==-2){alert("No such Question present.");return}}utils.isPhone()?($("#header",this.screen).hide(),$(".qinfo.phone").prepend("<div id='reportBtn' class='reportButton'>Report</div>"),$(".qinfo.desktop",this.screen).hide(),this.reportButton=$(".reportButton"),$("#"+AppConst.REVIEW_BTNS_DIV,this.obj).find("#ReportBtn").hide(),$("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).find("#ReportBtn").hide(),$("#footer",this.screen).addClass("phone"),this.createQuesMap(this.questionids,this.responseData),$(".qMapWrapper",this.screen).show(),this.isReview?$("#"+AppConst.REVIEW_BTNS_DIV,this.obj).find("#qMapDesktop").hide():$("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).find("#qMapDesktop").hide()):($("#coverImageDiv",this.screen).attr("src",AppConst.ASSETS_PATH+this.uicfg.Header.coverImage),$(".qMapWrapper").hide(),$(".qinfo.phone",this.screen).hide(),this.isReview?($("#"+AppConst.REVIEW_BTNS_DIV,this.obj).find("#qMapDesktop").show(),this.reportButton=$("#"+AppConst.REVIEW_BTNS_DIV,this.obj).find("#ReportBtn")):($("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).find("#qMapDesktop").show(),this.reportButton=$("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).find("#ReportBtn")),$(".qinfo").removeClass("phone"),$("#footer").removeClass("phone"),this.createQuesMapForDesktop(this.questionids,this.responseData)),$(".header-right-btn").find(".rightReportButton").hide(),$("title").html(this.uicfg.Header.title.text),this.partialAttempt==0&&($("#answersBtn",this.screen).hide(),$("#evaluateBtn",this.screen).hide(),$("#correctAnsBtn",this.screen).hide(),$("#userAnsBtn",this.screen).hide()),!this.partial_test_submission&&!this.isReview&&this.reportButton.addClass("disabled"),this.isReview?($("#"+AppConst.QBTN_CORRECT_ANS,this.screen).bind(AppEvent.CLICK,this.handleShowAnswer),$("#"+AppConst.QBTN_USER_ANS,this.screen).bind(AppEvent.CLICK,this.handleShowAnswer)):($("#resetQBtn",this.screen).bind(AppEvent.CLICK,this.resetBtnClick),$("#"+AppConst.QBTN_ANSWERS,this.screen).bind(AppEvent.CLICK,this.handleShowAnswer),$("#"+AppConst.QBTN_EVALUATE,this.screen).bind(AppEvent.CLICK,this.handleEvaluateBtnClick)),this.screen.find(".header-left-btn").bind(AppEvent.CLICK,this.handleBackClick),this.reportButton.bind("click",this.handleDoneClick),this.animconfig={hide:"",show:AppConst.QUESTION_PLAYER,direction:AppConst.ANIMATE_FORWARD,destroy:!0},$("#"+AppConst.QUESTION_PLAYER).addClass("current"),this.curScreen=AppConst.QUESTION_PLAYER,this.onNextQuestion()},onNextQuestion:function(){this.questionids.length>=1&&(this.curIndex!=this.questionids.length-1&&this.curIndex++,this.direction="forward",this.handlePreviousandNextClick(),Backbone.Events.trigger("getQuestionData",this.questionids[this.curIndex]))},onPreviousQuestion:function(){this.questionids.length>=1&&(this.curIndex>0&&this.curIndex--,this.direction="reverse",this.handlePreviousandNextClick(),Backbone.Events.trigger("getQuestionData",this.questionids[this.curIndex]))},handlePreviousandNextClick:function(){this.disableIScroll=!1;var e=utils.isPhone()?"/":" of ";$(".qposition",this.screen).text("Question : "+(this.curIndex+1)+e+this.questionids.length),this.curIndex==0?this.prevBtnEnabled=!1:this.prevBtnEnabled=!0,this.curIndex==this.questionids.length-1?this.nextBtnEnabled=!1:this.nextBtnEnabled=!0,utils.isPhone()||this.handleQmap()},handleQmap:function(){if($("#mapDiv",this.screen).find("li").length>this.visibleElement){var e=$("#mapDiv",this.screen).find("li").get(this.visibleElement-1),t=parseInt(e.id.split("nav")[1]),n=t-this.visibleElement+1;if(!(this.curIndex>=n&&this.curIndex<=t)){var r=Math.floor(t/this.visibleElement),i=Math.floor(this.curIndex/this.visibleElement),s=r-i+1,o=parseInt($(".pagination",this.screen).find(".selected").find("span").html()),u=$(".pagination",this.screen).find("a").get(o-s);$(u).trigger("click")}}},handleTemplateEvents:function(){this.quesView.resetClicked||(this.isReview?(this.toggleVisibleResponse(),this.quesView.lockQuestion(),utils.log(">>>>>inside test and review"),this.changeToolbarMode({mode:AppConst.TOOLBAR_REVIEW_USER}),$("#feedbackBtn",this.screen).unbind(),this.curQData.feedbacks&&this.curQData.feedbacks!=""?($("#feedbackBtn",this.screen).removeClass("disabled"),$("#feedbackBtn",this.screen).bind(AppEvent.CLICK,this.showFeedback)):$("#feedbackBtn",this.screen).addClass("disabled")):this.isTest?this.readOnly?(utils.log("test mode and read only :",this.readOnly),this.correctAnswerVisible=!0,this.toggleVisibleResponse(),this.quesView.lockQuestion(),this.changeToolbarMode({mode:AppConst.TOOLBAR_LOCKED})):this.changeToolbarMode({mode:AppConst.TOOLBAR_DEFAULT}):this.readOnly?(this.correctAnswerVisible=!0,this.toggleVisibleResponse(),this.quesView.lockQuestion(),this.changeToolbarMode({mode:AppConst.TOOLBAR_LOCKED})):(this.correctAnswerVisible=!1,this.changeToolbarMode({mode:AppConst.TOOLBAR_DEFAULT})),this.prevQobj!=undefined?utils.screenTransition({curScreen:$("#ques"+this.prevQobj.model.get("id")).parent(),newScreen:$("#ques"+this.curQobj.model.get("id")).parent(),direction:this.direction,persistent:!0,handler:this.destroyPrev}):this.partialAttempt==0&&!this.isReview&&this.quesView.enableInteraction())},handleDoneClick:function(){if(this.reportButton.hasClass("disabled")){utils.showToasterMessage(AppConst.INCOMPLETE_TEST_REPORT_CLICK_MSG);return}if(this.isAnswered&&this.quesView.EvaluateFlag==0||this.partialAttempt==0&&this.isAnswered)this.isBypass=!1,this.handleEvaluateClick();this.isTest,utils.hideQuesPopup();var e={interrupt:!1,timeTaken:this.model.get("timestamp"),direction:"forward",curScreen:AppConst.QUESTION_PLAYER,handler:this.destroy};Backbone.Events.trigger("assessmentCompleted",e)},showFeedback:function(){if($("#feedbackBtn").hasClass("disabled"))return;var e=_.findWhere(this.responseData,{id:this.questionids[this.curIndex]}),t=e.score;t==undefined&&(t=0),utils.showFeedback(this.curQData.feedbacks,t)},handleDoneStatus:function(e){var t=this.QAttemptStatus[this.questionids[this.curIndex]],n=-1;if(t!=e){e==AppConst.COMPLETE?($("#nav"+this.curIndex).addClass("attempted"),$("#nav"+this.curIndex).removeClass("notattempted"),$("#nav"+this.curIndex).removeClass("partial"),n=2):e==AppConst.PARTIAL?($("#nav"+this.curIndex).addClass("partial"),$("#nav"+this.curIndex).removeClass("notattempted"),$("#nav"+this.curIndex).removeClass("attempted"),n=1):($("#nav"+this.curIndex).addClass("notattempted"),$("#nav"+this.curIndex).removeClass("attempted"),$("#nav"+this.curIndex).removeClass("partial"),n=0),this.QAttemptStatus[this.questionids[this.curIndex]]=n;var r=_.without(this.QAttemptStatus,0,1).length;this.partial_test_submission==0&&(r==this.questionids.length?this.reportButton.removeClass("disabled"):this.reportButton.addClass("disabled"))}},onSubmitAssessment:function(e,t){this.destroy(),utils.log("onSubmitAssessment>>>>>>>>",this.questionids,e);var n=this.questionids.length-_.size(e),r=0;for(k in e)e[k].status==1&&r++;var i=new resultScreenVO;i.set({questionData:this.questionids,resData:e,score:r,numSkipped:n,timeTaken:this.model.get("timestamp"),isTest:this.isTest});var s=new resultsScreen({model:i,el:this.screen});this.curScreen=AppConst.RESULT_SCREEN,s.render(t),this.currentView=s,s.isTest=this.isTest,this.showScreen()},handleBackClick:function(){this.isTest&&this.stopwatch.stop();var e={interrupt:!0,timeTaken:this.model.get("timestamp")};Backbone.Events.trigger("assessmentCompleted",e)},resetBtnClick:function(e){utils.log($("#resetQBtn"));if($("#resetQBtn").hasClass("disabled"))return;this.quesView.inputNo>1&&this.isRemember==0&&this.isAnswered==1&&this.quesView.EvaluateFlag==1&&this.partialAttempt?utils.showResetPopup(this.resetAnswer):this.resetAnswer()},resetAnswer:function(e,t){e&&(this.resetType=e),t&&(this.isRemember=t),this.resetType==1?this.quesView.resetQuestionPartial?this.quesView.resetQuestionPartial():this.quesView.resetQuestion():this.quesView.resetQuestion()},nextBtnClick:function(e){if($("#nextQBtn",this.obj).hasClass("disabled"))return;if(this.navigatorsDisabled)return;this.navigatorsDisabled=!0,$(".overlay").show(),(this.isBypass!=1&&this.isAnswered==1&&this.quesView.EvaluateFlag==0||this.partialAttempt==0&&this.isAnswered==1)&&this.handleEvaluateClick(),this.onNextQuestion()},prevBtnClick:function(){if($("#prevQBtn",this.obj).hasClass("disabled"))return;if(this.navigatorsDisabled)return;this.navigatorsDisabled=!0,$(".overlay").show(),(this.isBypass!=1&&this.isAnswered==1&&this.quesView.EvaluateFlag==0||this.partialAttempt==0&&this.isAnswered==1)&&this.handleEvaluateClick(),this.onPreviousQuestion(),Backbone.Events.trigger("onPrevClicked")},nextConfirmation:function(e){e=e==2?!0:!1,e?this.showNextQuestion():this.handleEvaluate()},handleEvaluateBtnClick:function(e){var t=$("#"+AppConst.QBTN_EVALUATE,this.obj);if(t.hasClass("disabled"))return;this.handleEvaluateClick()},handleEvaluateClick:function(e){var t=$("#"+AppConst.QBTN_EVALUATE,this.obj);if(this.isBypass&&this.isTest)return;e?(AppConst.POPQ=!0,e.preventDefault()):AppConst.POPQ=!1,this.quesView.handleEvaluate(t)},handleShowAnswer:function(e){if(this.itemClicked==1)return;utils.hideQuesPopup();if(e){var t=$(e.currentTarget);t.get(0).tagName=="LABEL"&&(t=t.parents("span"));if(t.hasClass("disabled"))return;e.preventDefault()}this.itemClicked=!0,$("#labelanswers",this.screen).css("visibility","hidden");if(this.isTest)this.toggleVisibleResponse();else if(!this.correctAnswerVisible){var n=!1;n?this.showAnswerConfirmation(2):($("#"+AppConst.QBTN_ANSWERS,this.screen).addClass("toggle"),this.toggleVisibleResponse())}else $("#"+AppConst.QBTN_ANSWERS,this.screen).removeClass("toggle"),this.toggleVisibleResponse();this.itemClicked=!1},toggleVisibleResponse:function(){if(!this.correctAnswerVisible&&this.correctAnswerVisible!=null)this.isTest||this.isReview?($("#labelanswers",this.obj).css("visibility","visible"),this.changeToolbarMode({mode:AppConst.TOOLBAR_REVIEW_CORRECT})):this.changeToolbarMode({mode:AppConst.TOOLBAR_RESET}),this.quesView.populateAnswers(this.curQData.answers,this.correctAnswerVisible),this.correctAnswerVisible=!0;else{var e=[];this.CurrentResponse?e=this.CurrentResponse.userResponse:this.userResponse&&this.userResponse.userResponse&&(e=this.userResponse.userResponse,this.isTest||(this.readOnly=!1)),this.isTest||this.isReview?(this.changeToolbarMode({mode:AppConst.TOOLBAR_REVIEW_USER}),this.readOnly=!1):this.userResponse.length>0?this.changeToolbarMode({mode:AppConst.TOOLBAR_LOCKED}):this.changeToolbarMode({mode:AppConst.TOOLBAR_LOCKED}),this.quesView.populateAnswers(e,this.correctAnswerVisible),this.correctAnswerVisible=!1}},onQuestionReset:function(){this.quesView.enableInteraction(),this.changeToolbarMode({mode:AppConst.TOOLBAR_DEFAULT})},initializeActivity:function(questionData,userResponse){this.correctAnswerVisible=!0,utils.showPreloader(),this.quesView!=null,this.userResponse="",userResponse==null||userResponse==undefined||userResponse==""?this.readOnly=!1:userResponse.userResponse&&(this.readOnly=!0),this.curQData=questionData,this.userResponse=userResponse,questionData.instructions==""||questionData.instructions==undefined;var ins=$(".qinstructions",this.$el);if(questionData.rubric==""||questionData.rubric==undefined)ins.hide();else{ins.show();var rubric=utils.renderNode(questionData.rubric[0]),insTitle=$(".qinstructions span.instructionTitle",this.$el),insCont=$(".qinstructions span.instructionContent",this.$el);insTitle.hide(),insCont.removeClass("up-arrow"),insCont.removeClass("closed"),insCont.removeClass("open"),ins.unbind(),insCont.html(rubric),insCont.css({overflow:"hidden","white-space":"normal"}),questionData.rubric[0].type=="image"&&ins.css("height","auto");var ht=$(insCont).height();questionData.rubric[0].type=="text"&&ht>20&&(insCont.addClass("up-arrow"),insCont.addClass("open"),ins.bind(AppEvent.CLICK,this.toggleInstructions))}switch(questionData.type){case AppConst.QUESTION_TYPE_MCQ:if(questionData.responseType==AppConst.RESPONSE_TYPE_BINARY){utils.isPhone()&&(this.disableIScroll=!0);var quesVO=new mcqBinaryVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new mcqBinaryView({model:quesVO,el:this.el})}else if(questionData.responseType==AppConst.RESPONSE_TYPE_SET){var quesVO=new mcqSetVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new mcqSetView({model:quesVO,el:this.el})}else{utils.isPhone()&&(this.disableIScroll=!0);var quesVO=new mcqVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new mcqView({model:quesVO,el:this.el})}break;case AppConst.QUESTION_TYPE_IMAGE:var quesVO=new imageVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new imageTapPlace({model:quesVO,el:this.el});break;case AppConst.QUESTION_TYPE_FIB:if(questionData.responseType==AppConst.RESPONSE_TYPE_DRAG){var quesVO=new fibTapPlaceVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest,partialAttempt:this.partialAttempt}),this.disableIScroll=!0,this.quesView=new fibTapPlace({model:quesVO,el:this.el})}else{var quesVO=new fibVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new fibView({model:quesVO,el:this.el})}break;case AppConst.QUESTION_TYPE_GROUPING:this.disableIScroll=!0;var quesVO=new groupingTapPlaceVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new groupingTapPlace({model:quesVO,el:this.el});break;case AppConst.QUESTION_TYPE_MATCHSORT:var quesVO=new matchSortVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest,attemptMethod:this.templateConfig.matchSort.attemptMethod,partialAttempt:this.partialAttempt}),this.quesView=new matchSortView({model:quesVO,el:this.el});break;case AppConst.QUESTION_TYPE_LABELLING:var quesVO=new textLabellingVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new textLabellingView({model:quesVO,el:this.el});break;case AppConst.QUESTION_TYPE_REORDERING:var quesVO=new reorderingShiftViewVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest,attemptMethod:this.templateConfig.reordering.attemptMethod}),questionData.questionLayout.toUpperCase()==AppConst.LAYOUT_HORIZONTAL?(this.templateConfig["reordering"]["attemptMethod"]==AppConst.REORDERING_DRAG_DROP&&(this.disableIScroll=!0),this.quesView=new reorderingShiftViewHorizontal({model:quesVO,el:this.el})):this.quesView=new reorderingShift({model:quesVO,el:this.el});break;case AppConst.QUESTION_TYPE_SPEAKING:var quesVO=new speakingVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new speakingView({model:quesVO,el:this.el});break;case AppConst.QUESTION_TYPE_FIB_DROPDOWN:var quesVO=new fibDropDownVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest,attemptMethod:this.templateConfig.dropDown.attemptMethod,partialAttempt:this.partialAttempt}),this.quesView=new fibDropDown({model:quesVO,el:this.el});break;case AppConst.QUESTION_TYPE_CROSSWORD:var quesVO=new crosswordVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.templateConfig["crossword"]["autoPopulate"]==1?this.quesView=new crossword_auto({model:quesVO,el:this.el}):this.quesView=new crossword_cord({model:quesVO,el:this.el});break;case AppConst.QUESTION_TYPE_FIBTABLE:if(questionData.responseType==AppConst.RESPONSE_TYPE_BINARY)if(utils.isPhone()){var quesVO=new fibDropDownVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest,attemptMethod:this.templateConfig.dropDown.attemptMethod,partialAttempt:this.partialAttempt}),this.quesView=new fibDropDown({model:quesVO,el:this.el})}else{this.disableIScroll=!0;var quesVO=new fibBinaryTableVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest,maintainOptions:this.templateConfig.fibTapPlaceTable.maintainOptions}),this.quesView=new fibBinaryTable({model:quesVO,el:this.el})}else{var quesVO=new fibTextTableVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new fibTextTable({model:quesVO,el:this.el})}break;case AppConst.QUESTION_TYPE_OPENTEXT:var quesVO=new openTextVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new openText({model:quesVO,el:this.el});break;case AppConst.QUESTION_TYPE_OPENTEXT_TEACHER_MARKED:var quesVO=new openTextTeacherMarkedVO(questionData);quesVO.set({userResponse:this.userResponse,isReview:this.isReview,isTest:this.isTest}),this.quesView=new openTextTeacherMarked({model:quesVO,el:this.el})}this.quesView.unbind(),this.quesView.bind(AppEvent.TEMPLATE_READY,this.onTemplateReady),this.quesView.bind(AppEvent.ANSWER_MARKED,this.onAnswerMarked),this.quesView.bind(AppEvent.MARK_CORRECT,this.handleMarkCorrect),this.quesView.bind(AppEvent.MARK_INCORRECT,this.handleMarkIncorrect),this.quesView.bind(AppEvent.MARK_ANSWER,this.handleMarkAnswer),this.quesView.bind(AppEvent.QUESTION_RESET,this.onQuestionReset),this.quesView.bind(AppEvent.CHANGETOOLBARMODE,this.changeToolbarMode),this.quesView.bind(AppEvent.UPDATE_RESPONSE,this.updateResponse),this.quesView.bind(AppEvent.MARK_EMPTY,this.markEmpty),this.quesView.bind(AppEvent.REFRESH_SCROLL,this.refreshScroll),this.quesView.bind(AppEvent.Q_STATUS,this.handleDoneStatus),rel=questionData.type+"_"+questionData.questionLayout,questionData.type==AppConst.QUESTION_TYPE_FIBTABLE&&utils.isPhone()&&(rel="FIBDROPDOWN_");if(questionData.type==AppConst.QUESTION_TYPE_MCQ)if(questionData.responseType=="BINARY")rel+="_BINARY";else{try{QuestionText=eval(questionData.questionBody)}catch(e){}QuestionText.length>0&&(rel+="_"+QuestionText[0].type)}if(questionData.type==AppConst.QUESTION_TYPE_FIB){try{QuestionText=eval(questionData.leftCol)}catch(e){}QuestionText.length>0&&(rel+="_"+QuestionText[0].type);try{QuestionText=eval(questionData.questionBody)}catch(e){}QuestionText.length>0&&QuestionText[0].type=="image"&&(rel+="_"+QuestionText[0].type),questionData.responseType=="TEXT"?rel+="_text":questionData.responseType=="DRAGDROP"&&(rel+="_VERTICAL")}questionData.type==AppConst.QUESTION_TYPE_FIB&&questionData.responseType=="BINARY"&&(rel+="_BINARY"),this.prevQobj=_.clone(this.curQobj),this.curQobj=this.quesView,$(".infoButton").attr("rel",rel);var ref=this;$(".infoButton",this.screen).unbind().bind("click",function(){ref.showQueInfo(questionData.responseType)}),$("#instructionsWrapper",this.screen).unbind().bind("click",ref.hideQueInfo),$(".qno").removeClass("selected"),$("#nav"+this.curIndex).addClass("selected"),this.quesView.render()},toggleInstructions:function(){$(".instructionContent",this.obj).hasClass("open")?($(".instructionContent",this.obj).removeClass("open"),$(".instructionContent",this.obj).removeClass("up-arrow"),$(".instructionContent",this.obj).addClass("closed")):($(".instructionContent",this.obj).removeClass("closed"),$(".instructionContent",this.obj).addClass("open"),$(".instructionContent",this.obj).addClass("up-arrow")),this.refreshScroll()},evaluateQuestion:function(e){this.isBypass=!0,this.handleEvaluateClick()},showNextQuestion:function(e){this.initializeActivity(e)},refreshScroll:function(){this.initScroll()},showPreviousQuestion:function(e){this.initializeActivity(e)},updateResponse:function(e,t){t==[]&&delete this.responseData[e],Backbone.Events.trigger(AppEvent.SAVE_RESPONSE,e,t)},markEmpty:function(e){Backbone.Events.trigger(AppEvent.SAVE_RESPONSE,e,[])},showQueInfo:function(e){qView=$(".infoButton").attr("rel"),popupImage="";switch(qView){case AppConst.QUESTION_VIEW_FIB:popupImage=AppConst.QUESTION_INSTRUCTION_FIB;break;case AppConst.QUESTION_VIEW_FIB_VERTICAL:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_VERTICAL;break;case AppConst.QUESTION_VIEW_FIB_IMAGE_VERTICAL:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_IMAGE_VERTICAL;break;case AppConst.QUESTION_VIEW_FIB_IMAGE:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_IMAGE;break;case AppConst.QUESTION_VIEW_FIB_2COL:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_2COL;break;case AppConst.QUESTION_VIEW_FIB_TEXT:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_TEXT;break;case AppConst.QUESTION_VIEW_FIB_GAP_2COL_IMAGE_TEXT:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_GAP_2COL_IMAGE_TEXT;break;case AppConst.QUESTION_VIEW_FIB_GAP_2COL_AUDIO_TEXT:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_GAP_2COL_AUDIO_TEXT;break;case AppConst.QUESTION_VIEW_FIB_GAP:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_GAP;break;case AppConst.QUESTION_VIEW_FIB_GAP_2COL:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_GAP_2COL;break;case AppConst.QUESTION_VIEW_FIB_GAP_2COL_IMAGE:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_GAP_2COL_IMAGE;break;case AppConst.QUESTION_VIEW_FIB_GAP_2COL_AUDIO:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_GAP_2COL_AUDIO;break;case AppConst.QUESTION_VIEW_REORDERING:popupImage=AppConst.QUESTION_INSTRUCTION_REORDERING;break;case AppConst.QUESTION_VIEW_REORDERING_VERTICAL:popupImage=AppConst.QUESTION_INSTRUCTION_REORDERING_VERTICAL;break;case AppConst.QUESTION_VIEW_LABELLING:popupImage=AppConst.QUESTION_INSTRUCTION_LABELLING;break;case AppConst.QUESTION_VIEW_MCQ:popupImage=AppConst.QUESTION_INSTRUCTION_MCQ;break;case AppConst.QUESTION_VIEW_MCQ_2COL:popupImage=AppConst.QUESTION_INSTRUCTION_MCQ_2COL;break;case AppConst.QUESTION_VIEW_MCQ_TEXT:popupImage=AppConst.QUESTION_INSTRUCTION_MCQ_TEXT,e=="PICKER"&&(popupImage=AppConst.QUESTION_INSTRUCTION_MCQ_TEXT_PICKER);break;case AppConst.QUESTION_VIEW_MCQ_IMAGE:popupImage=AppConst.QUESTION_INSTRUCTION_MCQ_IMAGE;break;case AppConst.QUESTION_VIEW_MCQ_SOUND:popupImage=AppConst.QUESTION_INSTRUCTION_MCQ_SOUND;break;case AppConst.QUESTION_VIEW_MATCHSORT_VERTICAL:popupImage=AppConst.QUESTION_INSTRUCTION_MATCHSORT_VERTICAL;break;case AppConst.QUESTION_INSTRUCTION_GROUPING:popupImage=AppConst.QUESTION_INSTRUCTION_GROUPING;break;case AppConst.QUESTION_VIEW_IMAGE:popupImage=AppConst.QUESTION_INSTRUCTION_IMAGE;break;case AppConst.QUESTION_VIEW_GROUPING:popupImage=AppConst.QUESTION_INSTRUCTION_GROUPING;break;case AppConst.QUESTION_VIEW_FIB_AUDIO_2COL:popupImage=AppConst.QUESTION_INSTRUCTION_FIB_AUDIO_2COL;break;case AppConst.QUESTION_VIEW_FIBDROPDOWN:popupImage=AppConst.QUESTION_INSTRUCTION_FIBDROPDOWN;break;case AppConst.QUESTION_VIEW_BINARY:popupImage=AppConst.QUESTION_INSTRUCTION_BINARY;break;case AppConst.QUESTION_VIEW_BINARY_TABLE:popupImage=AppConst.QUESTION_INSTRUCTION_BINARY_TABLE;break;case AppConst.QUESTION_VIEW_OPENTEXT:popupImage=AppConst.QUESTION_INSTRUCTION_OPENTEXT;break;case AppConst.QUESTION_VIEW_OPENTEXT_TEACHER_MARKED:popupImage=AppConst.QUESTION_INSTRUCTION_OPENTEXT;break;default:}$("#instructionsWrapper img").attr("src",AppConst.OFFLINE_PATH+popupImage),$("#instructionsWrapper").show()},hideQueInfo:function(){$("#instructionsWrapper").hide()},showScreen:function(){var e=this;utils.screenTransition({curScreen:$("#questionPlayer"),newScreen:$("#"+AppConst.RESULT_SCREEN),direction:this.direction,persistent:!1,handler:function(){e.destroy()}})},onTemplateReady:function(){var e=this;this.handleTemplateEvents(),_.delay(function(){e.initScroll(),e.quesView.scroll=e.iScroll},500)},intRubricScroll:function(){this.rubricScroll!=null&&this.rubricScroll.destroy(),this.rubricScroll=new IScroll($(".qinstructions",this.screen).get(0),{desktopCompatibility:!0,interactiveScrollbars:!0,scrollY:!0}),ths=this,_.delay(function(){ths.rubricScroll.refresh()},999)},updateTime:function(e){this.model&&this.model.set({timestamp:e})},onAnswerMarked:function(e){this.changeToolbarMode(e)},changeToolbarMode:function(e){this.isAnswered=!1,$(".footer_ico",this.obj).addClass("disabled"),$(".review_ico",this.obj).addClass("disabled"),this.prevBtnEnabled&&$("#prevQBtn",this.obj).removeClass("disabled"),this.nextBtnEnabled&&$("#nextQBtn",this.obj).removeClass("disabled");switch(e.mode){case AppConst.TOOLBAR_DEFAULT:$("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).show(),$("#"+AppConst.REVIEW_BTNS_DIV,this.obj).hide(),$("#"+AppConst.QBTN_ANSWERS,this.obj).removeClass("toggle");break;case AppConst.TOOLBAR_ACTIVE:this.isAnswered=!0,$("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).show(),$("#"+AppConst.REVIEW_BTNS_DIV,this.obj).hide(),this.isTest||$("#"+AppConst.QBTN_EVALUATE,this.obj).removeClass("disabled"),$("#"+AppConst.QBTN_RESET,this.obj).removeClass("disabled"),this.enableCluesIfAvailable();break;case AppConst.TOOLBAR_LOCKED:this.isAnswered=!0,$("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).show(),$("#"+AppConst.REVIEW_BTNS_DIV,this.obj).hide(),this.isTest?$("#"+AppConst.QBTN_RESET,this.obj).removeClass("disabled"):($("#"+AppConst.QBTN_ANSWERS,this.obj).removeClass("disabled toggle"),$("#"+AppConst.QBTN_RESET,this.obj).removeClass("disabled"));break;case AppConst.TOOLBAR_DISABLED:$("#"+AppConst.QBTN_ANSWERS,this.obj).removeClass("disabled");break;case AppConst.TOOLBAR_RESET:$("#"+AppConst.QBTN_ANSWERS,this.obj).removeClass("disabled");break;case AppConst.TOOLBAR_REVIEW_CORRECT:$("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).hide(),$("#"+AppConst.REVIEW_BTNS_DIV,this.obj).show(),$("#"+AppConst.QBTN_USER_ANS,this.obj).removeClass("disabled"),$("#"+AppConst.QBTN_CORRECT_ANS,this.obj).addClass("selected"),$("#"+AppConst.QBTN_USER_ANS,this.obj).removeClass("selected");break;case AppConst.TOOLBAR_REVIEW_USER:$("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).hide(),$("#"+AppConst.REVIEW_BTNS_DIV,this.obj).show(),$("#"+AppConst.QBTN_CORRECT_ANS,this.obj).removeClass("disabled"),$("#"+AppConst.QBTN_USER_ANS,this.obj).addClass("selected"),$("#"+AppConst.QBTN_CORRECT_ANS,this.obj).removeClass("selected");break;case AppConst.TOOLBAR_SPEAKING_ACTIVE:$("#"+AppConst.QBTN_RESET,this.obj).removeClass("disabled");break;case AppConst.TOOLBAR_SPEAKING:$("#"+AppConst.QBTN_RESET,this.obj).addClass("disabled")}if(this.isReview){var t=$("#reviewBtnsContainer",this.screen);$("#assessmentBtnsContainer",this.screen).hide()}else{var t=$("#assessmentBtnsContainer",this.screen);$("#reviewBtnsContainer",this.screen).hide()}t.find("#qMapDesktop").removeClass("disabled"),this.nextBtnEnabled?(t.find("#nextQBtn").removeClass("disabled"),t.find("#nextQBtn").unbind().bind(AppEvent.CLICK,this.nextBtnClick)):t.find("#nextQBtn").addClass("disabled"),this.prevBtnEnabled?(t.find("#prevQBtn").removeClass("disabled"),t.find("#prevQBtn").unbind().bind(AppEvent.CLICK,this.prevBtnClick)):t.find("#prevQBtn").addClass("disabled")},enableCluesIfAvailable:function(){$("#"+AppConst.QBTN_CLUES,this.obj).unbind(),this.clues!=""?($("#"+AppConst.QBTN_CLUES,this.obj).removeClass("disabled"),$("#"+AppConst.QBTN_CLUES,this.obj).removeAttr("disabled"),$("#"+AppConst.QBTN_CLUES,this.obj).bind(AppEvent.CLICK,this.cluesBtnClick)):($("#"+AppConst.QBTN_CLUES,this.obj).addClass("disabled"),$("#"+AppConst.QBTN_CLUES,this.obj).attr("disabled","disabled"),$("#"+AppConst.QBTN_CLUES,this.obj).unbind(AppEvent.CLICK))},handleMarkCorrect:function(e,t){t.id=e,this.userResponse=t,!this.isTest,this.changeToolbarMode({mode:AppConst.TOOLBAR_LOCKED}),Backbone.Events.trigger(AppEvent.SAVE_RESPONSE,e,t)},handleMarkIncorrect:function(e,t){t.id=e,this.userResponse=t,!this.isTest,this.changeToolbarMode({mode:AppConst.TOOLBAR_LOCKED}),Backbone.Events.trigger(AppEvent.SAVE_RESPONSE,e,t)},handleMarkAnswer:function(e,t){t.id=e,this.userResponse=t,!this.isTest,this.changeToolbarMode({mode:AppConst.TOOLBAR_LOCKED}),Backbone.Events.trigger(AppEvent.SAVE_RESPONSE,e,t)},initScroll:function(){utils.log("initScroll :: ",this.iScroll);if(this.disableIScroll!=1){var e=$("#ques"+this.curQData.id).get(0),t=$("#footer",this.screen).get(0).offsetTop-$("#content",this.screen).get(0).offsetTop-70,n=isNaN(parseInt($(".qinstructions").css("margin")))?0:parseInt($(".qinstructions").css("margin"));$("#ques"+this.curQData.id,this.screen).css("height",t-n+"px"),$("#ques"+this.curQData.id,this.screen).css("overflow","hidden"),this.iScroll!=null&&this.iScroll.destroy(),this.iScroll=new IScroll($("#ques"+this.curQData.id,this.screen).get(0),{desktopCompatibility:!0,interactiveScrollbars:!0,scrollY:!0}),this.iScroll.moved=!1,ths=this,_.delay(function(){ths.iScroll.refresh()},999)}else this.quesView.scroll!=null&&this.quesView.scroll.destroy(),this.prevQobj&&this.prevQobj.scroll!=null&&this.prevQobj.scroll.destroy(),this.quesView.initScroll();utils.log("initScroll 2:: ",this.iScroll)},handleAnimationComplete:function(e){this.currentView.applyCSS()},handleQuestionAnimationComplete:function(e){},enableButton:function(e){$("#"+e,this.obj).removeClass("disabled")},disableButton:function(e){$("#"+e,this.obj).addClass("disabled")},createQuesMap:function(e,t){var n="";n+='<div class="qmapUlWrappar"><ul class="phone">';for(var r=0;r<t.length;r++)t&&t[r].userResponse!=undefined?n+='<li id="nav'+r+'" class="qno phone attempted">'+(r+1)+"</li>":n+='<li id="nav'+r+'" class="qno phone notattempted">'+(r+1)+"</li>";n+="</ul></div>",$(".navigator").prepend(n),$(".qMap").unbind().bind(AppEvent.CLICK,this.showQuesMap),$("#closeQMap",this.obj).bind(AppEvent.CLICK,this.hideQMap),$(".qno",this.obj).unbind().bind(AppEvent.CLICK,this.handleMapItemClick)},createQuesMapForDesktop:function(e,t){var n="";n+='<div class="mapDivOuter"><span class="prev disabled"></span><span id="mapDivWrapper"><ul id="mapDiv">';for(var r=0;r<t.length;r++)t[r]&&t[r].userResponse!=undefined?n+='<li id="nav'+r+'" class="qno attempted">'+(r+1)+"</li>":n+='<li id="nav'+r+'" class="qno notattempted">'+(r+1)+"</li>";n+='</ul></span><span class="next"></span></div>',this.isReview?$("#"+AppConst.REVIEW_BTNS_DIV,this.obj).find("#qMapDesktop").prepend(n):$("#"+AppConst.ASSESSMENT_BTNS_DIV,this.obj).find("#qMapDesktop").prepend(n);var i=$("#mapDiv").find("li").outerWidth()+6,s=$("#qMapDesktop").width()-$(".prev").width()-$(".next").width();window.navigator.userAgent.toLowerCase().indexOf("firefox")||window.navigator.userAgent.toLowerCase().indexOf("MSIE")?($("#mapDivWrapper").css("width",s+20+"px"),$("#mapDiv").css("width",s+20+"px")):($("#mapDivWrapper").css("width",s+"px !important"),$("#mapDiv").css("width",s+"px !important")),this.visibleElement=Math.floor(s/i);var o=Math.ceil(t.length/this.visibleElement),u='<div class="pagination" id="pagination" style="display: block;">';$("#qMapDesktop",this.obj).append(u),$("#page1",this.obj).addClass("selected"),$("#mapDiv").carouFredSel({auto:!1,prev:".prev",next:".next",pagination:"#pagination",circular:!1,visibleItemCount:this.visibleElement,infinite:!1,mousewheel:!1,synchronise:!1,scroll:{fx:"crossfade"},swipe:{onMouse:!0,onTouch:!0}});var a=s;window.navigator.userAgent.toLowerCase().indexOf("firefox")||window.navigator.userAgent.toLowerCase().indexOf("MSIE")?($("#mapDivWrapper").css("width",a+20+"px"),$("#mapDiv").css("width",a+20+"px")):($("#mapDivWrapper").css("width",a+20+"px !important"),$("#mapDiv").css("width",a+20+"px !important")),this.visibleElement>=e.length&&$(".next").addClass("disabled"),$(".qMap").unbind().bind(AppEvent.CLICK,this.showQuesMap),$("#closeQMap",this.obj).bind(AppEvent.CLICK,this.hideQMap),$(".qno",this.obj).unbind().bind(AppEvent.CLICK,this.handleMapItemClick)},showQuesMap:function(){if(this.quesView.spinnerOpen)return;$("#navigatorOverlay").show();var e=$(".qmapUlWrappar").height();$(".qmapUlWrappar").css("position","relative"),this.mapScroll=new IScroll($(".qmapUlWrappar").get(0),{desktopCompatibility:!0,hScroll:!0});var t=this;_.delay(function(){t.mapScroll.refresh()},999)},hideQMap:function(){this.mapScroll&&(this.mapScroll.destroy(),this.mapScroll=null),$("#navigatorOverlay").hide()},handleMapItemClick:function(e){var t=parseInt(e.target.id.split("nav")[1]);this.hideQMap(),t!=this.curIndex&&($(".overlay").show(),t>this.curIndex?this.direction="forward":this.direction="reverse",this.curIndex=t,(this.isBypass!=1&&this.isAnswered==1&&this.quesView.EvaluateFlag==0||this.partialAttempt==0&&this.isAnswered==1)&&this.handleEvaluateClick(),this.handlePreviousandNextClick(),Backbone.Events.trigger("getQuestionData",this.questionids[t]))},orientationchange:function(e){this.iScroll!=null&&(this.iScroll.destroy(),_.delay(this.initScroll,500));var t=this.quesView;_.delay(function(){t.orientationchange(e)},600)},destroyPrev:function(){this.prevQobj.scroll!=null&&this.prevQobj.scroll.destroy(),utils.log("destroying previous",this.prevQobj.model.get("id")),$("#ques"+this.prevQobj.model.get("id"),this.screen).unbind(),$("#ques"+this.prevQobj.model.get("id"),this.screen).remove(),$("#quesWrapper"+this.prevQobj.model.get("id"),this.screen).unbind(),$("#quesWrapper"+this.prevQobj.model.get("id"),this.screen).remove(),this.partialAttempt==0&&!this.isReview&&this.quesView.enableInteraction(),this.navigatorsDisabled=!1,utils.hidePreloader()},destroy:function(){this.quesView.destroy(),$(".header-right-btn",this.screen).unbind(),$(".header-left-btn",this.screen).unbind(),this.screen.unbind(),this.screen.remove()}});return questionPlayer}),define("core/model/resourceScreenVO",["AppConst","language"],function(e,t){var n=Backbone.Model.extend({defaults:function(){return{myId:e.RESOURCE_SCREEN,leftLabel:t.BACK_BUTTON_LABEL,title:t.RESOURCE_TITLE,rightLabel:"",leftBtnClass:"",rightBtnClass:"",content:"",headerVisible:"block",leftVisible:"block",titleVisible:"block",rightVisible:"block",resources:[],colorCode:"",coverImage:""}}});return n}),define("core/view/resourceScreen",["language","utilities","AppConst","AppEvent","external/iscroll5"],function(e,t,n,r,i){var s=Backbone.View.extend({curObj:this,screen:null,templateContent:"<div id='<%=myId%>' class='screen'><div id='header' class='head'>			<div class='center-content' >			<!--LEFT BTN-->	 		<div id='header-left' style='display: <%=leftVisible%>' class='header-left-btn  header-thumb'>				<div class='<%=leftBtnClass%>'>					<img id='coverImageDiv'/>					<p></p>				</div></div>			<!--TITLE-->			<h1 style='display: <%=titleVisible%>'><%=title%></h1>			<!--RIGHT BTN-->			<div class='header-right-btn' style='display: <%=rightVisible%>'>				<div class='<%=rightBtnClass%>'>					<div>					   <span>Version: "+n.VERSION+"</span>					</div>					<p><%=rightLabel%></p>				</div>			</div>		</div></div><div class='colorCode' style='background-color: <%=colorCode%>'></div>		<div class='center-content' ><div class='qinfo' >		<div id='resourceHeading'>Next steps</div></div>			<div class='resourceWrapperOuter'>			<div id='resourceWrapper'>				<div id='resourceContent'>				</div>			</div>			</div></div>			<div class='footerbar'>			<div class='center-content' >						<span class='backBtn'>Back to report</span>						</div>					</div>			<div class='infoOverlay'>			<div class='infoWrapper resourceInfo'>			<div class='contentWrapper'>			<div>			<div class='infoHeading'></div>				<div class='infoContent'></div>				</div></div>				<div class='closeBar'><span class='closeBtn resourceCloseBtn'>Close</span></div>			</div>		</div>		</div>",iScroll:null,resourceData:[],infoScroll:null,backButton:null,initialize:function(){_.bindAll(this,"onBackClick","showResource","showInfo","hideInfo","initScroll","destroy")},render:function(){this.screen=this.$el,this.generateResource()},generateResource:function(){this.$el.append(_.template(this.templateContent,this.model.toJSON())),this.screen=$("#"+this.model.get("myId")),this.resourceData=this.model.get("resources");var e="<ul>";for(var i=0;i<this.resourceData.length;i++){var s="",o="";this.resourceData[i].longText==""&&(s="disabled"),n.OFFLINE&&(this.resourceData[i].remCode=="TEST"||this.resourceData[i].remCode=="AGMS")&&(o="hide"),e+="<li id='"+i+"' class='resource "+o+"' data-remcode='"+this.resourceData[i].remCode+"'><span id='resourceType' class='"+this.resourceData[i].icon+"'></span><span class='resource-txt'>"+this.resourceData[i].descriptionText+"</span><span class='infoBtn "+s+"'></span></li>"}e+="</ul>",$("#resourceContent",this.screen).html(e);if(t.isPhone()){$("#header",this.screen).hide(),$(".qinfo",this.screen).prepend("<div id ='backButton' class='backButton'>Back</div>"),$(".qinfo",this.screen).addClass("phone"),$(".qinfo",this.screen).removeClass("dp");var u=$(".qinfo.phone",this.screen).get(0).outerHTML;$(".qinfo.phone",this.screen).remove(),$("#resourceScreen").prepend(u),this.backButton=$("#backButton"),$(".footerbar",this.screen).hide()}else $("#coverImageDiv",this.screen).attr("src",n.ASSETS_PATH+this.model.get("coverImage")),$("#header",this.screen).removeClass("hide"),$(".qinfo",this.screen).removeClass("phone"),$(".qinfo",this.screen).addClass("dp"),this.backButton=$(".backBtn",this.screen);this.backButton.bind(r.CLICK,this.onBackClick),$(".resource",this.screen).bind(r.CLICK,this.showResource),$(".infoBtn",this.screen).bind(r.CLICK,this.showInfo),this.initScroll()},initScroll:function(){var e=$("#resourceScreen").get(0).clientHeight-$("#header").get(0).clientHeight-$(".qinfo").get(0).clientHeight-$(".footerbar").get(0).clientHeight-$(".colorCode").get(0).clientHeight;$("#resourceWrapper").height(e-10),$("#resourceWrapper").css("position","relative"),this.iScroll!=null&&this.iScroll.destroy(),this.iScroll=new IScroll($("#resourceWrapper").get(0),{desktopCompatibility:!0,hScroll:!0}),ths=this,_.delay(function(){ths.iScroll.refresh()},999)},handleBackClick:function(e){Backbone.Events.trigger(r.QUIT_RESULT)},onBackClick:function(){var e=this,t={interrupt:!1,direction:"reverse",curScreen:n.RESOURCE_SCREEN,handler:function(){e.destroy()}};Backbone.Events.trigger("assessmentCompleted",t)},showResource:function(e){if(this.iScroll.moved)return;var n=e.target,r=n.className;if(r.indexOf("infoBtn")>-1)return;n.nodeName.toLowerCase()!="li"&&(n=n.parentNode),t.showResource(this.resourceData[n.id])},hideInfo:function(e){$(".infoOverlay").hide(),$(".resource",this.screen).removeClass("selected"),this.infoScroll!=null&&this.infoScroll.destroy(),$(".closeBtn",this.screen).unbind()},showInfo:function(e){var t=e.target.className;if(t.indexOf("disabled")>-1)return;$(e.target.parentNode).addClass("selected");var n=this.resourceData[e.target.parentNode.id].descriptionText,i=this.resourceData[e.target.parentNode.id].longText;$(".infoOverlay",this.screen).show(),$(".infoHeading",this.screen).html(n),$(".infoContent",this.screen).html(i),$(".closeBtn",this.screen).bind(r.CLICK,this.hideInfo);var s=$(".resourceInfo",this.screen).height();$(".contentWrapper",this.screen).height(s-10),$(".contentWrapper",this.screen).css("position","relative"),this.infoScroll!=null&&this.infoScroll.destroy(),this.infoScroll=new IScroll($(".contentWrapper",this.screen).get(0),{desktopCompatibility:!0,hScroll:!0}),ths=this,_.delay(function(){ths.infoScroll.refresh()},999)},destroy:function(){this.iScroll!=null&&this.iScroll.destroy(),$("#"+n.RESOURCE_SCREEN).unbind(),$("#"+n.RESOURCE_SCREEN).remove(),$(".header-left-btn",this.screen).unbind(),$(".backBtn",this.screen).unbind(),$(".resource",this.screen).unbind(),$(".infoBtn").unbind(),this.screen.unbind(),this.screen.remove()}});return s}),!function(e,t){function n(e){return e&&e.toLowerCase?e.toLowerCase():e}function r(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]==t)return!i;return i}var i=!1,s=null,o=parseFloat,u=Math.min,a=/(-?\d+\.?\d*)$/g,f=/(\d+\.?\d*)$/g,l=[],c=[],h=function(e){return"string"==typeof e},p=function(e,t){for(var n,r=e.length,i=r;i--;)n=r-i-1,t(e[n],n)},d=Array.prototype.indexOf||function(e){var t=this.length,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=t);t>n;n++)if(n in this&&this[n]===e)return n;return-1};e.tinysort={id:"TinySort",version:"1.5.6",copyright:"Copyright (c) 2008-2013 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(){var e=function(e,t){l.push(e),c.push(t)};return e.indexOf=d,e}(),defaults:{order:"asc",attr:s,data:s,useVal:i,place:"start",returns:i,cases:i,forceStrings:i,ignoreDashes:i,sortFunction:s}},e.fn.extend({tinysort:function(){var v,y,w,E,S=this,x=[],T=[],N=[],C=[],L=0,A=[],O=[],M=function(e){p(l,function(t){t.call(t,e)})},_=function(e,t){return"string"==typeof t&&(e.cases||(t=n(t)),t=t.replace(/^\s*(.*?)\s*$/i,"$1")),t},D=function(e,t){var n=0;for(0!==L&&(L=0);0===n&&E>L;){var r=C[L],s=r.oSettings,u=s.ignoreDashes?f:a;if(M(s),s.sortFunction)n=s.sortFunction(e,t);else if("rand"==s.order)n=Math.random()<.5?1:-1;else{var l=i,d=_(s,e.s[L]),v=_(s,t.s[L]);if(!s.forceStrings){var y=h(d)?d&&d.match(u):i,b=h(v)?v&&v.match(u):i;if(y&&b){var w=d.substr(0,d.length-y[0].length),S=v.substr(0,v.length-b[0].length);w==S&&(l=!i,d=o(y[0]),v=o(b[0]))}}n=r.iAsc*(v>d?-1:d>v?1:0)}p(c,function(e){n=e.call(e,l,d,v,n)}),0===n&&L++}return n};for(v=0,w=arguments.length;w>v;v++){var P=arguments[v];h(P)?A.push(P)-1>O.length&&(O.length=A.length-1):O.push(P)>A.length&&(A.length=O.length)}for(A.length>O.length&&(O.length=A.length),E=A.length,0===E&&(E=A.length=1,O.push({})),v=0,w=E;w>v;v++){var H=A[v],B=e.extend({},e.tinysort.defaults,O[v]),F=!!H&&""!==H,I=F&&":"===H[0];C.push({sFind:H,oSettings:B,bFind:F,bAttr:B.attr!==s&&""!==B.attr,bData:B.data!==s,bFilter:I,$Filter:I?S.filter(H):S,fnSort:B.sortFunction,iAsc:"asc"==B.order?1:-1})}return S.each(function(n,r){var i,s=e(r),o=s.parent().get(0),u=[];for(y=0;E>y;y++){var a=C[y],f=a.bFind?a.bFilter?a.$Filter.filter(r):s.find(a.sFind):s;u.push(a.bData?f.data(a.oSettings.data):a.bAttr?f.attr(a.oSettings.attr):a.oSettings.useVal?f.val():f.text()),i===t&&(i=f)}var l=d.call(N,o);0>l&&(l=N.push(o)-1,T[l]={s:[],n:[]}),i.length>0?T[l].s.push({s:u,e:s,n:n}):T[l].n.push({e:s,n:n})}),p(T,function(e){e.s.sort(D)}),p(T,function(e){var t=e.s,n=e.n,s=t.length,o=n.length,a=s+o,f=[],l=a,c=[0,0];switch(B.place){case"first":p(t,function(e){l=u(l,e.n)});break;case"org":p(t,function(e){f.push(e.n)});break;case"end":l=o;break;default:l=0}for(v=0;a>v;v++){var h=r(f,v)?!i:v>=l&&l+s>v,d=h?0:1,m=(h?t:n)[c[d]].e;m.parent().append(m),(h||!B.returns)&&x.push(m.get(0)),c[d]++}}),S.length=0,Array.prototype.push.apply(S,x),S}}),e.fn.TinySort=e.fn.Tinysort=e.fn.tsort=e.fn.tinysort}(jQuery),define("external/jquery.tinysort.min",function(){}),define("core/view/resultScreen",["language","utilities","AppConst","AppEvent","external/iscroll5","core/model/resourceScreenVO","core/view/resourceScreen","external/jquery.tinysort.min"],function(e,t,n,r,i,s,o,u){var a=Backbone.View.extend({curObj:this,screen:null,templateContent:"<div id='<%=myId%>' class='screen'><div id='header' class='head'>			<div class='center-content' >			<!--LEFT BTN-->	 		<div id='header-left' style='display: <%=leftVisible%>' class='header-left-btn  header-thumb'>				<div class='<%=leftBtnClass%>'>					<img id='coverImageDiv'/>					<p><%=leftLabel%></p>				</div></div>			<!--TITLE-->			<h1 style='display: <%=titleVisible%>'><%=title%></h1>			<!--RIGHT BTN-->			<div class='header-right-btn resourceBtn' style='display: <%=rightVisible%>'>				<div class='<%=rightBtnClass%>'>					<div>					   <span>Version: "+n.VERSION+"</span>					</div>					<p><%=rightLabel%></p>				</div>			</div>		</div></div><div class='colorCode' id='colorCodeDesktop' style='background-color: <%=colorCode%>'></div>		<div id='resultsContentCover' class='center-content'><div id='resultsContent'></div></div>		<div class='footerbar'>						<div class='center-content'><span id='backToReport'>Back To Reports</span><span id='resourceBtn'>Next steps</span><span id='printBtn'>Print</span>						</div>						</div></div>",templateContent2:'<div class="dp qinfo">            			<span id="usernameSpan">Test Results</span><span id="timerSpan" style="float:right;margin-right:1.5%;"></span>            			</div>            			<div class="colorCode" id="colorCodePhone" style="background-color: <%=colorCode%>"></div>            			<div class="progressdiv"><span  id="testScore" class="score"><span class="indicator"></span><span class="marks"></span><span class="percentage"></span></span></div>						<div id="testFeedbackContainer"><div>							<div class="testFeedbackWrapper">								<span class="testFeedbackIcon">Test Feedback</span>								<span class="testFeedbackContent"><span class="testFeedback"></span><span class="toggle-testFeedback open"></span></span>							</div>							<div id="sortByDiv" class="clearfix">								<span class="sort-text">Sort results by</span>								<span class="selectBox"><select id="sort"><option value="">select</option><option value="title">Question</option><option value="topic">Topic</option><option value="score">Score</option></select><i class="arrow"></i></span>							</div>							<div id="offlinePopup" class="error-msg">Your device is offline!</div>							<div id= "detailedProgressCover">								<div id= "detailedProgress" class="resques result-table"></div></div></div></div>								</div>',headerClass:"homehead",screenClass:"",leftBtnClass:"",resultData:[],iScroll:null,selectedFeedback:null,resourceButton:null,printButton:null,initialize:function(){_.bindAll(this,"handleReviewClick","handleBackClick","handleFeedbackClick","showResources","destroy","toggleTestFeedback","sortResult","showTopicInfo")},render:function(){this.generateResults()},generateResults:function(){this.resultData=this.model.get("resultData");var e=this.model.get("testFeedbackData"),i=this.model.get("testMarkScheme");this.$el.append(_.template(this.templateContent,this.model.toJSON())),t.log("el === ",this.$el),this.screen=$("#"+this.model.get("myId")),t.log("result screen ",$(this.screen));var s=_.template(this.templateContent2,this.model.toJSON());$("#resultsContent",this.screen).html(s),n.username!=""&&n.username!=undefined&&$("#usernameSpan",this.screen).html("Test Results for "+n.username);var o=0,u=0,a=!1,f="";t.isPhone()?f+="<ul class='progress-ui'>":f+="<ul class='result-grid-header'><li class='clearfix'><span class='col-0'></span><span class='col-1' id='sort-title'>Question<span class='sorting-icon'></span></span><span class='col-2' id='sort-topic'>Topic<span class='sorting-icon'></span></span><span class='col-3' id='sort-score'>Performance<span class='sorting-icon'></span></span><span class='col-4'></span></li></ul><ul class='progress-ui'>";for(var l=0;l<this.resultData.length;l++){var c=this.resultData[l].responseData.score;if(this.resultData[l].type==n.QUESTION_TYPE_OPENTEXT_TEACHER_MARKED&&this.resultData[l].responseData.isQuestionMarked!="true"){var h="Awaiting mark",p="awaiting";a=!0}else{c==undefined?c=0:c=parseInt(c);var d=parseInt(this.resultData[l].maxScore);o+=c,u+=d;var h=c+"/"+d,v=(c/d*100).toFixed(0);if(v<34)var p="incorrect";else if(v>=34&&v<=66)var p="partial";else var p="correct"}var m="hide";this.resultData[l].feedback&&this.resultData[l].feedback!=""&&(m="enabled"),t.isPhone()?(f+="<li class='progress-text'><span class='col-0'>"+(l+1)+") </span><span class='col-1 title'>"+this.resultData[l].title+"</span>",f+="<span class='topic col-2'><i><b>Topics :</b>"+this.resultData[l].topics+"</i></span>",f+="<span class='score-wrapper col-3 "+p+"'>",f+="<span class='indicator'></span>",f+="<span class='score' data-percentage='"+v+"'>"+h+"</span>",f+="<span class='scorePercent hide'>"+v+"</span>",f+="<span class='feedback-outer "+m+"'  id='feedback"+this.resultData[l].id+"' ><span class='resultfeedbackBtn' ></span><span class='feedback-icon'>Feedback</span></span>",f+="<span class='review-outer col-4' id='review"+this.resultData[l].id+"' ><span>Review</span></span></span>",f+="</li>"):(f+="<li class='progress-text clearfix'><span class='col-0'>"+(l+1)+") </span><span class='col-1 title'>"+this.resultData[l].title+"</span>",f+="<span class='topic col-2'>"+this.resultData[l].topics+"</span>",f+="<span class='score-wrapper col-3 "+p+"'>",f+="<span class='indicator'></span>",f+="<span class='score'>"+h+"</span>",f+="<span class='scorePercent hide'>"+v+"</span>",f+="<span class='feedback-outer "+m+"'  id='feedback"+this.resultData[l].id+"' ><span class='resultfeedbackBtn' ></span><span class='feedback-icon'>Feedback</span></span>&nbsp;</span>",f+="<span class='review-outer col-4' id='review"+this.resultData[l].id+"' ><span>Review</span></span>",f+="</li>")}f+="<div class='brClass'><br/><br/><br/></div></ul>",$("#detailedProgress",this.screen).html(f);var g=parseInt((o/u*100).toFixed(0)),y="";for(var l=0;l<i.length;l++)if(parseInt(i[l].gradeMinPercent)!=0||parseInt(i[l].gradeMaxPercent)!=0)if(g>=parseInt(i[l].gradeMinPercent)&&g<=parseInt(i[l].gradeMaxPercent)){y=i[l].gradeName;break}window.grade=y;if(a)$(".progressdiv",this.screen).addClass("awaiting"),$("#testScore",this.screen).find(".marks").html("Awaiting mark from teacher"),$("#testScore",this.screen).find(".percentage").hide();else{var b=0;u!=0&&(b=(o/u*100).toFixed(0)),b=parseInt(b);if(b<34)var w="incorrect";else if(b>=34&&b<=66)var w="partial";else var w="correct";$(".progressdiv",this.screen).addClass(w),$("#testScore",this.screen).find(".marks").html(o+"/"+u),$("#testScore",this.screen).find(".percentage").html(b+" %")}for(var l=0;l<e.length;l++)if(o>=parseInt(e[l].minMarks)&&o<=parseInt(e[l].maxMarks)){this.selectedFeedback=e[l];break}if(this.selectedFeedback&&this.selectedFeedback.feedbackText!=""){var E=$(".testFeedback",this.screen);$(E).html(this.selectedFeedback.feedbackText),t.isPhone()&&$(E).outerHeight()>20?(E.addClass("up-arrow"),E.addClass("open"),$(".toggle-testFeedback",this.screen).unbind().bind(r.CLICK,this.toggleTestFeedback)):$(".toggle-testFeedback",this.screen).hide()}else $(".testFeedbackWrapper",this.screen).hide();$(".feedback-outer",this.screen).unbind().bind(r.CLICK,this.handleFeedbackClick),$(".review-outer",this.screen).unbind().bind(r.CLICK,this.handleReviewClick),console.log("utils.isPhone(): "+t.isPhone());if(t.isPhone()){$("#header",this.screen).hide(),$("#colorCodeDesktop",this.screen).hide(),$(".qinfo",this.screen).prepend("<div id ='resourceButton' class='resourceBtn'>Next Steps</div><div id ='printButton'>Print</div>"),$(".qinfo",this.screen).addClass("phone"),$(".qinfo",this.screen).removeClass("dp");var S=$(".qinfo.phone",this.screen).get(0).outerHTML;$(".qinfo.phone",this.screen).remove(),$("#resultsContent",this.screen).prepend(S),this.resourceButton=$("#resourceButton"),this.printButton=$("#printButton"),$(".footerbar").hide(),$("#sort",this.screen).bind(r.CHANGE,this.sortResult),$("#sortByDiv",this.screen).show()}else $("#colorCodePhone",this.screen).hide(),$("#coverImageDiv",this.screen).attr("src",n.ASSETS_PATH+this.model.get("coverImage")),$(".qinfo",this.screen).removeClass("phone"),$(".qinfo",this.screen).addClass("dp"),this.resourceButton=$(".footerbar").find("#resourceBtn"),$(".result-grid-header",this.screen).find("span").bind(r.CLICK,this.sortResult),$("#sortByDiv",this.screen).hide(),this.printButton=$(".footerbar").find("#printBtn"),this.backToReportBtn=$(".footerbar").find("#backToReport");$(".progress-ui",this.screen).find(".topic").bind(r.CLICK,this.showTopicInfo),this.printButton.hide(),this.resourceButton.hide(),t.getParameterByName("reportView")=="true"&&(this.backToReportBtn.show(),this.backToReportBtn.unbind().bind(r.CLICK,this.openReportCard));if(this.selectedFeedback&&this.selectedFeedback.resources!=undefined)for(var l=0;l<this.selectedFeedback.resources.length;l++)if(this.selectedFeedback.resources[l].id!=""){this.resourceButton.show(),this.resourceButton.unbind().bind(r.CLICK,this.showResources);break}var x=this;t.isDesktopBrowser()?this.initScroll():_.delay(function(){t.hideAddressBar(),x.initScroll()},500)},sortResult:function(e){var n="";if(t.isPhone())n=e.target.value;else{var r=e.target;$(r).hasClass("sorting-icon")&&(r=r.parentNode);var n=r.id.split("sort-")[1];$(".result-grid-header>li>span",this.screen).removeClass("selected"),$(".sorting-icon",this.screen).removeClass("selected"),$(r).addClass("selected"),$(r).find(".sorting-icon").addClass("selected")}var i=$(".progress-ui >li",this.screen);switch(n){case"title":$(i).tsort("span.title");break;case"topic":$(i).tsort("span.topic");break;case"score":$(i).tsort("span.scorePercent",{order:"desc"})}var s=$(".brClass",this.screen).clone();$(".brClass",this.screen).remove(),$(".progress-ui",this.screen).append(s)},showTopicInfo:function(e){var n=$(e.target).html();if(n!=""){$(".infoOverlay").show(),$(".infoContent").html(n),$(".contentWrapper").addClass("topicContent"),$(".closeBtn2").bind(r.CLICK,function(){$(".contentWrapper").removeClass("topicContent"),$(".infoOverlay").hide(),t.infoScroll!=null&&t.infoScroll.destroy(),$(".closeBtn2").unbind()});var i=$(".infoWrapper").height();$(".contentWrapper").height(i),$(".contentWrapper").css("position","relative"),t.infoScroll!=null&&t.infoScroll.destroy(),t.infoScroll=new IScroll($(".contentWrapper").get(0),{desktopCompatibility:!0,hScroll:!0}),ths=this,_.delay(function(){t.infoScroll.refresh()},999)}},toggleTestFeedback:function(){if(this.iScroll&&this.iScroll.moved)return;$(".toggle-testFeedback",this.screen).hasClass("open")?($(".testFeedback",this.screen).removeClass("open"),$(".testFeedback",this.screen).removeClass("up-arrow"),$(".testFeedback",this.screen).addClass("closed"),$(".toggle-testFeedback",this.screen).removeClass("open").addClass("closed")):($(".testFeedback",this.screen).removeClass("closed"),$(".testFeedback",this.screen).addClass("open"),$(".testFeedback",this.screen).addClass("up-arrow"),$(".toggle-testFeedback",this.screen).removeClass("closed").addClass("open")),this.initScroll()},initScroll:function(){var e=$("#resultsScreen").get(0).clientHeight-$("#header").get(0).clientHeight-$(".qinfo").get(0).clientHeight-$(".progressdiv").get(0).clientHeight-$(".footerbar").get(0).clientHeight-$(".colorCode").get(0).clientHeight;$("#testFeedbackContainer").css("height",e+"px"),$("#testFeedbackContainer").css("overflow","hidden"),$("#testFeedbackContainer").css("position","relative"),this.iScroll!=null&&this.iScroll.destroy(),this.iScroll=new IScroll($("#testFeedbackContainer").get(0),{desktopCompatibility:!0,hScroll:!0}),ths=this,_.delay(function(){ths.iScroll.refresh()},999)},handleBackClick:function(e){Backbone.Events.trigger(r.QUIT_RESULT)},handleReviewClick:function(e){if(this.iScroll.moved)return;var t=e.target;t.className!="review-outer"&&(t=t.parentNode);var n=t.id.split("review")[1];this.iScroll!=null&&this.iScroll.destroy(),Backbone.Events.trigger(r.REVIEW_QUESTION,n.toString())},handleFeedbackClick:function(e){if(this.iScroll.moved)return;var n=e.target;n.className!="feedback-outer enabled"&&(n=n.parentNode);if(n.className=="feedback-outer disabled")return;var r=n.id.split("feedback")[1],i=_.findWhere(this.resultData,{id:r});t.showFeedback(i.feedback,i.responseData.score)},showResources:function(){var e=new s;e.set({title:this.model.get("title"),colorCode:this.model.get("colorCode"),coverImage:this.model.get("coverImage"),resources:this.selectedFeedback.resources});var r=new o({model:e,el:this.$el});r.render(),this.currentView=r;var i=this;t.screenTransition({curScreen:$("#"+n.RESULT_SCREEN),newScreen:$("#"+n.RESOURCE_SCREEN),direction:"forward",handler:function(){i.destroy()}})},destroy:function(){this.iScroll!=null&&this.iScroll.destroy(),$(".feedback-outer",this.screen).unbind(),$(".review-outer",this.screen).unbind(),this.resourceButton.unbind(),$(".header-right-btn",this.screen).unbind(),$(".header-left-btn",this.screen).unbind(),$("#"+n.RESULT_SCREEN,this.screen).unbind(),$("#"+n.RESULT_SCREEN,this.screen).remove(),this.screen.remove(),this.screen=null,this.off()},openReportCard:function(){var e=window.location.href.split("index.html")[0]+"reportCard.html";t.log("newUrl: "+e),window.open(e,"_self")}});return a}),define("core/AssessmentEngine",["utilities","AppConst","AppEvent","core/model/questionPlayerVO","core/model/resultScreenVO","core/view/questionPlayer","core/view/resultScreen"],function(e,t,n,r,i,s,o){var u={};return u.Constants={},u.Constants.Mode_Practise="Mode_Practise",u.Constants.Mode_Test="Mode_Test",u.Constants.Mode_Review="Mode_Review",u.Constants.Header_Title="Sample Assessment",u.Constants.Header_Quit="Quit",u.Constants.Header_Done="Report",u.Constants.Reset_Complete="Reset_Complete",u.Constants.Reset_Partial="Reset_Partial",u.Constants.Footer_Previous="Controls_Previous",u.Constants.Footer_Next="Controls_Next",u.Constants.Footer_Reset="Controls_Reset",u.Constants.Footer_Answer="Controls_Answer",u.Constants.Footer_Check="Controls_Check",u.Constants.ORIENTATION_TYPE="",u.AssessmentEngine=function(){var a,f,l,c={},h,p={ContainerEL:"#screens",QuestionIds:["0001"],Mode:"Practise",Partial_attempt:!0,partial_test_submission:!0,InstantFeedback:!1,TimerLimit:1,Reset:"Complete",Error_Prefix:"Imf_Error",LogPrefix:"Imf_Log",OrientationSupport:!1},d={dropDown:{attemptMethod:t.DROPDOWN_NATIVE},fibTapPlace:{maintainOptions:t.FIB_MAINTAIN_OPTIONS},fibTapPlaceTable:{maintainOptions:t.FIB_MAINTAIN_OPTIONS},matchSort:{attemptMethod:t.BOTH},reordering:{attemptMethod:t.REORDERING_TAP_PLACE},crossword:{autoPopulate:!0}},v={Header:{left:{visible:!0,text:u.Constants.Header_Quit.toString()},right:{visible:!0,text:u.Constants.Header_Done.toString()},title:{visible:!0,text:u.Constants.Header_Title.toString()},colorCode:"",coverImage:"",visible:!0},Controls:[u.Constants.Footer_Previous,u.Constants.Footer_Reset,u.Constants.Footer_Answer,u.Constants.Footer_Check,u.Constants.Footer_Next],Timer:!1,InstructionsImage:"instructions.gif"},m=function(e,t,n){n()},g=function(t){e.log(p.Error_Prefix,":",t)};window.onerror=function(t,n,r){return e.log(p.Error_Prefix,":",t," in ",n,", line ",r),!0};var y=function(e,t,r){e&&E(e,function(){}),t&&S(t,function(){}),Backbone.Events.trigger(n.ASSESSMENT_INITIATED)};setConfiguration=function(e,t){e&&E(e,function(){}),t&&S(t,function(){})};var b=function(n,i){l=this,l.VO=new r({colorCode:v.Header.colorCode}),l.view=new s({model:l.VO,el:p.ContainerEL}),l.view.render(p,v,d,i,n);var o="",u;"",$("#"+t.WELCOME_SCREEN).length!=0?o=t.WELCOME_SCREEN:(o=t.RESULT_SCREEN,u="reverse"),e.screenTransition({curScreen:$("#"+o),newScreen:$("#"+t.QUESTION_PLAYER),persistent:!1,direction:u,handler:w})},w=function(e){var n=e.selector.split("#")[1];if(n==t.WELCOME_SCREEN)Backbone.Events.trigger("destroyWelcomeScreen");else if(n==t.RESULT_SCREEN){var r=$("#"+t.RESULT_SCREEN);r.find(".feedback-outer").unbind(),r.find(".review-outer").unbind(),r.unbind(),r.remove()}else n==t.QUESTION_PLAYER&&this.view.destroy()},E=function(e,t){var n=this;m(e,"config",function(){p=_.defaults(e,p),t&&t()})},S=function(e,t){v.Header.title.text=e.Header.title.text,v.Header.colorCode=e.Header.colorCode,v.Header.coverImage=e.Header.coverImage,t&&t()},x=function(e,t){var n=e.type;m(e,n,function(){l.view.initializeActivity(e,t)})},T=function(e){e!=undefined?m(e,"question",function(){l.view.evaluateQuestion(e)}):l.view.evaluateQuestion()},N=function(){l.view.handleShowAnswer()},C=function(n){var r=this;r.VO=new i,r.VO.set({resultData:n.resultData,testFeedbackData:n.testFeedbackData,title:v.Header.title.text,colorCode:v.Header.colorCode,testMarkScheme:n.testMarkScheme,coverImage:v.Header.coverImage}),r.view=new o({model:r.VO,el:p.ContainerEL}),r.view.render(),this.currentView=r.view,n.direction==undefined&&(n.direction="forward"),e.screenTransition({curScreen:$("#"+n.curScreen),newScreen:$("#"+t.RESULT_SCREEN),direction:n.direction,persistent:!1,handler:n.handler})},k=function(){l.view.resetBtnClick()},L=function(e){l.view.showPreviousQuestion(e)},A=function(){window.orientation==90||window.orientation==-90?u.Constants.ORIENTATION_TYPE=t.LANDSCAPE:u.Constants.ORIENTATION_TYPE=t.PORTRAIT,window.addEventListener("orientationchange",function(){window.orientation==90||window.orientation==-90?u.Constants.ORIENTATION_TYPE=t.LANDSCAPE:u.Constants.ORIENTATION_TYPE=t.PORTRAIT,p.OrientationSupport?l.view.orientationchange(u.Constants.ORIENTATION_TYPE):u.Constants.ORIENTATION_TYPE==t.LANDSCAPE?($(".orientation-popup").show(),$(".overlay").show()):($(".orientation-popup").hide(),$(".overlay").hide())},!1)},O=function(){l&&l.view.initScroll()};return{init:function(e,t){y(e,t)},setConfiguration:function(e,t){setConfiguration(e,t)},onWindowResize:function(){O()},start:function(e,t,n){b(e,t)},setQuestionData:function(e,t){x(e,t)},evaluateQuestion:function(e){T(e)},nextQuestion:function(e){T(e)},previousQuestion:function(e){L(e)},resetQuestion:function(e){k(e),Backbone.Events.trigger("onQuestionReset",{resetQuestionID:"PRE_q321"})},hint:function(){Backbone.Events.trigger("onHintShowed",{hintQuestionID:"PRE_q321"})},showAnswer:function(){N()},showResult:function(e){C(e)},quit:function(){T(),Backbone.Events.trigger("onResponseSaved",{questionId:"PRE_q111",answer:[]})},handleAnimationComplete:function(e){this.destroy(),this.currentView.applyCSS()},setConfig:function(e){E(e)},setDisplay:function(e){},disableFooter:function(e){Backbone.Events.trigger("onControlsDisabled",{success:!0})},enableFooter:function(e){Backbone.Events.trigger("onControlsEnabled",{success:!0})},destroy:function(){$("#questionPlayer").unbind(),$("#questionPlayer").remove(),$("#resultsScreen").unbind(),$("#resultsScreen").remove()},bind:function(e,t){Backbone.Events.bind(e,t)},unbind:function(e,t){Backbone.Events.unbind(e,t)}}},new u.AssessmentEngine}),define("core/model/welcomeScreenVO",[],function(){var e=Backbone.Model.extend({defaults:function(){return{id:"",title:"",tierStructure:"",testDataDescription:"",logoImage:"",displayBanner:"",coverImage:"",colorCode:""}}});return e}),define("core/view/welcomeScreenView",["language","utilities","AppConst","AppEvent","external/iscroll5","APIConsumer"],function(e,t,n,r,i,s){var o=Backbone.View.extend({templateContent:'<div id="splashScreen"><header >							<div class="center-content" >                               <!--span id="logo"><img src="<%=logoImage%>">                              	</span-->                                <div id="banner">                                    <!--img src="'+n.ASSETS_PATH+'<%=displayBanner%>"-->                                    <div id="testHeader" class="test-header">                                        <h2><%=title%></h2>                                    </div>                                    <span class="version"> Version : '+n.VERSION+' </span>									               </div>                                </div>                            </header>                             <div class="colorCode" id="colorCodePhone" style="background-color: <%=colorCode%>"></div>                            <div id="containerCover">                              <div id="container">                              <div class="colorCode" id="colorCodeDesktop" style="background-color: <%=colorCode%>"></div>							   <div class="coverImageContainer" >                                    <img id="coverImageDiv" src="'+n.ASSETS_PATH+'<%=coverImage%>"/>									<!--img id="coverImageDiv" /-->									 </div>									 <div id="testDataWrapper">							    <div id="testData">								    <!--span id="testHeader">                                        <h2><%=title%></h2>                                    </span-->                                                                        <span id="tierStructure">                                      <% if(typeof tierStructure == "object"){ %>                                      <% _.each(tierStructure,function(tier,i){ %>                                        	<%=tier%>                                         	<% if(i<tierStructure.length -1){ %>                                        		:                                        	<%}%>                                       <% })}else{ %>                                       	<%=tierStructure%>                                    <%  }%>                                    </span>									 <span id="testName">                                        <h2><%=testName%></h2>                                    </span>                                    <span id="testDataDescription">                                    <% if(typeof testDescription == "string"){ %>                                        <%=testDescription%>                                      <%}%>                                      </span>                                   </div>							   </div>                                </div>                           </div>                                                        <footer>							<div class="center-content" >                                    <div id="reviewBtnsContainer">                                    <span id="reviewTest" class="footer_ico" style="visibility:<%=window.revBtn%>;background-color:<%=colorCode%>;">Review Test</span>                                    <span id="startTest" class="footer_ico"  style="background-color:<%=colorCode%>;">Start Test</span>                  </div>                          </div> </footer></div>',iScroll:null,initialize:function(){t.log("in welcome screen view init"),_.extend(this,Backbone.Events),this.listenTo(this.model,"change",this.render),_.bindAll(this,"handleStartTest")},render:function(){t.log("in welcome screen view render",this.model);var e=_.template(this.templateContent);this.el.html(e(this.model.toJSON()));var i=this.model.get("displayBanner"),s=this.model.get("coverImage");$(".coverImageContainer").find("img").attr("src",n.ASSETS_PATH+s),t.isPhone()?$("#colorCodeDesktop").hide():$("#colorCodePhone").hide(),$("#startTest").unbind().bind(r.CLICK,this.handleStartTest),$("#reviewTest").unbind().bind(r.CLICK,this.handleReviewTest);var o=this;t.isDesktopBrowser()?this.initScroll():_.delay(function(){t.hideAddressBar(),o.initScroll()},500)},handleStartTest:function(){this.trigger(r.START_TEST,"test")},handleReviewTest:function(){$("#splashScreen").remove().unbind(),window.App.gotoReview()},initScroll:function(){if(t.isPhone()){var e=$("#container").height()-$(".coverImageContainer").outerHeight();$("#testDataWrapper").height(e)}else{var e=$("#container").height()-$(".colorCodeDesktop").height(),n=isNaN(parseInt($("#testData").css("padding")))?0:parseInt($("#testData").css("padding"));$("#testDataWrapper").height(e-n)}this.iScroll!=null&&this.iScroll.destroy(),this.iScroll=new IScroll($("#testDataWrapper").get(0),{desktopCompatibility:!0,hScroll:!0}),ths=this,_.delay(function(){ths.iScroll.refresh()},999)},destroy:function(){$("#splashScreen").remove(),$("#splashScreen").unbind(),this.iScroll.destroy()}});return o});var CryptoJS=CryptoJS||function(e,t){var n={},r=n.lib={},i=function(){},s=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=s.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;e=e.sigBytes,this.clamp();if(r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),u=n.enc={},a=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((i&15).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new o.init(n,t/2)}},f=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(e.charCodeAt(r)&255)<<24-8*(r%4);return new o.init(n,t)}},l=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(f.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return f.parse(unescape(encodeURIComponent(e)))}},c=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,s=this.blockSize,u=i/(4*s),u=t?e.ceil(u):e.max((u|0)-this._minBufferSize,0);t=u*s,i=e.min(4*t,i);if(t){for(var a=0;a<t;a+=s)this._doProcessBlock(r,a);a=r.splice(0,t),n.sigBytes-=i}return new o.init(a,i)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=c.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return(new e.init(n)).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return(new h.HMAC.init(e,n)).finalize(t)}}});var h=n.algo={};return n}(Math);(function(){var e=CryptoJS,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var i=0;i<n;i+=3)for(var s=(t[i>>>2]>>>24-8*(i%4)&255)<<16|(t[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|t[i+2>>>2]>>>24-8*((i+2)%4)&255,o=0;4>o&&i+.75*o<n;o++)e.push(r.charAt(s>>>6*(3-o)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map,i=r.charAt(64);i&&(i=e.indexOf(i),-1!=i&&(n=i));for(var i=[],s=0,o=0;o<n;o++)if(o%4){var u=r.indexOf(e.charAt(o-1))<<2*(o%4),a=r.indexOf(e.charAt(o))>>>6-2*(o%4);i[s>>>2]|=(u|a)<<24-8*(s%4),s++}return t.create(i,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})(),function(e){function t(e,t,n,r,i,s,o){return e=e+(t&n|~t&r)+i+o,(e<<s|e>>>32-s)+t}function n(e,t,n,r,i,s,o){return e=e+(t&r|n&~r)+i+o,(e<<s|e>>>32-s)+t}function r(e,t,n,r,i,s,o){return e=e+(t^n^r)+i+o,(e<<s|e>>>32-s)+t}function i(e,t,n,r,i,s,o){return e=e+(n^(t|~r))+i+o,(e<<s|e>>>32-s)+t}for(var s=CryptoJS,o=s.lib,u=o.WordArray,a=o.Hasher,o=s.algo,f=[],l=0;64>l;l++)f[l]=4294967296*e.abs(e.sin(l+1))|0;o=o.MD5=a.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,s){for(var o=0;16>o;o++){var u=s+o,a=e[u];e[u]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360}var o=this._hash.words,u=e[s+0],a=e[s+1],l=e[s+2],c=e[s+3],h=e[s+4],v=e[s+5],m=e[s+6],g=e[s+7],y=e[s+8],w=e[s+9],E=e[s+10],S=e[s+11],x=e[s+12],T=e[s+13],N=e[s+14],C=e[s+15],k=o[0],L=o[1],A=o[2],O=o[3],k=t(k,L,A,O,u,7,f[0]),O=t(O,k,L,A,a,12,f[1]),A=t(A,O,k,L,l,17,f[2]),L=t(L,A,O,k,c,22,f[3]),k=t(k,L,A,O,h,7,f[4]),O=t(O,k,L,A,v,12,f[5]),A=t(A,O,k,L,m,17,f[6]),L=t(L,A,O,k,g,22,f[7]),k=t(k,L,A,O,y,7,f[8]),O=t(O,k,L,A,w,12,f[9]),A=t(A,O,k,L,E,17,f[10]),L=t(L,A,O,k,S,22,f[11]),k=t(k,L,A,O,x,7,f[12]),O=t(O,k,L,A,T,12,f[13]),A=t(A,O,k,L,N,17,f[14]),L=t(L,A,O,k,C,22,f[15]),k=n(k,L,A,O,a,5,f[16]),O=n(O,k,L,A,m,9,f[17]),A=n(A,O,k,L,S,14,f[18]),L=n(L,A,O,k,u,20,f[19]),k=n(k,L,A,O,v,5,f[20]),O=n(O,k,L,A,E,9,f[21]),A=n(A,O,k,L,C,14,f[22]),L=n(L,A,O,k,h,20,f[23]),k=n(k,L,A,O,w,5,f[24]),O=n(O,k,L,A,N,9,f[25]),A=n(A,O,k,L,c,14,f[26]),L=n(L,A,O,k,y,20,f[27]),k=n(k,L,A,O,T,5,f[28]),O=n(O,k,L,A,l,9,f[29]),A=n(A,O,k,L,g,14,f[30]),L=n(L,A,O,k,x,20,f[31]),k=r(k,L,A,O,v,4,f[32]),O=r(O,k,L,A,y,11,f[33]),A=r(A,O,k,L,S,16,f[34]),L=r(L,A,O,k,N,23,f[35]),k=r(k,L,A,O,a,4,f[36]),O=r(O,k,L,A,h,11,f[37]),A=r(A,O,k,L,g,16,f[38]),L=r(L,A,O,k,E,23,f[39]),k=r(k,L,A,O,T,4,f[40]),O=r(O,k,L,A,u,11,f[41]),A=r(A,O,k,L,c,16,f[42]),L=r(L,A,O,k,m,23,f[43]),k=r(k,L,A,O,w,4,f[44]),O=r(O,k,L,A,x,11,f[45]),A=r(A,O,k,L,C,16,f[46]),L=r(L,A,O,k,l,23,f[47]),k=i(k,L,A,O,u,6,f[48]),O=i(O,k,L,A,g,10,f[49]),A=i(A,O,k,L,N,15,f[50]),L=i(L,A,O,k,v,21,f[51]),k=i(k,L,A,O,x,6,f[52]),O=i(O,k,L,A,c,10,f[53]),A=i(A,O,k,L,E,15,f[54]),L=i(L,A,O,k,a,21,f[55]),k=i(k,L,A,O,y,6,f[56]),O=i(O,k,L,A,C,10,f[57]),A=i(A,O,k,L,m,15,f[58]),L=i(L,A,O,k,T,21,f[59]),k=i(k,L,A,O,h,6,f[60]),O=i(O,k,L,A,S,10,f[61]),A=i(A,O,k,L,l,15,f[62]),L=i(L,A,O,k,w,21,f[63]);o[0]=o[0]+k|0,o[1]=o[1]+L|0,o[2]=o[2]+A|0,o[3]=o[3]+O|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var s=e.floor(r/4294967296);n[(i+64>>>9<<4)+15]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360,n[(i+64>>>9<<4)+14]=(r<<8|r>>>24)&16711935|(r<<24|r>>>8)&4278255360,t.sigBytes=4*(n.length+1),this._process(),t=this._hash,n=t.words;for(r=0;4>r;r++)i=n[r],n[r]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360;return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),s.MD5=a._createHelper(o),s.HmacMD5=a._createHmacHelper(o)}(Math),function(){var e=CryptoJS,t=e.lib,n=t.Base,r=t.WordArray,t=e.algo,i=t.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=n.hasher.create(),s=r.create(),o=s.words,u=n.keySize,n=n.iterations;o.length<u;){a&&i.update(a);var a=i.update(e).finalize(t);i.reset();for(var f=1;f<n;f++)a=i.finalize(a),i.reset();s.concat(a)}return s.sigBytes=4*u,s}});e.EvpKDF=function(e,t,n){return i.create(n).compute(e,t)}}(),CryptoJS.lib.Cipher||function(e){var t=CryptoJS,n=t.lib,r=n.Base,i=n.WordArray,s=n.BufferedBlockAlgorithm,o=t.enc.Base64,u=t.algo.EvpKDF,a=n.Cipher=s.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?d:p).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?d:p).decrypt(e,t,n,r)}}}});n.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var f=t.mode={},l=function(t,n,r){var i=this._iv;i?this._iv=e:i=this._prevBlock;for(var s=0;s<r;s++)t[n+s]^=i[s]},c=(n.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();c.Encryptor=c.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;l.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),c.Decryptor=c.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=e.slice(t,t+r);n.decryptBlock(e,t),l.call(this,e,t,r),this._prevBlock=i}}),f=f.CBC=c,c=(t.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,n=n-e.sigBytes%n,r=n<<24|n<<16|n<<8|n,s=[],o=0;o<n;o+=4)s.push(r);n=i.create(s,n),e.concat(n)},unpad:function(e){e.sigBytes-=e.words[e.sigBytes-1>>>2]&255}},n.BlockCipher=a.extend({cfg:a.cfg.extend({mode:f,padding:c}),reset:function(){a.reset.call(this);var e=this.cfg,t=e.iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var h=n.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return e=e.salt,(e?i.create([1398893684,1701076831]).concat(e).concat(t):t).toString(o)},parse:function(e){e=o.parse(e);var t=e.words;if(1398893684==t[0]&&1701076831==t[1]){var n=i.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return h.create({ciphertext:e,salt:n})}},p=n.SerializableCipher=r.extend({cfg:r.extend({format:f}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r);return t=i.finalize(t),i=i.cfg,h.create({ciphertext:t,key:n,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),t=(t.kdf={}).OpenSSL={execute:function(e,t,n,r){return r||(r=i.random(8)),e=u.create({keySize:t+n}).compute(e,r),n=i.create(e.words.slice(t),4*n),e.sigBytes=4*t,h.create({key:e,iv:n,salt:r})}},d=n.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:t}),encrypt:function(e,t,n,r){return r=this.cfg.extend(r),n=r.kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,e=p.encrypt.call(this,e,t,n.key,r),e.mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,p.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=CryptoJS,t=e.lib.BlockCipher,n=e.algo,r=[],i=[],s=[],o=[],u=[],a=[],f=[],l=[],c=[],h=[],p=[],d=0;256>d;d++)p[d]=128>d?d<<1:d<<1^283;for(var v=0,m=0,d=0;256>d;d++){var g=m^m<<1^m<<2^m<<3^m<<4,g=g>>>8^g&255^99;r[v]=g,i[g]=v;var y=p[v],b=p[y],w=p[b],E=257*p[g]^16843008*g;s[v]=E<<24|E>>>8,o[v]=E<<16|E>>>16,u[v]=E<<8|E>>>24,a[v]=E,E=16843009*w^65537*b^257*y^16843008*v,f[g]=E<<24|E>>>8,l[g]=E<<16|E>>>16,c[g]=E<<8|E>>>24,h[g]=E,v?(v=y^p[p[p[w^y]]],m^=p[p[m]]):v=m=1}var S=[0,1,2,4,8,16,32,64,128,27,54],n=n.AES=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes/4,e=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],s=0;s<e;s++)if(s<n)i[s]=t[s];else{var o=i[s-1];s%n?6<n&&4==s%n&&(o=r[o>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[o&255]):(o=o<<8|o>>>24,o=r[o>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[o&255],o^=S[s/n|0]<<24),i[s]=i[s-n]^o}t=this._invKeySchedule=[];for(n=0;n<e;n++)s=e-n,o=n%4?i[s]:i[s-4],t[n]=4>n||4>=s?o:f[r[o>>>24]]^l[r[o>>>16&255]]^c[r[o>>>8&255]]^h[r[o&255]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,o,u,a,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,f,l,c,h,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,s,o,u){for(var a=this._nRounds,f=e[t]^n[0],l=e[t+1]^n[1],c=e[t+2]^n[2],h=e[t+3]^n[3],p=4,d=1;d<a;d++)var v=r[f>>>24]^i[l>>>16&255]^s[c>>>8&255]^o[h&255]^n[p++],m=r[l>>>24]^i[c>>>16&255]^s[h>>>8&255]^o[f&255]^n[p++],g=r[c>>>24]^i[h>>>16&255]^s[f>>>8&255]^o[l&255]^n[p++],h=r[h>>>24]^i[f>>>16&255]^s[l>>>8&255]^o[c&255]^n[p++],f=v,l=m,c=g;v=(u[f>>>24]<<24|u[l>>>16&255]<<16|u[c>>>8&255]<<8|u[h&255])^n[p++],m=(u[l>>>24]<<24|u[c>>>16&255]<<16|u[h>>>8&255]<<8|u[f&255])^n[p++],g=(u[c>>>24]<<24|u[h>>>16&255]<<16|u[f>>>8&255]<<8|u[l&255])^n[p++],h=(u[h>>>24]<<24|u[f>>>16&255]<<16|u[l>>>8&255]<<8|u[c&255])^n[p++],e[t]=v,e[t+1]=m,e[t+2]=g,e[t+3]=h},keySize:8});e.AES=t._createHelper(n)}(),define("cryptojs",function(){}),define("imfinity/cryptoPlugin",["backbone","cryptojs"],function(e,t){var n=e.Model.extend({defaults:{},encrypt:function(e,t){var n=CryptoJS.AES.encrypt(e,t),r=this.stringify(n);return r},decrypt:function(e,t){var n=this.parse(e),r=CryptoJS.AES.decrypt(n,t),i=r.toString(CryptoJS.enc.Utf8);return i},stringify:function(e){var t={ct:e.ciphertext.toString(CryptoJS.enc.Base64)};return e.iv&&(t.iv=e.iv.toString()),e.salt&&(t.s=e.salt.toString()),JSON.stringify(t)},parse:function(e){var t=JSON.parse(e),n=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(t.ct)});return t.iv&&(n.iv=CryptoJS.enc.Hex.parse(t.iv)),t.s&&(n.salt=CryptoJS.enc.Hex.parse(t.s)),n}});return new n}),define("core/model/localStorageDataVO",["imfinity/cryptoPlugin"],function(e){var t=Backbone.Model.extend({defaults:{user_id:"",test_id:"",test_name:"",test_metadata:"",attempts_taken:0,date:"",sync_status:!1,max_score:"",grade:"",isbn:"",data_url:"",base_url:"",att_id:"1"},save:function(t,n){var r=e.encrypt(this.get("user_id"),"123");this.set({user_id:r});var r=e.encrypt(this.get("test_id"),"123");this.set({test_id:r});var r=e.encrypt(this.get("test_name"),"123");this.set({test_name:r});var r=e.encrypt(JSON.stringify(this.get("test_metadata")),"123");this.set({test_metadata:r});var r=e.encrypt(String(this.get("attempts_taken")),"123");this.set({attempts_taken:r});var r=e.encrypt(this.get("date"),"123");this.set({date:r});var r=e.encrypt(JSON.stringify(this.get("sync_status")),"123");this.set({sync_status:r});var r=e.encrypt(String(this.get("max_score")),"123");this.set({max_score:r}),Backbone.Model.prototype.save.call(this,t,n)},parse:function(t){return t.user_id=e.decrypt(t.user_id,"123"),t.test_id=e.decrypt(t.test_id,"123"),t.test_name=e.decrypt(t.test_name,"123"),t.test_metadata=JSON.parse(e.decrypt(t.test_metadata,"123")),t.attempts_taken=parseInt(e.decrypt(t.attempts_taken,"123")),t.date=e.decrypt(t.date,"123"),t.sync_status=JSON.parse(e.decrypt(t.sync_status,"123")),t.max_score=e.decrypt(t.max_score,"123"),t}});return t}),function(e,t){typeof exports=="object"&&typeof require=="function"?module.exports=t(require("backbone")):typeof define=="function"&&define.amd?define("backboneLocalstorage",["backbone"],function(n){return t(n||e.Backbone)}):t(Backbone)}(this,function(e){function t(){return((1+Math.random())*65536|0).toString(16).substring(1)}function n(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function r(e){return e===Object(e)}function i(e,t){var n=e.length;while(n--)if(e[n]===t)return!0;return!1}function s(e,t){for(var n in t)e[n]=t[n];return e}function o(e,t){if(e==null)return void 0;var n=e[t];return typeof n=="function"?e[t]():n}return e.LocalStorage=window.Store=function(e,t){if(!this.localStorage)throw"Backbone.localStorage: Environment does not support localStorage.";this.name=e,this.serializer=t||{serialize:function(e){return r(e)?JSON.stringify(e):e},deserialize:function(e){return e&&JSON.parse(e)}};var n=this.localStorage().getItem(this.name);this.records=n&&n.split(",")||[]},s(e.LocalStorage.prototype,{save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(e){return!e.id&&e.id!==0&&(e.id=n(),e.set(e.idAttribute,e.id)),this.localStorage().setItem(this._itemName(e.id),this.serializer.serialize(e)),this.records.push(e.id.toString()),this.save(),this.find(e)},update:function(e){this.localStorage().setItem(this._itemName(e.id),this.serializer.serialize(e));var t=e.id.toString();return i(this.records,t)||(this.records.push(t),this.save()),this.find(e)},find:function(e){return this.serializer.deserialize(this.localStorage().getItem(this._itemName(e.id)))},findAll:function(){var e=[];for(var t=0,n,r;t<this.records.length;t++)n=this.records[t],r=this.serializer.deserialize(this.localStorage().getItem(this._itemName(n))),r!=null&&e.push(r);return e},destroy:function(e){this.localStorage().removeItem(this._itemName(e.id));var t=e.id.toString();for(var n=0,r;n<this.records.length;n++)this.records[n]===t&&this.records.splice(n,1);return this.save(),e},localStorage:function(){return localStorage},_clear:function(){var e=this.localStorage(),t=new RegExp("^"+this.name+"-");e.removeItem(this.name);for(var n in e)t.test(n)&&e.removeItem(n);this.records.length=0},_storageSize:function(){return this.localStorage().length},_itemName:function(e){return this.name+"-"+e}}),e.LocalStorage.sync=window.Store.sync=e.localSync=function(t,n,r){var i=o(n,"localStorage")||o(n.collection,"localStorage"),s,u,a=e.$?e.$.Deferred&&e.$.Deferred():e.Deferred&&e.Deferred();try{switch(t){case"read":s=n.id!=undefined?i.find(n):i.findAll();break;case"create":s=i.create(n);break;case"update":s=i.update(n);break;case"delete":s=i.destroy(n)}}catch(f){f.code===22&&i._storageSize()===0?u="Private browsing is unsupported":u=f.message}return s?(r&&r.success&&(e.VERSION==="0.9.10"?r.success(n,s,r):r.success(s)),a&&a.resolve(s)):(u=u?u:"Record Not Found",r&&r.error&&(e.VERSION==="0.9.10"?r.error(n,u,r):r.error(u)),a&&a.reject(u)),r&&r.complete&&r.complete(s),a&&a.promise()},e.ajaxSync=e.sync,e.getSyncMethod=function(t,n){var r=n&&n.ajaxSync;return!r&&(o(t,"localStorage")||o(t.collection,"localStorage"))?e.localSync:e.ajaxSync},e.sync=function(t,n,r){return e.getSyncMethod(n,r).apply(this,[t,n,r])},e.LocalStorage}),define("core/collections/testRecordCollection",["core/model/localStorageDataVO","backboneLocalstorage"],function(e,t){var n=Backbone.Collection.extend({initialize:function(){this.listenTo(event_bus,"doSorting",this.defineComparator)},model:e,localStorage:new t("Hodder_DB"),defineComparator:function(e,t){show=e.target;switch(t){case"testName":this.comparator=function(e){return e.get("test_id")};break;case"grade":this.comparator=function(e){return e.get("grade")};break;case"Score":this.comparator=function(e){return parseInt(e.get("test_metadata").ReceivedMarks)};break;case"lastTaken":this.comparator=function(e){var t=e.get("date"),n=t.split(" ");n[0]=n[0].substr(0,n[0].length-2);var r=new Date(n[1]+" "+n[0]+" "+n[2]),i=r.valueOf();return i};break;case"-testName":this.comparator=function(e){var t=e.get("test_id");return t=t.toLowerCase(),t=t.split(""),t=_.map(t,function(e){return String.fromCharCode(-e.charCodeAt(0))}),t};break;case"-grade":this.comparator=function(e){var t=e.get("grade");return t=t.toLowerCase(),t=t.split(""),t=_.map(t,function(e){return String.fromCharCode(-e.charCodeAt(0))}),t};break;case"-Score":this.comparator=function(e){return-parseInt(e.get("test_metadata").ReceivedMarks)};break;case"-lastTaken":this.comparator=function(e){var t=e.get("date"),n=t.split(" ");n[0]=n[0].substr(0,n[0].length-2);var r=new Date(n[1]+" "+n[0]+" "+n[2]),i=r.valueOf();return-i}}}});return n}),function(e){(jQuery.browser=jQuery.browser||{}).mobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera),define("external/detectmobilebrowser",function(){});var webViewInterface;define("core/TPComm",["AppConst","utilities","external/detectmobilebrowser","backbone"],function(e,t,n,r){document.addEventListener("DOMContentLoaded",function(){console.log("TP -- DOMContentLoaded",document.TPCommunicator)}),webViewInterface==null&&(webViewInterface={performAction:function(e,t,n,r){},getData:function(e,t,n,r){},log:function(e){console.log(e)}});var i=r.Model.extend({initialize:function(){this.jsCallStack=[],this.jsEventInterval=!1;var e={Android:function(){return navigator.userAgent.match(/Android/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},any:function(){return e.Android()||e.iOS()}};this.isMobile=e.any()},setInitializationProperties:function(e){this.initialData=e},log:function(e){webViewInterface.log(e)},getData:function(e,t,n,r){var i=this.fetchData(e,t,n,r);if(i){var s=null;try{s=JSON.parse(i)}catch(o){s=i}return s}},performAction:function(e,t,n,r){var i=this;setTimeout(function(){var s="";t!=null&&(s=JSON.stringify(t)),n&&i.addCallback(e,n,r),i.isMobile?webViewInterface.performAction(e,s):i.performActionWeb(e,t,n,r)},0)},fetchData:function(e,t,n,r){var i="";return t!=null&&(i=JSON.stringify(t)),n&&this.addCallback(e,n,r),this.isMobile?webViewInterface.getData(e,i):this.fetchWebData(e,t)},handleResponse:function(e,n){if(n!=""){var r="";try{r=JSON.parse(n)}catch(i){console.log("messageToSend");if(e==InterfaceConst.ACTIONTYPE_XHR){n=t.decodeBase64(n),console.log("messageToSend"),r=(new window.DOMParser).parseFromString(n,"text/xml"),console.log("messageToSend");var s=new XMLSerializer,o;r.documentElement.childNodes.length==1?o=r.documentElement.childNodes[0]:o=r.documentElement,r=s.serializeToString(o)}else r=n}r=r.replace(/\n/g,"").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"),this.trigger("onNativeResponse"+e,r)}else this.trigger("onNativeResponse"+e);this.off("onNativeResponse"+e)},fetchWebData:function(e,t){if(e==InterfaceConst.DATATYPE_GET_INITIAL_DATA)return this.fetchInitialData();if(e==InterfaceConst.DATATYPE_NETWORK_STATUS){var n=navigator.onLine;return n}if(e==InterfaceConst.DATATYPE_ENVIRONMENT)return this.initialData&&this.initialData.enviroment?this.initialData.enviroment:"None"},performActionWeb:function(e,t,n,r){return this.initialData},fetchInitialData:function(){return this.initialData},addCallback:function(e,t,n){t!=null&&this.on("onNativeResponse"+e,t,n)},addObserver:function(e,t,n){this.on(e,t,n)},removeObserver:function(e,t){this.off(evenName,t)},notifyJSObservers:function(e,t){var n=this;setTimeout(function(){t!=""?n.trigger(e,t):n.trigger(e)},0)},processJSEvent:function(){if(this.jsEventInterval==0){var e=this;this.jsEventInterval=!0,setTimeout(function(){e.executeJSStackEvent()},0)}},executeJSStackEvent:function(){var e=this.jsCallStack.splice(0,1)[0];if(e.data!="")this.trigger(e.eventName,e.data);else try{this.trigger(e.eventName)}catch(t){}this.jsEventInterval=!1,this.jsCallStack.length>0&&this.processJSEvent()}}),s=new i;document.TPCommunicator=s;if(!s.isMobile){if(navigator.userAgent.toLowerCase().indexOf("trident")>-1||navigator.userAgent.toLowerCase().indexOf("msie 9")>-1){var o=document.createEvent("CustomEvent");o.initCustomEvent("TPReady",!1,!1,{}),t.log("event dispatch for IE")}else{var o=new Event("TPReady");t.log("event dispatch for other browsers")}window.dispatchEvent(o)}return console.log("TPCommunicator -- initilized"),handleResponseFromNative=function(e,t){s.handleResponse(e,t)},notifyJSObservers=function(e,t){s.notifyJSObservers(e,t)},InterfaceConst={DATATYPE_GET_INITIAL_DATA:100,DATATYPE_NETWORK_STATUS:101,DATATYPE_ENVIRONMENT:102,ACTIONTYPE_LAUNCH_ASSESSMENT:1e3,ACTIONTYPE_CLOSE_WEBVIEW:1001,ACTIONTYPE_LAUNCH_REPORT:1002,ACTIONTYPE_XHR:1004},document.TPInterfaceConst=InterfaceConst,s}),define("core/QTIProcessor",["utilities","AppConst","core/model/localStorageDataVO","core/collections/testRecordCollection","core/TPComm"],function(e,t,n,r,i){function f(n){if(t.appEnvironment=="ReaderMobile"&&t.module=="Renderer"){e.log("in reader mobile getXml");var r=this,s={url:n.aeWebServicePath+t.ws.getTest,data:{TestID:n.testid,MODE:n.mode,USERID:n.userid,SAMSID:n.samsid,UserToken:n.usertoken},contentType:"xml"};i.performAction(document.TPInterfaceConst.ACTIONTYPE_XHR,s,function(t){e.log("Response from TPComm getTestDetailsByID WS: ",t);var n=p(t);$(r).trigger("onSerialize",n),e.log("------- in get xml Serializer via TPComm getTestDetailsByID WS")})}else if(t.module!="Report"){var r=this;$.ajax({url:n.aeWebServicePath+t.ws.getTest,data:{TestID:n.testid,MODE:n.mode,USERID:n.userid,SAMSID:n.samsid,UserToken:n.usertoken},success:function(t){e.log("response from getXml:: ",t);var n=p(t);$(r).trigger("onSerialize",n),e.log("------- in get xml Serializer")},error:function(e){},dataType:"xml"})}}function l(t){var n=h(t);e.log(t),$(this).trigger("onSerialize",n),e.log("------- in offlineXMLSerializer")}function c(t){var n=this;$.get(t,function(t){var r=h(t);$(n).trigger("onSerialize",r),e.log("------- in xmlSerializer")})}function h(t){if(typeof t=="string")var n=s.xml_str2json(t);else if(typeof t=="object"){t=unescape(t),e.log(t);var n=s.xml2json(t)}return e.log("----- jsonObj ",n),v(n)}function p(t){e.log(t);var n=t;if(typeof t=="object")var n=s.xml2json(t).string.__text;if(typeof n=="object"){var r="";for(var i=0;i<n.length;i++)r+=n[i];n=r}if(n.indexOf("root")<0){alert(n);return}var o=s.xml_str2json(n);return v(o)}function d(t){var n=s.json2xml(t);e.log("----- xmlObj ",n)}function v(n){e.log(n);var i=[],s=[],o=m(n.root.TestInformations.TestInformation);t.testid=o.id,collection1=new r,collection1.fetch({parse:!0});var u=collection1.where({user_id:t.userid,test_id:t.testid,isbn:t.isbn});try{u.length>0&&(window.revBtn="visible",e.log("Review available")),n.root.TestTakenDataCollection.TestTakenDataEntity.TESTTAKENDATA!=undefined&&(window.revBtn="visible",a=JSON.parse(n.root.TestTakenDataCollection.TestTakenDataEntity.TESTTAKENDATA))}catch(f){e.log(f," -- Error: Review not available")}if(t.OFFLINE==1&&(t.mode.toLowerCase()=="review"||window.revBtn=="visible")){e.log("Data inserted from local storage");var l=e.getLatestTestData(u),c=l.attributes.test_metadata.TestDataXML;n.root.TestTakenDataCollection.TestTakenDataEntity={},n.root.TestTakenDataCollection.TestTakenDataEntity.TESTTAKENDATA=c}var h=n.root.TestFeedbackCollection.FeedbackEntity.FeedbackData.feedback_asArray;if(n.root.TestTakenDataCollection.TestTakenDataEntity!=undefined&&n.root.TestTakenDataCollection.TestTakenDataEntity.TESTTAKENDATA!=undefined){i=JSON.parse(n.root.TestTakenDataCollection.TestTakenDataEntity.TESTTAKENDATA);if(t.mode.toLowerCase()=="review"||revBtn=="visible")t.timetakeninseconds=i[0].timetakeninseconds,e.log("AppConst set for timetaken.")}e.log("----- testFeedbacksArray ",h);var p=g(h);e.log("----testFeedbackData ",p);var d=n.root.QuestionCollection.QuestionEntity_asArray,v=[];for(var y=0;y<d.length;y++){var w=d[y],E={};E=N(w),E=k(E,w),v.push(E);if(i.length!=0){var S=J(i[y],E);s.push(S)}}var x=b(n.root.TestMarkscheme.MarkschemeGradeEntity_asArray);return{testMetaData:o,testFeedbackData:p,questionCollection:v,testMarkScheme:x,testTakenDataCollection:s}}function m(e){return{id:e.TESTID,title:e.PROJECTTITLENAME,titleId:e.TITLEID,tierStructure:e.XMLTIERSTRUCTURE.TIER,testDescription:e.TESTDESCRIPTION,colorCode:e.PROJECTCOLORCODE,logoImage:"interface/dl-online-icon.png",displayBanner:e.PROJECTTITLEIMAGE,coverImage:e.PROJECTCOVERIMAGE,resourcePath:e.AEDB_RESOURCESPATH,testName:e.TestName}}function g(t){var n=[];return e.log("----- feedbacksArrayObj ",t),_.each(t,function(t){var r=[];_.each(t.remediations_asArray,function(t){e.log(t),t._count!=""&&_.each(t.remediation_asArray,function(t){e.log(t),r.push({id:t._id,type:t._type,text:t._text,icon:t._icon,descriptionText:t._DescriptionText,longText:t._LongText,titleId:t._Titleid,contentFilename:t._ContentFilename,resourceFileName:t._resourceFileName,resourceType:t._ResourceType,fileType:t._FileType,titleContentsPathURL:t._titleContentsPathURL,url:t._URL,remCode:t._remCode,testId:t._TestID})})}),n.push({id:t._id,feedbackText:t._formattedfbtext,minPercentage:t._pfrom,maxPercentage:t._pto,minMarks:t._mfrom,maxMarks:t._mto,resources:r})}),e.log("----processed feedbackData ",n),n}function y(t,n){var r=[];return r.push({id:"",feedbackText:t,minPercentage:0,maxPercentage:100,minMarks:0,maxMarks:parseInt(n),resources:[]}),e.log("----processed feedbackData ",r),r}function b(e){var t=[];return _.each(e,function(e){t.push({gradeId:e.GRADEID,gradeName:e.GRADENAME,gradeMinPercent:e.GRADEMINPERCENT,gradeMaxPercent:e.GRADEMAXPERCENT,markSchemeId:e.MARKSCHEMEID,markSchemeDescription:e.MARKSCHEMEDESCRIPTION})}),t}function w(t){var n=[];return _.each(t,function(t){var r="";if(t._type=="a"){var i=t._location.split(".")[1];e.log(i);switch(i){case"doc":case"docx":r="word";break;case"ppt":case"pptx":r="powerpoint";break;case"pdf":r="pdf";break;case"html":case"htm":r="html";break;case"xls":case"xlsx":r="excel";break;case"png":case"jpg":case"jpeg":case"gif":case"bmp":r="image";break;default:r=t._type}}else r=t._type;var s="";switch(t._icon){case"iconEPages":s="iconURL";break;case"iconWord":s="iconDOC";break;case"iconImage":s="iconJPG";break;case"iconVideo":s="iconFLV";break;case"iconAudio":s="iconMP3";break;default:s=t._icon}n.push({id:t._id,text:t._text,data:t._location,type:r,icon:s})}),n}function E(e){var t=[];return _.each(e,function(e){var n="";switch(e._type.toLowerCase()){case"doc":case"docx":n="word";break;case"ppt":case"pptx":n="powerpoint";break;case"pdf":n="pdf";break;case"html":case"htm":n="html";break;case"xls":case"xlsx":n="excel";break;case"png":case"jpg":case"jpeg":case"gif":case"bmp":n="image";break;default:n=e._type}t.push({id:"",text:"",data:e._data,type:n,icon:""})}),t}function S(e){var t={},n=e.assetPath.split("/"),r=n[n.length-1].split("."),i=r[r.length-1],s="";switch(i.toLowerCase()){case"doc":case"docx":s="word";break;case"ppt":case"pptx":s="powerpoint";break;case"pdf":s="pdf";break;case"html":case"htm":s="html";break;case"xls":case"xlsx":s="excel";break;case"png":case"jpg":case"jpeg":case"gif":case"bmp":s="image";break;default:s=e._type}return t=[{id:"",text:"",data:e.assetPath,type:s,icon:""}],t}function x(e,t){var n={},r=e._data.split("/"),i=r[r.length-1].split("."),s=i[i.length-1],o="";switch(s.toLowerCase()){case"doc":case"docx":o="word";break;case"ppt":case"pptx":o="powerpoint";break;case"pdf":o="pdf";break;case"html":case"htm":o="html";break;case"xls":case"xlsx":o="excel";break;case"png":case"jpg":case"jpeg":case"gif":case"bmp":o="image";break;default:o=e._type}return n=[{id:t,text:"",data:e._data,type:o,icon:""}],n}function T(e,t){return _.each(e,function(e){var n="";switch(e.assetType.toLowerCase()){case"doc":case"docx":n="word";break;case"ppt":case"pptx":n="powerpoint";break;case"pdf":n="pdf";break;case"html":case"htm":n="html";break;case"xls":case"xlsx":n="excel";break;case"png":case"jpg":case"jpeg":case"gif":case"bmp":n="image";break;default:n=e._type}t.push({id:"",text:"",data:e.assetPath,type:n,icon:""})}),t}function N(e){var t=[],n,r=[];e.QUESTIONTYPECODE==="OTTM"?e.QUESTIONTEACHERFEEDBACK&&typeof e.QUESTIONTEACHERFEEDBACK=="string"&&(t=y(e.QUESTIONTEACHERFEEDBACK,e.QUESTIONMARKS)):(e.QUESTIONSTATEXML.question?e.QUESTIONSTATEXML.question.formcontents.question.hasOwnProperty("feedbacks")?n=e.QUESTIONSTATEXML.question.formcontents.question.feedbacks:e.QUESTIONSTATEXML.question.formcontents.hasOwnProperty("feedbacks")&&(n=e.QUESTIONSTATEXML.question.formcontents.feedbacks):e.QUESTIONSTATEXML.formcontents.question&&(e.QUESTIONSTATEXML.formcontents.question.hasOwnProperty("feedbacks")?n=e.QUESTIONSTATEXML.formcontents.question.feedbacks:e.QUESTIONSTATEXML.formcontents.hasOwnProperty("feedbacks")&&(n=e.QUESTIONSTATEXML.formcontents.feedbacks)),n!=undefined&&n._count!=""&&(t=g(n.feedback_asArray)));var i=[],s;if(e.QUESTIONTYPECODE.indexOf("MAT")==0)s=e.QUESTIONSTATEXML.question.formcontents.question.assets,s!=undefined&&s._count!=""&&(i=w(s.asset_asArray));else if(e.QUESTIONTYPECODE.indexOf("OT")<0){var o=e.QUESTIONDETAILSXML.assessmentItem.itemBody.div_asArray;_.each(o,function(e){e._id=="Rubric"&&(s=e.object_asArray,s!=undefined&&s.length>0&&(i=E(s)))})}else{var u=e.QUESTIONDETAILSXML.assessmentItem.rubric.rubricAssets;u.__cnt>0&&(i=T(u.asset_asArray,i))}var a="",f=[],l=e.QUESTIONTAGS.QuestionTagCollection.TagEntity,c=_.where(l,{TAGITEMTYPE:"CT"}),h=_.sortBy(c,function(e){return e.TAGITEMID});return _.each(h,function(e){var t=_.where(l,{TAGITEMPARENTID:e.TAGITEMID});f=C(t,l,f)}),f=_.unique(f),_.each(f,function(e,t){t<f.length-1?a+=e+", ":a+=e}),{id:e.QUESTIONID,title:e.QUESTIONDESCRIPTION,typeId:e.QUESTIONTYPEID,maxpoints:[e.QUESTIONMARKS],typecode:e.QUESTIONTYPECODE,heading:[],leftCol:[],rightCol:[],optionsLayout:"",questionLayout:"",modelParagraph:"",gradeId:e.QUESTIONGRADEID,gradeName:e.QUESTIONGRADENAME,gradeScore:e.QUESTIONGRADESCORE,gradeDescription:e.QUESTIONGRADEDESCRIPTION,feedbacks:t,questionMedia:i,optionsMedia:[],topics:a,activityMedia:r}}function C(e,t,n){if(e.length==0)return n;var r=_.where(e,{TAGITEMTYPE:"SC"}),i=_.where(e,{TAGITEMTYPE:"VA"}),s=_.sortBy(r,function(e){return e.TAGITEMID}),o=_.sortBy(i,function(e){return e.TAGITEMID});return _.each(s,function(e){var r=_.where(t,{TAGITEMPARENTID:e.TAGITEMID});n=C(r,t,n)}),_.each(o,function(e){n.push(e.TAGNAME)}),n}function k(t,n){if(n.QUESTIONTYPECODE==="MCDD"){e.log("-----MCDD ques obj",n),t.type="FIBDROPDOWN",t.responseType="DROPDOWN";var r=M(n.QUESTIONDETAILSXML.assessmentItem);t.answers=r.answers,t.options=r.options,t.rubric=r.rubric,t.questionBody=r.questionBody,t.title=r.title,t.activityMedia=r.activityMedia}else if(n.QUESTIONTYPECODE==="DDIW"){t.type="FIB",t.responseType="DRAGDROP";var r=P(n.QUESTIONDETAILSXML.assessmentItem);t.answers=r.answers,t.options=r.options,t.rubric=r.rubric,t.questionBody=r.questionBody,t.title=r.title}else if(n.QUESTIONTYPECODE==="DDS"){t.type="GROUPING",t.responseType="";var r=B(n.QUESTIONDETAILSXML.assessmentItem);t.options=r.options,t.questionBody=r.questionBody,t.rubric=r.rubric,t.answers=r.answers,t.groupsCount=r.groupsCount,t.blanksCount=r.blanksCount,t.title=r.title}else if(n.QUESTIONTYPECODE==="LC"){t.type="MATCHSORT",t.responseType="";var r=I(n.QUESTIONDETAILSXML.assessmentItem);t.options=r.options,t.questionBody=r.questionBody,t.rubric=r.rubric,t.answers=r.answers,t.title=r.title}else if(n.QUESTIONTYPECODE==="MATTF"){t.type="MCQ",t.responseType="BINARY",t.rubric=[],t.numberstyle=n.QUESTIONSTATEXML.question._numberstyle,n.QUESTIONSTATEXML.question.text!=undefined&&t.rubric.push({data:n.QUESTIONSTATEXML.question.text.image._source.replace(/\\/g,"/"),type:"image"}),t.labelTrue=n.QUESTIONSTATEXML.question._labeltrue?n.QUESTIONSTATEXML.question._labeltrue:"True",t.labelFalse=n.QUESTIONSTATEXML.question._labelfalse?n.QUESTIONSTATEXML.question._labelfalse:"False",t.feedbackName=n.QUESTIONSTATEXML.question._feedbackname,t.questionBody=[{data:n.QUESTIONSTATEXML.question.image._source.replace(/\\/g,"/"),type:"image"}];var r=L(n.QUESTIONSTATEXML.question);t.answers=r.answers,t.options=r.options}else if(n.QUESTIONTYPECODE==="MATMC"){t.type="MCQ",t.responseType="BUTTON",t.rubric=[],t.numberstyle=n.QUESTIONSTATEXML.question._numberstyle,n.QUESTIONSTATEXML.question.text!=undefined&&t.rubric.push({data:n.QUESTIONSTATEXML.question.text.image._source.replace(/\\/g,"/"),type:"image"}),t.feedbackName=n.QUESTIONSTATEXML.question._feedbackname,t.questionBody=[{data:n.QUESTIONSTATEXML.question.image?n.QUESTIONSTATEXML.question.image._source.replace(/\\/g,"/"):"",type:"image"}];var r=A(n.QUESTIONSTATEXML.question);t.answers=r.answers,t.options=r.options}else if(n.QUESTIONTYPECODE==="MATDD"){e.log("-----MATDD ques obj",n),t.type="FIB",t.responseType="DRAGDROP",t.rubric=[],n.QUESTIONSTATEXML.question.text!=undefined&&t.rubric.push({data:n.QUESTIONSTATEXML.question.text.image._source.replace(/\\/g,"/"),type:"image"}),t.feedbackName=n.QUESTIONSTATEXML.question._feedbackname,t.maintainOptions=n.QUESTIONSTATEXML.question._multipleselection;var r=O(n.QUESTIONSTATEXML.question);t.questionBody=r.questionBody,t.answers=r.answers,t.options=r.options,t.blankPositions=r.blankPositions}else if(n.QUESTIONTYPECODE==="TT"){t.type="FIBTABLE",t.responseType="BINARY";var r=R(n.QUESTIONDETAILSXML.assessmentItem);t.options=r.options,t.questionBody=r.questionBody,t.rubric=r.rubric,t.answers=r.answers,t.title=r.title}else if(n.QUESTIONTYPECODE==="OT"){t.type="OPENTEXT",t.responseType="";var r=U(n.QUESTIONDETAILSXML.assessmentItem);t.options=r.options,t.questionBody=r.questionBody,t.rubric=r.rubric,t.answers=r.answers,t.activityMedia=r.activityMedia}else if(n.QUESTIONTYPECODE==="OTTM"){t.type="OPENTEXT_TEACHER_MARKED",t.responseType="",t.marksObtained=n.QUESTIONTEACHERMARKS,t.isQuestionMarked=n.QUESTIONTEACHERHASMARKED,t.maxScore=n.QUESTIONMARKS;var r=z(n.QUESTIONDETAILSXML.assessmentItem);t.options=r.options,t.questionBody=r.questionBody,t.rubric=r.rubric,t.answers=r.answers,t.activityMedia=r.activityMedia}return t}function L(e){var t=[],n=[];return _.each(e.answer_asArray,function(e){t.push({data:"",type:"text"},{data:e.image._source.replace(/\\/g,"/"),type:"image"},{data:"<br/>",type:"text"}),n.push(e._correct=="true"?1:0)}),{options:t,answers:n}}function A(e){var t=[],n=[],r=1;return _.each(e.answer_asArray,function(e){t.push([{data:e.image._source.replace(/\\/g,"/"),type:"image"}]),e._correct=="true"&&n.push(r),r++}),{options:t,answers:n}}function O(e){var t=[],n=[],r=[],i=[],s=[],o=1,u=[];return s.push({data:e.image?e.image._source.replace(/\\/g,"/"):"",type:"image"}),_.each(e.answer_asArray,function(e){e.image_asArray.length>1&&(e.image_asArray[0]._source.indexOf("blank.png")>=0?s.push("GAP"):s.push({data:e.image_asArray[0]._source.replace(/\\/g,"/"),type:"image"},"GAP"),u.push({x:e._dx,y:e._dy,w:e._dw,h:e._dh}));var n=e.image_asArray[e.image_asArray.length-1]._source.replace(/\\/g,"/");t.push(n),e._dx&&r.push(n)}),t=_.unique(t),_.each(t,function(e){n.push({data:e,type:"image"})}),_.each(r,function(e){var n=t.indexOf(e)+1;i.push([n])}),{questionBody:s,options:n,blankPositions:u,answers:i}}function M(e){var t=[],n=[],r=[],i=[],s,o,u={},a=e.responseDeclaration_asArray;_.each(a,function(e){n.push(e.correctResponse.value_asArray)});var f=e.itemBody.inlineChoiceInteraction_asArray;_.each(f,function(e){var n=[],r=e.inlineChoice_asArray;_.each(r,function(e){e.__cdata&&n.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"})}),t.push(n)});var l=e.itemBody.div_asArray;_.each(l,function(e){switch(e._id){case"Title":o=e.__cdata.replace(/\n/g,"<br />");break;case"Rubric":r.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"});break;case"htmlText":s=e.__cdata.replace(/\n/g,"<br />");break;case"componentStyle":break;case"audio":if(e.div)for(var t=0;t<e.div.length;t++){var n=e.div[t]._id;u[n]=x(e.div[t].object,n)}}});if(e.activityTexts!=undefined){var c=e.activityTexts.activityText_asArray;_.each(c,function(e){var t=e.activityAssets.asset_asArray;if(t.length>0){var n=[];_.each(t,function(e){n.push(S(e))}),u.push(n)}})}return i=D(s),{options:t,answers:n,rubric:r,questionBody:i,title:o,activityMedia:u}}function D(t){var n=t;n=n.replace(/\<fon(.+?)\>/g,""),n=n.replace(/\<\/fon(.+?)\>/g,""),n=n.replace(/&lt(.+?)&gt;/g,""),n=n.replace(/\<object(.+?)\object>/g,function(e,t){return t.indexOf("dDrop")>-1||t.indexOf("mcTarget_")>-1?"[blank]":$(e).attr("type").toLowerCase()=="audio"||$(t).attr("type").toLowerCase()=="audio"?e:""});var r=n.split("[blank]");e.log("----qBodyElems",r);var i=[];for(var s=0;s<r.length;s++)s!=r.length-1&&r[s]==""?i.push("GAP"):(i.push({data:r[s],type:"text"}),s!=r.length-1&&i.push("GAP"));return e.log("----questionBody",i),i}function P(t){var n=[],r=[],i=[],s,o,u=t.itemBody.div_asArray;_.each(u,function(e){switch(e._id){case"Title":o=e.__cdata.replace(/\n/g,"<br />");break;case"Rubric":r.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"});break;case"Target":s=e.__cdata.replace(/\n/g,"<br />");break;case"componentStyle":}}),i=D(s);var a=t.itemBody.matchInteraction.simpleMatchSet[1].simpleAssociableChoice_asArray;_.each(a,function(e){n.push(e.__cdata.replace(/\n/g,"<br />"))});var f=H(n);return e.log(f),{options:f.options,answers:f.answers,rubric:r,questionBody:i,title:o}}function H(t){e.log("----optionsArr",t);var n=t.length,r=e.create_unique_random_array(n,1,n),i=[];for(var s=0;s<n;s++)i.push([r[s]]);e.log("----answers",i);var o=[];for(var s=0;s<n;s++)o[r[s]-1]={data:t[s],type:"text"};return e.log("----options",o),{answers:i,options:o}}function B(t){var n=[],r=[],i=[],s=[],o=[],u=[],a=[],f,l,c,h,p=t.itemBody.div_asArray;_.each(p,function(e){switch(e._id){case"Title":h=e.__cdata.replace(/\n/g,"<br />");break;case"Rubric":u.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"});break;case"header":f=e.div_asArray;break;case"ElementsAssociation":}}),l=f.length,_.each(f,function(e){n.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"})}),c=t.itemBody.matchInteraction.simpleMatchSet[0].simpleAssociableChoice_asArray.length;var d=t.itemBody.matchInteraction.simpleMatchSet[1].simpleAssociableChoice_asArray;_.each(d,function(e){o.push(e._identifier)});var v=t.responseDeclaration.correctResponse.value_asArray;_.each(v,function(e){r.push(e.split(" ")[1])});var m=_.unique(r),g=[];return _.each(m,function(e,t){var n=e.split(",");_.each(n,function(e,n){var r={};r[t]=o.indexOf(e),g.push(r)})}),g=_.shuffle(g),_.each(g,function(e){_.each(e,function(e,t){i.push(parseInt(t)+1),s.push(e)})}),e.log(s,i,d),_.each(s,function(e,t){a.push([{data:d[e].__cdata.replace(/\n/g,"<br />"),type:"text"}])}),{options:n,rubric:u,answers:i,questionBody:a,groupsCount:l,blanksCount:c,title:h}}function j(e,t,n){var r=e/t,i=[];return _.each(n,function(e){var t,n,s;e=parseInt(e),e++,t=e/r,n=e%r,s=n!=0?Math.ceil(t):t,i.push(s)}),i}function F(t,n,r){var i=t/n,s=[],o=[],u=1,a=e.create_unique_random_array(n,1,n);for(var f=0;f<a.length;f++)o.push(u),u+=i;return _.each(r,function(e){var t=0;_.each(a,function(n){e==n&&(s.push(t+o[n-1]),o[n-1]++)})}),s}function I(e){var t=[],n=[],r=[],i=[],s=[],o=[],u=[],a,f=e.itemBody.div_asArray;_.each(f,function(e){switch(e._id){case"Title":a=e.__cdata.replace(/\n/g,"<br />");break;case"Rubric":r.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"})}}),n=e.itemBody.matchInteraction.simpleMatchSet[0].simpleAssociableChoice_asArray,t=e.itemBody.matchInteraction.simpleMatchSet[1].simpleAssociableChoice_asArray,i=q(n),o=q(t);var l=q(t),c=e.responseDeclaration.correctResponse.value_asArray;_.each(c,function(e){var t=e.split(" ")[1];t=parseInt(t.substring(2)),u.push(t)});for(var h=0;h<l.length;h++)s.push(l[u[h]-1]);return{options:o,rubric:r,answers:s,questionBody:i,title:a}}function q(e){var t=[];return _.each(e,function(e){t.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"})}),t}function R(e){var t=[],n=[],r=[],i=[],s=[],o,u,a=[],f,l,c="",h=e.itemBody.div_asArray;return _.each(h,function(e){switch(e._id){case"Title":c=e.__cdata.replace(/\n/g,"<br />");break;case"Rubric":i.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"});break;case"header":o=e.div_asArray;break;case"ElementsAssociation":break;case"rubricText":u=e.div_asArray}}),_.each(o,function(e){t.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"})}),_.each(u,function(e){s.push({data:e.__cdata.replace(/\n/g,"<br />"),type:"text"})}),f=e.itemBody.choiceInteraction[0].simpleChoice_asArray,_.each(f,function(e){n.push(e._identifier)}),l=e.responseDeclaration_asArray,_.each(l,function(e){a.push(e.correctResponse.value)}),_.each(a,function(e){var t=n.indexOf(e);r.push([++t])}),{options:t,rubric:i,answers:r,questionBody:s,title:c}}function U(e){var t=[],n=[],r=[],i=[],s=[],o=e.activityTexts.activityText_asArray;return _.each(o,function(e){t.push({data:e.defaultResponseText_asArray[0].__cdata,type:"text"}),i.push({data:e.activityTextDescription_asArray[0].__cdata.replace(/\n/g,"<br />"),type:"text"});var r=e.acceptableResponses.responseText_asArray,o=[];_.each(r,function(e){o.push({data:e.__cdata,type:"text"})}),n.push(o);if(e.activityAssets.__cnt>0){var u=e.activityAssets.asset_asArray,a=[];u.length>0&&_.each(u,function(e){a.push(S(e))}),s.push(a)}else s.push([])}),r.push({data:e.rubric.rubricText.__cdata.replace(/\n/g,"<br />"),type:"text"}),{options:t,rubric:r,answers:n,questionBody:i,activityMedia:s}}function z(e){var t=[],n=[],r=[],i=[],s=[],o=e.activityTexts.activityText_asArray;return _.each(o,function(e){t.push({data:e.defaultResponseText_asArray[0].__cdata,type:"text"}),i.push({data:e.activityTextDescription_asArray[0].__cdata.replace(/\n/g,"<br />"),type:"text"});if(e.activityAssets.__cnt>0){var n=e.activityAssets.asset_asArray,r=[];n.length>0&&_.each(n,function(e){r.push(S(e))}),s.push(r)}else s.push([])}),r.push({data:e.rubric.rubricText.__cdata.replace(/\n/g,"<br />"),type:"text"}),{options:t,rubric:r,answers:n,questionBody:i,activityMedia:s}}function W(n,r,i){var s=[],o="",u=-1,f=0;o+="<TestEntity><testid>"+t.testid+"</testid>",_.each(n,function(n){u++,n.responseData.type!="OPENTEXT_TEACHER_MARKED"&&(o+="<QuestionEntity>",o+="<Questionid>"+n.responseData.id+"</Questionid>",o+="<MarksTotal>"+n.responseData.maxScore+"</MarksTotal>",o+="<MarksScored>"+n.responseData.score+"</MarksScored>",o+="</QuestionEntity>",f+=parseInt(n.responseData.score)!=NaN?parseInt(n.responseData.score):0);var i="";switch(n.responseData.type){case"FIBDROPDOWN":_.each(n.responseData.userResponse,function(e){i+=e+1+"|"}),s.push({stateobject:i,name:n.title,score:n.responseData.score,maxscore:n.responseData.maxScore});break;case"MCQ":if(n.responseData.responseType=="BUTTON"){i={},i.breakdown=[];for(var a=0;a<n.responseData.optLength;a++)i.breakdown.push({Index:a,Value:_.contains(n.responseData.userResponse,""+(a+1))?1:0});s.push({stateobject:JSON.stringify(i),name:n.title,score:n.responseData.score,maxscore:n.responseData.maxScore})}else if(n.responseData.responseType=="BINARY"){i={},i.breakdown=[];var l=0;for(var a=0;a<n.responseData.userResponse.length;a++)parseInt(n.responseData.userResponse[a])>0&&l++,i.breakdown.push({Index:a,Value:n.responseData.userResponse[a]});i.count=l,s.push({stateobject:JSON.stringify(i),name:n.title,score:n.responseData.score,maxscore:n.responseData.maxScore})}break;case"FIB":if(n.responseData.responseType=="DRAGDROP"){if(n.responseData.optionImg){var c={};c.breakdown=[],_.each(n.responseData.userResponse,function(e){c.breakdown.push({Value:String(e),Score:String(n.responseData.multiplier)})}),i=JSON.stringify(c)}else{var h=n.responseData.userResponse.length,p=e.generateAlphaArr(h);for(var a=0;a<h;a++)for(var d=0;d<r[u].answers.length;d++){var v=r[u].answers[d],m=-1;if(_.indexOf(v,n.responseData.userResponse[a])>-1){m=d,i+="T"+(a+1)+"|"+p[d]+",";break}}}s.push({stateobject:i,name:n.title,score:n.responseData.score,maxscore:n.responseData.maxScore})}break;case"FIBTABLE":if(n.responseData.responseType=="BINARY"){var h=n.responseData.userResponse.length;for(var a=0;a<h;a++)i+="rubric"+a+"|Choice"+String.fromCharCode(64+n.responseData.userResponse[a])+",";s.push({stateobject:i,name:n.title,score:n.responseData.score,maxscore:n.responseData.maxScore})}break;case"OPENTEXT":var h=n.responseData.userResponse.length,p=e.generateAlphaArr(h),c={};for(var a=0;a<h;a++)c[a]={isCorrect:n.responseData.userResponse[a].isCorrect,inputText:n.responseData.userResponse[a].inputText};i=JSON.stringify(c),s.push({stateobject:i,name:n.title,score:n.responseData.score,maxscore:n.responseData.maxScore});break;case"OPENTEXT_TEACHER_MARKED":var h=n.responseData.userResponse.length,c={};for(var a=0;a<h;a++)c[a]={inputText:n.responseData.userResponse[a].inputText};i=JSON.stringify(c),s.push({stateobject:i,name:n.title});var h=n.responseData.userResponse.length;for(var a=0;a<h;a++)o+="<QuestionEntity>",o+="<Questionid>"+n.responseData.id+"</Questionid>",o+="<ActivityDescription>"+n.responseData.userResponse[a].ActivityDescription+"</ActivityDescription>",o+="<StudentResponse>"+n.responseData.userResponse[a].inputText+"</StudentResponse>",o+="<ActivityOrder>"+(a+1)+"</ActivityOrder>",o+="</QuestionEntity>";break;case"MATCHSORT":var h=n.responseData.userResponse.length,p=e.generateAlphaArr(h);for(var a=0;a<h;a++)i+="arrow_RC"+(a+1)+"_LC"+n.responseData.userResponse[a].index+":";s.push({name:n.title,score:n.responseData.score,stateobject:i,maxscore:n.responseData.maxScore});break;case"GROUPING":var g=n.responseData.userResponse;for(var a=0;a<g.length;a++)i+=""+a+":"+g[a]+"|";s.push({name:n.title,score:n.responseData.score,stateobject:i,maxscore:n.responseData.maxScore,type:"grouping"})}t.mode.toLowerCase()!="review"&&(s[0].timetakeninseconds=timeTaken)}),o+="</TestEntity>",e.log("----userResponseArr",s),e.log("----userResponseArr",JSON.stringify(s)),e.log("----QuestionDetails",o),e.log("----QuestionDetails",escape(o)),o=o.replace(/</g,"%26lt%3B").replace(/>/g,"%26gt%3B"),e.log("----QuestionDetails 1 :: ",o),e.log("----QuestionDetails 2 :: ","&lt;TestEntity&gt;&lt;testid&gt;3845&lt;/testid&gt;&lt;QuestionEntity&gt;&lt;Questionid&gt;26222&lt;/Questionid&gt;&lt;MarksTotal&gt;1&lt;/MarksTotal&gt;&lt;MarksScored&gt;0&lt;/MarksScored&gt;&lt;/QuestionEntity&gt;&lt;QuestionEntity&gt;&lt;Questionid&gt;26253&lt;/Questionid&gt;&lt;MarksTotal&gt;1&lt;/MarksTotal&gt;&lt;MarksScored&gt;0&lt;/MarksScored&gt;&lt;/QuestionEntity&gt;&lt;QuestionEntity&gt;&lt;Questionid&gt;26254&lt;/Questionid&gt;&lt;MarksTotal&gt;1&lt;/MarksTotal&gt;&lt;MarksScored&gt;0&lt;/MarksScored&gt;&lt;/QuestionEntity&gt;&lt;QuestionEntity&gt;&lt;Questionid&gt;26257&lt;/Questionid&gt;&lt;MarksTotal&gt;1&lt;/MarksTotal&gt;&lt;MarksScored&gt;0&lt;/MarksScored&gt;&lt;/QuestionEntity&gt;&lt;QuestionEntity&gt;&lt;Questionid&gt;26258&lt;/Questionid&gt;&lt;MarksTotal&gt;1&lt;/MarksTotal&gt;&lt;MarksScored&gt;0&lt;/MarksScored&gt;&lt;/QuestionEntity&gt;&lt;QuestionEntity&gt;&lt;Questionid&gt;26290&lt;/Questionid&gt;&lt;MarksTotal&gt;2&lt;/MarksTotal&gt;&lt;MarksScored&gt;0&lt;/MarksScored&gt;&lt;/QuestionEntity&gt;&lt;QuestionEntity&gt;&lt;Questionid&gt;26291&lt;/Questionid&gt;&lt;MarksTotal&gt;1&lt;/MarksTotal&gt;&lt;MarksScored&gt;0&lt;/MarksScored&gt;&lt;/QuestionEntity&gt;&lt;QuestionEntity&gt;&lt;Questionid&gt;26292&lt;/Questionid&gt;&lt;MarksTotal&gt;6&lt;/MarksTotal&gt;&lt;MarksScored&gt;4&lt;/MarksScored&gt;&lt;/QuestionEntity&gt;&lt;/TestEntity&gt;"),t.appEnvironment=="ReaderMobile"&&t.mode.toLowerCase()=="review"&&!t.OFFLINE&&(s=a);var l={TestID:""+t.testid,USERID:t.userid,SAMSID:t.samsid,UserToken:t.usertoken,ReceivedMarks:""+f,TestDataXML:JSON.stringify(s),QuestionDetails:""+o,TimeTakenInSeconds:t.timetakeninseconds};return l}function X(n,r){var s=t.aeWebServicePath+t.ws.saveTest;navigator.userAgent.toLowerCase().indexOf("msie 9")>-1&&(s=t.dlWebservicePath+t.ws.saveTest);if(t.appEnvironment=="ReaderMobile"){e.log("service params testid going in ajax: "+n.TestID);var o={url:s,data:n,method:"POST",contentType:"xml"};i.performAction(document.TPInterfaceConst.ACTIONTYPE_XHR,o,function(t){e.log("Response from TPComm Online Saving WS: ",t),t.search("Test successfully saved.")>-1?(e.log("Success via ReaderMobile TPComm postDataToDL"),r(!0),clickCheck=!0):(e.log("Failure via ReaderMobile TPComm postDataToDL"),r(!1),clickCheck=!1)})}else $.ajax({type:"POST",url:s,data:n,success:function(t){e.log("success :"+t),r(!0),clickCheck=!0},error:function(t){e.log("error :",t),r(!1),clickCheck=!1},dataType:"xml"})}function V(e,t){var n=this;$.get(e,function(e){var n=s.xml2json(e);n.root.TestTakenDataCollection.TestTakenDataEntity.TESTTAKENDATA=JSON.stringify(t),d(n)})}function J(t,n){var r={},i=[],s=[];r.id=n.id,n.typecode!="OTTM"&&(r.maxScore=t.maxscore,r.score=t.score,r.title=t.name);switch(n.typecode){case"MATTF":i=JSON.parse(t.stateobject).breakdown,_.each(i,function(e){s.push(e.Value)});break;case"MATMC":i=JSON.parse(t.stateobject).breakdown,_.each(i,function(e){e.Value!=0&&s.push(++e.Index)});break;case"MATDD":i=JSON.parse(t.stateobject).breakdown,_.each(i,function(e){s.push(parseInt(e.Value))});break;case"TT":var o,u,a,f=[];o=t.stateobject,u=o.split(","),u.length--,_.each(u,function(e){f.push(e.split("|")[1])}),a=_.uniq(f),a.sort(),_.each(f,function(e){var t=a.indexOf(e);s.push(++t)});break;case"DDIW":var o,u,a,f=[];o=t.stateobject,u=o.split(","),u.length--,_.each(u,function(e){f.push(e.split("|")[1])}),a=e.generateAlphaArr(f.length),_.each(f,function(e){var t=n.answers[a.indexOf(e)];s.push([t])});break;case"DDS":var o,u,a,f=[];o=t.stateobject,u=o.split("|"),u.length--,_.each(u,function(e){f.push(parseInt(e.split(":")[1]))}),t.type=="grouping"?s=f:s=j(n.blanksCount,n.groupsCount,f);break;case"OT":i=JSON.parse(t.stateobject),_.each(i,function(e){s.push({inputText:e.inputText,isCorrect:e.isCorrect})});break;case"OTTM":r.maxScore=n.maxScore,r.score=n.marksObtained,r.title=n.title,r.isQuestionMarked=n.isQuestionMarked,i=JSON.parse(t.stateobject),_.each(i,function(e){s.push({inputText:e.inputText})});break;case"MCDD":i=t.stateobject;var l=i.split("|");for(var c=0;c<l.length-1;c++)s.push(--l[c]);break;case"LC":i=t.stateobject;var l=i.split(":");for(var c=0;c<l.length-1;c++){var h=parseInt(l[c].split("LC")[1]);s.push({attempted:!0,type:"text",index:h,data:n.options[h-1].data})}}return r.userResponse=s,r}var s=new X2JS,o,u=!1;savedTestData=[];var a="";return{postDataToDL:X,serialize:c,offlineSerialize:l,deserializeUserResponse:W,getXml:f}});var packs=new Object;packs.welcomeScreenData={id:"1150",title:"TAQA GCSE Science",tierStructure:"Biology: 1: B1.2 Nerves and hormones",testDataDescription:"B1.2 Nerves and hormones",logoImage:"interface/dl-online-icon.png",displayBanner:"interface/OCR Spec A Banner.png",coverImage:"interface/112795_OCR_SPECA.jpg"},packs.pack=[{id:"2",answers:[],leftCol:[],modelParagraph:"",options:[{data:"1",type:"text"},{data:"2",type:"text"},{data:"3",type:"text"},{data:"4",type:"text"},{data:"5",type:"text"}],optionsLayout:"",questionBody:[{data:"The impulse passes along a motor neurone.",type:"text"},{data:"The impulse passes along a sensory neurone.",type:"text"},{data:"Muscles in the arm contract.",type:"text"},{data:"Receptors in skin detect a stimulus.",type:"text"},{data:"The impulse passes along a relay neurone.",type:"text"}],heading:[],questionMedia:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"pdf"}],optionsMedia:[],questionLayout:"",responseType:"",rightCol:[],rubric:[{data:"When your hand touches a hot object, your body responds automatically. Sort the statements describing what happens during the reflex action into the correct order.",type:"text"}],title:"Matching",maxpoints:["5"],feedback:[{id:"1",feedbackText:"Matching feedback - 1",minPercentage:"0",maxPercentage:"50",minMarks:"0",maxMarks:"3",resources:[{id:"1",type:"Resource",text:"AQABiologyA2_00610.doc ",icon:"iconDOC",descriptionText:" Chapter 2 Learning outcomes",longText:"List of outcomes mapped to the AQA specification",titleId:"60",contentFilename:"dps0038-0039.swf",resourceFileName:"AQABiologyA2_00610.doc",resourceType:"Learning Outcomes",fileType:"Word",titleContentsPathURL:"",url:"",remCode:"DLR"}]},{id:"2",feedbackText:"Matching feedback - 2",minPercentage:"51",maxPercentage:"100",minMarks:"4",maxMarks:"6",resources:[{id:"1",type:"Resource",text:"AQABiologyA2_01470.htm ",icon:"iconPersonalTutor",descriptionText:" The greenhouse effect and global warming",longText:"Presentation explaining how the greenhouse effect allows conditions on Earth to be warm enough for life to exist - and how changes in atmospheric composition are causing overheating, leading to global warming",titleId:"60",contentFilename:"dps0084-0085.swf",resourceFileName:"AQABiologyA2_01470.htm",resourceType:"Skills Tutorial",fileType:"Personal Tutor",titleContentsPathURL:"",url:"",remCode:"DLR"}]}],type:"MATCHSORT"},{id:"3",description:"The Battle of Falkirk",typeId:"9",heading:[],leftCol:[],rightCol:[],optionsLayout:"",questionLayout:"",modelParagraph:"",gradeId:"144",gradeName:"No grade",gradeScore:"0",gradeDescription:"No grade range",answers:[[2],[5],[4],[6],[3],[7],[1]],options:[{data:"killed",type:"text"},{data:"wood",type:"text"},{data:"Scots",type:"text"},{data:"schiltrons",type:"text"},{data:"loch",type:"text"},{data:"English",type:"text"},{data:"archers",type:"text"}],questionBody:[{data:"Wallace and the Scottish army took up a strong defensive position on a hillside with a thick ",type:"text"},"GAP",{data:" behind them and a small ",type:"text"},"GAP",{data:" in front of them. The Scottish spearmen were arranged in four 'hedgehog-like' circles called ",type:"text"},"GAP",{data:"<br/>The ",type:"text"},"GAP",{data:"horsemen advanced. They split into two sections and each one moved around the loch to attack the sides of the ",type:"text"},"GAP",{data:" army. The spearmen stood firm in their schiltrons, and the English knights could not get through them. However, the English ",type:"text"},"GAP",{data:" fired their arrows at the centre of the schiltrons. Many Scottish spearmen were ",type:"text"},"GAP",{data:" and the English knights were able to break through.<br />The Scottish rebellion was over.",type:"text"}],questionMedia:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"pdf"}],optionsMedia:[],descriptionText:"",multiplier:"1",maxpoints:["7"],type:"FIB",responseType:"DRAGDROP",title:"Fib tap place",asset:"na",rubric:[{data:"Interactive drag and drop activity. Pupils complete the text about the Battle of Falkirk using the phrases provided.",type:"text"}],feedbacks:[{id:"",feedbackText:"",minPercentage:"",maxPercentage:"",minMarks:"",maxMarks:"",resources:[{id:"",type:"",text:"",icon:"",descriptionText:"",longText:"",titleId:"",contentFilename:"",resourceFileName:"",resourceType:"",fileType:"",titleContentsPathURL:"",url:"",remCode:""}]}]},{id:"4",heading:[],maxpoints:["4"],answers:["1","0","1","0"],leftCol:[],modelParagraph:"",options:[{data:" ",type:"text"},{data:"The coldest temperature is 0°",type:"text"},{data:"<br/>",type:"text"},{data:"",type:"text"},{data:"The coldest temperature is −5°.",type:"text"},{data:"<br/>",type:"text"},{data:"",type:"text"},{data:"The warmest temperature is 3°",type:"text"},{data:"<br/>",type:"text"},{data:"",type:"text"},{data:"The difference between the warmest and coldest temperature is 10°",type:"text"},{data:"<br/>",type:"text"}],optionsLayout:"",questionBody:[{data:"Here are some temperatures:    5°   −2°    0°    2°   3°   −5°   −3°",type:"text"}],questionMedia:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"pdf"}],optionsMedia:[],questionLayout:"",responseType:"BINARY",rightCol:[],rubric:[{data:"Decide whether each of the statements is true or false.",type:"text"}],title:"True / false",type:"MCQ"},{id:"5",heading:[],answers:[[4],[1],[2],[3]],leftCol:[],modelParagraph:"",options:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"image"},{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/4.png",type:"image"},{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/5.png",type:"image"},{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/6.png",type:"image"}],optionsLayout:"",questionBody:[{data:"1) 7 multiplied by 2 = ",type:"text"},"GAP",{data:"<br/>2) Square of 4 = ",type:"text"},"GAP",{data:"<br/>3) 2401 muliplied by 16 = ",type:"text"},"GAP",{data:"<br/>4) 3430 divided by 35 =  ",type:"text"},"GAP"],questionMedia:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"pdf"}],optionsMedia:[],questionLayout:"",responseType:"DRAGDROP",rightCol:[],rubric:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/1.png",type:"image"}],title:"fib tap place (image)",maxpoints:["4"],feedback:[],type:"FIB"},{id:"99",answers:[[0],[3],[1]],leftCol:[],modelParagraph:"",options:[[{data:"FSH",type:"text"},{data:"LH",type:"text"},{data:"Oestrogen",type:"text"},{data:"progesterone",type:"text"}],[{data:"FSH",type:"text"},{data:"LH",type:"text"},{data:"Oestrogen",type:"text"},{data:"progesterone",type:"text"}],[{data:"FSH",type:"text"},{data:"LH",type:"text"},{data:"Oestrogen",type:"text"},{data:"progesterone",type:"text"}]],optionsLayout:"",questionBody:[{data:"The diagram shows some of the events in a woman's monthly cycle. Several hormones are involved in control of the menstrual cycle.<br/>A) Which hormone secreted by the pituitary gland causes an egg to mature in the ovary? ",type:"text"},"GAP",{data:" <br/> B) Which hormone stimulates the release of an egg from the ovary?",type:"text"},"GAP",{data:" . <br/> C) Which hormone is secreted from the ovaries to inhibit production of FSH? ",type:"text"},"GAP",{data:" .",type:"text"}],heading:[],questionLayout:"",responseType:"DROPDOWN",rightCol:[],rubric:[{data:"Choose the correct word or phrase to complete the sentences.",type:"text"}],questionMedia:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"pdf"}],optionsMedia:[],title:"FIB dropDown",maxpoints:["3"],feedback:[{id:"1",feedbackText:"fib drop down feedback - 1",minPercentage:"0",maxPercentage:"50",minMarks:"0",maxMarks:"5",resources:[{id:"1",type:"Resource",text:"AQABiologyA2_00610.doc ",icon:"iconDOC",descriptionText:" Chapter 2 Learning outcomes",longText:"List of outcomes mapped to the AQA specification",titleId:"60",contentFilename:"dps0038-0039.swf",resourceFileName:"AQABiologyA2_00610.doc",resourceType:"Learning Outcomes",fileType:"Word",titleContentsPathURL:"",url:"",remCode:"DLR"},{id:"2",type:"Resource",text:"AQABiologyA2_00610.doc ",icon:"iconDOC",descriptionText:" Chapter 2 Learning outcomes",longText:"List of outcomes mapped to the AQA specification",titleId:"60",contentFilename:"dps0038-0039.swf",resourceFileName:"AQABiologyA2_00610.doc",resourceType:"Learning Outcomes",fileType:"Word",titleContentsPathURL:"",url:"",remCode:"DLR"},{id:"3",type:"Resource",text:"AQABiologyA2_00610.doc ",icon:"iconDOC",descriptionText:" Chapter 2 Learning outcomes",longText:"List of outcomes mapped to the AQA specification",titleId:"60",contentFilename:"dps0038-0039.swf",resourceFileName:"AQABiologyA2_00610.doc",resourceType:"Learning Outcomes",fileType:"Word",titleContentsPathURL:"",url:"",remCode:"DLR"},{id:"4",type:"Resource",text:"AQABiologyA2_00610.doc ",icon:"iconDOC",descriptionText:" Chapter 2 Learning outcomes",longText:"List of outcomes mapped to the AQA specification",titleId:"60",contentFilename:"dps0038-0039.swf",resourceFileName:"AQABiologyA2_00610.doc",resourceType:"Learning Outcomes",fileType:"Word",titleContentsPathURL:"",url:"",remCode:"DLR"}]},{id:"2",feedbackText:"fib drop down - 2",minPercentage:"51",maxPercentage:"100",minMarks:"6",maxMarks:"10",resources:[{id:"1",type:"Resource",text:"AQABiologyA2_01470.htm ",icon:"iconPersonalTutor",descriptionText:" The greenhouse effect and global warming",longText:"Presentation explaining how the greenhouse effect allows conditions on Earth to be warm enough for life to exist - and how changes in atmospheric composition are causing overheating, leading to global warming",titleId:"60",contentFilename:"dps0084-0085.swf",resourceFileName:"AQABiologyA2_01470.htm",resourceType:"Skills Tutorial",fileType:"Personal Tutor",titleContentsPathURL:"",url:"",remCode:"DLR"},{id:"2",type:"Resource",text:"AQABiologyA2_01470.htm ",icon:"iconPersonalTutor",descriptionText:" The greenhouse effect and global warming",longText:"Presentation explaining how the greenhouse effect allows conditions on Earth to be warm enough for life to exist - and how changes in atmospheric composition are causing overheating, leading to global warming",titleId:"60",contentFilename:"dps0084-0085.swf",resourceFileName:"AQABiologyA2_01470.htm",resourceType:"Skills Tutorial",fileType:"Personal Tutor",titleContentsPathURL:"",url:"",remCode:"DLR"}]}],type:"FIBDROPDOWN"},{id:"6",answers:[6,3,1,4,2,5],leftCol:[],modelParagraph:"",options:[{data:"Aluminium ions",type:"text"},{data:"Magnesium ions",type:"text"},{data:"Iron(III) ions",type:"text"},{data:"Chloride ions",type:"text"},{data:"Sulfate ions",type:"text"},{data:"Carbonates",type:"text"}],optionsLayout:"",questionBody:[[{data:"React with acids to form carbon dioxide",type:"text"}],[{data:"Form a brown precipitate with sodium hydroxide solution",type:"text"}],[{data:"Form a white precipitate with sodium hydroxide solution, and dissolve in excess sodium hydroxide",type:"text"}],[{data:"Form a white precipitate with acidified silver nitrate solution",type:"text"}],[{data:"Form a white precipitate with sodium hydroxide solution, which remains in excess sodium hydroxide",type:"text"}],[{data:"Form a white precipitate with acidified barium chloride solution",type:"text"}]],heading:[],questionMedia:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"pdf"}],optionsMedia:[],questionLayout:"",responseType:"",rightCol:[],rubric:[{data:"Tick the column for the correct option.",type:"text"}],title:"Grouping",maxpoints:["6"],type:"GROUPING"},{id:"7",heading:[],answers:["3"],leftCol:[],modelParagraph:"",options:[[{data:"/UserContents/tests/3845/preview/3845/assessment_items/assets/26222/2.png",type:"image"}],[{data:"/UserContents/tests/3845/preview/3845/assessment_items/assets/26222/3.png",type:"image"}],[{data:"/UserContents/tests/3845/preview/3845/assessment_items/assets/26222/4.png",type:"image"}],[{data:"/UserContents/tests/3845/preview/3845/assessment_items/assets/26222/5.png",type:"image"}]],optionsLayout:"2COL",questionBody:[{data:"/UserContents/tests/3845/preview/3845/assessment_items/assets/26222/1.png",type:"image"}],questionMedia:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"pdf"}],optionsMedia:[undefined,{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"image"},undefined,undefined],questionLayout:"",responseType:"BUTTON",rightCol:[],rubric:[],title:"Cube root 2",maxpoints:["1"],type:"MCQ"},{id:"13",answers:[[0],[1],[2],[4],[3],[5]],options:[{data:"Aluminium ions",type:"text"},{data:"Magnesium ions",type:"text"},{data:"Iron(III) ions",type:"text"},{data:"Chloride ions",type:"text"},{data:"Sulfate ions",type:"text"},{data:"Carbonates",type:"text"}],optionsLayout:"",rowHeader:[],questionBody:[{data:"React with acids to form carbon dioxide",type:"text"},{data:"Form a brown precipitate with sodium hydroxide solution",type:"text"},{data:"Form a white precipitate with sodium hydroxide solution, and dissolve in excess sodium hydroxide",type:"text"},{data:"Form a white precipitate with acidified silver nitrate solution",type:"text"},{data:"Form a white precipitate with sodium hydroxide solution, which remains in excess sodium hydroxide",type:"text"},{data:"Form a white precipitate with acidified barium chloride solution",type:"text"}],heading:[],questionMedia:[{data:"/UserContents/tests/25/preview/25/assessment_items/assets/4137/3.png",type:"pdf"}],optionsMedia:[],questionLayout:"",responseType:"BINARY",rubric:[{data:"Listen to the poem. Then type in the missing words to complete the poem.",type:"text"}],title:"Complete the poem (fill in the blanks)",maxpoints:["10"],type:"FIBTABLE"},{id:"26197",title:"Punctuate",typeId:"14",maxpoints:["3"],heading:[{data:"",type:"text"}],leftCol:[],rightCol:[],optionsLayout:"",questionLayout:"",modelParagraph:"",gradeId:"144",gradeName:"No grade",gradeScore:"0",gradeDescription:"No grade range",type:"OPENTEXT",responseType:"",optionsMedia:[],questionMedia:[],options:[{data:"The managers assistant didnt notice the missing keys. Hours passed before the boss asked her where they were.",type:"text"},{data:'"Ive not seen them," she said. "Perhaps your wifes got them?"',type:"text"},{data:'"I dont think so," he replied. "Ill borrow Jerrys spare set."',type:"text"}],questionBody:[{data:"The managers assistant didnt notice the missing keys. Hours passed before the boss asked her where they were.",type:"text"},{data:'"Ive not seen them," she said. "Perhaps your wifes got them?"',type:"text"},{data:'"I dont think so," he replied. "Ill borrow Jerrys spare set."',type:"text"}],rubric:[{data:"Insert the 7 missing apostrophes:",type:"text"}],answers:[{data:"The manager's assistant didn't notice the missing keys. Hours passed before the boss asked her where they were.",type:"text"},{data:'"I\'ve not seen them," she said. "Perhaps your wife\'s got them?"',type:"text"},{data:'"I don’t think so," he replied. "I\'ll borrow Jerry\'s spare set."',type:"text"}],feedback:[{id:"1",feedbackText:"fib drop down feedback - 1",minPercentage:"0",maxPercentage:"50",minMarks:"0",maxMarks:"5",resources:[{id:"1",type:"Resource",text:"AQABiologyA2_00610.doc ",icon:"iconDOC",descriptionText:" Chapter 2 Learning outcomes",longText:"List of outcomes mapped to the AQA specification",titleId:"60",contentFilename:"dps0038-0039.swf",resourceFileName:"AQABiologyA2_00610.doc",resourceType:"Learning Outcomes",fileType:"Word",titleContentsPathURL:"",url:"",remCode:"DLR"},{id:"2",type:"Resource",text:"AQABiologyA2_00610.doc ",icon:"iconDOC",descriptionText:" Chapter 2 Learning outcomes",longText:"List of outcomes mapped to the AQA specification",titleId:"60",contentFilename:"dps0038-0039.swf",resourceFileName:"AQABiologyA2_00610.doc",resourceType:"Learning Outcomes",fileType:"Word",titleContentsPathURL:"",url:"",remCode:"DLR"},{id:"3",type:"Resource",text:"AQABiologyA2_00610.doc ",icon:"iconDOC",descriptionText:" Chapter 2 Learning outcomes",longText:"List of outcomes mapped to the AQA specification",titleId:"60",contentFilename:"dps0038-0039.swf",resourceFileName:"AQABiologyA2_00610.doc",resourceType:"Learning Outcomes",fileType:"Word",titleContentsPathURL:"",url:"",remCode:"DLR"},{id:"4",type:"Resource",text:"AQABiologyA2_00610.doc ",icon:"iconDOC",descriptionText:" Chapter 2 Learning outcomes",longText:"List of outcomes mapped to the AQA specification",titleId:"60",contentFilename:"dps0038-0039.swf",resourceFileName:"AQABiologyA2_00610.doc",resourceType:"Learning Outcomes",fileType:"Word",titleContentsPathURL:"",url:"",remCode:"DLR"}]},{id:"2",feedbackText:"fib drop down - 2",minPercentage:"51",maxPercentage:"100",minMarks:"6",maxMarks:"10",resources:[{id:"1",type:"Resource",text:"AQABiologyA2_01470.htm ",icon:"iconPersonalTutor",descriptionText:" The greenhouse effect and global warming",longText:"Presentation explaining how the greenhouse effect allows conditions on Earth to be warm enough for life to exist - and how changes in atmospheric composition are causing overheating, leading to global warming",titleId:"60",contentFilename:"dps0084-0085.swf",resourceFileName:"AQABiologyA2_01470.htm",resourceType:"Skills Tutorial",fileType:"Personal Tutor",titleContentsPathURL:"",url:"",remCode:"DLR"},{id:"2",type:"Resource",text:"AQABiologyA2_01470.htm ",icon:"iconPersonalTutor",descriptionText:" The greenhouse effect and global warming",longText:"Presentation explaining how the greenhouse effect allows conditions on Earth to be warm enough for life to exist - and how changes in atmospheric composition are causing overheating, leading to global warming",titleId:"60",contentFilename:"dps0084-0085.swf",resourceFileName:"AQABiologyA2_01470.htm",resourceType:"Skills Tutorial",fileType:"Personal Tutor",titleContentsPathURL:"",url:"",remCode:"DLR"}]}]}],define("A1",function(){}),define("core/SyncProcessor",["AppConst","utilities","core/model/localStorageDataVO","core/collections/testRecordCollection","core/QTIProcessor","core/TPComm"],function(e,t,n,r,i,s){function u(n){t.log(e),collection1=new r,collection1.fetch();var i=[];$.each(collection1.pluck("user_id"),function(e,t){$.inArray(t,i)===-1&&i.push(t)});var s=i;t.log("unique userIDs present: "+s);var o=s.indexOf(e.userid);if(s.length>0){o!=0&&(s.splice(o,1),s.unshift(e.userid));for(var u=0;u<s.length;u++){var f=collection1.where({user_id:s[u],sync_status:!1});f.length>0?a(s[u],n):(t.log("Before all data sync in updateSync."),c(e.userid,n))}}else t.log("No Prev user data found in localstorage, syncing getAllTestData."),c(e.userid,n)}function a(n,s){collection1=new r,collection1.fetch();var o=collection1.where({user_id:n,sync_status:!1});t.log("SyncData size for current user: "+o.length);if(o.length>0){function u(r,i){return function(u){if(u){var f=collection1.where({user_id:n,test_id:r,att_id:i});model=f[0],model.set("sync_status",!0),model.save(),n==e.userid&&o.length-1==0&&e.appEnvironment=="ReaderMobile"&&e.module=="Report"?(t.log("Before all data sync ---->"),c(e.userid,s)):a(n,s)}else t.log("Data Syncing failed for "+i+" request(s)")}}var f=o[0].attributes;i.postDataToDL(f.test_metadata,u(f.test_id,f.att_id))}else t.log("No data found in localStorage to sync."),s()}function f(e){if(e!=null||""){collection1=new r,collection1.fetch();var n=collection1.where({user_id:e});if(n.length>0){for(var i=0;i<n.length;i++)n[i].destroy();t.log("User Info deleted successfully for username: "+e)}else t.log("No info found for username: "+e+" !!")}else t.log("Delete from localStorage failed.")}function l(){collection1=new r,collection1.fetch();var t=collection1.where({user_id:e.userid,isbn:e.isbn});_.chain(t).clone().each(function(e){e.destroy()})}function c(n,r){var i={},o=e.dlWebservicePath+e.ws.getReports;if(n!=null||""){i={userToken:e.reportToken,titleISBN:e.isbn,requestTestCount:10},e.appEnvironment=="Reader"|e.appEnvironment=="ReaderMobile"|e.appEnvironment=="Editor"?(i.dlUserID=0,i.opUserID=n):(i.dlUserID=n,i.opUserID="");if(e.appEnvironment=="ReaderMobile"){var u={url:o,data:i,method:"POST",contentType:"xml"};s.performAction(document.TPInterfaceConst.ACTIONTYPE_XHR,u,function(e){t.log("Response from TPComm Report Card getAllTestData WS: ",e),h(n,e,r)})}else $.ajax({url:o,data:i,success:function(e){h(n,e,r)},error:function(e){t.log("Error in fetching latest test reports: "+e)},dataType:"xml"})}}function h(t,n,r){if(e.appEnvironment!="ReaderMobile")var i=o.xml2json(n);else var i=o.xml_str2json(n);if(i.StudentProjectReport.TestResults.StudentTestResult==undefined){r("empty");return}var s=i.StudentProjectReport.TestResults.StudentTestResult;s.length==undefined&&(s=[s]);var u="";for(var a=0;a<s.length;a++)a==0?u+=s[a].Test.TestID:u=u+","+s[a].Test.TestID;e.appEnvironment=="Reader"?p(t,s,r):d(t,u,s,r)}function p(n,r,i){l();for(var s=0;s<r.length;s++){t.log("received date in sync: "+r[s].LastDateTaken);var o={TestID:r[s].Test.TestID,ReceivedMarks:r[s].Grade.AttainedMark,TestDataXML:null,QuestionDetails:"",TimeTakenInSeconds:r[s].TimeTakenInSeconds,USERID:n},u=t.checkLocalStorage();u&&collection1.create({user_id:n,test_id:r[s].Test.TestID,test_name:r[s].Test.TestDescription,test_metadata:o,attempts_taken:r[s].TimesTaken,date:r[s].LastDateTaken,sync_status:!1,max_score:r[s].Grade.AvailableMark,grade:r[s].Grade.GradeText,isbn:e.isbn,data_url:rendererVars.dataUrl,base_url:rendererVars.contentBaseUrl,att_id:"1"})}e.appEnvironment=="Reader"&&i(collection1.models)}function d(n,r,i,u){t.log("No. of TestIDs: "+r.split(",").length);if(e.appEnvironment=="ReaderMobile"){var a={url:e.aeWebServicePath+e.ws.getTests,data:{TestIDs:r,MODE:"REVIEW",USERID:n,SAMSID:"12345",UserToken:e.usertoken},method:"POST",contentType:"xml"};s.performAction(document.TPInterfaceConst.ACTIONTYPE_XHR,a,function(r){t.log("Response from TPComm Report Card getUserResponses WS: ",r);var s=o.xml_str2json(r),a=s.ArrayOfTestReport.TestReport;t.log("No. of TestResponses: "+a.length),v(n,i,a,e.usertoken,u)})}else $.ajax({url:e.aeWebServicePath+e.ws.getTests,data:{TestIDs:r,MODE:"REVIEW",USERID:n,SAMSID:"12345",UserToken:e.usertoken},success:function(r){var s=o.xml2json(r),a=s.ArrayOfTestReport.TestReport;t.log("No. of TestResponses: "+a.length),v(n,i,a,e.usertoken,u)},error:function(e){t.log("Error in getting test data for testIDs: "+e)},dataType:"xml"})}function v(n,r,i,s,o){t.log("saving data from report WS for reader mobile"),l(),i.length==undefined&&(i=[i]);for(var u=0;u<r.length;u++){var a=i[u].Report.root.TestTakenDataCollection.TestTakenDataEntity.TESTTAKENDATA,f={TestID:r[u].Test.TestID,ReceivedMarks:r[u].Grade.AttainedMark,TestDataXML:a,QuestionDetails:"",TimeTakenInSeconds:r[u].TimeTakenInSeconds,USERID:n,SAMSID:"12345",UserToken:s},c=t.checkLocalStorage();c&&collection1.create({user_id:n,test_id:r[u].Test.TestID,test_name:r[u].Test.TestDescription,test_metadata:f,attempts_taken:r[u].TimesTaken,date:r[u].LastDateTaken,sync_status:!0,max_score:r[u].Grade.AvailableMark,grade:r[u].Grade.GradeText,isbn:e.isbn,data_url:rendererVars.dataUrl,base_url:rendererVars.contentBaseUrl,att_id:"1"})}e.appEnvironment=="Reader"|e.appEnvironment=="ReaderMobile"&&o(collection1.models)}function m(t,n){if(t!=null||""){collection1=new r,collection1.fetch();var i=collection1.where({user_id:t,test_id:n,isbn:e.isbn});_.each(i,function(e){})}}var o=new X2JS;return{syncUserTestData:a,updateSync:u,getAllTestData:c}}),define("core/EnvProcessor",["AppConst","utilities","core/TPComm","core/SyncProcessor"],function(e,t,n,r){function o(){t.showPreloader(),e.module="Renderer";var r=n.getData(document.TPInterfaceConst.DATATYPE_ENVIRONMENT);if(r=="None"){var i=t.getParameterByName("stand_alone");r=i==="true"?"OFP":"HDL"}u(r)}function u(o){e.appEnvironment=o,t.log("AppConst.appEnvironment "+e.appEnvironment);switch(o){case"HDL":s=n.getData(document.TPInterfaceConst.DATATYPE_GET_INITIAL_DATA),rendererVars={testID:t.getParameterByName("testId"),mode:"normal",isPreview:!1,offline:!1,userID:s.userId,samsID:"12345",userToken:s.properties.token,username:s.userName,isbn:s.isbn,dlWebservicePath:s.properties.reportWS,aeWebServicePath:s.properties.assessmentWS,contentBaseUrl:s.widgetDataFolder},e.ws=e.wsSet[0],f(),App.load();break;case"Reader":e.ws=e.wsSet[1],s=n.getData(document.TPInterfaceConst.DATATYPE_GET_INITIAL_DATA),l(function(n){if(n){rendererVars={testID:parseInt(i.testId),mode:"normal",isPreview:!1,offline:!1,userID:s.userId,samsID:"12345",userToken:s.properties.token,username:s.userName,isbn:i.titleISBN,dlWebservicePath:s.properties.reportWS,aeWebServicePath:s.properties.assessmentWS,contentBaseUrl:s.widgetDataFolder+i.relativeURI};if(!i.saveInDL&&i.saveInDL!=undefined){e.appEnvironment=o="Editor",u(o);return}f(),App.load()}else t.log("3pw.json not found!")});break;case"ReaderMobile":e.ws=e.wsSet[1],t.getParameterByName("testid")!=""&&(s.widgetDataFolder="http://localhost/Contents/"+t.getParameterByName("testid")+"/"),s=n.getData(document.TPInterfaceConst.DATATYPE_GET_INITIAL_DATA),l(function(l){if(l){rendererVars={testID:parseInt(i.testId),mode:"normal",isPreview:!1,offline:!1,userID:s.userId,samsID:"12345",userToken:s.properties.token,reportToken:s.properties.reportToken,username:s.userName,isbn:i.titleISBN,dlwebservicePath:s.properties.reportWS,aeWebServicePath:s.properties.assessmentWS,contentBaseUrl:s.widgetDataFolder+i.relativeURI};if(!i.saveInDL&&i.saveInDL!=undefined){e.appEnvironment=o="Editor",u(o);return}var c=n.getData(document.TPInterfaceConst.DATATYPE_NETWORK_STATUS);rendererVars.offline=c.status?!1:!0;var h=s.widgetDataFolder+i.relativeURI+"/"+i.jsPath;h!=undefined?a(h,function(){f(),e.OFFLINE==0&&e.mode.toLowerCase()!="review"?r.syncUserTestData(e.userid,function(){t.log("Syncing TestData for user:"+e.userid),App.load()}):App.load()}):t.log("Error in loading XML Data")}else t.log("3pw.json not found!")});break;case"Editor":s=n.getData(document.TPInterfaceConst.DATATYPE_GET_INITIAL_DATA),t.log(s),l(function(e){if(e){rendererVars={testID:parseInt(i.testId),mode:"PREVIEW",isPreview:!0,offline:!0,userID:s.userId,samsID:"12345",userToken:s.properties.token,username:s.userName,isbn:i.titleISBN,dlWebservicePath:s.properties.reportWS,aeWebServicePath:s.properties.assessmentWS,contentBaseUrl:s.widgetDataFolder+i.relativeURI},f();var n=s.widgetDataFolder+i.relativeURI+"/"+i.jsPath;n!=undefined?a(n,function(){f(),App.load()}):t.log("Error in loading XML Data")}else t.log("3pw.json not found!")}),e.ws=e.wsSet[1];break;case"OFP":rendererVars={mode:"",isPreview:!0,offline:!0,relativePath:"",dlWebservicePath:"",aeWebServicePath:"",contentBaseUrl:""},rendererVars.userID=t.getParameterByName("userid"),rendererVars.mode=t.getParameterByName("mode"),rendererVars.contentBaseUrl=t.getParameterByName("contentBaseUrl"),rendererVars.isbn=t.getParameterByName("ISBN"),rendererVars.dataUrl=t.getParameterByName("test_data_url");var c,h=t.getParameterByName("test_data_url");t.log("xmlPath for offline mode: "+h),h!=undefined?a(h,function(){f(),App.load()}):t.log("Error in loading XML Data");break;default:t.log("default environment")}}function a(e,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){if(n.readyState=="loaded"||n.readyState=="complete")n.onreadystatechange=null,t()}:n.onload=function(){t()},n.src=e,n.innerHTML=null,document.head.appendChild(n)}function f(){rendererVars!=undefined&&(rendererVars.mode=t.getParameterByName("mode")!=""?t.getParameterByName("mode"):rendererVars.mode,rendererVars.testID=t.getParameterByName("testid")!=""?t.getParameterByName("testid"):rendererVars.testID,e.OFFLINE=rendererVars.offline,e.testid=rendererVars.testID?rendererVars.testID:e.testID,e.mode=rendererVars.mode?rendererVars.mode:e.mode,e.userid=rendererVars.userID?rendererVars.userID:e.userID,e.samsid=rendererVars.samsID?rendererVars.samsID:e.samsID,e.usertoken=rendererVars.userToken?rendererVars.userToken:e.userToken,e.username=rendererVars.username?decodeURIComponent(rendererVars.username):decodeURIComponent(e.username),e.dlWebservicePath=rendererVars.dlwebservicePath?rendererVars.dlwebservicePath:e.dlWebservicePath,e.aeWebServicePath=rendererVars.aeWebServicePath?rendererVars.aeWebServicePath:e.aeWebServicePath,e.dlAuthorizationServiceURL=rendererVars.dlAuthorizationServiceURL?rendererVars.dlAuthorizationServiceURL:e.dlAuthorizationServiceURL,e.ASSETS_PATH=rendererVars.contentBaseUrl?rendererVars.contentBaseUrl:e.ASSETS_PATH,e.siteURL=rendererVars.siteURL?rendererVars.siteURL:e.siteURL,e.OFFLINE_PATH=rendererVars.relativePath,e.launchID=rendererVars.launchID,e.timetakeninseconds=rendererVars.timeTakenInSeconds?rendererVars.timeTakenInSeconds:e.timeTakenInSeconds,e.isbn=rendererVars.isbn?rendererVars.isbn:e.isbn,e.reportToken=rendererVars.reportToken?rendererVars.reportToken:e.reportToken),e.OFFLINE?e.OFFLINE_PATH=rendererVars.relativePath:e.OFFLINE_PATH=""}function l(e){$.ajax({url:s.widgetDataFolder+"/3pw.json",dataType:"JSON",success:function(n){t.log("3pw data loaded."),i=n,e(!0)},error:function(n){t.log("Error in loading 3pw data: "+n.status),e(!1)}})}var i,s;return{config:o,setEnvParams:u}}),define("APIConsumer",["core/AssessmentEngine","language","AppConst","AppEvent","utilities","core/model/welcomeScreenVO","core/view/welcomeScreenView","core/QTIProcessor","A1","core/model/localStorageDataVO","core/collections/testRecordCollection","core/SyncProcessor","core/EnvProcessor","core/TPComm"],function(objAE,language,AppConst,AppEvent,utils,welcomeScreenVO,welcomeScreenView,QTIProcessor,A1,localStorageDataVO,testRecordCollection,SyncProcessor,EnvProcessor,TPComm){function assessmentInitiated(){utils.log("APIConsumer.js: assessment Init done"),AppConst.launchID&&(quesID=AppConst.launchID,AppConst.launchID=""),objAE.start(quesID,responseData),quesID="",config.Mode.toLowerCase()==="test"&&(startTime=new Date)}function questionDataFetched(e){utils.log("C: question data done ",e);var t="",n={};for(var r in packs.pack)utils.log("----pack id----",packs.pack[r].id),packs.pack[r].id==e.toString()&&(t=packs.pack[r],utils.log("----questiondata-----",JSON.stringify(t)));responseData!=null&&(utils.log("Passing response: ",responseData[e.toString()]),n=_.findWhere(responseData,{id:e.toString()})),objAE.setQuestionData(t,n)}function saveResponse(e,t){utils.log("C: question Evaluated done -- ",e,t);if(t!=undefined&&_.size(t)!=0){for(var n=0;n<responseData.length;n++)if(responseData[n].id==e){responseData[n]=t;break}}else for(var n=0;n<responseData.length;n++)if(responseData[n].id==e){responseData[n]={id:e};break}utils.log("responsedate: ",responseData)}function assessmentCompleted(e,t){if(clickCheck==0){clickCheck=!0;if(config.Mode.toLowerCase()==="test"){var n=new Date,r=n-startTime;r/=1e3,AppConst.timetakeninseconds=""+Math.round(r);var i=Math.round(r%60);r=Math.floor(r/60);var s=Math.round(r%60);r=Math.floor(r/60);var o=Math.round(r%24);r=Math.floor(r/24);var u=r;o<10?o="0"+o:o,s<10?s="0"+s:s,i<10?i="0"+i:i,timeTaken=o+":"+s+":"+i,utils.log("time taken: "+timeTaken)}var a=[];t==undefined&&(t=responseData);for(var f=0;f<questionIds.length;f++){var l=questionIds[f],c="";testData.testTakenDataCollection.length>0?(c=testData.testTakenDataCollection[f].title,c==undefined&&(c=testData.testTakenDataCollection[f].name)):c=packs.pack[f].title,a[f]={id:l,title:c,feedback:packs.pack[f].feedbacks,responseData:_.findWhere(responseData,{id:l}),maxScore:packs.pack[f].maxpoints,type:packs.pack[f].type,topics:packs.pack[f].topics}}e.timeTaken=AppConst.timetakeninseconds,e.resultData=a,e.testMarkScheme=testData.testMarkScheme,e.testFeedbackData=testData.testFeedbackData,utils.log("resultObj ::::",JSON.stringify(e));var h=QTIProcessor.deserializeUserResponse(a,testData.questionCollection);utils.log(h);if(config.Mode.toLowerCase()=="test"&&isPreview==0&&AppConst.appEnvironment=="Reader"|AppConst.appEnvironment=="ReaderMobile"|AppConst.appEnvironment=="HDL"){var p=TPComm.getData(document.TPInterfaceConst.DATATYPE_NETWORK_STATUS);AppConst.OFFLINE=p.status?!1:!0,utils.log("NETWORK STATUS BEFORE SAVETESTDETAILSBYID --> AppConst.OFFLINE: "+AppConst.OFFLINE+"& isOnline.status: "+p.status),AppConst.appEnvironment=="ReaderMobile"&&AppConst.OFFLINE==0||AppConst.appEnvironment=="Reader"|AppConst.appEnvironment=="HDL"?(AppConst.appEnvironment=="ReaderMobile"&&(utils.log("--- saving test attempted data to local storage for reader mobile"),saveTest(h)),QTIProcessor.postDataToDL(h,function(t){t?(objAE.showResult(e),$("#offlinePopup").css({display:"none"}),$("#timerSpan").html("Time Taken - "+timeTaken),utils.hidePreloader(),clickCheck=!1):($("#timerSpan").html(""),utils.hidePreloader(),alert("Error : Not able to save test."),clickCheck=!1)})):(saveTest(h),clickCheck=!1,objAE.showResult(e),$("#offlinePopup").css({display:"block"}),$("#timerSpan").html("Time Taken - "+timeTaken),utils.hidePreloader())}else{clickCheck=!1,objAE.showResult(e);if(AppConst.OFFLINE==1){var d=AppConst.appEnvironment=="OFP"?"none":"block";$("#offlinePopup").css({display:d}),utils.log("Environment: "+AppConst.appEnvironment+" & offline notifier display:"+d)}AppConst.mode.toLowerCase()=="review"?(AppConst.appEnvironment=="ReaderMobile"&&!AppConst.OFFLINE&&saveTest(h,!0),AppConst.timetakeninseconds==undefined?$("#timerSpan").empty():($("#timerSpan").html("Time Taken - "+AppConst.timetakeninseconds),utils.log("in else"))):(config.Mode.toLowerCase()=="test"&&saveTest(h),$("#timerSpan").html("Time Taken - "+timeTaken)),utils.hidePreloader()}}else utils.log("Only Single Click allowed!")}function saveTest(e,t){var n=0;for(var r=0;r<JSON.parse(e.TestDataXML).length;r++)n+=parseInt(JSON.parse(e.TestDataXML)[r].maxscore);var i=new Date,s=i.toString().split(" ");s[2]=""+parseInt(s[2]);switch(s[2]){case"1":case"01":case"21":case"31":s[2]=s[2].concat("st");break;case"2":case"02":case"22":s[2]=s[2].concat("nd");break;case"3":case"03":case"23":s[2]=s[2].concat("rd");break;default:s[2]=s[2].concat("th")}var o=s[2]+" "+s[1]+" "+s[3],u=window.grade==""||window.grade==undefined?"-":window.grade;collection1=new testRecordCollection,collection1.fetch();var a=collection1.where({user_id:AppConst.userid,test_id:AppConst.testid,isbn:AppConst.isbn});utils.log(a);var f,l,c;utils.log(e);if(a.length===0)f="1",l="1";else{var h=utils.getLatestTestData(a),p=h.get("attempts_taken"),c=h.get("att_id");l=parseInt(c)+1,f=parseInt(p)+1}t==undefined?t=AppConst.appEnvironment=="ReaderMobile"&&AppConst.OFFLINE==0?!0:!1:(utils.log("----- For ReaderMobile review"),f!="1"&&(l=parseInt(l)-1,f=parseInt(f)-1),_.chain(a).clone().each(function(e){e.destroy()}));var d=utils.checkLocalStorage();d&&collection1.create({user_id:AppConst.userid,test_id:AppConst.testid,test_name:testData.testMetaData.testName,test_metadata:e,date:o,attempts_taken:f,sync_status:t,max_score:n,grade:u,isbn:AppConst.isbn,data_url:rendererVars.dataUrl,base_url:rendererVars.contentBaseUrl,att_id:l})}function continuePractise(e){utils.log("continuePractise id:: ",e),quesID=e,objAE.init({Mode:"Practise",ContainerEL:"#screens",QuestionIds:questionIds})}function continueTest(e){utils.log("continueTest id:: ",e),quesID=e,objAE.init({Mode:"Test",ContainerEL:"#screens",QuestionIds:questionIds})}function onReview(e){quesID=e,config.Mode="Review",objAE.init(config,uiconfig),utils.log("in review")}function StarTest(){config.Mode="Test",objAE.init(config,uiconfig)}function quitResult(){alert("quitResult"),objAE.destroy()}function initialize(){window.revBtn="hidden",EnvProcessor.config()}function loadApp(){AppConst.IS_PHONE=screen.width<768?!0:!1,handleOrientation(),navigator.userAgent.toLowerCase().indexOf("msie 9")>-1&&$("html").addClass("ie9"),AppConst.mode&&AppConst.mode.toLowerCase()=="review"&&(config.Mode="Review"),AppConst.mode&&AppConst.mode.toLowerCase()=="preview"&&(config.Mode="Test"),window.addEventListener("orientationchange",handleOrientation,!1),utils.checkDevice(),SCROLL_Y=0,DEVICE_IPAD="ipad",DEVICE_ANDROID_TAB="DEVICE_ANDROID_TAB",DEVICE_TYPE=DEVICE_ANDROID_TAB,origHeight=window.innerHeight,origWidth=window.innerWidth,landscapeMode=origWidth>origHeight?!0:!1,keyboardOpen=!1,window.onresize=function(e){handleWindowResize()},$(QTIProcessor).unbind("onSerialize").bind("onSerialize",onTestDataSerialized);var e=utils.getSpecificQueryStringValues("filename");utils.log("AppConst before review check: ",AppConst);if(AppConst.testid!=""&&AppConst.OFFLINE!=1){var t=utils.getWebServiceParams();utils.log("Review Check for Environment: "+AppConst.appEnvironment),AppConst.appEnvironment=="Reader"|AppConst.appEnvironment=="ReaderMobile"&&(t.mode="review",utils.log("mode override for review button")),QTIProcessor.getXml(t)}else if(e!=undefined&&e!=""){isPreview=!0;var n=utils.getAllQueryStringValues();utils.setWebServiceParams(n),QTIProcessor.serialize(e)}else{var r=decodeURIComponent(xmlData.replace(/<br \/>/g,"\n"));QTIProcessor.offlineSerialize(r)}AppConst.mode&&AppConst.mode.toLowerCase()=="review"&&(config.Mode="Review"),AppConst.mode&&AppConst.mode.toLowerCase()=="preview"&&(config.Mode="Test",isPreview=!0)}function handleOrientation(){_.delay(function(){if(utils.isDesktopBrowser())return;var e=window.innerHeight>=window.innerWidth?"portrait":"landscape",t=AppConst.IS_PHONE;t?e=="landscape"?_.delay(function(){$("body").find("input").blur(),$("body").find("div[contenteditable='true']").blur(),$("#orientation-popup-text").html("Please use your device in portrait mode only."),$(".orientation-popup").css("display","block"),$(".overlay").show()},500):($(".orientation-popup").css("display","none"),$(".overlay").hide()):e=="landscape"?($(".orientation-popup").css("display","none"),$(".overlay").hide()):_.delay(function(){$("body").find("input").blur(),$("body").find("div[contenteditable='true']").blur(),$("#orientation-popup-text").html("Please use your device in landscape mode only."),$(".orientation-popup").css("display","block"),$(".overlay").show()},500)},500)}function onTestDataSerialized(e,t){testData=t,packs.pack=testData.questionCollection,testData.testTakenDataCollection.length!=0&&config.Mode=="Review"?responseData=testData.testTakenDataCollection:window.revBtn=="visible"?responseDataTemp=testData.testTakenDataCollection:responseData=[],utils.resourcePath=testData.testMetaData.resourcePath,AppConst.TEST_NAME=testData.testMetaData.title;if(config.Mode=="Review"){initiateAssessmentEngine("Review");return}curScreen.VO=new welcomeScreenVO(testData.testMetaData),curScreen.view=new welcomeScreenView({model:curScreen.VO}),curScreen.view.el=$("#screens"),window.curScreen=curScreen,curScreen.view.render(),utils.hidePreloader(),curScreen.view.bind(AppEvent.START_TEST,initiateAssessmentEngine)}function destroyWelcomeScreen(){curScreen.view!=undefined&&curScreen.view.destroy()}function initiateAssessmentEngine(mode){objAE.bind("assessmentInitiated",assessmentInitiated),objAE.bind("getQuestionData",questionDataFetched),objAE.bind("saveResponse",saveResponse),objAE.bind("assessmentCompleted",assessmentCompleted),objAE.bind("continueAssessment",continueTest),objAE.bind("continueTest",continueTest),objAE.bind("reviewAssessment",onReview),objAE.bind("quitResult",quitResult),objAE.bind("destroyWelcomeScreen",destroyWelcomeScreen),utils.log("response ",packs.pack);for(i=0;i<eval("packs.pack").length;i++){var id=eval("packs.pack")[i].id;questionIds.push(id),_.findWhere(responseData,{id:id})==undefined&&responseData.push({id:id})}config={Partial_attempt:!1,partial_test_submission:!1,ContainerEL:"#screens",QuestionIds:questionIds,OrientationSupport:!1},uiconfig={Header:{title:{text:testData.testMetaData.testName},colorCode:testData.testMetaData.colorCode,coverImage:testData.testMetaData.coverImage}},mode=="Review"?(objAE.setConfiguration(config,uiconfig),assessmentCompleted([],responseData)):(mode.toLowerCase()=="preview"&&(mode="Test",isPreview=!0),StarTest()),utils.log("questionIds ::: ",questionIds)}function handleWindowResize(){window.innerWidth!=origWidth&&(landscapeMode=window.innerWidth>window.innerHeight?!0:!1,origHeight=window.innerHeight,origWidth=window.innerWidth),window.innerHeight<origHeight?keyboardOpen=!0:(origHeight=window.innerHeight,keyboardOpen=!1),keyboardOpen?$("#footer").css("visibility","hidden"):$("#footer").css("visibility","visible"),objAE.onWindowResize()}function gotoReview(){AppConst.mode="Review";if(AppConst.appEnvironment=="ReaderMobile"){var e=TPComm.getData(document.TPInterfaceConst.DATATYPE_NETWORK_STATUS);AppConst.OFFLINE=e.status?!1:!0}responseData=responseDataTemp,initiateAssessmentEngine("Review")}var quesID=null,questionIds=[],testFeedbackData=[],testData=[],curScreen={},config={Mode:""},uiconfig={},isPreview=!1,clickCheck=!1,responseData=[];return{init:initialize,load:loadApp,gotoReview:gotoReview,saveTest:saveTest}}),window.XDomainRequest&&jQuery.ajaxTransport(function(e){if(e.crossDomain&&e.async){e.timeout&&(e.xdrTimeout=e.timeout,delete e.timeout);var t;return{send:function(n,r){function i(e,n,i,s){t.onload=t.onerror=t.ontimeout=jQuery.noop,t=undefined,r(e,n,i,s)}t=new XDomainRequest,t.onload=function(){i(200,"OK",{text:t.responseText},"Content-Type: "+t.contentType)},t.onerror=function(){i(404,"Not Found")},t.onprogress=jQuery.noop,t.ontimeout=function(){i(0,"timeout")},t.timeout=e.xdrTimeout||Number.MAX_VALUE,t.open(e.type,e.url),t.send(e.hasContent&&e.data||null)},abort:function(){t&&(t.onerror=jQuery.noop,t.abort())}}}}),define("xdomainrequest",function(){}),define("core/model/reportCardViewVO",["backbone"],function(e){var t=e.Model.extend({initialize:function(){},defaults:{testName:"test1",lastTaken:new Date,grade:"D",Score:"0"}});return t}),define("core/collections/reportCardViewCollection",["backbone","core/model/reportCardViewVO"],function(e,t){var n=e.Collection.extend({initialize:function(){this.listenTo(event_bus,"doSorting",this.defineComparator)},model:t,defineComparator:function(e){switch(e){case"testName":this.comparator=function(e){return e.get("test_id")};break;case"grade":this.comparator=function(e){};break;case"Score":this.comparator=function(e){return e.get("test_metadata").ReceivedMarks};break;case"lastTaken":this.comparator=function(e){};case"-testName":this.comparator=function(e){var t=e.get("test_id");return t=t.toLowerCase(),t=t.split(""),t=_.map(t,function(e){return String.fromCharCode(-e.charCodeAt(0))}),t};break;case"-grade":this.comparator=function(e){};break;case"-Score":this.comparator=function(e){return-e.get("test_metadata").ReceivedMarks};break;case"-lastTaken":this.comparator=function(e){}}}});return n}),function(e){e.color={},e.color.make=function(t,n,r,i){var s={};return s.r=t||0,s.g=n||0,s.b=r||0,s.a=i!=null?i:1,s.add=function(e,t){for(var n=0;n<e.length;++n)s[e.charAt(n)]+=t;return s.normalize()},s.scale=function(e,t){for(var n=0;n<e.length;++n)s[e.charAt(n)]*=t;return s.normalize()},s.toString=function(){return s.a>=1?"rgb("+[s.r,s.g,s.b].join(",")+")":"rgba("+[s.r,s.g,s.b,s.a].join(",")+")"},s.normalize=function(){function e(e,t,n){return t<e?e:t>n?n:t}return s.r=e(0,parseInt(s.r),255),s.g=e(0,parseInt(s.g),255),s.b=e(0,parseInt(s.b),255),s.a=e(0,s.a,1),s},s.clone=function(){return e.color.make(s.r,s.b,s.g,s.a)},s.normalize()},e.color.extract=function(t,n){var r;do{r=t.css(n).toLowerCase();if(r!=""&&r!="transparent")break;t=t.parent()}while(t.length&&!e.nodeName(t.get(0),"body"));return r=="rgba(0, 0, 0, 0)"&&(r="transparent"),e.color.parse(r)},e.color.parse=function(n){var r,i=e.color.make;if(r=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n))return i(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10));if(r=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return i(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10),parseFloat(r[4]));if(r=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n))return i(parseFloat(r[1])*2.55,parseFloat(r[2])*2.55,parseFloat(r[3])*2.55);if(r=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return i(parseFloat(r[1])*2.55,parseFloat(r[2])*2.55,parseFloat(r[3])*2.55,parseFloat(r[4]));if(r=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n))return i(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16));if(r=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n))return i(parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16));var s=e.trim(n).toLowerCase();return s=="transparent"?i(255,255,255,0):(r=t[s]||[0,0,0],i(r[0],r[1],r[2]))};var t={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(e){function n(t,n){var r=n.children("."+t)[0];if(r==null){r=document.createElement("canvas"),r.className=t,e(r).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(n);if(!r.getContext){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");r=window.G_vmlCanvasManager.initElement(r)}}this.element=r;var i=this.context=r.getContext("2d"),s=window.devicePixelRatio||1,o=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1;this.pixelRatio=s/o,this.resize(n.width(),n.height()),this.textContainer=null,this.text={},this._textCache={}}function r(t,r,s,o){function E(e,t){t=[w].concat(t);for(var n=0;n<e.length;++n)e[n].apply(this,t)}function S(){var t={Canvas:n};for(var r=0;r<o.length;++r){var i=o[r];i.init(w,t),i.options&&e.extend(!0,a,i.options)}}function x(n){e.extend(!0,a,n),n&&n.colors&&(a.colors=n.colors),a.xaxis.color==null&&(a.xaxis.color=e.color.parse(a.grid.color).scale("a",.22).toString()),a.yaxis.color==null&&(a.yaxis.color=e.color.parse(a.grid.color).scale("a",.22).toString()),a.xaxis.tickColor==null&&(a.xaxis.tickColor=a.grid.tickColor||a.xaxis.color),a.yaxis.tickColor==null&&(a.yaxis.tickColor=a.grid.tickColor||a.yaxis.color),a.grid.borderColor==null&&(a.grid.borderColor=a.grid.color),a.grid.tickColor==null&&(a.grid.tickColor=e.color.parse(a.grid.color).scale("a",.22).toString());var r,i,s,o=t.css("font-size"),u=o?+o.replace("px",""):13,f={style:t.css("font-style"),size:Math.round(.8*u),variant:t.css("font-variant"),weight:t.css("font-weight"),family:t.css("font-family")};s=a.xaxes.length||1;for(r=0;r<s;++r)i=a.xaxes[r],i&&!i.tickColor&&(i.tickColor=i.color),i=e.extend(!0,{},a.xaxis,i),a.xaxes[r]=i,i.font&&(i.font=e.extend({},f,i.font),i.font.color||(i.font.color=i.color),i.font.lineHeight||(i.font.lineHeight=Math.round(i.font.size*1.15)));s=a.yaxes.length||1;for(r=0;r<s;++r)i=a.yaxes[r],i&&!i.tickColor&&(i.tickColor=i.color),i=e.extend(!0,{},a.yaxis,i),a.yaxes[r]=i,i.font&&(i.font=e.extend({},f,i.font),i.font.color||(i.font.color=i.color),i.font.lineHeight||(i.font.lineHeight=Math.round(i.font.size*1.15)));a.xaxis.noTicks&&a.xaxis.ticks==null&&(a.xaxis.ticks=a.xaxis.noTicks),a.yaxis.noTicks&&a.yaxis.ticks==null&&(a.yaxis.ticks=a.yaxis.noTicks),a.x2axis&&(a.xaxes[1]=e.extend(!0,{},a.xaxis,a.x2axis),a.xaxes[1].position="top",a.x2axis.min==null&&(a.xaxes[1].min=null),a.x2axis.max==null&&(a.xaxes[1].max=null)),a.y2axis&&(a.yaxes[1]=e.extend(!0,{},a.yaxis,a.y2axis),a.yaxes[1].position="right",a.y2axis.min==null&&(a.yaxes[1].min=null),a.y2axis.max==null&&(a.yaxes[1].max=null)),a.grid.coloredAreas&&(a.grid.markings=a.grid.coloredAreas),a.grid.coloredAreasColor&&(a.grid.markingsColor=a.grid.coloredAreasColor),a.lines&&e.extend(!0,a.series.lines,a.lines),a.points&&e.extend(!0,a.series.points,a.points),a.bars&&e.extend(!0,a.series.bars,a.bars),a.shadowSize!=null&&(a.series.shadowSize=a.shadowSize),a.highlightColor!=null&&(a.series.highlightColor=a.highlightColor);for(r=0;r<a.xaxes.length;++r)O(d,r+1).options=a.xaxes[r];for(r=0;r<a.yaxes.length;++r)O(v,r+1).options=a.yaxes[r];for(var l in b)a.hooks[l]&&a.hooks[l].length&&(b[l]=b[l].concat(a.hooks[l]));E(b.processOptions,[a])}function T(e){u=N(e),M(),_()}function N(t){var n=[];for(var r=0;r<t.length;++r){var i=e.extend(!0,{},a.series);t[r].data!=null?(i.data=t[r].data,delete t[r].data,e.extend(!0,i,t[r]),t[r].data=i.data):i.data=t[r],n.push(i)}return n}function C(e,t){var n=e[t+"axis"];return typeof n=="object"&&(n=n.n),typeof n!="number"&&(n=1),n}function k(){return e.grep(d.concat(v),function(e){return e})}function L(e){var t={},n,r;for(n=0;n<d.length;++n)r=d[n],r&&r.used&&(t["x"+r.n]=r.c2p(e.left));for(n=0;n<v.length;++n)r=v[n],r&&r.used&&(t["y"+r.n]=r.c2p(e.top));return t.x1!==undefined&&(t.x=t.x1),t.y1!==undefined&&(t.y=t.y1),t}function A(e){var t={},n,r,i;for(n=0;n<d.length;++n){r=d[n];if(r&&r.used){i="x"+r.n,e[i]==null&&r.n==1&&(i="x");if(e[i]!=null){t.left=r.p2c(e[i]);break}}}for(n=0;n<v.length;++n){r=v[n];if(r&&r.used){i="y"+r.n,e[i]==null&&r.n==1&&(i="y");if(e[i]!=null){t.top=r.p2c(e[i]);break}}}return t}function O(t,n){return t[n-1]||(t[n-1]={n:n,direction:t==d?"x":"y",options:e.extend(!0,{},t==d?a.xaxis:a.yaxis)}),t[n-1]}function M(){var t=u.length,n=-1,r;for(r=0;r<u.length;++r){var i=u[r].color;i!=null&&(t--,typeof i=="number"&&i>n&&(n=i))}t<=n&&(t=n+1);var s,o=[],f=a.colors,l=f.length,c=0;for(r=0;r<t;r++)s=e.color.parse(f[r%l]||"#666"),r%l==0&&r&&(c>=0?c<.5?c=-c-.2:c=0:c=-c),o[r]=s.scale("rgb",1+c);var h=0,p;for(r=0;r<u.length;++r){p=u[r],p.color==null?(p.color=o[h].toString(),++h):typeof p.color=="number"&&(p.color=o[p.color].toString());if(p.lines.show==null){var m,g=!0;for(m in p)if(p[m]&&p[m].show){g=!1;break}g&&(p.lines.show=!0)}p.lines.zero==null&&(p.lines.zero=!!p.lines.fill),p.xaxis=O(d,C(p,"x")),p.yaxis=O(v,C(p,"y"))}}function _(){function x(e,t,n){t<e.datamin&&t!=-r&&(e.datamin=t),n>e.datamax&&n!=r&&(e.datamax=n)}var t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=Number.MAX_VALUE,i,s,o,a,f,l,c,h,p,d,v,m,g,y,w,S;e.each(k(),function(e,r){r.datamin=t,r.datamax=n,r.used=!1});for(i=0;i<u.length;++i)l=u[i],l.datapoints={points:[]},E(b.processRawData,[l,l.data,l.datapoints]);for(i=0;i<u.length;++i){l=u[i],w=l.data,S=l.datapoints.format;if(!S){S=[],S.push({x:!0,number:!0,required:!0}),S.push({y:!0,number:!0,required:!0});if(l.bars.show||l.lines.show&&l.lines.fill){var T=!!(l.bars.show&&l.bars.zero||l.lines.show&&l.lines.zero);S.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:T}),l.bars.horizontal&&(delete S[S.length-1].y,S[S.length-1].x=!0)}l.datapoints.format=S}if(l.datapoints.pointsize!=null)continue;l.datapoints.pointsize=S.length,h=l.datapoints.pointsize,c=l.datapoints.points;var N=l.lines.show&&l.lines.steps;l.xaxis.used=l.yaxis.used=!0;for(s=o=0;s<w.length;++s,o+=h){y=w[s];var C=y==null;if(!C)for(a=0;a<h;++a)m=y[a],g=S[a],g&&(g.number&&m!=null&&(m=+m,isNaN(m)?m=null:m==Infinity?m=r:m==-Infinity&&(m=-r)),m==null&&(g.required&&(C=!0),g.defaultValue!=null&&(m=g.defaultValue))),c[o+a]=m;if(C)for(a=0;a<h;++a)m=c[o+a],m!=null&&(g=S[a],g.autoscale!==!1&&(g.x&&x(l.xaxis,m,m),g.y&&x(l.yaxis,m,m))),c[o+a]=null;else if(N&&o>0&&c[o-h]!=null&&c[o-h]!=c[o]&&c[o-h+1]!=c[o+1]){for(a=0;a<h;++a)c[o+h+a]=c[o+a];c[o+1]=c[o-h+1],o+=h}}}for(i=0;i<u.length;++i)l=u[i],E(b.processDatapoints,[l,l.datapoints]);for(i=0;i<u.length;++i){l=u[i],c=l.datapoints.points,h=l.datapoints.pointsize,S=l.datapoints.format;var L=t,A=t,O=n,M=n;for(s=0;s<c.length;s+=h){if(c[s]==null)continue;for(a=0;a<h;++a){m=c[s+a],g=S[a];if(!g||g.autoscale===!1||m==r||m==-r)continue;g.x&&(m<L&&(L=m),m>O&&(O=m)),g.y&&(m<A&&(A=m),m>M&&(M=m))}}if(l.bars.show){var _;switch(l.bars.align){case"left":_=0;break;case"right":_=-l.bars.barWidth;break;default:_=-l.bars.barWidth/2}l.bars.horizontal?(A+=_,M+=_+l.bars.barWidth):(L+=_,O+=_+l.bars.barWidth)}x(l.xaxis,L,O),x(l.yaxis,A,M)}e.each(k(),function(e,r){r.datamin==t&&(r.datamin=null),r.datamax==n&&(r.datamax=null)})}function D(){t.css("padding",0).children().filter(function(){return!e(this).hasClass("flot-overlay")&&!e(this).hasClass("flot-base")}).remove(),t.css("position")=="static"&&t.css("position","relative"),f=new n("flot-base",t),l=new n("flot-overlay",t),h=f.context,p=l.context,c=e(l.element).unbind();var r=t.data("plot");r&&(r.shutdown(),l.clear()),t.data("plot",w)}function P(){a.grid.hoverable&&(c.mousemove(at),c.bind("mouseleave",ft)),a.grid.clickable&&c.click(lt),E(b.bindEvents,[c])}function H(){ot&&clearTimeout(ot),c.unbind("mousemove",at),c.unbind("mouseleave",ft),c.unbind("click",lt),E(b.shutdown,[c])}function B(e){function t(e){return e}var n,r,i=e.options.transform||t,s=e.options.inverseTransform;e.direction=="x"?(n=e.scale=g/Math.abs(i(e.max)-i(e.min)),r=Math.min(i(e.max),i(e.min))):(n=e.scale=y/Math.abs(i(e.max)-i(e.min)),n=-n,r=Math.max(i(e.max),i(e.min))),i==t?e.p2c=function(e){return(e-r)*n}:e.p2c=function(e){return(i(e)-r)*n},s?e.c2p=function(e){return s(r+e/n)}:e.c2p=function(e){return r+e/n}}function j(e){var t=e.options,n=e.ticks||[],r=t.labelWidth||0,i=t.labelHeight||0,s=r||(e.direction=="x"?Math.floor(f.width/(n.length||1)):null),o=e.direction+"Axis "+e.direction+e.n+"Axis",u="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+o,a=t.font||"flot-tick-label tickLabel";for(var l=0;l<n.length;++l){var c=n[l];if(!c.label)continue;var h=f.getTextInfo(u,c.label,a,null,s);r=Math.max(r,h.width),i=Math.max(i,h.height)}e.labelWidth=t.labelWidth||r,e.labelHeight=t.labelHeight||i}function F(t){var n=t.labelWidth,r=t.labelHeight,i=t.options.position,s=t.direction==="x",o=t.options.tickLength,u=a.grid.axisMargin,l=a.grid.labelMargin,c=!0,h=!0,p=!0,g=!1;e.each(s?d:v,function(e,n){n&&(n.show||n.reserveSpace)&&(n===t?g=!0:n.options.position===i&&(g?h=!1:c=!1),g||(p=!1))}),h&&(u=0),o==null&&(o=p?"full":5),isNaN(+o)||(l+=+o),s?(r+=l,i=="bottom"?(m.bottom+=r+u,t.box={top:f.height-m.bottom,height:r}):(t.box={top:m.top+u,height:r},m.top+=r+u)):(n+=l,i=="left"?(t.box={left:m.left+u,width:n},m.left+=n+u):(m.right+=n+u,t.box={left:f.width-m.right,width:n})),t.position=i,t.tickLength=o,t.box.padding=l,t.innermost=c}function I(e){e.direction=="x"?(e.box.left=m.left-e.labelWidth/2,e.box.width=f.width-m.left-m.right+e.labelWidth):(e.box.top=m.top-e.labelHeight/2,e.box.height=f.height-m.bottom-m.top+e.labelHeight)}function q(){var t=a.grid.minBorderMargin,n,r;if(t==null){t=0;for(r=0;r<u.length;++r)t=Math.max(t,2*(u[r].points.radius+u[r].points.lineWidth/2))}var i={left:t,right:t,top:t,bottom:t};e.each(k(),function(e,t){t.reserveSpace&&t.ticks&&t.ticks.length&&(t.direction==="x"?(i.left=Math.max(i.left,t.labelWidth/2),i.right=Math.max(i.right,t.labelWidth/2)):(i.bottom=Math.max(i.bottom,t.labelHeight/2),i.top=Math.max(i.top,t.labelHeight/2)))}),m.left=Math.ceil(Math.max(i.left,m.left)),m.right=Math.ceil(Math.max(i.right,m.right)),m.top=Math.ceil(Math.max(i.top,m.top)),m.bottom=Math.ceil(Math.max(i.bottom,m.bottom))}function R(){var t,n=k(),r=a.grid.show;for(var i in m){var s=a.grid.margin||0;m[i]=typeof s=="number"?s:s[i]||0}E(b.processOffset,[m]);for(var i in m)typeof a.grid.borderWidth=="object"?m[i]+=r?a.grid.borderWidth[i]:0:m[i]+=r?a.grid.borderWidth:0;e.each(n,function(e,t){var n=t.options;t.show=n.show==null?t.used:n.show,t.reserveSpace=n.reserveSpace==null?t.show:n.reserveSpace,U(t)});if(r){var o=e.grep(n,function(e){return e.show||e.reserveSpace});e.each(o,function(e,t){z(t),W(t),X(t,t.ticks),j(t)});for(t=o.length-1;t>=0;--t)F(o[t]);q(),e.each(o,function(e,t){I(t)})}g=f.width-m.left-m.right,y=f.height-m.bottom-m.top,e.each(n,function(e,t){B(t)}),r&&G(),it()}function U(e){var t=e.options,n=+(t.min!=null?t.min:e.datamin),r=+(t.max!=null?t.max:e.datamax),i=r-n;if(i==0){var s=r==0?1:.01;t.min==null&&(n-=s);if(t.max==null||t.min!=null)r+=s}else{var o=t.autoscaleMargin;o!=null&&(t.min==null&&(n-=i*o,n<0&&e.datamin!=null&&e.datamin>=0&&(n=0)),t.max==null&&(r+=i*o,r>0&&e.datamax!=null&&e.datamax<=0&&(r=0)))}e.min=n,e.max=r}function z(t){var n=t.options,r;typeof n.ticks=="number"&&n.ticks>0?r=n.ticks:r=.3*Math.sqrt(t.direction=="x"?f.width:f.height);var s=(t.max-t.min)/r,o=-Math.floor(Math.log(s)/Math.LN10),u=n.tickDecimals;u!=null&&o>u&&(o=u);var a=Math.pow(10,-o),l=s/a,c;l<1.5?c=1:l<3?(c=2,l>2.25&&(u==null||o+1<=u)&&(c=2.5,++o)):l<7.5?c=5:c=10,c*=a,n.minTickSize!=null&&c<n.minTickSize&&(c=n.minTickSize),t.delta=s,t.tickDecimals=Math.max(0,u!=null?u:o),t.tickSize=n.tickSize||c;if(n.mode=="time"&&!t.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");t.tickGenerator||(t.tickGenerator=function(e){var t=[],n=i(e.min,e.tickSize),r=0,s=Number.NaN,o;do o=s,s=n+r*e.tickSize,t.push(s),++r;while(s<e.max&&s!=o);return t},t.tickFormatter=function(e,t){var n=t.tickDecimals?Math.pow(10,t.tickDecimals):1,r=""+Math.round(e*n)/n;if(t.tickDecimals!=null){var i=r.indexOf("."),s=i==-1?0:r.length-i-1;if(s<t.tickDecimals)return(s?r:r+".")+(""+n).substr(1,t.tickDecimals-s)}return r}),e.isFunction(n.tickFormatter)&&(t.tickFormatter=function(e,t){return""+n.tickFormatter(e,t)});if(n.alignTicksWithAxis!=null){var h=(t.direction=="x"?d:v)[n.alignTicksWithAxis-1];if(h&&h.used&&h!=t){var p=t.tickGenerator(t);p.length>0&&(n.min==null&&(t.min=Math.min(t.min,p[0])),n.max==null&&p.length>1&&(t.max=Math.max(t.max,p[p.length-1]))),t.tickGenerator=function(e){var t=[],n,r;for(r=0;r<h.ticks.length;++r)n=(h.ticks[r].v-h.min)/(h.max-h.min),n=e.min+n*(e.max-e.min),t.push(n);return t};if(!t.mode&&n.tickDecimals==null){var m=Math.max(0,-Math.floor(Math.log(t.delta)/Math.LN10)+1),g=t.tickGenerator(t);g.length>1&&/\..*0$/.test((g[1]-g[0]).toFixed(m))||(t.tickDecimals=m)}}}}function W(t){var n=t.options.ticks,r=[];n==null||typeof n=="number"&&n>0?r=t.tickGenerator(t):n&&(e.isFunction(n)?r=n(t):r=n);var i,s;t.ticks=[];for(i=0;i<r.length;++i){var o=null,u=r[i];typeof u=="object"?(s=+u[0],u.length>1&&(o=u[1])):s=+u,o==null&&(o=t.tickFormatter(s,t)),isNaN(s)||t.ticks.push({v:s,label:o})}}function X(e,t){e.options.autoscaleMargin&&t.length>0&&(e.options.min==null&&(e.min=Math.min(e.min,t[0].v)),e.options.max==null&&t.length>1&&(e.max=Math.max(e.max,t[t.length-1].v)))}function V(){f.clear(),E(b.drawBackground,[h]);var e=a.grid;e.show&&e.backgroundColor&&K(),e.show&&!e.aboveData&&Q();for(var t=0;t<u.length;++t)E(b.drawSeries,[h,u[t]]),Y(u[t]);E(b.draw,[h]),e.show&&e.aboveData&&Q(),f.render(),ht()}function J(e,t){var n,r,i,s,o=k();for(var u=0;u<o.length;++u){n=o[u];if(n.direction==t){s=t+n.n+"axis",!e[s]&&n.n==1&&(s=t+"axis");if(e[s]){r=e[s].from,i=e[s].to;break}}}e[s]||(n=t=="x"?d[0]:v[0],r=e[t+"1"],i=e[t+"2"]);if(r!=null&&i!=null&&r>i){var a=r;r=i,i=a}return{from:r,to:i,axis:n}}function K(){h.save(),h.translate(m.left,m.top),h.fillStyle=bt(a.grid.backgroundColor,y,0,"rgba(255, 255, 255, 0)"),h.fillRect(0,0,g,y),h.restore()}function Q(){var t,n,r,i;h.save(),h.translate(m.left,m.top);var s=a.grid.markings;if(s){e.isFunction(s)&&(n=w.getAxes(),n.xmin=n.xaxis.min,n.xmax=n.xaxis.max,n.ymin=n.yaxis.min,n.ymax=n.yaxis.max,s=s(n));for(t=0;t<s.length;++t){var o=s[t],u=J(o,"x"),f=J(o,"y");u.from==null&&(u.from=u.axis.min),u.to==null&&(u.to=u.axis.max),f.from==null&&(f.from=f.axis.min),f.to==null&&(f.to=f.axis.max);if(u.to<u.axis.min||u.from>u.axis.max||f.to<f.axis.min||f.from>f.axis.max)continue;u.from=Math.max(u.from,u.axis.min),u.to=Math.min(u.to,u.axis.max),f.from=Math.max(f.from,f.axis.min),f.to=Math.min(f.to,f.axis.max);var l=u.from===u.to,c=f.from===f.to;if(l&&c)continue;u.from=Math.floor(u.axis.p2c(u.from)),u.to=Math.floor(u.axis.p2c(u.to)),f.from=Math.floor(f.axis.p2c(f.from)),f.to=Math.floor(f.axis.p2c(f.to));if(l||c){var p=o.lineWidth||a.grid.markingsLineWidth,d=p%2?.5:0;h.beginPath(),h.strokeStyle=o.color||a.grid.markingsColor,h.lineWidth=p,l?(h.moveTo(u.to+d,f.from),h.lineTo(u.to+d,f.to)):(h.moveTo(u.from,f.to+d),h.lineTo(u.to,f.to+d)),h.stroke()}else h.fillStyle=o.color||a.grid.markingsColor,h.fillRect(u.from,f.to,u.to-u.from,f.from-f.to)}}n=k(),r=a.grid.borderWidth;for(var v=0;v<n.length;++v){var b=n[v],E=b.box,S=b.tickLength,x,T,N,C;if(!b.show||b.ticks.length==0)continue;h.lineWidth=1,b.direction=="x"?(x=0,S=="full"?T=b.position=="top"?0:y:T=E.top-m.top+(b.position=="top"?E.height:0)):(T=0,S=="full"?x=b.position=="left"?0:g:x=E.left-m.left+(b.position=="left"?E.width:0)),b.innermost||(h.strokeStyle=b.options.color,h.beginPath(),N=C=0,b.direction=="x"?N=g+1:C=y+1,h.lineWidth==1&&(b.direction=="x"?T=Math.floor(T)+.5:x=Math.floor(x)+.5),h.moveTo(x,T),h.lineTo(x+N,T+C),h.stroke()),h.strokeStyle=b.options.tickColor,h.beginPath();for(t=0;t<b.ticks.length;++t){var L=b.ticks[t].v;N=C=0;if(isNaN(L)||L<b.min||L>b.max||S=="full"&&(typeof r=="object"&&r[b.position]>0||r>0)&&(L==b.min||L==b.max))continue;b.direction=="x"?(x=b.p2c(L),C=S=="full"?-y:S,b.position=="top"&&(C=-C)):(T=b.p2c(L),N=S=="full"?-g:S,b.position=="left"&&(N=-N)),h.lineWidth==1&&(b.direction=="x"?x=Math.floor(x)+.5:T=Math.floor(T)+.5),h.moveTo(x,T),h.lineTo(x+N,T+C)}h.stroke()}r&&(i=a.grid.borderColor,typeof r=="object"||typeof i=="object"?(typeof r!="object"&&(r={top:r,right:r,bottom:r,left:r}),typeof i!="object"&&(i={top:i,right:i,bottom:i,left:i}),r.top>0&&(h.strokeStyle=i.top,h.lineWidth=r.top,h.beginPath(),h.moveTo(0-r.left,0-r.top/2),h.lineTo(g,0-r.top/2),h.stroke()),r.right>0&&(h.strokeStyle=i.right,h.lineWidth=r.right,h.beginPath(),h.moveTo(g+r.right/2,0-r.top),h.lineTo(g+r.right/2,y),h.stroke()),r.bottom>0&&(h.strokeStyle=i.bottom,h.lineWidth=r.bottom,h.beginPath(),h.moveTo(g+r.right,y+r.bottom/2),h.lineTo(0,y+r.bottom/2),h.stroke()),r.left>0&&(h.strokeStyle=i.left,h.lineWidth=r.left,h.beginPath(),h.moveTo(0-r.left/2,y+r.bottom),h.lineTo(0-r.left/2,0),h.stroke())):(h.lineWidth=r,h.strokeStyle=a.grid.borderColor,h.strokeRect(-r/2,-r/2,g+r,y+r))),h.restore()}function G(){e.each(k(),function(e,t){var n=t.box,r=t.direction+"Axis "+t.direction+t.n+"Axis",i="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+r,s=t.options.font||"flot-tick-label tickLabel",o,u,a,l,c;f.removeText(i);if(!t.show||t.ticks.length==0)return;for(var h=0;h<t.ticks.length;++h){o=t.ticks[h];if(!o.label||o.v<t.min||o.v>t.max)continue;t.direction=="x"?(l="center",u=m.left+t.p2c(o.v),t.position=="bottom"?a=n.top+n.padding:(a=n.top+n.height-n.padding,c="bottom")):(c="middle",a=m.top+t.p2c(o.v),t.position=="left"?(u=n.left+n.width-n.padding,l="right"):u=n.left+n.padding),f.addText(i,u,a,o.label,s,null,null,l,c)}})}function Y(e){e.lines.show&&Z(e),e.bars.show&&nt(e),e.points.show&&et(e)}function Z(e){function t(e,t,n,r,i){var s=e.points,o=e.pointsize,u=null,a=null;h.beginPath();for(var f=o;f<s.length;f+=o){var l=s[f-o],c=s[f-o+1],p=s[f],d=s[f+1];if(l==null||p==null)continue;if(c<=d&&c<i.min){if(d<i.min)continue;l=(i.min-c)/(d-c)*(p-l)+l,c=i.min}else if(d<=c&&d<i.min){if(c<i.min)continue;p=(i.min-c)/(d-c)*(p-l)+l,d=i.min}if(c>=d&&c>i.max){if(d>i.max)continue;l=(i.max-c)/(d-c)*(p-l)+l,c=i.max}else if(d>=c&&d>i.max){if(c>i.max)continue;p=(i.max-c)/(d-c)*(p-l)+l,d=i.max}if(l<=p&&l<r.min){if(p<r.min)continue;c=(r.min-l)/(p-l)*(d-c)+c,l=r.min}else if(p<=l&&p<r.min){if(l<r.min)continue;d=(r.min-l)/(p-l)*(d-c)+c,p=r.min}if(l>=p&&l>r.max){if(p>r.max)continue;c=(r.max-l)/(p-l)*(d-c)+c,l=r.max}else if(p>=l&&p>r.max){if(l>r.max)continue;d=(r.max-l)/(p-l)*(d-c)+c,p=r.max}(l!=u||c!=a)&&h.moveTo(r.p2c(l)+t,i.p2c(c)+n),u=p,a=d,h.lineTo(r.p2c(p)+t,i.p2c(d)+n)}h.stroke()}function n(e,t,n){var r=e.points,i=e.pointsize,s=Math.min(Math.max(0,n.min),n.max),o=0,u,a=!1,f=1,l=0,c=0;for(;;){if(i>0&&o>r.length+i)break;o+=i;var p=r[o-i],d=r[o-i+f],v=r[o],m=r[o+f];if(a){if(i>0&&p!=null&&v==null){c=o,i=-i,f=2;continue}if(i<0&&o==l+i){h.fill(),a=!1,i=-i,f=1,o=l=c+i;continue}}if(p==null||v==null)continue;if(p<=v&&p<t.min){if(v<t.min)continue;d=(t.min-p)/(v-p)*(m-d)+d,p=t.min}else if(v<=p&&v<t.min){if(p<t.min)continue;m=(t.min-p)/(v-p)*(m-d)+d,v=t.min}if(p>=v&&p>t.max){if(v>t.max)continue;d=(t.max-p)/(v-p)*(m-d)+d,p=t.max}else if(v>=p&&v>t.max){if(p>t.max)continue;m=(t.max-p)/(v-p)*(m-d)+d,v=t.max}a||(h.beginPath(),h.moveTo(t.p2c(p),n.p2c(s)),a=!0);if(d>=n.max&&m>=n.max){h.lineTo(t.p2c(p),n.p2c(n.max)),h.lineTo(t.p2c(v),n.p2c(n.max));continue}if(d<=n.min&&m<=n.min){h.lineTo(t.p2c(p),n.p2c(n.min)),h.lineTo(t.p2c(v),n.p2c(n.min));continue}var g=p,y=v;d<=m&&d<n.min&&m>=n.min?(p=(n.min-d)/(m-d)*(v-p)+p,d=n.min):m<=d&&m<n.min&&d>=n.min&&(v=(n.min-d)/(m-d)*(v-p)+p,m=n.min),d>=m&&d>n.max&&m<=n.max?(p=(n.max-d)/(m-d)*(v-p)+p,d=n.max):m>=d&&m>n.max&&d<=n.max&&(v=(n.max-d)/(m-d)*(v-p)+p,m=n.max),p!=g&&h.lineTo(t.p2c(g),n.p2c(d)),h.lineTo(t.p2c(p),n.p2c(d)),h.lineTo(t.p2c(v),n.p2c(m)),v!=y&&(h.lineTo(t.p2c(v),n.p2c(m)),h.lineTo(t.p2c(y),n.p2c(m)))}}h.save(),h.translate(m.left,m.top),h.lineJoin="round";var r=e.lines.lineWidth,i=e.shadowSize;if(r>0&&i>0){h.lineWidth=i,h.strokeStyle="rgba(0,0,0,0.1)";var s=Math.PI/18;t(e.datapoints,Math.sin(s)*(r/2+i/2),Math.cos(s)*(r/2+i/2),e.xaxis,e.yaxis),h.lineWidth=i/2,t(e.datapoints,Math.sin(s)*(r/2+i/4),Math.cos(s)*(r/2+i/4),e.xaxis,e.yaxis)}h.lineWidth=r,h.strokeStyle=e.color;var o=rt(e.lines,e.color,0,y);o&&(h.fillStyle=o,n(e.datapoints,e.xaxis,e.yaxis)),r>0&&t(e.datapoints,0,0,e.xaxis,e.yaxis),h.restore()}function et(e){function t(e,t,n,r,i,s,o,u){var a=e.points,f=e.pointsize;for(var l=0;l<a.length;l+=f){var c=a[l],p=a[l+1];if(c==null||c<s.min||c>s.max||p<o.min||p>o.max)continue;h.beginPath(),c=s.p2c(c),p=o.p2c(p)+r,u=="circle"?h.arc(c,p,t,0,i?Math.PI:Math.PI*2,!1):u(h,c,p,t,i),h.closePath(),n&&(h.fillStyle=n,h.fill()),h.stroke()}}h.save(),h.translate(m.left,m.top);var n=e.points.lineWidth,r=e.shadowSize,i=e.points.radius,s=e.points.symbol;n==0&&(n=1e-4);if(n>0&&r>0){var o=r/2;h.lineWidth=o,h.strokeStyle="rgba(0,0,0,0.1)",t(e.datapoints,i,null,o+o/2,!0,e.xaxis,e.yaxis,s),h.strokeStyle="rgba(0,0,0,0.2)",t(e.datapoints,i,null,o/2,!0,e.xaxis,e.yaxis,s)}h.lineWidth=n,h.strokeStyle=e.color,t(e.datapoints,i,rt(e.points,e.color),0,!1,e.xaxis,e.yaxis,s),h.restore()}function tt(e,t,n,r,i,s,o,u,a,f,l){var c,h,p,d,v,m,g,y,b;f?(y=m=g=!0,v=!1,c=n,h=e,d=t+r,p=t+i,h<c&&(b=h,h=c,c=b,v=!0,m=!1)):(v=m=g=!0,y=!1,c=e+r,h=e+i,p=n,d=t,d<p&&(b=d,d=p,p=b,y=!0,g=!1));if(h<o.min||c>o.max||d<u.min||p>u.max)return;c<o.min&&(c=o.min,v=!1),h>o.max&&(h=o.max,m=!1),p<u.min&&(p=u.min,y=!1),d>u.max&&(d=u.max,g=!1),c=o.p2c(c),p=u.p2c(p),h=o.p2c(h),d=u.p2c(d),s&&(a.fillStyle=s(p,d),a.fillRect(c,d,h-c,p-d)),l>0&&(v||m||g||y)&&(a.beginPath(),a.moveTo(c,p),v?a.lineTo(c,d):a.moveTo(c,d),g?a.lineTo(h,d):a.moveTo(h,d),m?a.lineTo(h,p):a.moveTo(h,p),y?a.lineTo(c,p):a.moveTo(c,p),a.stroke())}function nt(e){function t(t,n,r,i,s,o){var u=t.points,a=t.pointsize;for(var f=0;f<u.length;f+=a){if(u[f]==null)continue;tt(u[f],u[f+1],u[f+2],n,r,i,s,o,h,e.bars.horizontal,e.bars.lineWidth)}}h.save(),h.translate(m.left,m.top),h.lineWidth=e.bars.lineWidth,h.strokeStyle=e.color;var n;switch(e.bars.align){case"left":n=0;break;case"right":n=-e.bars.barWidth;break;default:n=-e.bars.barWidth/2}var r=e.bars.fill?function(t,n){return rt(e.bars,e.color,t,n)}:null;t(e.datapoints,n,n+e.bars.barWidth,r,e.xaxis,e.yaxis),h.restore()}function rt(t,n,r,i){var s=t.fill;if(!s)return null;if(t.fillColor)return bt(t.fillColor,r,i,n);var o=e.color.parse(n);return o.a=typeof s=="number"?s:.4,o.normalize(),o.toString()}function it(){a.legend.container!=null?e(a.legend.container).html(""):t.find(".legend").remove();if(!a.legend.show)return;var n=[],r=[],i=!1,s=a.legend.labelFormatter,o,f;for(var l=0;l<u.length;++l)o=u[l],o.label&&(f=s?s(o.label,o):o.label,f&&r.push({label:f,color:o.color}));if(a.legend.sorted)if(e.isFunction(a.legend.sorted))r.sort(a.legend.sorted);else if(a.legend.sorted=="reverse")r.reverse();else{var c=a.legend.sorted!="descending";r.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=c?1:-1})}for(var l=0;l<r.length;++l){var h=r[l];l%a.legend.noColumns==0&&(i&&n.push("</tr>"),n.push("<tr>"),i=!0),n.push('<td class="legendColorBox"><div style="border:1px solid '+a.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+h.color+';overflow:hidden"></div></div></td>'+'<td class="legendLabel">'+h.label+"</td>")}i&&n.push("</tr>");if(n.length==0)return;var p='<table style="font-size:smaller;color:'+a.grid.color+'">'+n.join("")+"</table>";if(a.legend.container!=null)e(a.legend.container).html(p);else{var d="",v=a.legend.position,g=a.legend.margin;g[0]==null&&(g=[g,g]),v.charAt(0)=="n"?d+="top:"+(g[1]+m.top)+"px;":v.charAt(0)=="s"&&(d+="bottom:"+(g[1]+m.bottom)+"px;"),v.charAt(1)=="e"?d+="right:"+(g[0]+m.right)+"px;":v.charAt(1)=="w"&&(d+="left:"+(g[0]+m.left)+"px;");var y=e('<div class="legend">'+p.replace('style="','style="position:absolute;'+d+";")+"</div>").appendTo(t);if(a.legend.backgroundOpacity!=0){var b=a.legend.backgroundColor;b==null&&(b=a.grid.backgroundColor,b&&typeof b=="string"?b=e.color.parse(b):b=e.color.extract(y,"background-color"),b.a=1,b=b.toString());var w=y.children();e('<div style="position:absolute;width:'+w.width()+"px;height:"+w.height()+"px;"+d+"background-color:"+b+';"> </div>').prependTo(y).css("opacity",a.legend.backgroundOpacity)}}}function ut(e,t,n){var r=a.grid.mouseActiveRadius,i=r*r+1,s=null,o=!1,f,l,c;for(f=u.length-1;f>=0;--f){if(!n(u[f]))continue;var h=u[f],p=h.xaxis,d=h.yaxis,v=h.datapoints.points,m=p.c2p(e),g=d.c2p(t),y=r/p.scale,b=r/d.scale;c=h.datapoints.pointsize,p.options.inverseTransform&&(y=Number.MAX_VALUE),d.options.inverseTransform&&(b=Number.MAX_VALUE);if(h.lines.show||h.points.show)for(l=0;l<v.length;l+=c){var w=v[l],E=v[l+1];if(w==null)continue;if(w-m>y||w-m<-y||E-g>b||E-g<-b)continue;var S=Math.abs(p.p2c(w)-e),x=Math.abs(d.p2c(E)-t),T=S*S+x*x;T<i&&(i=T,s=[f,l/c])}if(h.bars.show&&!s){var N,C;switch(h.bars.align){case"left":N=0;break;case"right":N=-h.bars.barWidth;break;default:N=-h.bars.barWidth/2}C=N+h.bars.barWidth;for(l=0;l<v.length;l+=c){var w=v[l],E=v[l+1],k=v[l+2];if(w==null)continue;if(u[f].bars.horizontal?m<=Math.max(k,w)&&m>=Math.min(k,w)&&g>=E+N&&g<=E+C:m>=w+N&&m<=w+C&&g>=Math.min(k,E)&&g<=Math.max(k,E))s=[f,l/c]}}}return s?(f=s[0],l=s[1],c=u[f].datapoints.pointsize,{datapoint:u[f].datapoints.points.slice(l*c,(l+1)*c),dataIndex:l,series:u[f],seriesIndex:f}):null}function at(e){a.grid.hoverable&&ct("plothover",e,function(e){return e["hoverable"]!=0})}function ft(e){a.grid.hoverable&&ct("plothover",e,function(e){return!1})}function lt(e){ct("plotclick",e,function(e){return e["clickable"]!=0})}function ct(e,n,r){var i=c.offset(),s=n.pageX-i.left-m.left,o=n.pageY-i.top-m.top,u=L({left:s,top:o});u.pageX=n.pageX,u.pageY=n.pageY;var f=ut(s,o,r);f&&(f.pageX=parseInt(f.series.xaxis.p2c(f.datapoint[0])+i.left+m.left,10),f.pageY=parseInt(f.series.yaxis.p2c(f.datapoint[1])+i.top+m.top,10));if(a.grid.autoHighlight){for(var l=0;l<st.length;++l){var h=st[l];h.auto==e&&(!f||h.series!=f.series||h.point[0]!=f.datapoint[0]||h.point[1]!=f.datapoint[1])&&vt(h.series,h.point)}f&&dt(f.series,f.datapoint,e)}t.trigger(e,[u,f])}function ht(){var e=a.interaction.redrawOverlayInterval;if(e==-1){pt();return}ot||(ot=setTimeout(pt,e))}function pt(){ot=null,p.save(),l.clear(),p.translate(m.left,m.top);var e,t;for(e=0;e<st.length;++e)t=st[e],t.series.bars.show?yt(t.series,t.point):gt(t.series,t.point);p.restore(),E(b.drawOverlay,[p])}function dt(e,t,n){typeof e=="number"&&(e=u[e]);if(typeof t=="number"){var r=e.datapoints.pointsize;t=e.datapoints.points.slice(r*t,r*(t+1))}var i=mt(e,t);i==-1?(st.push({series:e,point:t,auto:n}),ht()):n||(st[i].auto=!1)}function vt(e,t){if(e==null&&t==null){st=[],ht();return}typeof e=="number"&&(e=u[e]);if(typeof t=="number"){var n=e.datapoints.pointsize;t=e.datapoints.points.slice(n*t,n*(t+1))}var r=mt(e,t);r!=-1&&(st.splice(r,1),ht())}function mt(e,t){for(var n=0;n<st.length;++n){var r=st[n];if(r.series==e&&r.point[0]==t[0]&&r.point[1]==t[1])return n}return-1}function gt(t,n){var r=n[0],i=n[1],s=t.xaxis,o=t.yaxis,u=typeof t.highlightColor=="string"?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString();if(r<s.min||r>s.max||i<o.min||i>o.max)return;var a=t.points.radius+t.points.lineWidth/2;p.lineWidth=a,p.strokeStyle=u;var f=1.5*a;r=s.p2c(r),i=o.p2c(i),p.beginPath(),t.points.symbol=="circle"?p.arc(r,i,f,0,2*Math.PI,!1):t.points.symbol(p,r,i,f,!1),p.closePath(),p.stroke()}function yt(t,n){var r=typeof t.highlightColor=="string"?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString(),i=r,s;switch(t.bars.align){case"left":s=0;break;case"right":s=-t.bars.barWidth;break;default:s=-t.bars.barWidth/2}p.lineWidth=t.bars.lineWidth,p.strokeStyle=r,tt(n[0],n[1],n[2]||0,s,s+t.bars.barWidth,function(){return i},t.xaxis,t.yaxis,p,t.bars.horizontal,t.bars.lineWidth)}function bt(t,n,r,i){if(typeof t=="string")return t;var s=h.createLinearGradient(0,r,0,n);for(var o=0,u=t.colors.length;o<u;++o){var a=t.colors[o];if(typeof a!="string"){var f=e.color.parse(i);a.brightness!=null&&(f=f.scale("rgb",a.brightness)),a.opacity!=null&&(f.a*=a.opacity),a=f.toString()}s.addColorStop(o/(u-1),a)}return s}var u=[],a={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},f=null,l=null,c=null,h=null,p=null,d=[],v=[],m={left:0,right:0,top:0,bottom:0},g=0,y=0,b={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},w=this;w.setData=T,w.setupGrid=R,w.draw=V,w.getPlaceholder=function(){return t},w.getCanvas=function(){return f.element},w.getPlotOffset=function(){return m},w.width=function(){return g},w.height=function(){return y},w.offset=function(){var e=c.offset();return e.left+=m.left,e.top+=m.top,e},w.getData=function(){return u},w.getAxes=function(){var t={},n;return e.each(d.concat(v),function(e,n){n&&(t[n.direction+(n.n!=1?n.n:"")+"axis"]=n)}),t},w.getXAxes=function(){return d},w.getYAxes=function(){return v},w.c2p=L,w.p2c=A,w.getOptions=function(){return a},w.highlight=dt,w.unhighlight=vt,w.triggerRedrawOverlay=ht,w.pointOffset=function(e){return{left:parseInt(d[C(e,"x")-1].p2c(+e.x)+m.left,10),top:parseInt(v[C(e,"y")-1].p2c(+e.y)+m.top,10)}},w.shutdown=H,w.destroy=function(){H(),t.removeData("plot").empty(),u=[],a=null,f=null,l=null,c=null,h=null,p=null,d=[],v=[],b=null,st=[],w=null},w.resize=function(){var e=t.width(),n=t.height();f.resize(e,n),l.resize(e,n)},w.hooks=b,S(w),x(s),D(),T(r),R(),V(),P();var st=[],ot=null}function i(e,t){return t*Math.floor(e/t)}var t=Object.prototype.hasOwnProperty;e.fn.detach||(e.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})}),n.prototype.resize=function(e,t){if(e<=0||t<=0)throw new Error("Invalid dimensions for plot, width = "+e+", height = "+t);var n=this.element,r=this.context,i=this.pixelRatio;this.width!=e&&(n.width=e*i,n.style.width=e+"px",this.width=e),this.height!=t&&(n.height=t*i,n.style.height=t+"px",this.height=t),r.restore(),r.save(),r.scale(i,i)},n.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},n.prototype.render=function(){var e=this._textCache;for(var n in e)if(t.call(e,n)){var r=this.getTextLayer(n),i=e[n];r.hide();for(var s in i)if(t.call(i,s)){var o=i[s];for(var u in o)if(t.call(o,u)){var a=o[u].positions;for(var f=0,l;l=a[f];f++)l.active?l.rendered||(r.append(l.element),l.rendered=!0):(a.splice(f--,1),l.rendered&&l.element.detach());a.length==0&&delete o[u]}}r.show()}},n.prototype.getTextLayer=function(t){var n=this.text[t];return n==null&&(this.textContainer==null&&(this.textContainer=e("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),n=this.text[t]=e("<div></div>").addClass(t).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),n},n.prototype.getTextInfo=function(t,n,r,i,s){var o,u,a,f;n=""+n,typeof r=="object"?o=r.style+" "+r.variant+" "+r.weight+" "+r.size+"px/"+r.lineHeight+"px "+r.family:o=r,u=this._textCache[t],u==null&&(u=this._textCache[t]={}),a=u[o],a==null&&(a=u[o]={}),f=a[n];if(f==null){var l=e("<div></div>").html(n).css({position:"absolute","max-width":s,top:-9999}).appendTo(this.getTextLayer(t));typeof r=="object"?l.css({font:o,color:r.color}):typeof r=="string"&&l.addClass(r),f=a[n]={width:l.outerWidth(!0),height:l.outerHeight(!0),element:l,positions:[]},l.detach()}return f},n.prototype.addText=function(e,t,n,r,i,s,o,u,a){var f=this.getTextInfo(e,r,i,s,o),l=f.positions;u=="center"?t-=f.width/2:u=="right"&&(t-=f.width),a=="middle"?n-=f.height/2:a=="bottom"&&(n-=f.height);for(var c=0,h;h=l[c];c++)if(h.x==t&&h.y==n){h.active=!0;return}h={active:!0,rendered:!1,element:l.length?f.element.clone():f.element,x:t,y:n},l.push(h),h.element.css({top:Math.round(n),left:Math.round(t),"text-align":u})},n.prototype.removeText=function(e,n,r,i,s,o){if(i==null){var u=this._textCache[e];if(u!=null)for(var a in u)if(t.call(u,a)){var f=u[a];for(var l in f)if(t.call(f,l)){var c=f[l].positions;for(var h=0,p;p=c[h];h++)p.active=!1}}}else{var c=this.getTextInfo(e,i,s,o).positions;for(var h=0,p;p=c[h];h++)p.x==n&&p.y==r&&(p.active=!1)}},e.plot=function(t,n,i){var s=new r(e(t),n,i,e.plot.plugins);return s},e.plot.version="0.8.3",e.plot.plugins=[],e.fn.plot=function(t,n){return this.each(function(){e.plot(this,t,n)})}}(jQuery),function(e){function r(r){function p(t,n,r){l||(l=!0,i=t.getCanvas(),s=e(i).parent(),o=t.getOptions(),t.setData(d(t.getData())))}function d(t){var n=0,r=0,i=0,s=o.series.pie.combine.color,u=[];for(var a=0;a<t.length;++a){var f=t[a].data;e.isArray(f)&&f.length==1&&(f=f[0]),e.isArray(f)?!isNaN(parseFloat(f[1]))&&isFinite(f[1])?f[1]=+f[1]:f[1]=0:!isNaN(parseFloat(f))&&isFinite(f)?f=[1,+f]:f=[1,0],t[a].data=[f]}for(var a=0;a<t.length;++a)n+=t[a].data[0][1];for(var a=0;a<t.length;++a){var f=t[a].data[0][1];f/n<=o.series.pie.combine.threshold&&(r+=f,i++,s||(s=t[a].color))}for(var a=0;a<t.length;++a){var f=t[a].data[0][1];(i<2||f/n>o.series.pie.combine.threshold)&&u.push(e.extend(t[a],{data:[[1,f]],color:t[a].color,label:t[a].label,angle:f*Math.PI*2/n,percent:f/(n/100)}))}return i>1&&u.push({data:[[1,r]],color:s,label:o.series.pie.combine.label,angle:r*Math.PI*2/n,percent:r/(n/100)}),u}function v(r,i){function y(){c.clearRect(0,0,h,p),s.children().filter(".pieLabel, .pieLabelBackground").remove()}function b(){var e=o.series.pie.shadow.left,t=o.series.pie.shadow.top,n=10,r=o.series.pie.shadow.alpha,i=o.series.pie.radius>1?o.series.pie.radius:u*o.series.pie.radius;if(i>=h/2-e||i*o.series.pie.tilt>=p/2-t||i<=n)return;c.save(),c.translate(e,t),c.globalAlpha=r,c.fillStyle="#000",c.translate(a,f),c.scale(1,o.series.pie.tilt);for(var s=1;s<=n;s++)c.beginPath(),c.arc(0,0,i,0,Math.PI*2,!1),c.fill(),i-=s;c.restore()}function w(){function l(e,t,i){if(e<=0||isNaN(e))return;i?c.fillStyle=t:(c.strokeStyle=t,c.lineJoin="round"),c.beginPath(),Math.abs(e-Math.PI*2)>1e-9&&c.moveTo(0,0),c.arc(0,0,n,r,r+e/2,!1),c.arc(0,0,n,r+e/2,r+e,!1),c.closePath(),r+=e,i?c.fill():c.stroke()}function d(){function l(t,n,i){if(t.data[0][1]==0)return!0;var u=o.legend.labelFormatter,l,c=o.series.pie.label.formatter;u?l=u(t.label,t):l=t.label,c&&(l=c(l,t));var d=(n+t.angle+n)/2,v=a+Math.round(Math.cos(d)*r),m=f+Math.round(Math.sin(d)*r)*o.series.pie.tilt,g="<span class='pieLabel' id='pieLabel"+i+"' style='position:absolute;top:"+m+"px;left:"+v+"px;'>"+l+"</span>";s.append(g);var y=s.children("#pieLabel"+i),b=m-y.height()/2,w=v-y.width()/2;y.css("top",b),y.css("left",w);if(0-b>0||0-w>0||p-(b+y.height())<0||h-(w+y.width())<0)return!1;if(o.series.pie.label.background.opacity!=0){var E=o.series.pie.label.background.color;E==null&&(E=t.color);var S="top:"+b+"px;left:"+w+"px;";e("<div class='pieLabelBackground' style='position:absolute;width:"+y.width()+"px;height:"+y.height()+"px;"+S+"background-color:"+E+";'></div>").css("opacity",o.series.pie.label.background.opacity).insertBefore(y)}return!0}var n=t,r=o.series.pie.label.radius>1?o.series.pie.label.radius:u*o.series.pie.label.radius;for(var i=0;i<v.length;++i){if(v[i].percent>=o.series.pie.label.threshold*100&&!l(v[i],n,i))return!1;n+=v[i].angle}return!0}var t=Math.PI*o.series.pie.startAngle,n=o.series.pie.radius>1?o.series.pie.radius:u*o.series.pie.radius;c.save(),c.translate(a,f),c.scale(1,o.series.pie.tilt),c.save();var r=t;for(var i=0;i<v.length;++i)v[i].startAngle=r,l(v[i].angle,v[i].color,!0);c.restore();if(o.series.pie.stroke.width>0){c.save(),c.lineWidth=o.series.pie.stroke.width,r=t;for(var i=0;i<v.length;++i)l(v[i].angle,o.series.pie.stroke.color,!1);c.restore()}return m(c),c.restore(),o.series.pie.label.show?d():!0}if(!s)return;var h=r.getPlaceholder().width(),p=r.getPlaceholder().height(),d=s.children().filter(".legend").children().width()||0;c=i,l=!1,u=Math.min(h,p/o.series.pie.tilt)/2,f=p/2+o.series.pie.offset.top,a=h/2,o.series.pie.offset.left=="auto"?(o.legend.position.match("w")?a+=d/2:a-=d/2,a<u?a=u:a>h-u&&(a=h-u)):a+=o.series.pie.offset.left;var v=r.getData(),g=0;do g>0&&(u*=n),g+=1,y(),o.series.pie.tilt<=.8&&b();while(!w()&&g<t);g>=t&&(y(),s.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>")),r.setSeries&&r.insertLegend&&(r.setSeries(v),r.insertLegend())}function m(e){if(o.series.pie.innerRadius>0){e.save();var t=o.series.pie.innerRadius>1?o.series.pie.innerRadius:u*o.series.pie.innerRadius;e.globalCompositeOperation="destination-out",e.beginPath(),e.fillStyle=o.series.pie.stroke.color,e.arc(0,0,t,0,Math.PI*2,!1),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.strokeStyle=o.series.pie.stroke.color,e.arc(0,0,t,0,Math.PI*2,!1),e.stroke(),e.closePath(),e.restore()}}function g(e,t){for(var n=!1,r=-1,i=e.length,s=i-1;++r<i;s=r)(e[r][1]<=t[1]&&t[1]<e[s][1]||e[s][1]<=t[1]&&t[1]<e[r][1])&&t[0]<(e[s][0]-e[r][0])*(t[1]-e[r][1])/(e[s][1]-e[r][1])+e[r][0]&&(n=!n);return n}function y(e,t){var n=r.getData(),i=r.getOptions(),s=i.series.pie.radius>1?i.series.pie.radius:u*i.series.pie.radius,o,l;for(var h=0;h<n.length;++h){var p=n[h];if(p.pie.show){c.save(),c.beginPath(),c.moveTo(0,0),c.arc(0,0,s,p.startAngle,p.startAngle+p.angle/2,!1),c.arc(0,0,s,p.startAngle+p.angle/2,p.startAngle+p.angle,!1),c.closePath(),o=e-a,l=t-f;if(c.isPointInPath){if(c.isPointInPath(e-a,t-f))return c.restore(),{datapoint:[p.percent,p.data],dataIndex:0,series:p,seriesIndex:h}}else{var d=s*Math.cos(p.startAngle),v=s*Math.sin(p.startAngle),m=s*Math.cos(p.startAngle+p.angle/4),y=s*Math.sin(p.startAngle+p.angle/4),b=s*Math.cos(p.startAngle+p.angle/2),w=s*Math.sin(p.startAngle+p.angle/2),E=s*Math.cos(p.startAngle+p.angle/1.5),S=s*Math.sin(p.startAngle+p.angle/1.5),x=s*Math.cos(p.startAngle+p.angle),T=s*Math.sin(p.startAngle+p.angle),N=[[0,0],[d,v],[m,y],[b,w],[E,S],[x,T]],C=[o,l];if(g(N,C))return c.restore(),{datapoint:[p.percent,p.data],dataIndex:0,series:p,seriesIndex:h}}c.restore()}}return null}function b(e){E("plothover",e)}function w(e){E("plotclick",e)}function E(e,t){var n=r.offset(),i=parseInt(t.pageX-n.left),u=parseInt(t.pageY-n.top),a=y(i,u);if(o.grid.autoHighlight)for(var f=0;f<h.length;++f){var l=h[f];l.auto==e&&(!a||l.series!=a.series)&&x(l.series)}a&&S(a.series,e);var c={pageX:t.pageX,pageY:t.pageY};s.trigger(e,[c,a])}function S(e,t){var n=T(e);n==-1?(h.push({series:e,auto:t}),r.triggerRedrawOverlay()):t||(h[n].auto=!1)}function x(e){e==null&&(h=[],r.triggerRedrawOverlay());var t=T(e);t!=-1&&(h.splice(t,1),r.triggerRedrawOverlay())}function T(e){for(var t=0;t<h.length;++t){var n=h[t];if(n.series==e)return t}return-1}function N(e,t){function s(e){if(e.angle<=0||isNaN(e.angle))return;t.fillStyle="rgba(255, 255, 255, "+n.series.pie.highlight.opacity+")",t.beginPath(),Math.abs(e.angle-Math.PI*2)>1e-9&&t.moveTo(0,0),t.arc(0,0,r,e.startAngle,e.startAngle+e.angle/2,!1),t.arc(0,0,r,e.startAngle+e.angle/2,e.startAngle+e.angle,!1),t.closePath(),t.fill()}var n=e.getOptions(),r=n.series.pie.radius>1?n.series.pie.radius:u*n.series.pie.radius;t.save(),t.translate(a,f),t.scale(1,n.series.pie.tilt);for(var i=0;i<h.length;++i)s(h[i].series);m(t),t.restore()}var i=null,s=null,o=null,u=null,a=null,f=null,l=!1,c=null,h=[];r.hooks.processOptions.push(function(e,t){t.series.pie.show&&(t.grid.show=!1,t.series.pie.label.show=="auto"&&(t.legend.show?t.series.pie.label.show=!1:t.series.pie.label.show=!0),t.series.pie.radius=="auto"&&(t.series.pie.label.show?t.series.pie.radius=.75:t.series.pie.radius=1),t.series.pie.tilt>1?t.series.pie.tilt=1:t.series.pie.tilt<0&&(t.series.pie.tilt=0))}),r.hooks.bindEvents.push(function(e,t){var n=e.getOptions();n.series.pie.show&&(n.grid.hoverable&&t.unbind("mousemove").mousemove(b),n.grid.clickable&&t.unbind("click").click(w))}),r.hooks.processDatapoints.push(function(e,t,n,r){var i=e.getOptions();i.series.pie.show&&p(e,t,n,r)}),r.hooks.drawOverlay.push(function(e,t){var n=e.getOptions();n.series.pie.show&&N(e,t)}),r.hooks.draw.push(function(e,t){var n=e.getOptions();n.series.pie.show&&v(e,t)})}var t=10,n=.95,i={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(e,t){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+t.color+";'>"+e+"<br/>"+Math.round(t.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};e.plot.plugins.push({init:r,options:i,name:"pie",version:"1.1"})}(jQuery),define("external/jquery-flot-min.js",function(){}),function(e){function r(r){function p(t,n,r){l||(l=!0,i=t.getCanvas(),s=e(i).parent(),o=t.getOptions(),t.setData(d(t.getData())))}function d(t){var n=0,r=0,i=0,s=o.series.pie.combine.color,u=[];for(var a=0;a<t.length;++a){var f=t[a].data;e.isArray(f)&&f.length==1&&(f=f[0]),e.isArray(f)?!isNaN(parseFloat(f[1]))&&isFinite(f[1])?f[1]=+f[1]:f[1]=0:!isNaN(parseFloat(f))&&isFinite(f)?f=[1,+f]:f=[1,0],t[a].data=[f]}for(var a=0;a<t.length;++a)n+=t[a].data[0][1];for(var a=0;a<t.length;++a){var f=t[a].data[0][1];f/n<=o.series.pie.combine.threshold&&(r+=f,i++,s||(s=t[a].color))}for(var a=0;a<t.length;++a){var f=t[a].data[0][1];(i<2||f/n>o.series.pie.combine.threshold)&&u.push(e.extend(t[a],{data:[[1,f]],color:t[a].color,label:t[a].label,angle:f*Math.PI*2/n,percent:f/(n/100)}))}return i>1&&u.push({data:[[1,r]],color:s,label:o.series.pie.combine.label,angle:r*Math.PI*2/n,percent:r/(n/100)}),u}function v(r,i){function y(){c.clearRect(0,0,h,p),s.children().filter(".pieLabel, .pieLabelBackground").remove()}function b(){var e=o.series.pie.shadow.left,t=o.series.pie.shadow.top,n=10,r=o.series.pie.shadow.alpha,i=o.series.pie.radius>1?o.series.pie.radius:u*o.series.pie.radius;if(i>=h/2-e||i*o.series.pie.tilt>=p/2-t||i<=n)return;c.save(),c.translate(e,t),c.globalAlpha=r,c.fillStyle="#000",c.translate(a,f),c.scale(1,o.series.pie.tilt);for(var s=1;s<=n;s++)c.beginPath(),c.arc(0,0,i,0,Math.PI*2,!1),c.fill(),i-=s;c.restore()}function w(){function l(e,t,i){if(e<=0||isNaN(e))return;i?c.fillStyle=t:(c.strokeStyle=t,c.lineJoin="round"),c.beginPath(),Math.abs(e-Math.PI*2)>1e-9&&c.moveTo(0,0),c.arc(0,0,n,r,r+e/2,!1),c.arc(0,0,n,r+e/2,r+e,!1),c.closePath(),r+=e,i?c.fill():c.stroke()}function d(){function l(t,n,i){if(t.data[0][1]==0)return!0;var u=o.legend.labelFormatter,l,c=o.series.pie.label.formatter;u?l=u(t.label,t):l=t.label,c&&(l=c(l,t));var d=(n+t.angle+n)/2,v=a+Math.round(Math.cos(d)*r),m=f+Math.round(Math.sin(d)*r)*o.series.pie.tilt,g="<span class='pieLabel' id='pieLabel"+i+"' style='position:absolute;top:"+m+"px;left:"+v+"px;'>"+l+"</span>";s.append(g);var y=s.children("#pieLabel"+i),b=m-y.height()/2,w=v-y.width()/2;y.css("top",b),y.css("left",w);if(0-b>0||0-w>0||p-(b+y.height())<0||h-(w+y.width())<0)return!1;if(o.series.pie.label.background.opacity!=0){var E=o.series.pie.label.background.color;E==null&&(E=t.color);var S="top:"+b+"px;left:"+w+"px;";e("<div class='pieLabelBackground' style='position:absolute;width:"+y.width()+"px;height:"+y.height()+"px;"+S+"background-color:"+E+";'></div>").css("opacity",o.series.pie.label.background.opacity).insertBefore(y)}return!0}var n=t,r=o.series.pie.label.radius>1?o.series.pie.label.radius:u*o.series.pie.label.radius;for(var i=0;i<v.length;++i){if(v[i].percent>=o.series.pie.label.threshold*100&&!l(v[i],n,i))return!1;n+=v[i].angle}return!0}var t=Math.PI*o.series.pie.startAngle,n=o.series.pie.radius>1?o.series.pie.radius:u*o.series.pie.radius;c.save(),c.translate(a,f),c.scale(1,o.series.pie.tilt),c.save();var r=t;for(var i=0;i<v.length;++i)v[i].startAngle=r,l(v[i].angle,v[i].color,!0);c.restore();if(o.series.pie.stroke.width>0){c.save(),c.lineWidth=o.series.pie.stroke.width,r=t;for(var i=0;i<v.length;++i)l(v[i].angle,o.series.pie.stroke.color,!1);c.restore()}return m(c),c.restore(),o.series.pie.label.show?d():!0}if(!s)return;var h=r.getPlaceholder().width(),p=r.getPlaceholder().height(),d=s.children().filter(".legend").children().width()||0;c=i,l=!1,u=Math.min(h,p/o.series.pie.tilt)/2,f=p/2+o.series.pie.offset.top,a=h/2,o.series.pie.offset.left=="auto"?(o.legend.position.match("w")?a+=d/2:a-=d/2,a<u?a=u:a>h-u&&(a=h-u)):a+=o.series.pie.offset.left;var v=r.getData(),g=0;do g>0&&(u*=n),g+=1,y(),o.series.pie.tilt<=.8&&b();while(!w()&&g<t);g>=t&&(y(),s.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>")),r.setSeries&&r.insertLegend&&(r.setSeries(v),r.insertLegend())}function m(e){if(o.series.pie.innerRadius>0){e.save();var t=o.series.pie.innerRadius>1?o.series.pie.innerRadius:u*o.series.pie.innerRadius;e.globalCompositeOperation="destination-out",e.beginPath(),e.fillStyle=o.series.pie.stroke.color,e.arc(0,0,t,0,Math.PI*2,!1),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.strokeStyle=o.series.pie.stroke.color,e.arc(0,0,t,0,Math.PI*2,!1),e.stroke(),e.closePath(),e.restore()}}function g(e,t){for(var n=!1,r=-1,i=e.length,s=i-1;++r<i;s=r)(e[r][1]<=t[1]&&t[1]<e[s][1]||e[s][1]<=t[1]&&t[1]<e[r][1])&&t[0]<(e[s][0]-e[r][0])*(t[1]-e[r][1])/(e[s][1]-e[r][1])+e[r][0]&&(n=!n);return n}function y(e,t){var n=r.getData(),i=r.getOptions(),s=i.series.pie.radius>1?i.series.pie.radius:u*i.series.pie.radius,o,l;for(var h=0;h<n.length;++h){var p=n[h];if(p.pie.show){c.save(),c.beginPath(),c.moveTo(0,0),c.arc(0,0,s,p.startAngle,p.startAngle+p.angle/2,!1),c.arc(0,0,s,p.startAngle+p.angle/2,p.startAngle+p.angle,!1),c.closePath(),o=e-a,l=t-f;if(c.isPointInPath){if(c.isPointInPath(e-a,t-f))return c.restore(),{datapoint:[p.percent,p.data],dataIndex:0,series:p,seriesIndex:h}}else{var d=s*Math.cos(p.startAngle),v=s*Math.sin(p.startAngle),m=s*Math.cos(p.startAngle+p.angle/4),y=s*Math.sin(p.startAngle+p.angle/4),b=s*Math.cos(p.startAngle+p.angle/2),w=s*Math.sin(p.startAngle+p.angle/2),E=s*Math.cos(p.startAngle+p.angle/1.5),S=s*Math.sin(p.startAngle+p.angle/1.5),x=s*Math.cos(p.startAngle+p.angle),T=s*Math.sin(p.startAngle+p.angle),N=[[0,0],[d,v],[m,y],[b,w],[E,S],[x,T]],C=[o,l];if(g(N,C))return c.restore(),{datapoint:[p.percent,p.data],dataIndex:0,series:p,seriesIndex:h}}c.restore()}}return null}function b(e){E("plothover",e)}function w(e){E("plotclick",e)}function E(e,t){var n=r.offset(),i=parseInt(t.pageX-n.left),u=parseInt(t.pageY-n.top),a=y(i,u);if(o.grid.autoHighlight)for(var f=0;f<h.length;++f){var l=h[f];l.auto==e&&(!a||l.series!=a.series)&&x(l.series)}a&&S(a.series,e);var c={pageX:t.pageX,pageY:t.pageY};s.trigger(e,[c,a])}function S(e,t){var n=T(e);n==-1?(h.push({series:e,auto:t}),r.triggerRedrawOverlay()):t||(h[n].auto=!1)}function x(e){e==null&&(h=[],r.triggerRedrawOverlay());var t=T(e);t!=-1&&(h.splice(t,1),r.triggerRedrawOverlay())}function T(e){for(var t=0;t<h.length;++t){var n=h[t];if(n.series==e)return t}return-1}function N(e,t){function s(e){if(e.angle<=0||isNaN(e.angle))return;t.fillStyle="rgba(255, 255, 255, "+n.series.pie.highlight.opacity+")",t.beginPath(),Math.abs(e.angle-Math.PI*2)>1e-9&&t.moveTo(0,0),t.arc(0,0,r,e.startAngle,e.startAngle+e.angle/2,!1),t.arc(0,0,r,e.startAngle+e.angle/2,e.startAngle+e.angle,!1),t.closePath(),t.fill()}var n=e.getOptions(),r=n.series.pie.radius>1?n.series.pie.radius:u*n.series.pie.radius;t.save(),t.translate(a,f),t.scale(1,n.series.pie.tilt);for(var i=0;i<h.length;++i)s(h[i].series);m(t),t.restore()}var i=null,s=null,o=null,u=null,a=null,f=null,l=!1,c=null,h=[];r.hooks.processOptions.push(function(e,t){t.series.pie.show&&(t.grid.show=!1,t.series.pie.label.show=="auto"&&(t.legend.show?t.series.pie.label.show=!1:t.series.pie.label.show=!0),t.series.pie.radius=="auto"&&(t.series.pie.label.show?t.series.pie.radius=.75:t.series.pie.radius=1),t.series.pie.tilt>1?t.series.pie.tilt=1:t.series.pie.tilt<0&&(t.series.pie.tilt=0))}),r.hooks.bindEvents.push(function(e,t){var n=e.getOptions();n.series.pie.show&&(n.grid.hoverable&&t.unbind("mousemove").mousemove(b),n.grid.clickable&&t.unbind("click").click(w))}),r.hooks.processDatapoints.push(function(e,t,n,r){var i=e.getOptions();i.series.pie.show&&p(e,t,n,r)}),r.hooks.drawOverlay.push(function(e,t){var n=e.getOptions();n.series.pie.show&&N(e,t)}),r.hooks.draw.push(function(e,t){var n=e.getOptions();n.series.pie.show&&v(e,t)})}var t=10,n=.95,i={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(e,t){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+t.color+";'>"+e+"<br/>"+Math.round(t.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};e.plot.plugins.push({init:r,options:i,name:"pie",version:"1.1"})}(jQuery),define("external/jquery-flot-pie-min.js",function(){}),define("core/EnvProcessorReport",["AppConst","utilities","core/TPComm"],function(e,t,n){function s(){t.showPreloader(),e.module="Report";var r=n.getData(document.TPInterfaceConst.DATATYPE_ENVIRONMENT);if(r=="None"){var i=t.getParameterByName("stand_alone");r=i==="true"?"OFP":"HDL"}o(r)}function o(s){e.appEnvironment=s;switch(s){case"Reader":e.ws=e.wsSet[1],i=n.getData(document.TPInterfaceConst.DATATYPE_GET_INITIAL_DATA),a(function(n){if(n){rendererVars={userID:i.userId,samsID:"12345",userToken:i.properties.token,reportToken:i.properties.reportToken,username:i.userName,isbn:r.titleISBN,dlwebservicePath:i.properties.reportWS,aeWebServicePath:i.properties.assessmentWS,contentBaseUrl:i.widgetDataFolder+r.relativeURI,bookName:i.bookName};if(!r.saveInDL&&r.saveInDL!=undefined){e.appEnvironment=s="Editor",o(s);return}u(),myview.renderTemplate()}else t.log("3pw.json not found!")}),e.reportCardImage=i.widgetDataFolder+"courseHome.jpg";break;case"ReaderMobile":case"Editor":i=n.getData(document.TPInterfaceConst.DATATYPE_GET_INITIAL_DATA),a(function(n){if(n){rendererVars={userID:i.userId,samsID:"12345",userToken:i.properties.token,reportToken:i.properties.reportToken,username:i.userName,isbn:r.titleISBN,dlwebservicePath:i.properties.reportWS,aeWebServicePath:i.properties.assessmentWS,contentBaseUrl:i.widgetDataFolder+r.relativeURI,bookName:i.bookName};if(!r.saveInDL&&s=="ReaderMobile"&&r.saveInDL!=undefined){e.appEnvironment=s="Editor",o(s);return}u(),myview.renderTemplate()}else t.log("3pw.json not found!")}),e.reportCardImage=i.widgetDataFolder+"courseHome.jpg",e.ws=e.wsSet[1];break;case"OFP":e.userid=t.getParameterByName("userID"),e.username=t.getParameterByName("username"),e.bookName=t.getParameterByName("bookName"),e.isbn=t.getParameterByName("ISBN"),e.reportCardImage=t.getParameterByName("imagePath")+"/courseHome.jpg",t.log("Fetched Params for OFP from QueryString: "+e.username+" | "+e.bookName+" | "+e.reportCardImage);break;default:console.log("default environment")}}function u(){rendererVars!=undefined&&(e.OFFLINE=rendererVars.offline,e.testid=rendererVars.testID?rendererVars.testID:e.testID,e.mode=rendererVars.mode?rendererVars.mode:e.mode,e.userid=rendererVars.userID?rendererVars.userID:e.userID,e.samsid=rendererVars.samsID?rendererVars.samsID:e.samsID,e.usertoken=rendererVars.userToken?rendererVars.userToken:e.userToken,e.username=rendererVars.username?decodeURIComponent(rendererVars.username):decodeURIComponent(e.username),e.dlWebservicePath=rendererVars.dlwebservicePath?rendererVars.dlwebservicePath:e.dlWebservicePath,e.aeWebServicePath=rendererVars.aeWebServicePath?rendererVars.aeWebServicePath:e.aeWebServicePath,e.dlAuthorizationServiceURL=rendererVars.dlAuthorizationServiceURL?rendererVars.dlAuthorizationServiceURL:e.dlAuthorizationServiceURL,e.ASSETS_PATH=rendererVars.contentBaseUrl?rendererVars.contentBaseUrl:e.ASSETS_PATH,e.siteURL=rendererVars.siteURL?rendererVars.siteURL:e.siteURL,e.OFFLINE_PATH=rendererVars.relativePath,e.launchID=rendererVars.launchID,e.timetakeninseconds=rendererVars.timeTakenInSeconds?rendererVars.timeTakenInSeconds:e.timeTakenInSeconds,e.isbn=rendererVars.isbn?rendererVars.isbn:e.isbn,e.bookName=rendererVars.bookName?rendererVars.bookName:e.bookName,e.reportToken=rendererVars.reportToken?rendererVars.reportToken:e.reportToken),e.OFFLINE?e.OFFLINE_PATH=rendererVars.relativePath:e.OFFLINE_PATH=""}function a(e){$.ajax({url:i.widgetDataFolder+"/3pw.json",dataType:"JSON",success:function(n){t.log("3pw data loaded."),r=n,e(!0)},error:function(n){t.log("Error in loading 3pw data: "+n.status),e(!1)}})}var r,i;return{config:s}}),define("core/view/reportCardView",["backbone","external/jquery-flot-min.js","external/jquery-flot-pie-min.js","core/model/localStorageDataVO","core/collections/testRecordCollection","core/EnvProcessorReport","core/SyncProcessor","utilities","AppConst","core/TPComm"],function(e,t,n,r,i,s,o,u,a,f){var l=e.View.extend({configure:function(){u.showPreloader(),s.config(),a.appEnvironment=="OFP"&&(this.render(),u.hidePreloader())},renderTemplate:function(){var e=this;if(a.appEnvironment=="Editor")e.render(),u.hidePreloader();else if(a.appEnvironment=="ReaderMobile"){var t=f.getData(document.TPInterfaceConst.DATATYPE_NETWORK_STATUS);a.OFFLINE=t.status?!1:!0,u.log("In report card ReaderMobile :: READERMOBILE NETWORK STATUS | AppConst.OFFLINE: "+a.OFFLINE+" & isOnline.status: "+t.status),t.status==1?o.updateSync(function(t){t=="empty"&&u.log("No data from reader mobile report card WS"),e.render(),u.hidePreloader()}):(e.render(),u.hidePreloader(),u.log("No updateSync triggered in report :: READERMOBILE NETWORK STATUS | AppConst.OFFLINE: "+a.OFFLINE+" & isOnline.status: "+t.status))}else o.getAllTestData(a.userid,function(t){e.render(),u.hidePreloader()})},el:".container",events:{"click .sortBtn":"doSorting","click span.review-btn":"toReview"},templates:"<div class='center-content' id='resultsContentCover' style='width: 95%;max-width: 100%;'>					  <div class='ProgressSWrapper'>					    <div class='report-heading'>					      <h1 id='userName'></h1>					      <h2 id='bookName'></h2>					    </div>					    <div class='ReportSumContainer'>					      <h3>Test progress summary</h3>					      <div class='progress-section'>					        <div class='imagecontainer'></div>					        <div class='progressreport1'>					          <h4>Number of tests taken </h4>					          <h2 id='reportTestsTaken'>N/A</h2>					        </div>					        <div class='progressreport2'>					          <h4>Percent</h4>					          <h2 id='reportPercent'></h2>					        </div>					        <div class='progressreport3' >					          <div class='chartlegend'><h4>Total Score:</h4>					            <ul>					              <li><span style='background:#6b8fe5;'></span>Marks gained</li>					              <li><span style='background:#ccc;'></span>Marks dropped</li>					            </ul>					          </div>					          <div id='placeholder' class='pie-chart'></div>					        </div>					      </div>					    </div>					  </div>					</div>					<div id='detailedProgressCover'>					    <div class='resques'>					      <ul class='result-grid-header'>					        <li>					        <span class='col-1' >Test Name<button class ='sortBtn' data = 'testName'></button></span>					        <span class='col-2' >Last Taken (attempts)<button class ='sortBtn' data = 'lastTaken'></button></span>					        <span class='col-3' >Grade<button class ='sortBtn' data = 'grade'></button></span>					        <span class='col-4' >Score<button class ='sortBtn' data = 'Score'></button></span>					        <span class='col-5' >Review Test</span>					        </li>					      </ul>					      <ul class='progress-ui'>					       </ul>					    </div>					</div>",templateTable:"<% _.each(collection, function(model) { %>								<li class='progress-text '>									<span class='col-1 title' style='text-align:left!important'><%= model.test_name %></span>							        <span class='col-2'><%= model.date %> (x<%= model.attempts_taken %>)</span>							        <span class='col-3'>							        	<%= model.grade %>							        </span>							        <span class='score-wrapper col-4'>							          <span class='indicator'></span>							          <span class='score' style='width:auto'>							          	<% var per = (parseInt(model.test_metadata.ReceivedMarks)/parseInt(model.max_score))*100;per=Math.round(per); %>							          <%= per %>%&nbsp;&nbsp;(<%=model.test_metadata.ReceivedMarks%>/<%=model.max_score%>)</span>							        </span>							        <span class='review-outer col-5' id='review<%=model.test_id%>'>							          <span class='review-btn'>Review</span>							        </span>						        </li>							<% }); %>",doSorting:function(e){title=$(e.target).attr("data"),sortArray[title]=="ascending"?(newTitle="-"+title,sortArray[title]="descending"):(newTitle=title,sortArray[title]="ascending"),event_bus.trigger("doSorting",e,newTitle),this.collection.sort(),this.generateTestDataTable(),$(".sortBtn").removeClass("desc").removeClass("asc"),newTitle.indexOf("-")>-1?$("button[data="+title+"]").addClass("desc"):$("button[data="+title+"]").addClass("asc")},generateTestDataTable:function(){var e=_.template(this.templateTable);$(".progress-ui").empty().append(e({collection:this.collection.toJSON()})),$(".score-wrapper").each(function(e,t){var n=parseInt($(t).children("span.score").html());n<34?respColor="incorrect":n>=34&&n<=66?respColor="partial":respColor="correct",$(t).addClass(respColor)}),this.collection.length==0&&$(".progress-ui").append("<div class='report-no-data'>No Results</div>"),a.appEnvironment=="Reader"|a.appEnvironment=="ReaderMobile"|a.appEnvironment=="Editor"&&($("span.col-5").hide(),$("span.col-4").css({"border-right":"none"}))},toReview:function(e){var t=window.location.href.split("#")[0].replace("reportCard","index"),n=e.target.parentElement.id.split("review")[1];u.log("captured testid : "+n);if(a.appEnvironment=="OFP"){var r=u.getParameterByName("stand_alone")?"true":"false",i=u.getParameterByName("userID"),s=u.getParameterByName("ISBN"),o=mycollection.where({user_id:i,test_id:n,isbn:s}),f=t+"#stand_alone="+r+"&userid="+i+"&mode=REVIEW&test_data_url="+o[0].attributes.data_url+"&ISBN="+s+"&contentBaseUrl="+o[0].attributes.base_url;window.open(f,"")}else u.log("new url ----- "+t+"#testid="+n+"&mode=REVIEW&reportView=true"),window.open(t+"#testid="+n+"&mode=REVIEW&reportView=true","_self")},render:function(){var e=0,t=0,n=[],r=[],i=[],s=[];this.collection.fetch(),i=this.collection.where({user_id:a.userid,isbn:a.isbn}),s=_.filter(i,function(e){n.indexOf(e.get("test_id"))==-1&&n.push(e.get("test_id"))});for(var o=0;o<n.length;o++){var f=this.collection.where({user_id:a.userid,test_id:n[o],isbn:a.isbn}),l=u.getLatestTestData(f);r.push(l)}u.log("Sorted n filtered report models: ",r),_.each(r,function(e){e.attributes.date=e.attributes.date.replace(/\b0+/g,"")}),u.log("Report generated for userid:"+a.userid+" & isbn:"+a.isbn);if(a.OFFLINE==0||a.appEnvironment=="Reader")r=r.reverse(),u.log("Reversal of report Data");this.collection.reset(r);var c=this.collection.models;indicatorArray=[];for(var o=0;o<c.length;o++){var h=parseInt(c[o].attributes.max_score),p=parseInt(c[o].attributes.test_metadata.ReceivedMarks);t+=h,e+=p;var d=Math.round(p*100/h);d<34?indicatorArray[o]="incorrect":d>=34&&d<=66?indicatorArray[o]="partial":indicatorArray[o]="correct"}datapie=[{label:"Marks gained",data:0,color:"rgb(107,143,229)"},{label:"Marks dropped",data:0,color:"rgb(204,204,204)"}],datapie[0].data=e,datapie[1].data=t-e;var v=datapie[0].data/t*100,m=_.template(this.templates);$(".container").append(this.$el.html(m())),this.generateTestDataTable(),$("#userName").html(a.username),$("#bookName").html(a.bookName),$("div.imagecontainer").html("<img src='"+a.reportCardImage+"' alt='image'/>");var g=isNaN(v)?"0%":Math.round(v)+"%";$("#reportPercent").html(g),$("#reportTestsTaken").html(c.length),$.plot($("#placeholder"),datapie,{series:{pie:{show:!0,radius:65,label:{show:!0,radius:.5,formatter:function(e,t){return'<div style="font-size:8pt;text-align:center;padding:2px;color:#000;">'+t.data[0][1]+"</div>"}},threshold:.1}},legend:{show:!1}})}});return l}),require.config({paths:{jquery:"external/jQuery",underscore:"external/underscore",backbone:"external/backbone",language:"core/language",utilities:"core/utilities",AppConst:"core/AppConst",AppEvent:"core/AppEvent",spinningwheel:"external/spinningwheel-min",xdomainrequest:"external/jquery.xdomainrequest.min",cryptojs:"external/crypto",backboneLocalstorage:"external/backbone.localStorage",SyncProcessor:"core/SyncProcessor",EnvProcessor:"core/EnvProcessor"},shim:{backbone:{exports:"Backbone",deps:["underscore"]},underscore:{exports:"_"},APIConsumer:{deps:["backbone","underscore"],exports:"App"},"core/TPComm":{dpes:["backbone","underscore"],exports:"TPComm"}}}),require(["underscore","jquery","backbone","external/xml2json","APIConsumer","utilities","xdomainrequest","cryptojs","backboneLocalstorage","core/collections/reportCardViewCollection","core/model/reportCardViewVO","core/view/reportCardView"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h='<div id=page>		<!-- Div structure for background overlay -->		<div class="overlay" style="display: none">    		<div id="preloader" ></div>		</div>		<div id ="" class="orientation-popup" style="display: none">				<div class="popup-head-gradient"></div>				<span id="orientation-popup-text">  </span>				</div>		<div id="feedbackOverlay">			<div id="feedbackWrapper">				<div id="closeFeedback" class="closeFeedback closeBtn" ></div>				<span class="feedbackTitle">Question Feedback</span>				<div id="contentWrapper">					<div id="feedbackContent"></div>				</div>			</div>		</div>		<div class="infoOverlay">			<div class="infoWrapper">				<div class="closeBtn closeBtn2" ></div>				<div class="contentWrapper">					<div class="infoContent"></div>				</div>			</div>		</div>		<div id="toast" class="Overlay_toast" style="display: none;">			<div class="toast_message"></div>		</div>		<!-- Div structure for progress loader -->		<div id="floatingCirclesG" style="display: none">			<div class="f_circleG" id="frotateG_01">			</div>			<div class="f_circleG" id="frotateG_02">			</div>			<div class="f_circleG" id="frotateG_03">			</div>			<div class="f_circleG" id="frotateG_04">			</div>			<div class="f_circleG" id="frotateG_05">			</div>			<div class="f_circleG" id="frotateG_06">			</div>			<div class="f_circleG" id="frotateG_07">			</div>			<div class="f_circleG" id="frotateG_08">			</div>		</div>		<!-- container for loading screens in test player-->		<div id="screens"></div>		</div>';t(document.body).append(h),event_bus=e.extend({},n.Events),window.App=i,i.init()}),define("main",function(){});